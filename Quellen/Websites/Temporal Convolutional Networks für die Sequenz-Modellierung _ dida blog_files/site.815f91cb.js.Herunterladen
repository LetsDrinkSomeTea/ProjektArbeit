var Iv=!1,Pv=!1,Gl=[];function Rk(e){Dk(e)}function Dk(e){Gl.includes(e)||Gl.push(e),Ok()}function _S(e){let i=Gl.indexOf(e);i!==-1&&Gl.splice(i,1)}function Ok(){!Pv&&!Iv&&(Iv=!0,queueMicrotask(Fk))}function Fk(){Iv=!1,Pv=!0;for(let e=0;e<Gl.length;e++)Gl[e]();Gl.length=0,Pv=!1}var Vu,_f,dg,yS,kv=!0;function Bk(e){kv=!1,e(),kv=!0}function Nk(e){Vu=e.reactive,dg=e.release,_f=i=>e.effect(i,{scheduler:a=>{kv?Rk(a):a()}}),yS=e.raw}function Nw(e){_f=e}function Uk(e){let i=()=>{};return[c=>{let d=_f(c);return e._x_effects||(e._x_effects=new Set,e._x_runEffects=()=>{e._x_effects.forEach(f=>f())}),e._x_effects.add(d),i=()=>{d!==void 0&&(e._x_effects.delete(d),dg(d))},d},()=>{i()}]}var vS=[],xS=[],bS=[];function Vk(e){bS.push(e)}function wS(e,i){typeof i=="function"?(e._x_cleanups||(e._x_cleanups=[]),e._x_cleanups.push(i)):(i=e,xS.push(i))}function $k(e){vS.push(e)}function jk(e,i,a){e._x_attributeCleanups||(e._x_attributeCleanups={}),e._x_attributeCleanups[i]||(e._x_attributeCleanups[i]=[]),e._x_attributeCleanups[i].push(a)}function TS(e,i){!e._x_attributeCleanups||Object.entries(e._x_attributeCleanups).forEach(([a,c])=>{(i===void 0||i.includes(a))&&(c.forEach(d=>d()),delete e._x_attributeCleanups[a])})}var k0=new MutationObserver(R0),L0=!1;function ES(){k0.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),L0=!0}function Gk(){qk(),k0.disconnect(),L0=!1}var Bd=[],Dy=!1;function qk(){Bd=Bd.concat(k0.takeRecords()),Bd.length&&!Dy&&(Dy=!0,queueMicrotask(()=>{Wk(),Dy=!1}))}function Wk(){R0(Bd),Bd.length=0}function tr(e){if(!L0)return e();Gk();let i=e();return ES(),i}var z0=!1,Om=[];function Hk(){z0=!0}function Zk(){z0=!1,R0(Om),Om=[]}function R0(e){if(z0){Om=Om.concat(e);return}let i=[],a=[],c=new Map,d=new Map;for(let f=0;f<e.length;f++)if(!e[f].target._x_ignoreMutationObserver&&(e[f].type==="childList"&&(e[f].addedNodes.forEach(y=>y.nodeType===1&&i.push(y)),e[f].removedNodes.forEach(y=>y.nodeType===1&&a.push(y))),e[f].type==="attributes")){let y=e[f].target,s=e[f].attributeName,w=e[f].oldValue,C=()=>{c.has(y)||c.set(y,[]),c.get(y).push({name:s,value:y.getAttribute(s)})},L=()=>{d.has(y)||d.set(y,[]),d.get(y).push(s)};y.hasAttribute(s)&&w===null?C():y.hasAttribute(s)?(L(),C()):L()}d.forEach((f,y)=>{TS(y,f)}),c.forEach((f,y)=>{vS.forEach(s=>s(y,f))});for(let f of a)if(!i.includes(f)&&(xS.forEach(y=>y(f)),f._x_cleanups))for(;f._x_cleanups.length;)f._x_cleanups.pop()();i.forEach(f=>{f._x_ignoreSelf=!0,f._x_ignore=!0});for(let f of i)a.includes(f)||!f.isConnected||(delete f._x_ignoreSelf,delete f._x_ignore,bS.forEach(y=>y(f)),f._x_ignore=!0,f._x_ignoreSelf=!0);i.forEach(f=>{delete f._x_ignoreSelf,delete f._x_ignore}),i=null,a=null,c=null,d=null}function SS(e){return vf(bu(e))}function yf(e,i,a){return e._x_dataStack=[i,...bu(a||e)],()=>{e._x_dataStack=e._x_dataStack.filter(c=>c!==i)}}function Uw(e,i){let a=e._x_dataStack[0];Object.entries(i).forEach(([c,d])=>{a[c]=d})}function bu(e){return e._x_dataStack?e._x_dataStack:typeof ShadowRoot=="function"&&e instanceof ShadowRoot?bu(e.host):e.parentNode?bu(e.parentNode):[]}function vf(e){let i=new Proxy({},{ownKeys:()=>Array.from(new Set(e.flatMap(a=>Object.keys(a)))),has:(a,c)=>e.some(d=>d.hasOwnProperty(c)),get:(a,c)=>(e.find(d=>{if(d.hasOwnProperty(c)){let f=Object.getOwnPropertyDescriptor(d,c);if(f.get&&f.get._x_alreadyBound||f.set&&f.set._x_alreadyBound)return!0;if((f.get||f.set)&&f.enumerable){let y=f.get,s=f.set,w=f;y=y&&y.bind(i),s=s&&s.bind(i),y&&(y._x_alreadyBound=!0),s&&(s._x_alreadyBound=!0),Object.defineProperty(d,c,{...w,get:y,set:s})}return!0}return!1})||{})[c],set:(a,c,d)=>{let f=e.find(y=>y.hasOwnProperty(c));return f?f[c]=d:e[e.length-1][c]=d,!0}});return i}function AS(e){let i=c=>typeof c=="object"&&!Array.isArray(c)&&c!==null,a=(c,d="")=>{Object.entries(Object.getOwnPropertyDescriptors(c)).forEach(([f,{value:y,enumerable:s}])=>{if(s===!1||y===void 0)return;let w=d===""?f:`${d}.${f}`;typeof y=="object"&&y!==null&&y._x_interceptor?c[f]=y.initialize(e,w,f):i(y)&&y!==c&&!(y instanceof Element)&&a(y,w)})};return a(e)}function CS(e,i=()=>{}){let a={initialValue:void 0,_x_interceptor:!0,initialize(c,d,f){return e(this.initialValue,()=>Xk(c,d),y=>Lv(c,d,y),d,f)}};return i(a),c=>{if(typeof c=="object"&&c!==null&&c._x_interceptor){let d=a.initialize.bind(a);a.initialize=(f,y,s)=>{let w=c.initialize(f,y,s);return a.initialValue=w,d(f,y,s)}}else a.initialValue=c;return a}}function Xk(e,i){return i.split(".").reduce((a,c)=>a[c],e)}function Lv(e,i,a){if(typeof i=="string"&&(i=i.split(".")),i.length===1)e[i[0]]=a;else{if(i.length===0)throw error;return e[i[0]]||(e[i[0]]={}),Lv(e[i[0]],i.slice(1),a)}}var MS={};function Xs(e,i){MS[e]=i}function zv(e,i){return Object.entries(MS).forEach(([a,c])=>{Object.defineProperty(e,`$${a}`,{get(){let[d,f]=RS(i);return d={interceptor:CS,...d},wS(i,f),c(i,d)},enumerable:!1})}),e}function Kk(e,i,a,...c){try{return a(...c)}catch(d){rf(d,e,i)}}function rf(e,i,a=void 0){Object.assign(e,{el:i,expression:a}),console.warn(`Alpine Expression Error: ${e.message}

${a?'Expression: "'+a+`"

`:""}`,i),setTimeout(()=>{throw e},0)}var Cm=!0;function Yk(e){let i=Cm;Cm=!1,e(),Cm=i}function pu(e,i,a={}){let c;return Mr(e,i)(d=>c=d,a),c}function Mr(...e){return IS(...e)}var IS=PS;function Qk(e){IS=e}function PS(e,i){let a={};zv(a,e);let c=[a,...bu(e)];if(typeof i=="function")return Jk(c,i);let d=tL(c,i,e);return Kk.bind(null,e,i,d)}function Jk(e,i){return(a=()=>{},{scope:c={},params:d=[]}={})=>{let f=i.apply(vf([c,...e]),d);Fm(a,f)}}var Oy={};function eL(e,i){if(Oy[e])return Oy[e];let a=Object.getPrototypeOf(async function(){}).constructor,c=/^[\n\s]*if.*\(.*\)/.test(e)||/^(let|const)\s/.test(e)?`(() => { ${e} })()`:e,f=(()=>{try{return new a(["__self","scope"],`with (scope) { __self.result = ${c} }; __self.finished = true; return __self.result;`)}catch(y){return rf(y,i,e),Promise.resolve()}})();return Oy[e]=f,f}function tL(e,i,a){let c=eL(i,a);return(d=()=>{},{scope:f={},params:y=[]}={})=>{c.result=void 0,c.finished=!1;let s=vf([f,...e]);if(typeof c=="function"){let w=c(c,s).catch(C=>rf(C,a,i));c.finished?(Fm(d,c.result,s,y,a),c.result=void 0):w.then(C=>{Fm(d,C,s,y,a)}).catch(C=>rf(C,a,i)).finally(()=>c.result=void 0)}}}function Fm(e,i,a,c,d){if(Cm&&typeof i=="function"){let f=i.apply(a,c);f instanceof Promise?f.then(y=>Fm(e,y,a,c)).catch(y=>rf(y,d,i)):e(f)}else e(i)}var D0="x-";function $u(e=""){return D0+e}function iL(e){D0=e}var kS={};function Rn(e,i){kS[e]=i}function O0(e,i,a){if(i=Array.from(i),e._x_virtualDirectives){let f=Object.entries(e._x_virtualDirectives).map(([s,w])=>({name:s,value:w})),y=LS(f);f=f.map(s=>y.find(w=>w.name===s.name)?{name:`x-bind:${s.name}`,value:`"${s.value}"`}:s),i=i.concat(f)}let c={};return i.map(FS((f,y)=>c[f]=y)).filter(NS).map(sL(c,a)).sort(oL).map(f=>rL(e,f))}function LS(e){return Array.from(e).map(FS()).filter(i=>!NS(i))}var Rv=!1,Rd=new Map,zS=Symbol();function nL(e){Rv=!0;let i=Symbol();zS=i,Rd.set(i,[]);let a=()=>{for(;Rd.get(i).length;)Rd.get(i).shift()();Rd.delete(i)},c=()=>{Rv=!1,a()};e(a),c()}function RS(e){let i=[],a=s=>i.push(s),[c,d]=Uk(e);return i.push(d),[{Alpine:xf,effect:c,cleanup:a,evaluateLater:Mr.bind(Mr,e),evaluate:pu.bind(pu,e)},()=>i.forEach(s=>s())]}function rL(e,i){let a=()=>{},c=kS[i.type]||a,[d,f]=RS(e);jk(e,i.original,f);let y=()=>{e._x_ignore||e._x_ignoreSelf||(c.inline&&c.inline(e,i,d),c=c.bind(c,e,i,d),Rv?Rd.get(zS).push(c):c())};return y.runCleanups=f,y}var DS=(e,i)=>({name:a,value:c})=>(a.startsWith(e)&&(a=a.replace(e,i)),{name:a,value:c}),OS=e=>e;function FS(e=()=>{}){return({name:i,value:a})=>{let{name:c,value:d}=BS.reduce((f,y)=>y(f),{name:i,value:a});return c!==i&&e(c,i),{name:c,value:d}}}var BS=[];function F0(e){BS.push(e)}function NS({name:e}){return US().test(e)}var US=()=>new RegExp(`^${D0}([^:^.]+)\\b`);function sL(e,i){return({name:a,value:c})=>{let d=a.match(US()),f=a.match(/:([a-zA-Z0-9\-:]+)/),y=a.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],s=i||e[a]||a;return{type:d?d[1]:null,value:f?f[1]:null,modifiers:y.map(w=>w.replace(".","")),expression:c,original:s}}}var Dv="DEFAULT",lm=["ignore","ref","data","id","bind","init","for","mask","model","modelable","transition","show","if",Dv,"teleport"];function oL(e,i){let a=lm.indexOf(e.type)===-1?Dv:e.type,c=lm.indexOf(i.type)===-1?Dv:i.type;return lm.indexOf(a)-lm.indexOf(c)}function Nd(e,i,a={}){e.dispatchEvent(new CustomEvent(i,{detail:a,bubbles:!0,composed:!0,cancelable:!0}))}var Ov=[],B0=!1;function VS(e=()=>{}){return queueMicrotask(()=>{B0||setTimeout(()=>{Fv()})}),new Promise(i=>{Ov.push(()=>{e(),i()})})}function Fv(){for(B0=!1;Ov.length;)Ov.shift()()}function aL(){B0=!0}function Jl(e,i){if(typeof ShadowRoot=="function"&&e instanceof ShadowRoot){Array.from(e.children).forEach(d=>Jl(d,i));return}let a=!1;if(i(e,()=>a=!0),a)return;let c=e.firstElementChild;for(;c;)Jl(c,i),c=c.nextElementSibling}function wu(e,...i){console.warn(`Alpine Warning: ${e}`,...i)}function lL(){document.body||wu("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),Nd(document,"alpine:init"),Nd(document,"alpine:initializing"),ES(),Vk(i=>Fa(i,Jl)),wS(i=>uL(i)),$k((i,a)=>{O0(i,a).forEach(c=>c())});let e=i=>!fg(i.parentElement,!0);Array.from(document.querySelectorAll(GS())).filter(e).forEach(i=>{Fa(i)}),Nd(document,"alpine:initialized")}var N0=[],$S=[];function jS(){return N0.map(e=>e())}function GS(){return N0.concat($S).map(e=>e())}function qS(e){N0.push(e)}function WS(e){$S.push(e)}function fg(e,i=!1){return pg(e,a=>{if((i?GS():jS()).some(d=>a.matches(d)))return!0})}function pg(e,i){if(!!e){if(i(e))return e;if(e._x_teleportBack&&(e=e._x_teleportBack),!!e.parentElement)return pg(e.parentElement,i)}}function cL(e){return jS().some(i=>e.matches(i))}function Fa(e,i=Jl){nL(()=>{i(e,(a,c)=>{O0(a,a.attributes).forEach(d=>d()),a._x_ignore&&c()})})}function uL(e){Jl(e,i=>TS(i))}function U0(e,i){return Array.isArray(i)?Vw(e,i.join(" ")):typeof i=="object"&&i!==null?hL(e,i):typeof i=="function"?U0(e,i()):Vw(e,i)}function Vw(e,i){let a=d=>d.split(" ").filter(f=>!e.classList.contains(f)).filter(Boolean),c=d=>(e.classList.add(...d),()=>{e.classList.remove(...d)});return i=i===!0?i="":i||"",c(a(i))}function hL(e,i){let a=s=>s.split(" ").filter(Boolean),c=Object.entries(i).flatMap(([s,w])=>w?a(s):!1).filter(Boolean),d=Object.entries(i).flatMap(([s,w])=>w?!1:a(s)).filter(Boolean),f=[],y=[];return d.forEach(s=>{e.classList.contains(s)&&(e.classList.remove(s),y.push(s))}),c.forEach(s=>{e.classList.contains(s)||(e.classList.add(s),f.push(s))}),()=>{y.forEach(s=>e.classList.add(s)),f.forEach(s=>e.classList.remove(s))}}function mg(e,i){return typeof i=="object"&&i!==null?dL(e,i):fL(e,i)}function dL(e,i){let a={};return Object.entries(i).forEach(([c,d])=>{a[c]=e.style[c],c.startsWith("--")||(c=pL(c)),e.style.setProperty(c,d)}),setTimeout(()=>{e.style.length===0&&e.removeAttribute("style")}),()=>{mg(e,a)}}function fL(e,i){let a=e.getAttribute("style",i);return e.setAttribute("style",i),()=>{e.setAttribute("style",a||"")}}function pL(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Bv(e,i=()=>{}){let a=!1;return function(){a?i.apply(this,arguments):(a=!0,e.apply(this,arguments))}}Rn("transition",(e,{value:i,modifiers:a,expression:c},{evaluate:d})=>{typeof c=="function"&&(c=d(c)),c?mL(e,c,i):gL(e,a,i)});function mL(e,i,a){HS(e,U0,""),{enter:d=>{e._x_transition.enter.during=d},"enter-start":d=>{e._x_transition.enter.start=d},"enter-end":d=>{e._x_transition.enter.end=d},leave:d=>{e._x_transition.leave.during=d},"leave-start":d=>{e._x_transition.leave.start=d},"leave-end":d=>{e._x_transition.leave.end=d}}[a](i)}function gL(e,i,a){HS(e,mg);let c=!i.includes("in")&&!i.includes("out")&&!a,d=c||i.includes("in")||["enter"].includes(a),f=c||i.includes("out")||["leave"].includes(a);i.includes("in")&&!c&&(i=i.filter((j,q)=>q<i.indexOf("out"))),i.includes("out")&&!c&&(i=i.filter((j,q)=>q>i.indexOf("out")));let y=!i.includes("opacity")&&!i.includes("scale"),s=y||i.includes("opacity"),w=y||i.includes("scale"),C=s?0:1,L=w?bd(i,"scale",95)/100:1,k=bd(i,"delay",0),R=bd(i,"origin","center"),V="opacity, transform",H=bd(i,"duration",150)/1e3,J=bd(i,"duration",75)/1e3,ue="cubic-bezier(0.4, 0.0, 0.2, 1)";d&&(e._x_transition.enter.during={transformOrigin:R,transitionDelay:k,transitionProperty:V,transitionDuration:`${H}s`,transitionTimingFunction:ue},e._x_transition.enter.start={opacity:C,transform:`scale(${L})`},e._x_transition.enter.end={opacity:1,transform:"scale(1)"}),f&&(e._x_transition.leave.during={transformOrigin:R,transitionDelay:k,transitionProperty:V,transitionDuration:`${J}s`,transitionTimingFunction:ue},e._x_transition.leave.start={opacity:1,transform:"scale(1)"},e._x_transition.leave.end={opacity:C,transform:`scale(${L})`})}function HS(e,i,a={}){e._x_transition||(e._x_transition={enter:{during:a,start:a,end:a},leave:{during:a,start:a,end:a},in(c=()=>{},d=()=>{}){Nv(e,i,{during:this.enter.during,start:this.enter.start,end:this.enter.end},c,d)},out(c=()=>{},d=()=>{}){Nv(e,i,{during:this.leave.during,start:this.leave.start,end:this.leave.end},c,d)}})}window.Element.prototype._x_toggleAndCascadeWithTransitions=function(e,i,a,c){const d=document.visibilityState==="visible"?requestAnimationFrame:setTimeout;let f=()=>d(a);if(i){e._x_transition&&(e._x_transition.enter||e._x_transition.leave)?e._x_transition.enter&&(Object.entries(e._x_transition.enter.during).length||Object.entries(e._x_transition.enter.start).length||Object.entries(e._x_transition.enter.end).length)?e._x_transition.in(a):f():e._x_transition?e._x_transition.in(a):f();return}e._x_hidePromise=e._x_transition?new Promise((y,s)=>{e._x_transition.out(()=>{},()=>y(c)),e._x_transitioning.beforeCancel(()=>s({isFromCancelledTransition:!0}))}):Promise.resolve(c),queueMicrotask(()=>{let y=ZS(e);y?(y._x_hideChildren||(y._x_hideChildren=[]),y._x_hideChildren.push(e)):d(()=>{let s=w=>{let C=Promise.all([w._x_hidePromise,...(w._x_hideChildren||[]).map(s)]).then(([L])=>L());return delete w._x_hidePromise,delete w._x_hideChildren,C};s(e).catch(w=>{if(!w.isFromCancelledTransition)throw w})})})};function ZS(e){let i=e.parentNode;if(!!i)return i._x_hidePromise?i:ZS(i)}function Nv(e,i,{during:a,start:c,end:d}={},f=()=>{},y=()=>{}){if(e._x_transitioning&&e._x_transitioning.cancel(),Object.keys(a).length===0&&Object.keys(c).length===0&&Object.keys(d).length===0){f(),y();return}let s,w,C;_L(e,{start(){s=i(e,c)},during(){w=i(e,a)},before:f,end(){s(),C=i(e,d)},after:y,cleanup(){w(),C()}})}function _L(e,i){let a,c,d,f=Bv(()=>{tr(()=>{a=!0,c||i.before(),d||(i.end(),Fv()),i.after(),e.isConnected&&i.cleanup(),delete e._x_transitioning})});e._x_transitioning={beforeCancels:[],beforeCancel(y){this.beforeCancels.push(y)},cancel:Bv(function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();f()}),finish:f},tr(()=>{i.start(),i.during()}),aL(),requestAnimationFrame(()=>{if(a)return;let y=Number(getComputedStyle(e).transitionDuration.replace(/,.*/,"").replace("s",""))*1e3,s=Number(getComputedStyle(e).transitionDelay.replace(/,.*/,"").replace("s",""))*1e3;y===0&&(y=Number(getComputedStyle(e).animationDuration.replace("s",""))*1e3),tr(()=>{i.before()}),c=!0,requestAnimationFrame(()=>{a||(tr(()=>{i.end()}),Fv(),setTimeout(e._x_transitioning.finish,y+s),d=!0)})})}function bd(e,i,a){if(e.indexOf(i)===-1)return a;const c=e[e.indexOf(i)+1];if(!c||i==="scale"&&isNaN(c))return a;if(i==="duration"){let d=c.match(/([0-9]+)ms/);if(d)return d[1]}return i==="origin"&&["top","right","left","center","bottom"].includes(e[e.indexOf(i)+2])?[c,e[e.indexOf(i)+2]].join(" "):c}var Uv=!1;function gg(e,i=()=>{}){return(...a)=>Uv?i(...a):e(...a)}function yL(e,i){i._x_dataStack||(i._x_dataStack=e._x_dataStack),Uv=!0,xL(()=>{vL(i)}),Uv=!1}function vL(e){let i=!1;Fa(e,(c,d)=>{Jl(c,(f,y)=>{if(i&&cL(f))return y();i=!0,d(f,y)})})}function xL(e){let i=_f;Nw((a,c)=>{let d=i(a);return dg(d),()=>{}}),e(),Nw(i)}function XS(e,i,a,c=[]){switch(e._x_bindings||(e._x_bindings=Vu({})),e._x_bindings[i]=a,i=c.includes("camel")?CL(i):i,i){case"value":bL(e,a);break;case"style":TL(e,a);break;case"class":wL(e,a);break;default:EL(e,i,a);break}}function bL(e,i){if(e.type==="radio")e.attributes.value===void 0&&(e.value=i),window.fromModel&&(e.checked=$w(e.value,i));else if(e.type==="checkbox")Number.isInteger(i)?e.value=i:!Number.isInteger(i)&&!Array.isArray(i)&&typeof i!="boolean"&&![null,void 0].includes(i)?e.value=String(i):Array.isArray(i)?e.checked=i.some(a=>$w(a,e.value)):e.checked=!!i;else if(e.tagName==="SELECT")AL(e,i);else{if(e.value===i)return;e.value=i}}function wL(e,i){e._x_undoAddedClasses&&e._x_undoAddedClasses(),e._x_undoAddedClasses=U0(e,i)}function TL(e,i){e._x_undoAddedStyles&&e._x_undoAddedStyles(),e._x_undoAddedStyles=mg(e,i)}function EL(e,i,a){[null,void 0,!1].includes(a)&&ML(i)?e.removeAttribute(i):(KS(i)&&(a=i),SL(e,i,a))}function SL(e,i,a){e.getAttribute(i)!=a&&e.setAttribute(i,a)}function AL(e,i){const a=[].concat(i).map(c=>c+"");Array.from(e.options).forEach(c=>{c.selected=a.includes(c.value)})}function CL(e){return e.toLowerCase().replace(/-(\w)/g,(i,a)=>a.toUpperCase())}function $w(e,i){return e==i}function KS(e){return["disabled","checked","required","readonly","hidden","open","selected","autofocus","itemscope","multiple","novalidate","allowfullscreen","allowpaymentrequest","formnovalidate","autoplay","controls","loop","muted","playsinline","default","ismap","reversed","async","defer","nomodule"].includes(e)}function ML(e){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(e)}function IL(e,i,a){if(e._x_bindings&&e._x_bindings[i]!==void 0)return e._x_bindings[i];let c=e.getAttribute(i);return c===null?typeof a=="function"?a():a:KS(i)?!![i,"true"].includes(c):c===""?!0:c}function YS(e,i){var a;return function(){var c=this,d=arguments,f=function(){a=null,e.apply(c,d)};clearTimeout(a),a=setTimeout(f,i)}}function QS(e,i){let a;return function(){let c=this,d=arguments;a||(e.apply(c,d),a=!0,setTimeout(()=>a=!1,i))}}function PL(e){e(xf)}var Fl={},jw=!1;function kL(e,i){if(jw||(Fl=Vu(Fl),jw=!0),i===void 0)return Fl[e];Fl[e]=i,typeof i=="object"&&i!==null&&i.hasOwnProperty("init")&&typeof i.init=="function"&&Fl[e].init(),AS(Fl[e])}function LL(){return Fl}var JS={};function zL(e,i){let a=typeof i!="function"?()=>i:i;e instanceof Element?e2(e,a()):JS[e]=a}function RL(e){return Object.entries(JS).forEach(([i,a])=>{Object.defineProperty(e,i,{get(){return(...c)=>a(...c)}})}),e}function e2(e,i,a){let c=[];for(;c.length;)c.pop()();let d=Object.entries(i).map(([y,s])=>({name:y,value:s})),f=LS(d);d=d.map(y=>f.find(s=>s.name===y.name)?{name:`x-bind:${y.name}`,value:`"${y.value}"`}:y),O0(e,d,a).map(y=>{c.push(y.runCleanups),y()})}var t2={};function DL(e,i){t2[e]=i}function OL(e,i){return Object.entries(t2).forEach(([a,c])=>{Object.defineProperty(e,a,{get(){return(...d)=>c.bind(i)(...d)},enumerable:!1})}),e}var FL={get reactive(){return Vu},get release(){return dg},get effect(){return _f},get raw(){return yS},version:"3.10.3",flushAndStopDeferringMutations:Zk,dontAutoEvaluateFunctions:Yk,disableEffectScheduling:Bk,setReactivityEngine:Nk,closestDataStack:bu,skipDuringClone:gg,addRootSelector:qS,addInitSelector:WS,addScopeToNode:yf,deferMutations:Hk,mapAttributes:F0,evaluateLater:Mr,setEvaluator:Qk,mergeProxies:vf,findClosest:pg,closestRoot:fg,interceptor:CS,transition:Nv,setStyles:mg,mutateDom:tr,directive:Rn,throttle:QS,debounce:YS,evaluate:pu,initTree:Fa,nextTick:VS,prefixed:$u,prefix:iL,plugin:PL,magic:Xs,store:kL,start:lL,clone:yL,bound:IL,$data:SS,data:DL,bind:zL},xf=FL;function BL(e,i){const a=Object.create(null),c=e.split(",");for(let d=0;d<c.length;d++)a[c[d]]=!0;return i?d=>!!a[d.toLowerCase()]:d=>!!a[d]}var NL=Object.freeze({});Object.freeze([]);var i2=Object.assign,UL=Object.prototype.hasOwnProperty,_g=(e,i)=>UL.call(e,i),ql=Array.isArray,Ud=e=>n2(e)==="[object Map]",VL=e=>typeof e=="string",V0=e=>typeof e=="symbol",yg=e=>e!==null&&typeof e=="object",$L=Object.prototype.toString,n2=e=>$L.call(e),r2=e=>n2(e).slice(8,-1),$0=e=>VL(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,jL=e=>{const i=Object.create(null);return a=>i[a]||(i[a]=e(a))},GL=jL(e=>e.charAt(0).toUpperCase()+e.slice(1)),s2=(e,i)=>e!==i&&(e===e||i===i),Vv=new WeakMap,wd=[],po,Wl=Symbol("iterate"),$v=Symbol("Map key iterate");function qL(e){return e&&e._isEffect===!0}function WL(e,i=NL){qL(e)&&(e=e.raw);const a=XL(e,i);return i.lazy||a(),a}function HL(e){e.active&&(o2(e),e.options.onStop&&e.options.onStop(),e.active=!1)}var ZL=0;function XL(e,i){const a=function(){if(!a.active)return e();if(!wd.includes(a)){o2(a);try{return YL(),wd.push(a),po=a,e()}finally{wd.pop(),a2(),po=wd[wd.length-1]}}};return a.id=ZL++,a.allowRecurse=!!i.allowRecurse,a._isEffect=!0,a.active=!0,a.raw=e,a.deps=[],a.options=i,a}function o2(e){const{deps:i}=e;if(i.length){for(let a=0;a<i.length;a++)i[a].delete(e);i.length=0}}var Tu=!0,j0=[];function KL(){j0.push(Tu),Tu=!1}function YL(){j0.push(Tu),Tu=!0}function a2(){const e=j0.pop();Tu=e===void 0?!0:e}function qs(e,i,a){if(!Tu||po===void 0)return;let c=Vv.get(e);c||Vv.set(e,c=new Map);let d=c.get(a);d||c.set(a,d=new Set),d.has(po)||(d.add(po),po.deps.push(d),po.options.onTrack&&po.options.onTrack({effect:po,target:e,type:i,key:a}))}function Ba(e,i,a,c,d,f){const y=Vv.get(e);if(!y)return;const s=new Set,w=L=>{L&&L.forEach(k=>{(k!==po||k.allowRecurse)&&s.add(k)})};if(i==="clear")y.forEach(w);else if(a==="length"&&ql(e))y.forEach((L,k)=>{(k==="length"||k>=c)&&w(L)});else switch(a!==void 0&&w(y.get(a)),i){case"add":ql(e)?$0(a)&&w(y.get("length")):(w(y.get(Wl)),Ud(e)&&w(y.get($v)));break;case"delete":ql(e)||(w(y.get(Wl)),Ud(e)&&w(y.get($v)));break;case"set":Ud(e)&&w(y.get(Wl));break}const C=L=>{L.options.onTrigger&&L.options.onTrigger({effect:L,target:e,key:a,type:i,newValue:c,oldValue:d,oldTarget:f}),L.options.scheduler?L.options.scheduler(L):L()};s.forEach(C)}var QL=BL("__proto__,__v_isRef,__isVue"),l2=new Set(Object.getOwnPropertyNames(Symbol).map(e=>Symbol[e]).filter(V0)),JL=vg(),ez=vg(!1,!0),tz=vg(!0),iz=vg(!0,!0),Bm={};["includes","indexOf","lastIndexOf"].forEach(e=>{const i=Array.prototype[e];Bm[e]=function(...a){const c=vn(this);for(let f=0,y=this.length;f<y;f++)qs(c,"get",f+"");const d=i.apply(c,a);return d===-1||d===!1?i.apply(c,a.map(vn)):d}});["push","pop","shift","unshift","splice"].forEach(e=>{const i=Array.prototype[e];Bm[e]=function(...a){KL();const c=i.apply(this,a);return a2(),c}});function vg(e=!1,i=!1){return function(c,d,f){if(d==="__v_isReactive")return!e;if(d==="__v_isReadonly")return e;if(d==="__v_raw"&&f===(e?i?dz:T2:i?hz:w2).get(c))return c;const y=ql(c);if(!e&&y&&_g(Bm,d))return Reflect.get(Bm,d,f);const s=Reflect.get(c,d,f);return(V0(d)?l2.has(d):QL(d))||(e||qs(c,"get",d),i)?s:jv(s)?!y||!$0(d)?s.value:s:yg(s)?e?E2(s):H0(s):s}}var nz=c2(),rz=c2(!0);function c2(e=!1){return function(a,c,d,f){let y=a[c];if(!e&&(d=vn(d),y=vn(y),!ql(a)&&jv(y)&&!jv(d)))return y.value=d,!0;const s=ql(a)&&$0(c)?Number(c)<a.length:_g(a,c),w=Reflect.set(a,c,d,f);return a===vn(f)&&(s?s2(d,y)&&Ba(a,"set",c,d,y):Ba(a,"add",c,d)),w}}function sz(e,i){const a=_g(e,i),c=e[i],d=Reflect.deleteProperty(e,i);return d&&a&&Ba(e,"delete",i,void 0,c),d}function oz(e,i){const a=Reflect.has(e,i);return(!V0(i)||!l2.has(i))&&qs(e,"has",i),a}function az(e){return qs(e,"iterate",ql(e)?"length":Wl),Reflect.ownKeys(e)}var u2={get:JL,set:nz,deleteProperty:sz,has:oz,ownKeys:az},h2={get:tz,set(e,i){return console.warn(`Set operation on key "${String(i)}" failed: target is readonly.`,e),!0},deleteProperty(e,i){return console.warn(`Delete operation on key "${String(i)}" failed: target is readonly.`,e),!0}};i2({},u2,{get:ez,set:rz});i2({},h2,{get:iz});var G0=e=>yg(e)?H0(e):e,q0=e=>yg(e)?E2(e):e,W0=e=>e,xg=e=>Reflect.getPrototypeOf(e);function bg(e,i,a=!1,c=!1){e=e.__v_raw;const d=vn(e),f=vn(i);i!==f&&!a&&qs(d,"get",i),!a&&qs(d,"get",f);const{has:y}=xg(d),s=c?W0:a?q0:G0;if(y.call(d,i))return s(e.get(i));if(y.call(d,f))return s(e.get(f));e!==d&&e.get(i)}function wg(e,i=!1){const a=this.__v_raw,c=vn(a),d=vn(e);return e!==d&&!i&&qs(c,"has",e),!i&&qs(c,"has",d),e===d?a.has(e):a.has(e)||a.has(d)}function Tg(e,i=!1){return e=e.__v_raw,!i&&qs(vn(e),"iterate",Wl),Reflect.get(e,"size",e)}function d2(e){e=vn(e);const i=vn(this);return xg(i).has.call(i,e)||(i.add(e),Ba(i,"add",e,e)),this}function f2(e,i){i=vn(i);const a=vn(this),{has:c,get:d}=xg(a);let f=c.call(a,e);f?b2(a,c,e):(e=vn(e),f=c.call(a,e));const y=d.call(a,e);return a.set(e,i),f?s2(i,y)&&Ba(a,"set",e,i,y):Ba(a,"add",e,i),this}function p2(e){const i=vn(this),{has:a,get:c}=xg(i);let d=a.call(i,e);d?b2(i,a,e):(e=vn(e),d=a.call(i,e));const f=c?c.call(i,e):void 0,y=i.delete(e);return d&&Ba(i,"delete",e,void 0,f),y}function m2(){const e=vn(this),i=e.size!==0,a=Ud(e)?new Map(e):new Set(e),c=e.clear();return i&&Ba(e,"clear",void 0,void 0,a),c}function Eg(e,i){return function(c,d){const f=this,y=f.__v_raw,s=vn(y),w=i?W0:e?q0:G0;return!e&&qs(s,"iterate",Wl),y.forEach((C,L)=>c.call(d,w(C),w(L),f))}}function cm(e,i,a){return function(...c){const d=this.__v_raw,f=vn(d),y=Ud(f),s=e==="entries"||e===Symbol.iterator&&y,w=e==="keys"&&y,C=d[e](...c),L=a?W0:i?q0:G0;return!i&&qs(f,"iterate",w?$v:Wl),{next(){const{value:k,done:R}=C.next();return R?{value:k,done:R}:{value:s?[L(k[0]),L(k[1])]:L(k),done:R}},[Symbol.iterator](){return this}}}}function za(e){return function(...i){{const a=i[0]?`on key "${i[0]}" `:"";console.warn(`${GL(e)} operation ${a}failed: target is readonly.`,vn(this))}return e==="delete"?!1:this}}var g2={get(e){return bg(this,e)},get size(){return Tg(this)},has:wg,add:d2,set:f2,delete:p2,clear:m2,forEach:Eg(!1,!1)},_2={get(e){return bg(this,e,!1,!0)},get size(){return Tg(this)},has:wg,add:d2,set:f2,delete:p2,clear:m2,forEach:Eg(!1,!0)},y2={get(e){return bg(this,e,!0)},get size(){return Tg(this,!0)},has(e){return wg.call(this,e,!0)},add:za("add"),set:za("set"),delete:za("delete"),clear:za("clear"),forEach:Eg(!0,!1)},v2={get(e){return bg(this,e,!0,!0)},get size(){return Tg(this,!0)},has(e){return wg.call(this,e,!0)},add:za("add"),set:za("set"),delete:za("delete"),clear:za("clear"),forEach:Eg(!0,!0)},lz=["keys","values","entries",Symbol.iterator];lz.forEach(e=>{g2[e]=cm(e,!1,!1),y2[e]=cm(e,!0,!1),_2[e]=cm(e,!1,!0),v2[e]=cm(e,!0,!0)});function x2(e,i){const a=i?e?v2:_2:e?y2:g2;return(c,d,f)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?c:Reflect.get(_g(a,d)&&d in c?a:c,d,f)}var cz={get:x2(!1,!1)},uz={get:x2(!0,!1)};function b2(e,i,a){const c=vn(a);if(c!==a&&i.call(e,c)){const d=r2(e);console.warn(`Reactive ${d} contains both the raw and reactive versions of the same object${d==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var w2=new WeakMap,hz=new WeakMap,T2=new WeakMap,dz=new WeakMap;function fz(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pz(e){return e.__v_skip||!Object.isExtensible(e)?0:fz(r2(e))}function H0(e){return e&&e.__v_isReadonly?e:S2(e,!1,u2,cz,w2)}function E2(e){return S2(e,!0,h2,uz,T2)}function S2(e,i,a,c,d){if(!yg(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&!(i&&e.__v_isReactive))return e;const f=d.get(e);if(f)return f;const y=pz(e);if(y===0)return e;const s=new Proxy(e,y===2?c:a);return d.set(e,s),s}function vn(e){return e&&vn(e.__v_raw)||e}function jv(e){return Boolean(e&&e.__v_isRef===!0)}Xs("nextTick",()=>VS);Xs("dispatch",e=>Nd.bind(Nd,e));Xs("watch",(e,{evaluateLater:i,effect:a})=>(c,d)=>{let f=i(c),y=!0,s,w=a(()=>f(C=>{JSON.stringify(C),y?s=C:queueMicrotask(()=>{d(C,s),s=C}),y=!1}));e._x_effects.delete(w)});Xs("store",LL);Xs("data",e=>SS(e));Xs("root",e=>fg(e));Xs("refs",e=>(e._x_refs_proxy||(e._x_refs_proxy=vf(mz(e))),e._x_refs_proxy));function mz(e){let i=[],a=e;for(;a;)a._x_refs&&i.push(a._x_refs),a=a.parentNode;return i}var Fy={};function A2(e){return Fy[e]||(Fy[e]=0),++Fy[e]}function gz(e,i){return pg(e,a=>{if(a._x_ids&&a._x_ids[i])return!0})}function _z(e,i){e._x_ids||(e._x_ids={}),e._x_ids[i]||(e._x_ids[i]=A2(i))}Xs("id",e=>(i,a=null)=>{let c=gz(e,i),d=c?c._x_ids[i]:A2(i);return a?`${i}-${d}-${a}`:`${i}-${d}`});Xs("el",e=>e);C2("Focus","focus","focus");C2("Persist","persist","persist");function C2(e,i,a){Xs(i,c=>wu(`You can't use [$${directiveName}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${a}`,c))}Rn("modelable",(e,{expression:i},{effect:a,evaluateLater:c})=>{let d=c(i),f=()=>{let C;return d(L=>C=L),C},y=c(`${i} = __placeholder`),s=C=>y(()=>{},{scope:{__placeholder:C}}),w=f();s(w),queueMicrotask(()=>{if(!e._x_model)return;e._x_removeModelListeners.default();let C=e._x_model.get,L=e._x_model.set;a(()=>s(C())),a(()=>L(f()))})});Rn("teleport",(e,{expression:i},{cleanup:a})=>{e.tagName.toLowerCase()!=="template"&&wu("x-teleport can only be used on a <template> tag",e);let c=document.querySelector(i);c||wu(`Cannot find x-teleport element for selector: "${i}"`);let d=e.content.cloneNode(!0).firstElementChild;e._x_teleport=d,d._x_teleportBack=e,e._x_forwardEvents&&e._x_forwardEvents.forEach(f=>{d.addEventListener(f,y=>{y.stopPropagation(),e.dispatchEvent(new y.constructor(y.type,y))})}),yf(d,{},e),tr(()=>{c.appendChild(d),Fa(d),d._x_ignore=!0}),a(()=>d.remove())});var M2=()=>{};M2.inline=(e,{modifiers:i},{cleanup:a})=>{i.includes("self")?e._x_ignoreSelf=!0:e._x_ignore=!0,a(()=>{i.includes("self")?delete e._x_ignoreSelf:delete e._x_ignore})};Rn("ignore",M2);Rn("effect",(e,{expression:i},{effect:a})=>a(Mr(e,i)));function I2(e,i,a,c){let d=e,f=w=>c(w),y={},s=(w,C)=>L=>C(w,L);if(a.includes("dot")&&(i=yz(i)),a.includes("camel")&&(i=vz(i)),a.includes("passive")&&(y.passive=!0),a.includes("capture")&&(y.capture=!0),a.includes("window")&&(d=window),a.includes("document")&&(d=document),a.includes("prevent")&&(f=s(f,(w,C)=>{C.preventDefault(),w(C)})),a.includes("stop")&&(f=s(f,(w,C)=>{C.stopPropagation(),w(C)})),a.includes("self")&&(f=s(f,(w,C)=>{C.target===e&&w(C)})),(a.includes("away")||a.includes("outside"))&&(d=document,f=s(f,(w,C)=>{e.contains(C.target)||C.target.isConnected!==!1&&(e.offsetWidth<1&&e.offsetHeight<1||e._x_isShown!==!1&&w(C))})),a.includes("once")&&(f=s(f,(w,C)=>{w(C),d.removeEventListener(i,f,y)})),f=s(f,(w,C)=>{bz(i)&&wz(C,a)||w(C)}),a.includes("debounce")){let w=a[a.indexOf("debounce")+1]||"invalid-wait",C=Gv(w.split("ms")[0])?Number(w.split("ms")[0]):250;f=YS(f,C)}if(a.includes("throttle")){let w=a[a.indexOf("throttle")+1]||"invalid-wait",C=Gv(w.split("ms")[0])?Number(w.split("ms")[0]):250;f=QS(f,C)}return d.addEventListener(i,f,y),()=>{d.removeEventListener(i,f,y)}}function yz(e){return e.replace(/-/g,".")}function vz(e){return e.toLowerCase().replace(/-(\w)/g,(i,a)=>a.toUpperCase())}function Gv(e){return!Array.isArray(e)&&!isNaN(e)}function xz(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase()}function bz(e){return["keydown","keyup"].includes(e)}function wz(e,i){let a=i.filter(f=>!["window","document","prevent","stop","once"].includes(f));if(a.includes("debounce")){let f=a.indexOf("debounce");a.splice(f,Gv((a[f+1]||"invalid-wait").split("ms")[0])?2:1)}if(a.length===0||a.length===1&&Gw(e.key).includes(a[0]))return!1;const d=["ctrl","shift","alt","meta","cmd","super"].filter(f=>a.includes(f));return a=a.filter(f=>!d.includes(f)),!(d.length>0&&d.filter(y=>((y==="cmd"||y==="super")&&(y="meta"),e[`${y}Key`])).length===d.length&&Gw(e.key).includes(a[0]))}function Gw(e){if(!e)return[];e=xz(e);let i={ctrl:"control",slash:"/",space:"-",spacebar:"-",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",equal:"="};return i[e]=e,Object.keys(i).map(a=>{if(i[a]===e)return a}).filter(a=>a)}Rn("model",(e,{modifiers:i,expression:a},{effect:c,cleanup:d})=>{let f=Mr(e,a),y=`${a} = rightSideOfExpression($event, ${a})`,s=Mr(e,y);var w=e.tagName.toLowerCase()==="select"||["checkbox","radio"].includes(e.type)||i.includes("lazy")?"change":"input";let C=Tz(e,i,a),L=I2(e,w,i,R=>{s(()=>{},{scope:{$event:R,rightSideOfExpression:C}})});e._x_removeModelListeners||(e._x_removeModelListeners={}),e._x_removeModelListeners.default=L,d(()=>e._x_removeModelListeners.default());let k=Mr(e,`${a} = __placeholder`);e._x_model={get(){let R;return f(V=>R=V),R},set(R){k(()=>{},{scope:{__placeholder:R}})}},e._x_forceModelUpdate=()=>{f(R=>{R===void 0&&a.match(/\./)&&(R=""),window.fromModel=!0,tr(()=>XS(e,"value",R)),delete window.fromModel})},c(()=>{i.includes("unintrusive")&&document.activeElement.isSameNode(e)||e._x_forceModelUpdate()})});function Tz(e,i,a){return e.type==="radio"&&tr(()=>{e.hasAttribute("name")||e.setAttribute("name",a)}),(c,d)=>tr(()=>{if(c instanceof CustomEvent&&c.detail!==void 0)return c.detail||c.target.value;if(e.type==="checkbox")if(Array.isArray(d)){let f=i.includes("number")?By(c.target.value):c.target.value;return c.target.checked?d.concat([f]):d.filter(y=>!Ez(y,f))}else return c.target.checked;else{if(e.tagName.toLowerCase()==="select"&&e.multiple)return i.includes("number")?Array.from(c.target.selectedOptions).map(f=>{let y=f.value||f.text;return By(y)}):Array.from(c.target.selectedOptions).map(f=>f.value||f.text);{let f=c.target.value;return i.includes("number")?By(f):i.includes("trim")?f.trim():f}}})}function By(e){let i=e?parseFloat(e):null;return Sz(i)?i:e}function Ez(e,i){return e==i}function Sz(e){return!Array.isArray(e)&&!isNaN(e)}Rn("cloak",e=>queueMicrotask(()=>tr(()=>e.removeAttribute($u("cloak")))));WS(()=>`[${$u("init")}]`);Rn("init",gg((e,{expression:i},{evaluate:a})=>typeof i=="string"?!!i.trim()&&a(i,{},!1):a(i,{},!1)));Rn("text",(e,{expression:i},{effect:a,evaluateLater:c})=>{let d=c(i);a(()=>{d(f=>{tr(()=>{e.textContent=f})})})});Rn("html",(e,{expression:i},{effect:a,evaluateLater:c})=>{let d=c(i);a(()=>{d(f=>{tr(()=>{e.innerHTML=f,e._x_ignoreSelf=!0,Fa(e),delete e._x_ignoreSelf})})})});F0(DS(":",OS($u("bind:"))));Rn("bind",(e,{value:i,modifiers:a,expression:c,original:d},{effect:f})=>{if(!i){let s={};RL(s),Mr(e,c)(C=>{e2(e,C,d)},{scope:s});return}if(i==="key")return Az(e,c);let y=Mr(e,c);f(()=>y(s=>{s===void 0&&c.match(/\./)&&(s=""),tr(()=>XS(e,i,s,a))}))});function Az(e,i){e._x_keyExpression=i}qS(()=>`[${$u("data")}]`);Rn("data",gg((e,{expression:i},{cleanup:a})=>{i=i===""?"{}":i;let c={};zv(c,e);let d={};OL(d,c);let f=pu(e,i,{scope:d});f===void 0&&(f={}),zv(f,e);let y=Vu(f);AS(y);let s=yf(e,y);y.init&&pu(e,y.init),a(()=>{y.destroy&&pu(e,y.destroy),s()})}));Rn("show",(e,{modifiers:i,expression:a},{effect:c})=>{let d=Mr(e,a);e._x_doHide||(e._x_doHide=()=>{tr(()=>{e.style.setProperty("display","none",i.includes("important")?"important":void 0)})}),e._x_doShow||(e._x_doShow=()=>{tr(()=>{e.style.length===1&&e.style.display==="none"?e.removeAttribute("style"):e.style.removeProperty("display")})});let f=()=>{e._x_doHide(),e._x_isShown=!1},y=()=>{e._x_doShow(),e._x_isShown=!0},s=()=>setTimeout(y),w=Bv(k=>k?y():f(),k=>{typeof e._x_toggleAndCascadeWithTransitions=="function"?e._x_toggleAndCascadeWithTransitions(e,k,y,f):k?s():f()}),C,L=!0;c(()=>d(k=>{!L&&k===C||(i.includes("immediate")&&(k?s():f()),w(k),C=k,L=!1)}))});Rn("for",(e,{expression:i},{effect:a,cleanup:c})=>{let d=Mz(i),f=Mr(e,d.items),y=Mr(e,e._x_keyExpression||"index");e._x_prevKeys=[],e._x_lookup={},a(()=>Cz(e,d,f,y)),c(()=>{Object.values(e._x_lookup).forEach(s=>s.remove()),delete e._x_prevKeys,delete e._x_lookup})});function Cz(e,i,a,c){let d=y=>typeof y=="object"&&!Array.isArray(y),f=e;a(y=>{Iz(y)&&y>=0&&(y=Array.from(Array(y).keys(),ue=>ue+1)),y===void 0&&(y=[]);let s=e._x_lookup,w=e._x_prevKeys,C=[],L=[];if(d(y))y=Object.entries(y).map(([ue,j])=>{let q=qw(i,j,ue,y);c(se=>L.push(se),{scope:{index:ue,...q}}),C.push(q)});else for(let ue=0;ue<y.length;ue++){let j=qw(i,y[ue],ue,y);c(q=>L.push(q),{scope:{index:ue,...j}}),C.push(j)}let k=[],R=[],V=[],H=[];for(let ue=0;ue<w.length;ue++){let j=w[ue];L.indexOf(j)===-1&&V.push(j)}w=w.filter(ue=>!V.includes(ue));let J="template";for(let ue=0;ue<L.length;ue++){let j=L[ue],q=w.indexOf(j);if(q===-1)w.splice(ue,0,j),k.push([J,ue]);else if(q!==ue){let se=w.splice(ue,1)[0],ge=w.splice(q-1,1)[0];w.splice(ue,0,ge),w.splice(q,0,se),R.push([se,ge])}else H.push(j);J=j}for(let ue=0;ue<V.length;ue++){let j=V[ue];s[j]._x_effects&&s[j]._x_effects.forEach(_S),s[j].remove(),s[j]=null,delete s[j]}for(let ue=0;ue<R.length;ue++){let[j,q]=R[ue],se=s[j],ge=s[q],ie=document.createElement("div");tr(()=>{ge.after(ie),se.after(ge),ge._x_currentIfEl&&ge.after(ge._x_currentIfEl),ie.before(se),se._x_currentIfEl&&se.after(se._x_currentIfEl),ie.remove()}),Uw(ge,C[L.indexOf(q)])}for(let ue=0;ue<k.length;ue++){let[j,q]=k[ue],se=j==="template"?f:s[j];se._x_currentIfEl&&(se=se._x_currentIfEl);let ge=C[q],ie=L[q],Ie=document.importNode(f.content,!0).firstElementChild;yf(Ie,Vu(ge),f),tr(()=>{se.after(Ie),Fa(Ie)}),typeof ie=="object"&&wu("x-for key cannot be an object, it must be a string or an integer",f),s[ie]=Ie}for(let ue=0;ue<H.length;ue++)Uw(s[H[ue]],C[L.indexOf(H[ue])]);f._x_prevKeys=L})}function Mz(e){let i=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,a=/^\s*\(|\)\s*$/g,c=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,d=e.match(c);if(!d)return;let f={};f.items=d[2].trim();let y=d[1].replace(a,"").trim(),s=y.match(i);return s?(f.item=y.replace(i,"").trim(),f.index=s[1].trim(),s[2]&&(f.collection=s[2].trim())):f.item=y,f}function qw(e,i,a,c){let d={};return/^\[.*\]$/.test(e.item)&&Array.isArray(i)?e.item.replace("[","").replace("]","").split(",").map(y=>y.trim()).forEach((y,s)=>{d[y]=i[s]}):/^\{.*\}$/.test(e.item)&&!Array.isArray(i)&&typeof i=="object"?e.item.replace("{","").replace("}","").split(",").map(y=>y.trim()).forEach(y=>{d[y]=i[y]}):d[e.item]=i,e.index&&(d[e.index]=a),e.collection&&(d[e.collection]=c),d}function Iz(e){return!Array.isArray(e)&&!isNaN(e)}function P2(){}P2.inline=(e,{expression:i},{cleanup:a})=>{let c=fg(e);c._x_refs||(c._x_refs={}),c._x_refs[i]=e,a(()=>delete c._x_refs[i])};Rn("ref",P2);Rn("if",(e,{expression:i},{effect:a,cleanup:c})=>{let d=Mr(e,i),f=()=>{if(e._x_currentIfEl)return e._x_currentIfEl;let s=e.content.cloneNode(!0).firstElementChild;return yf(s,{},e),tr(()=>{e.after(s),Fa(s)}),e._x_currentIfEl=s,e._x_undoIf=()=>{Jl(s,w=>{w._x_effects&&w._x_effects.forEach(_S)}),s.remove(),delete e._x_currentIfEl},s},y=()=>{!e._x_undoIf||(e._x_undoIf(),delete e._x_undoIf)};a(()=>d(s=>{s?f():y()})),c(()=>e._x_undoIf&&e._x_undoIf())});Rn("id",(e,{expression:i},{evaluate:a})=>{a(i).forEach(d=>_z(e,d))});F0(DS("@",OS($u("on:"))));Rn("on",gg((e,{value:i,modifiers:a,expression:c},{cleanup:d})=>{let f=c?Mr(e,c):()=>{};e.tagName.toLowerCase()==="template"&&(e._x_forwardEvents||(e._x_forwardEvents=[]),e._x_forwardEvents.includes(i)||e._x_forwardEvents.push(i));let y=I2(e,i,a,s=>{f(()=>{},{scope:{$event:s},params:[s]})});d(()=>y())}));Sg("Collapse","collapse","collapse");Sg("Intersect","intersect","intersect");Sg("Focus","trap","focus");Sg("Mask","mask","mask");function Sg(e,i,a){Rn(i,c=>wu(`You can't use [x-${i}] without first installing the "${e}" plugin here: https://alpinejs.dev/plugins/${a}`,c))}xf.setEvaluator(PS);xf.setReactivityEngine({reactive:H0,effect:WL,release:HL,raw:vn});var Pz=xf,Cs=Pz;function kz(e){e.directive("collapse",i),i.inline=(a,{modifiers:c})=>{!c.includes("min")||(a._x_doShow=()=>{},a._x_doHide=()=>{})};function i(a,{modifiers:c}){let d=Ww(c,"duration",250)/1e3,f=Ww(c,"min",0),y=!c.includes("min");a._x_isShown||(a.style.height=`${f}px`),!a._x_isShown&&y&&(a.hidden=!0),a._x_isShown||(a.style.overflow="hidden");let s=(C,L)=>{let k=e.setStyles(C,L);return L.height?()=>{}:k},w={transitionProperty:"height",transitionDuration:`${d}s`,transitionTimingFunction:"cubic-bezier(0.4, 0.0, 0.2, 1)"};a._x_transition={in(C=()=>{},L=()=>{}){y&&(a.hidden=!1),y&&(a.style.display=null);let k=a.getBoundingClientRect().height;a.style.height="auto";let R=a.getBoundingClientRect().height;k===R&&(k=f),e.transition(a,e.setStyles,{during:w,start:{height:k+"px"},end:{height:R+"px"}},()=>a._x_isShown=!0,()=>{a.style.height==`${R}px`&&(a.style.overflow=null)})},out(C=()=>{},L=()=>{}){let k=a.getBoundingClientRect().height;e.transition(a,s,{during:w,start:{height:k+"px"},end:{height:f+"px"}},()=>a.style.overflow="hidden",()=>{a._x_isShown=!1,a.style.height==`${f}px`&&y&&(a.style.display="none",a.hidden=!0)})}}}}function Ww(e,i,a){if(e.indexOf(i)===-1)return a;const c=e[e.indexOf(i)+1];if(!c)return a;if(i==="duration"){let d=c.match(/([0-9]+)ms/);if(d)return d[1]}if(i==="min"){let d=c.match(/([0-9]+)px/);if(d)return d[1]}return c}var Lz=kz;function zz(e){let i=()=>{let a,c=localStorage;return e.interceptor((d,f,y,s,w)=>{let C=a||`_x_${s}`,L=Rz(C,c)?Dz(C,c):d;return y(L),e.effect(()=>{let k=f();Oz(C,k,c),y(k)}),L},d=>{d.as=f=>(a=f,d),d.using=f=>(c=f,d)})};Object.defineProperty(e,"$persist",{get:()=>i()}),e.magic("persist",i)}function Rz(e,i){return i.getItem(e)!==null}function Dz(e,i){return JSON.parse(i.getItem(e,i))}function Oz(e,i,a){a.setItem(e,JSON.stringify(i))}var Fz=zz;/*!
* tabbable 5.2.1
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var k2=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])',"details>summary:first-of-type","details"],Hw=k2.join(","),Nm=typeof Element>"u"?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,L2=function(i,a,c){var d=Array.prototype.slice.apply(i.querySelectorAll(Hw));return a&&Nm.call(i,Hw)&&d.unshift(i),d=d.filter(c),d},Bz=function(i){return i.contentEditable==="true"},z2=function(i){var a=parseInt(i.getAttribute("tabindex"),10);return isNaN(a)?Bz(i)||(i.nodeName==="AUDIO"||i.nodeName==="VIDEO"||i.nodeName==="DETAILS")&&i.getAttribute("tabindex")===null?0:i.tabIndex:a},Nz=function(i,a){return i.tabIndex===a.tabIndex?i.documentOrder-a.documentOrder:i.tabIndex-a.tabIndex},Z0=function(i){return i.tagName==="INPUT"},Uz=function(i){return Z0(i)&&i.type==="hidden"},Vz=function(i){var a=i.tagName==="DETAILS"&&Array.prototype.slice.apply(i.children).some(function(c){return c.tagName==="SUMMARY"});return a},$z=function(i,a){for(var c=0;c<i.length;c++)if(i[c].checked&&i[c].form===a)return i[c]},jz=function(i){if(!i.name)return!0;var a=i.form||i.ownerDocument,c=function(s){return a.querySelectorAll('input[type="radio"][name="'+s+'"]')},d;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")d=c(window.CSS.escape(i.name));else try{d=c(i.name)}catch(y){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",y.message),!1}var f=$z(d,i.form);return!f||f===i},Gz=function(i){return Z0(i)&&i.type==="radio"},qz=function(i){return Gz(i)&&!jz(i)},Wz=function(i,a){if(getComputedStyle(i).visibility==="hidden")return!0;var c=Nm.call(i,"details>summary:first-of-type"),d=c?i.parentElement:i;if(Nm.call(d,"details:not([open]) *"))return!0;if(!a||a==="full")for(;i;){if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}else if(a==="non-zero-area"){var f=i.getBoundingClientRect(),y=f.width,s=f.height;return y===0&&s===0}return!1},Hz=function(i){if(Z0(i)||i.tagName==="SELECT"||i.tagName==="TEXTAREA"||i.tagName==="BUTTON")for(var a=i.parentElement;a;){if(a.tagName==="FIELDSET"&&a.disabled){for(var c=0;c<a.children.length;c++){var d=a.children.item(c);if(d.tagName==="LEGEND")return!d.contains(i)}return!0}a=a.parentElement}return!1},X0=function(i,a){return!(a.disabled||Uz(a)||Wz(a,i.displayCheck)||Vz(a)||Hz(a))},Zz=function(i,a){return!(!X0(i,a)||qz(a)||z2(a)<0)},Xz=function(i,a){a=a||{};var c=[],d=[],f=L2(i,a.includeContainer,Zz.bind(null,a));f.forEach(function(s,w){var C=z2(s);C===0?c.push(s):d.push({documentOrder:w,tabIndex:C,node:s})});var y=d.sort(Nz).map(function(s){return s.node}).concat(c);return y},Kz=function(i,a){a=a||{};var c=L2(i,a.includeContainer,X0.bind(null,a));return c},Yz=k2.concat("iframe").join(","),R2=function(i,a){if(a=a||{},!i)throw new Error("No node provided");return Nm.call(i,Yz)===!1?!1:X0(a,i)};/*!
* focus-trap 6.6.1
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function Zw(e,i){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);i&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),a.push.apply(a,c)}return a}function Qz(e){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Zw(Object(a),!0).forEach(function(c){Jz(e,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Zw(Object(a)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(a,c))})}return e}function Jz(e,i,a){return i in e?Object.defineProperty(e,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[i]=a,e}var Xw=function(){var e=[];return{activateTrap:function(a){if(e.length>0){var c=e[e.length-1];c!==a&&c.pause()}var d=e.indexOf(a);d===-1||e.splice(d,1),e.push(a)},deactivateTrap:function(a){var c=e.indexOf(a);c!==-1&&e.splice(c,1),e.length>0&&e[e.length-1].unpause()}}}(),eR=function(i){return i.tagName&&i.tagName.toLowerCase()==="input"&&typeof i.select=="function"},tR=function(i){return i.key==="Escape"||i.key==="Esc"||i.keyCode===27},iR=function(i){return i.key==="Tab"||i.keyCode===9},Kw=function(i){return setTimeout(i,0)},Ny=function(i,a){var c=-1;return i.every(function(d,f){return a(d)?(c=f,!1):!0}),c},Td=function(i){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return typeof i=="function"?i.apply(void 0,c):i},nR=function(i,a){var c=document,d=Qz({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0},a),f={containers:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0},y,s=function(Ie,ze,Ae){return Ie&&Ie[ze]!==void 0?Ie[ze]:d[Ae||ze]},w=function(Ie){return f.containers.some(function(ze){return ze.contains(Ie)})},C=function(Ie){var ze=d[Ie];if(!ze)return null;var Ae=ze;if(typeof ze=="string"&&(Ae=c.querySelector(ze),!Ae))throw new Error("`".concat(Ie,"` refers to no known node"));if(typeof ze=="function"&&(Ae=ze(),!Ae))throw new Error("`".concat(Ie,"` did not return a node"));return Ae},L=function(){var Ie;if(s({},"initialFocus")===!1)return!1;if(C("initialFocus")!==null)Ie=C("initialFocus");else if(w(c.activeElement))Ie=c.activeElement;else{var ze=f.tabbableGroups[0],Ae=ze&&ze.firstTabbableNode;Ie=Ae||C("fallbackFocus")}if(!Ie)throw new Error("Your focus-trap needs to have at least one focusable element");return Ie},k=function(){if(f.tabbableGroups=f.containers.map(function(Ie){var ze=Xz(Ie);if(ze.length>0)return{container:Ie,firstTabbableNode:ze[0],lastTabbableNode:ze[ze.length-1]}}).filter(function(Ie){return!!Ie}),f.tabbableGroups.length<=0&&!C("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times")},R=function ie(Ie){if(Ie!==!1&&Ie!==c.activeElement){if(!Ie||!Ie.focus){ie(L());return}Ie.focus({preventScroll:!!d.preventScroll}),f.mostRecentlyFocusedNode=Ie,eR(Ie)&&Ie.select()}},V=function(Ie){var ze=C("setReturnFocus");return ze||Ie},H=function(Ie){if(!w(Ie.target)){if(Td(d.clickOutsideDeactivates,Ie)){y.deactivate({returnFocus:d.returnFocusOnDeactivate&&!R2(Ie.target)});return}Td(d.allowOutsideClick,Ie)||Ie.preventDefault()}},J=function(Ie){var ze=w(Ie.target);ze||Ie.target instanceof Document?ze&&(f.mostRecentlyFocusedNode=Ie.target):(Ie.stopImmediatePropagation(),R(f.mostRecentlyFocusedNode||L()))},ue=function(Ie){k();var ze=null;if(f.tabbableGroups.length>0){var Ae=Ny(f.tabbableGroups,function(Gt){var Vt=Gt.container;return Vt.contains(Ie.target)});if(Ae<0)Ie.shiftKey?ze=f.tabbableGroups[f.tabbableGroups.length-1].lastTabbableNode:ze=f.tabbableGroups[0].firstTabbableNode;else if(Ie.shiftKey){var He=Ny(f.tabbableGroups,function(Gt){var Vt=Gt.firstTabbableNode;return Ie.target===Vt});if(He<0&&f.tabbableGroups[Ae].container===Ie.target&&(He=Ae),He>=0){var Ce=He===0?f.tabbableGroups.length-1:He-1,Ge=f.tabbableGroups[Ce];ze=Ge.lastTabbableNode}}else{var De=Ny(f.tabbableGroups,function(Gt){var Vt=Gt.lastTabbableNode;return Ie.target===Vt});if(De<0&&f.tabbableGroups[Ae].container===Ie.target&&(De=Ae),De>=0){var We=De===f.tabbableGroups.length-1?0:De+1,et=f.tabbableGroups[We];ze=et.firstTabbableNode}}}else ze=C("fallbackFocus");ze&&(Ie.preventDefault(),R(ze))},j=function(Ie){if(tR(Ie)&&Td(d.escapeDeactivates)!==!1){Ie.preventDefault(),y.deactivate();return}if(iR(Ie)){ue(Ie);return}},q=function(Ie){Td(d.clickOutsideDeactivates,Ie)||w(Ie.target)||Td(d.allowOutsideClick,Ie)||(Ie.preventDefault(),Ie.stopImmediatePropagation())},se=function(){if(!!f.active)return Xw.activateTrap(y),f.delayInitialFocusTimer=d.delayInitialFocus?Kw(function(){R(L())}):R(L()),c.addEventListener("focusin",J,!0),c.addEventListener("mousedown",H,{capture:!0,passive:!1}),c.addEventListener("touchstart",H,{capture:!0,passive:!1}),c.addEventListener("click",q,{capture:!0,passive:!1}),c.addEventListener("keydown",j,{capture:!0,passive:!1}),y},ge=function(){if(!!f.active)return c.removeEventListener("focusin",J,!0),c.removeEventListener("mousedown",H,!0),c.removeEventListener("touchstart",H,!0),c.removeEventListener("click",q,!0),c.removeEventListener("keydown",j,!0),y};return y={activate:function(Ie){if(f.active)return this;var ze=s(Ie,"onActivate"),Ae=s(Ie,"onPostActivate"),He=s(Ie,"checkCanFocusTrap");He||k(),f.active=!0,f.paused=!1,f.nodeFocusedBeforeActivation=c.activeElement,ze&&ze();var Ce=function(){He&&k(),se(),Ae&&Ae()};return He?(He(f.containers.concat()).then(Ce,Ce),this):(Ce(),this)},deactivate:function(Ie){if(!f.active)return this;clearTimeout(f.delayInitialFocusTimer),f.delayInitialFocusTimer=void 0,ge(),f.active=!1,f.paused=!1,Xw.deactivateTrap(y);var ze=s(Ie,"onDeactivate"),Ae=s(Ie,"onPostDeactivate"),He=s(Ie,"checkCanReturnFocus");ze&&ze();var Ce=s(Ie,"returnFocus","returnFocusOnDeactivate"),Ge=function(){Kw(function(){Ce&&R(V(f.nodeFocusedBeforeActivation)),Ae&&Ae()})};return Ce&&He?(He(V(f.nodeFocusedBeforeActivation)).then(Ge,Ge),this):(Ge(),this)},pause:function(){return f.paused||!f.active?this:(f.paused=!0,ge(),this)},unpause:function(){return!f.paused||!f.active?this:(f.paused=!1,k(),se(),this)},updateContainerElements:function(Ie){var ze=[].concat(Ie).filter(Boolean);return f.containers=ze.map(function(Ae){return typeof Ae=="string"?c.querySelector(Ae):Ae}),f.active&&k(),this}},y.updateContainerElements(i),y};function rR(e){let i,a;window.addEventListener("focusin",()=>{i=a,a=document.activeElement}),e.magic("focus",c=>{let d=c;return{__noscroll:!1,__wrapAround:!1,within(f){return d=f,this},withoutScrolling(){return this.__noscroll=!0,this},noscroll(){return this.__noscroll=!0,this},withWrapAround(){return this.__wrapAround=!0,this},wrap(){return this.withWrapAround()},focusable(f){return R2(f)},previouslyFocused(){return i},lastFocused(){return i},focused(){return a},focusables(){return Array.isArray(d)?d:Kz(d,{displayCheck:"none"})},all(){return this.focusables()},isFirst(f){let y=this.all();return y[0]&&y[0].isSameNode(f)},isLast(f){let y=this.all();return y.length&&y.slice(-1)[0].isSameNode(f)},getFirst(){return this.all()[0]},getLast(){return this.all().slice(-1)[0]},getNext(){let f=this.all(),y=document.activeElement;if(f.indexOf(y)!==-1)return this.__wrapAround&&f.indexOf(y)===f.length-1?f[0]:f[f.indexOf(y)+1]},getPrevious(){let f=this.all(),y=document.activeElement;if(f.indexOf(y)!==-1)return this.__wrapAround&&f.indexOf(y)===0?f.slice(-1)[0]:f[f.indexOf(y)-1]},first(){this.focus(this.getFirst())},last(){this.focus(this.getLast())},next(){this.focus(this.getNext())},previous(){this.focus(this.getPrevious())},prev(){return this.previous()},focus(f){!f||setTimeout(()=>{f.hasAttribute("tabindex")||f.setAttribute("tabindex","0"),f.focus({preventScroll:this._noscroll})})}}}),e.directive("trap",e.skipDuringClone((c,{expression:d,modifiers:f},{effect:y,evaluateLater:s,cleanup:w})=>{let C=s(d),L=!1,k=nR(c,{escapeDeactivates:!1,allowOutsideClick:!0,fallbackFocus:()=>c,initialFocus:c.querySelector("[autofocus]")}),R=()=>{},V=()=>{};const H=()=>{R(),R=()=>{},V(),V=()=>{},k.deactivate({returnFocus:!f.includes("noreturn")})};y(()=>C(J=>{L!==J&&(J&&!L&&setTimeout(()=>{f.includes("inert")&&(R=Yw(c)),f.includes("noscroll")&&(V=sR()),k.activate()}),!J&&L&&H(),L=!!J)})),w(H)},(c,{expression:d,modifiers:f},{evaluate:y})=>{f.includes("inert")&&y(d)&&Yw(c)}))}function Yw(e){let i=[];return D2(e,a=>{let c=a.hasAttribute("aria-hidden");a.setAttribute("aria-hidden","true"),i.push(()=>c||a.removeAttribute("aria-hidden"))}),()=>{for(;i.length;)i.pop()()}}function D2(e,i){e.isSameNode(document.body)||!e.parentNode||Array.from(e.parentNode.children).forEach(a=>{a.isSameNode(e)||i(a),D2(e.parentNode,i)})}function sR(){let e=document.documentElement.style.overflow,i=document.documentElement.style.paddingRight,a=window.innerWidth-document.documentElement.clientWidth;return document.documentElement.style.overflow="hidden",document.documentElement.style.paddingRight=`${a}px`,()=>{document.documentElement.style.overflow=e,document.documentElement.style.paddingRight=i}}var oR=rR,K0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aR(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}(function(e,i){(function(a,c){c()})(K0,function(){function a(d){var f=!0,y=!1,s=null,w={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function C(ie){return!!(ie&&ie!==document&&ie.nodeName!=="HTML"&&ie.nodeName!=="BODY"&&"classList"in ie&&"contains"in ie.classList)}function L(ie){var Ie=ie.type,ze=ie.tagName;return!!(ze==="INPUT"&&w[Ie]&&!ie.readOnly||ze==="TEXTAREA"&&!ie.readOnly||ie.isContentEditable)}function k(ie){ie.classList.contains("focus-visible")||(ie.classList.add("focus-visible"),ie.setAttribute("data-focus-visible-added",""))}function R(ie){!ie.hasAttribute("data-focus-visible-added")||(ie.classList.remove("focus-visible"),ie.removeAttribute("data-focus-visible-added"))}function V(ie){ie.metaKey||ie.altKey||ie.ctrlKey||(C(d.activeElement)&&k(d.activeElement),f=!0)}function H(ie){f=!1}function J(ie){!C(ie.target)||(f||L(ie.target))&&k(ie.target)}function ue(ie){!C(ie.target)||(ie.target.classList.contains("focus-visible")||ie.target.hasAttribute("data-focus-visible-added"))&&(y=!0,window.clearTimeout(s),s=window.setTimeout(function(){y=!1},100),R(ie.target))}function j(ie){document.visibilityState==="hidden"&&(y&&(f=!0),q())}function q(){document.addEventListener("mousemove",ge),document.addEventListener("mousedown",ge),document.addEventListener("mouseup",ge),document.addEventListener("pointermove",ge),document.addEventListener("pointerdown",ge),document.addEventListener("pointerup",ge),document.addEventListener("touchmove",ge),document.addEventListener("touchstart",ge),document.addEventListener("touchend",ge)}function se(){document.removeEventListener("mousemove",ge),document.removeEventListener("mousedown",ge),document.removeEventListener("mouseup",ge),document.removeEventListener("pointermove",ge),document.removeEventListener("pointerdown",ge),document.removeEventListener("pointerup",ge),document.removeEventListener("touchmove",ge),document.removeEventListener("touchstart",ge),document.removeEventListener("touchend",ge)}function ge(ie){ie.target.nodeName&&ie.target.nodeName.toLowerCase()==="html"||(f=!1,se())}document.addEventListener("keydown",V,!0),document.addEventListener("mousedown",H,!0),document.addEventListener("pointerdown",H,!0),document.addEventListener("touchstart",H,!0),document.addEventListener("visibilitychange",j,!0),q(),d.addEventListener("focus",J,!0),d.addEventListener("blur",ue,!0),d.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&d.host?d.host.setAttribute("data-js-focus-visible",""):d.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if(typeof window<"u"&&typeof document<"u"){window.applyFocusVisiblePolyfill=a;var c;try{c=new CustomEvent("focus-visible-polyfill-ready")}catch{c=document.createEvent("CustomEvent"),c.initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(c)}typeof document<"u"&&a(document)})})();var O2={exports:{}},Y0={exports:{}},F2=function(i,a){return function(){for(var d=new Array(arguments.length),f=0;f<d.length;f++)d[f]=arguments[f];return i.apply(a,d)}},lR=F2,Q0=Object.prototype.toString,J0=function(e){return function(i){var a=Q0.call(i);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())}}(Object.create(null));function nc(e){return e=e.toLowerCase(),function(a){return J0(a)===e}}function ex(e){return Array.isArray(e)}function Um(e){return typeof e>"u"}function cR(e){return e!==null&&!Um(e)&&e.constructor!==null&&!Um(e.constructor)&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}var B2=nc("ArrayBuffer");function uR(e){var i;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?i=ArrayBuffer.isView(e):i=e&&e.buffer&&B2(e.buffer),i}function hR(e){return typeof e=="string"}function dR(e){return typeof e=="number"}function N2(e){return e!==null&&typeof e=="object"}function Mm(e){if(J0(e)!=="object")return!1;var i=Object.getPrototypeOf(e);return i===null||i===Object.prototype}var fR=nc("Date"),pR=nc("File"),mR=nc("Blob"),gR=nc("FileList");function tx(e){return Q0.call(e)==="[object Function]"}function _R(e){return N2(e)&&tx(e.pipe)}function yR(e){var i="[object FormData]";return e&&(typeof FormData=="function"&&e instanceof FormData||Q0.call(e)===i||tx(e.toString)&&e.toString()===i)}var vR=nc("URLSearchParams");function xR(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function bR(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function ix(e,i){if(!(e===null||typeof e>"u"))if(typeof e!="object"&&(e=[e]),ex(e))for(var a=0,c=e.length;a<c;a++)i.call(null,e[a],a,e);else for(var d in e)Object.prototype.hasOwnProperty.call(e,d)&&i.call(null,e[d],d,e)}function qv(){var e={};function i(d,f){Mm(e[f])&&Mm(d)?e[f]=qv(e[f],d):Mm(d)?e[f]=qv({},d):ex(d)?e[f]=d.slice():e[f]=d}for(var a=0,c=arguments.length;a<c;a++)ix(arguments[a],i);return e}function wR(e,i,a){return ix(i,function(d,f){a&&typeof d=="function"?e[f]=lR(d,a):e[f]=d}),e}function TR(e){return e.charCodeAt(0)===65279&&(e=e.slice(1)),e}function ER(e,i,a,c){e.prototype=Object.create(i.prototype,c),e.prototype.constructor=e,a&&Object.assign(e.prototype,a)}function SR(e,i,a){var c,d,f,y={};i=i||{};do{for(c=Object.getOwnPropertyNames(e),d=c.length;d-- >0;)f=c[d],y[f]||(i[f]=e[f],y[f]=!0);e=Object.getPrototypeOf(e)}while(e&&(!a||a(e,i))&&e!==Object.prototype);return i}function AR(e,i,a){e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=i.length;var c=e.indexOf(i,a);return c!==-1&&c===a}function CR(e){if(!e)return null;var i=e.length;if(Um(i))return null;for(var a=new Array(i);i-- >0;)a[i]=e[i];return a}var MR=function(e){return function(i){return e&&i instanceof e}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array)),cr={isArray:ex,isArrayBuffer:B2,isBuffer:cR,isFormData:yR,isArrayBufferView:uR,isString:hR,isNumber:dR,isObject:N2,isPlainObject:Mm,isUndefined:Um,isDate:fR,isFile:pR,isBlob:mR,isFunction:tx,isStream:_R,isURLSearchParams:vR,isStandardBrowserEnv:bR,forEach:ix,merge:qv,extend:wR,trim:xR,stripBOM:TR,inherits:ER,toFlatObject:SR,kindOf:J0,kindOfTest:nc,endsWith:AR,toArray:CR,isTypedArray:MR,isFileList:gR},su=cr;function Qw(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var U2=function(i,a,c){if(!a)return i;var d;if(c)d=c(a);else if(su.isURLSearchParams(a))d=a.toString();else{var f=[];su.forEach(a,function(w,C){w===null||typeof w>"u"||(su.isArray(w)?C=C+"[]":w=[w],su.forEach(w,function(k){su.isDate(k)?k=k.toISOString():su.isObject(k)&&(k=JSON.stringify(k)),f.push(Qw(C)+"="+Qw(k))}))}),d=f.join("&")}if(d){var y=i.indexOf("#");y!==-1&&(i=i.slice(0,y)),i+=(i.indexOf("?")===-1?"?":"&")+d}return i},IR=cr;function Ag(){this.handlers=[]}Ag.prototype.use=function(i,a,c){return this.handlers.push({fulfilled:i,rejected:a,synchronous:c?c.synchronous:!1,runWhen:c?c.runWhen:null}),this.handlers.length-1};Ag.prototype.eject=function(i){this.handlers[i]&&(this.handlers[i]=null)};Ag.prototype.forEach=function(i){IR.forEach(this.handlers,function(c){c!==null&&i(c)})};var PR=Ag,kR=cr,LR=function(i,a){kR.forEach(i,function(d,f){f!==a&&f.toUpperCase()===a.toUpperCase()&&(i[a]=d,delete i[f])})},V2=cr;function Eu(e,i,a,c,d){Error.call(this),this.message=e,this.name="AxiosError",i&&(this.code=i),a&&(this.config=a),c&&(this.request=c),d&&(this.response=d)}V2.inherits(Eu,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var $2=Eu.prototype,j2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(e){j2[e]={value:e}});Object.defineProperties(Eu,j2);Object.defineProperty($2,"isAxiosError",{value:!0});Eu.from=function(e,i,a,c,d,f){var y=Object.create($2);return V2.toFlatObject(e,y,function(w){return w!==Error.prototype}),Eu.call(y,e.message,i,a,c,d),y.name=e.name,f&&Object.assign(y,f),y};var ju=Eu,G2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Us=cr;function zR(e,i){i=i||new FormData;var a=[];function c(f){return f===null?"":Us.isDate(f)?f.toISOString():Us.isArrayBuffer(f)||Us.isTypedArray(f)?typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,y){if(Us.isPlainObject(f)||Us.isArray(f)){if(a.indexOf(f)!==-1)throw Error("Circular reference detected in "+y);a.push(f),Us.forEach(f,function(w,C){if(!Us.isUndefined(w)){var L=y?y+"."+C:C,k;if(w&&!y&&typeof w=="object"){if(Us.endsWith(C,"{}"))w=JSON.stringify(w);else if(Us.endsWith(C,"[]")&&(k=Us.toArray(w))){k.forEach(function(R){!Us.isUndefined(R)&&i.append(L,c(R))});return}}d(w,L)}}),a.pop()}else i.append(y,c(f))}return d(e),i}var q2=zR,Uy,Jw;function RR(){if(Jw)return Uy;Jw=1;var e=ju;return Uy=function(a,c,d){var f=d.config.validateStatus;!d.status||!f||f(d.status)?a(d):c(new e("Request failed with status code "+d.status,[e.ERR_BAD_REQUEST,e.ERR_BAD_RESPONSE][Math.floor(d.status/100)-4],d.config,d.request,d))},Uy}var Vy,eT;function DR(){if(eT)return Vy;eT=1;var e=cr;return Vy=e.isStandardBrowserEnv()?function(){return{write:function(c,d,f,y,s,w){var C=[];C.push(c+"="+encodeURIComponent(d)),e.isNumber(f)&&C.push("expires="+new Date(f).toGMTString()),e.isString(y)&&C.push("path="+y),e.isString(s)&&C.push("domain="+s),w===!0&&C.push("secure"),document.cookie=C.join("; ")},read:function(c){var d=document.cookie.match(new RegExp("(^|;\\s*)("+c+")=([^;]*)"));return d?decodeURIComponent(d[3]):null},remove:function(c){this.write(c,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Vy}var OR=function(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)},FR=function(i,a){return a?i.replace(/\/+$/,"")+"/"+a.replace(/^\/+/,""):i},BR=OR,NR=FR,W2=function(i,a){return i&&!BR(a)?NR(i,a):a},$y,tT;function UR(){if(tT)return $y;tT=1;var e=cr,i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return $y=function(c){var d={},f,y,s;return c&&e.forEach(c.split(`
`),function(C){if(s=C.indexOf(":"),f=e.trim(C.substr(0,s)).toLowerCase(),y=e.trim(C.substr(s+1)),f){if(d[f]&&i.indexOf(f)>=0)return;f==="set-cookie"?d[f]=(d[f]?d[f]:[]).concat([y]):d[f]=d[f]?d[f]+", "+y:y}}),d},$y}var jy,iT;function VR(){if(iT)return jy;iT=1;var e=cr;return jy=e.isStandardBrowserEnv()?function(){var a=/(msie|trident)/i.test(navigator.userAgent),c=document.createElement("a"),d;function f(y){var s=y;return a&&(c.setAttribute("href",s),s=c.href),c.setAttribute("href",s),{href:c.href,protocol:c.protocol?c.protocol.replace(/:$/,""):"",host:c.host,search:c.search?c.search.replace(/^\?/,""):"",hash:c.hash?c.hash.replace(/^#/,""):"",hostname:c.hostname,port:c.port,pathname:c.pathname.charAt(0)==="/"?c.pathname:"/"+c.pathname}}return d=f(window.location.href),function(s){var w=e.isString(s)?f(s):s;return w.protocol===d.protocol&&w.host===d.host}}():function(){return function(){return!0}}(),jy}var Gy,nT;function Cg(){if(nT)return Gy;nT=1;var e=ju,i=cr;function a(c){e.call(this,c==null?"canceled":c,e.ERR_CANCELED),this.name="CanceledError"}return i.inherits(a,e,{__CANCEL__:!0}),Gy=a,Gy}var qy,rT;function $R(){return rT||(rT=1,qy=function(i){var a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return a&&a[1]||""}),qy}var Wy,sT;function oT(){if(sT)return Wy;sT=1;var e=cr,i=RR(),a=DR(),c=U2,d=W2,f=UR(),y=VR(),s=G2,w=ju,C=Cg(),L=$R();return Wy=function(R){return new Promise(function(H,J){var ue=R.data,j=R.headers,q=R.responseType,se;function ge(){R.cancelToken&&R.cancelToken.unsubscribe(se),R.signal&&R.signal.removeEventListener("abort",se)}e.isFormData(ue)&&e.isStandardBrowserEnv()&&delete j["Content-Type"];var ie=new XMLHttpRequest;if(R.auth){var Ie=R.auth.username||"",ze=R.auth.password?unescape(encodeURIComponent(R.auth.password)):"";j.Authorization="Basic "+btoa(Ie+":"+ze)}var Ae=d(R.baseURL,R.url);ie.open(R.method.toUpperCase(),c(Ae,R.params,R.paramsSerializer),!0),ie.timeout=R.timeout;function He(){if(!!ie){var De="getAllResponseHeaders"in ie?f(ie.getAllResponseHeaders()):null,We=!q||q==="text"||q==="json"?ie.responseText:ie.response,et={data:We,status:ie.status,statusText:ie.statusText,headers:De,config:R,request:ie};i(function(Vt){H(Vt),ge()},function(Vt){J(Vt),ge()},et),ie=null}}if("onloadend"in ie?ie.onloadend=He:ie.onreadystatechange=function(){!ie||ie.readyState!==4||ie.status===0&&!(ie.responseURL&&ie.responseURL.indexOf("file:")===0)||setTimeout(He)},ie.onabort=function(){!ie||(J(new w("Request aborted",w.ECONNABORTED,R,ie)),ie=null)},ie.onerror=function(){J(new w("Network Error",w.ERR_NETWORK,R,ie,ie)),ie=null},ie.ontimeout=function(){var We=R.timeout?"timeout of "+R.timeout+"ms exceeded":"timeout exceeded",et=R.transitional||s;R.timeoutErrorMessage&&(We=R.timeoutErrorMessage),J(new w(We,et.clarifyTimeoutError?w.ETIMEDOUT:w.ECONNABORTED,R,ie)),ie=null},e.isStandardBrowserEnv()){var Ce=(R.withCredentials||y(Ae))&&R.xsrfCookieName?a.read(R.xsrfCookieName):void 0;Ce&&(j[R.xsrfHeaderName]=Ce)}"setRequestHeader"in ie&&e.forEach(j,function(We,et){typeof ue>"u"&&et.toLowerCase()==="content-type"?delete j[et]:ie.setRequestHeader(et,We)}),e.isUndefined(R.withCredentials)||(ie.withCredentials=!!R.withCredentials),q&&q!=="json"&&(ie.responseType=R.responseType),typeof R.onDownloadProgress=="function"&&ie.addEventListener("progress",R.onDownloadProgress),typeof R.onUploadProgress=="function"&&ie.upload&&ie.upload.addEventListener("progress",R.onUploadProgress),(R.cancelToken||R.signal)&&(se=function(De){!ie||(J(!De||De&&De.type?new C:De),ie.abort(),ie=null)},R.cancelToken&&R.cancelToken.subscribe(se),R.signal&&(R.signal.aborted?se():R.signal.addEventListener("abort",se))),ue||(ue=null);var Ge=L(Ae);if(Ge&&["http","https","file"].indexOf(Ge)===-1){J(new w("Unsupported protocol "+Ge+":",w.ERR_BAD_REQUEST,R));return}ie.send(ue)})},Wy}var Hy,aT;function jR(){return aT||(aT=1,Hy=null),Hy}var Qn=cr,lT=LR,cT=ju,GR=G2,qR=q2,WR={"Content-Type":"application/x-www-form-urlencoded"};function uT(e,i){!Qn.isUndefined(e)&&Qn.isUndefined(e["Content-Type"])&&(e["Content-Type"]=i)}function HR(){var e;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(e=oT()),e}function ZR(e,i,a){if(Qn.isString(e))try{return(i||JSON.parse)(e),Qn.trim(e)}catch(c){if(c.name!=="SyntaxError")throw c}return(a||JSON.stringify)(e)}var Mg={transitional:GR,adapter:HR(),transformRequest:[function(i,a){if(lT(a,"Accept"),lT(a,"Content-Type"),Qn.isFormData(i)||Qn.isArrayBuffer(i)||Qn.isBuffer(i)||Qn.isStream(i)||Qn.isFile(i)||Qn.isBlob(i))return i;if(Qn.isArrayBufferView(i))return i.buffer;if(Qn.isURLSearchParams(i))return uT(a,"application/x-www-form-urlencoded;charset=utf-8"),i.toString();var c=Qn.isObject(i),d=a&&a["Content-Type"],f;if((f=Qn.isFileList(i))||c&&d==="multipart/form-data"){var y=this.env&&this.env.FormData;return qR(f?{"files[]":i}:i,y&&new y)}else if(c||d==="application/json")return uT(a,"application/json"),ZR(i);return i}],transformResponse:[function(i){var a=this.transitional||Mg.transitional,c=a&&a.silentJSONParsing,d=a&&a.forcedJSONParsing,f=!c&&this.responseType==="json";if(f||d&&Qn.isString(i)&&i.length)try{return JSON.parse(i)}catch(y){if(f)throw y.name==="SyntaxError"?cT.from(y,cT.ERR_BAD_RESPONSE,this,null,this.response):y}return i}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jR()},validateStatus:function(i){return i>=200&&i<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Qn.forEach(["delete","get","head"],function(i){Mg.headers[i]={}});Qn.forEach(["post","put","patch"],function(i){Mg.headers[i]=Qn.merge(WR)});var nx=Mg,XR=cr,KR=nx,YR=function(i,a,c){var d=this||KR;return XR.forEach(c,function(y){i=y.call(d,i,a)}),i},Zy,hT;function H2(){return hT||(hT=1,Zy=function(i){return!!(i&&i.__CANCEL__)}),Zy}var dT=cr,Xy=YR,QR=H2(),JR=nx,eD=Cg();function Ky(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new eD}var tD=function(i){Ky(i),i.headers=i.headers||{},i.data=Xy.call(i,i.data,i.headers,i.transformRequest),i.headers=dT.merge(i.headers.common||{},i.headers[i.method]||{},i.headers),dT.forEach(["delete","get","head","post","put","patch","common"],function(d){delete i.headers[d]});var a=i.adapter||JR.adapter;return a(i).then(function(d){return Ky(i),d.data=Xy.call(i,d.data,d.headers,i.transformResponse),d},function(d){return QR(d)||(Ky(i),d&&d.response&&(d.response.data=Xy.call(i,d.response.data,d.response.headers,i.transformResponse))),Promise.reject(d)})},Qr=cr,Z2=function(i,a){a=a||{};var c={};function d(L,k){return Qr.isPlainObject(L)&&Qr.isPlainObject(k)?Qr.merge(L,k):Qr.isPlainObject(k)?Qr.merge({},k):Qr.isArray(k)?k.slice():k}function f(L){if(Qr.isUndefined(a[L])){if(!Qr.isUndefined(i[L]))return d(void 0,i[L])}else return d(i[L],a[L])}function y(L){if(!Qr.isUndefined(a[L]))return d(void 0,a[L])}function s(L){if(Qr.isUndefined(a[L])){if(!Qr.isUndefined(i[L]))return d(void 0,i[L])}else return d(void 0,a[L])}function w(L){if(L in a)return d(i[L],a[L]);if(L in i)return d(void 0,i[L])}var C={url:y,method:y,data:y,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:w};return Qr.forEach(Object.keys(i).concat(Object.keys(a)),function(k){var R=C[k]||f,V=R(k);Qr.isUndefined(V)&&R!==w||(c[k]=V)}),c},Yy,fT;function X2(){return fT||(fT=1,Yy={version:"0.27.2"}),Yy}var iD=X2().version,Pa=ju,rx={};["object","boolean","number","function","string","symbol"].forEach(function(e,i){rx[e]=function(c){return typeof c===e||"a"+(i<1?"n ":" ")+e}});var pT={};rx.transitional=function(i,a,c){function d(f,y){return"[Axios v"+iD+"] Transitional option '"+f+"'"+y+(c?". "+c:"")}return function(f,y,s){if(i===!1)throw new Pa(d(y," has been removed"+(a?" in "+a:"")),Pa.ERR_DEPRECATED);return a&&!pT[y]&&(pT[y]=!0,console.warn(d(y," has been deprecated since v"+a+" and will be removed in the near future"))),i?i(f,y,s):!0}};function nD(e,i,a){if(typeof e!="object")throw new Pa("options must be an object",Pa.ERR_BAD_OPTION_VALUE);for(var c=Object.keys(e),d=c.length;d-- >0;){var f=c[d],y=i[f];if(y){var s=e[f],w=s===void 0||y(s,f,e);if(w!==!0)throw new Pa("option "+f+" must be "+w,Pa.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new Pa("Unknown option "+f,Pa.ERR_BAD_OPTION)}}var rD={assertOptions:nD,validators:rx},K2=cr,sD=U2,mT=PR,gT=tD,Ig=Z2,oD=W2,Y2=rD,ou=Y2.validators;function Su(e){this.defaults=e,this.interceptors={request:new mT,response:new mT}}Su.prototype.request=function(i,a){typeof i=="string"?(a=a||{},a.url=i):a=i||{},a=Ig(this.defaults,a),a.method?a.method=a.method.toLowerCase():this.defaults.method?a.method=this.defaults.method.toLowerCase():a.method="get";var c=a.transitional;c!==void 0&&Y2.assertOptions(c,{silentJSONParsing:ou.transitional(ou.boolean),forcedJSONParsing:ou.transitional(ou.boolean),clarifyTimeoutError:ou.transitional(ou.boolean)},!1);var d=[],f=!0;this.interceptors.request.forEach(function(V){typeof V.runWhen=="function"&&V.runWhen(a)===!1||(f=f&&V.synchronous,d.unshift(V.fulfilled,V.rejected))});var y=[];this.interceptors.response.forEach(function(V){y.push(V.fulfilled,V.rejected)});var s;if(!f){var w=[gT,void 0];for(Array.prototype.unshift.apply(w,d),w=w.concat(y),s=Promise.resolve(a);w.length;)s=s.then(w.shift(),w.shift());return s}for(var C=a;d.length;){var L=d.shift(),k=d.shift();try{C=L(C)}catch(R){k(R);break}}try{s=gT(C)}catch(R){return Promise.reject(R)}for(;y.length;)s=s.then(y.shift(),y.shift());return s};Su.prototype.getUri=function(i){i=Ig(this.defaults,i);var a=oD(i.baseURL,i.url);return sD(a,i.params,i.paramsSerializer)};K2.forEach(["delete","get","head","options"],function(i){Su.prototype[i]=function(a,c){return this.request(Ig(c||{},{method:i,url:a,data:(c||{}).data}))}});K2.forEach(["post","put","patch"],function(i){function a(c){return function(f,y,s){return this.request(Ig(s||{},{method:i,headers:c?{"Content-Type":"multipart/form-data"}:{},url:f,data:y}))}}Su.prototype[i]=a(),Su.prototype[i+"Form"]=a(!0)});var aD=Su,Qy,_T;function lD(){if(_T)return Qy;_T=1;var e=Cg();function i(a){if(typeof a!="function")throw new TypeError("executor must be a function.");var c;this.promise=new Promise(function(y){c=y});var d=this;this.promise.then(function(f){if(!!d._listeners){var y,s=d._listeners.length;for(y=0;y<s;y++)d._listeners[y](f);d._listeners=null}}),this.promise.then=function(f){var y,s=new Promise(function(w){d.subscribe(w),y=w}).then(f);return s.cancel=function(){d.unsubscribe(y)},s},a(function(y){d.reason||(d.reason=new e(y),c(d.reason))})}return i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(c){if(this.reason){c(this.reason);return}this._listeners?this._listeners.push(c):this._listeners=[c]},i.prototype.unsubscribe=function(c){if(!!this._listeners){var d=this._listeners.indexOf(c);d!==-1&&this._listeners.splice(d,1)}},i.source=function(){var c,d=new i(function(y){c=y});return{token:d,cancel:c}},Qy=i,Qy}var Jy,yT;function cD(){return yT||(yT=1,Jy=function(i){return function(c){return i.apply(null,c)}}),Jy}var ev,vT;function uD(){if(vT)return ev;vT=1;var e=cr;return ev=function(a){return e.isObject(a)&&a.isAxiosError===!0},ev}var xT=cr,hD=F2,Im=aD,dD=Z2,fD=nx;function Q2(e){var i=new Im(e),a=hD(Im.prototype.request,i);return xT.extend(a,Im.prototype,i),xT.extend(a,i),a.create=function(d){return Q2(dD(e,d))},a}var Vr=Q2(fD);Vr.Axios=Im;Vr.CanceledError=Cg();Vr.CancelToken=lD();Vr.isCancel=H2();Vr.VERSION=X2().version;Vr.toFormData=q2;Vr.AxiosError=ju;Vr.Cancel=Vr.CanceledError;Vr.all=function(i){return Promise.all(i)};Vr.spread=cD();Vr.isAxiosError=uD();Y0.exports=Vr;Y0.exports.default=Vr;(function(e){e.exports=Y0.exports})(O2);const er=aR(O2.exports);function sx(e,i){const a=Object.create(null),c=e.split(",");for(let d=0;d<c.length;d++)a[c[d]]=!0;return i?d=>!!a[d.toLowerCase()]:d=>!!a[d]}const pD="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",mD=sx(pD);function bf(e){if(si(e)){const i={};for(let a=0;a<e.length;a++){const c=e[a],d=$n(c)?yD(c):bf(c);if(d)for(const f in d)i[f]=d[f]}return i}else{if($n(e))return e;if(jn(e))return e}}const gD=/;(?![^(]*\))/g,_D=/:(.+)/;function yD(e){const i={};return e.split(gD).forEach(a=>{if(a){const c=a.split(_D);c.length>1&&(i[c[0].trim()]=c[1].trim())}}),i}function $i(e){let i="";if($n(e))i=e;else if(si(e))for(let a=0;a<e.length;a++){const c=$i(e[a]);c&&(i+=c+" ")}else if(jn(e))for(const a in e)e[a]&&(i+=a+" ");return i.trim()}function vD(e){if(!e)return null;let{class:i,style:a}=e;return i&&!$n(i)&&(e.class=$i(i)),a&&(e.style=bf(a)),e}const Pi=e=>$n(e)?e:e==null?"":si(e)||jn(e)&&(e.toString===iA||!gi(e.toString))?JSON.stringify(e,J2,2):String(e),J2=(e,i)=>i&&i.__v_isRef?J2(e,i.value):gu(i)?{[`Map(${i.size})`]:[...i.entries()].reduce((a,[c,d])=>(a[`${c} =>`]=d,a),{})}:tA(i)?{[`Set(${i.size})`]:[...i.values()]}:jn(i)&&!si(i)&&!nA(i)?String(i):i,un={},mu=[],js=()=>{},xD=()=>!1,bD=/^on[^a-z]/,Pg=e=>bD.test(e),eA=e=>e.startsWith("onUpdate:"),lr=Object.assign,ox=(e,i)=>{const a=e.indexOf(i);a>-1&&e.splice(a,1)},wD=Object.prototype.hasOwnProperty,Oi=(e,i)=>wD.call(e,i),si=Array.isArray,gu=e=>kg(e)==="[object Map]",tA=e=>kg(e)==="[object Set]",gi=e=>typeof e=="function",$n=e=>typeof e=="string",ax=e=>typeof e=="symbol",jn=e=>e!==null&&typeof e=="object",lx=e=>jn(e)&&gi(e.then)&&gi(e.catch),iA=Object.prototype.toString,kg=e=>iA.call(e),TD=e=>kg(e).slice(8,-1),nA=e=>kg(e)==="[object Object]",cx=e=>$n(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Vd=sx(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Lg=e=>{const i=Object.create(null);return a=>i[a]||(i[a]=e(a))},ED=/-(\w)/g,Ws=Lg(e=>e.replace(ED,(i,a)=>a?a.toUpperCase():"")),SD=/\B([A-Z])/g,zg=Lg(e=>e.replace(SD,"-$1").toLowerCase()),Rg=Lg(e=>e.charAt(0).toUpperCase()+e.slice(1)),$d=Lg(e=>e?`on${Rg(e)}`:""),Au=(e,i)=>!Object.is(e,i),jd=(e,i)=>{for(let a=0;a<e.length;a++)e[a](i)},Vm=(e,i,a)=>{Object.defineProperty(e,i,{configurable:!0,enumerable:!1,value:a})},rA=e=>{const i=parseFloat(e);return isNaN(i)?e:i};let bT;const AD=()=>bT||(bT=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let es;class ux{constructor(i=!1){this.active=!0,this.effects=[],this.cleanups=[],!i&&es&&(this.parent=es,this.index=(es.scopes||(es.scopes=[])).push(this)-1)}run(i){if(this.active){const a=es;try{return es=this,i()}finally{es=a}}}on(){es=this}off(){es=this.parent}stop(i){if(this.active){let a,c;for(a=0,c=this.effects.length;a<c;a++)this.effects[a].stop();for(a=0,c=this.cleanups.length;a<c;a++)this.cleanups[a]();if(this.scopes)for(a=0,c=this.scopes.length;a<c;a++)this.scopes[a].stop(!0);if(this.parent&&!i){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.active=!1}}}function CD(e){return new ux(e)}function sA(e,i=es){i&&i.active&&i.effects.push(e)}function MD(){return es}function ID(e){es&&es.cleanups.push(e)}const hx=e=>{const i=new Set(e);return i.w=0,i.n=0,i},oA=e=>(e.w&Na)>0,aA=e=>(e.n&Na)>0,PD=({deps:e})=>{if(e.length)for(let i=0;i<e.length;i++)e[i].w|=Na},kD=e=>{const{deps:i}=e;if(i.length){let a=0;for(let c=0;c<i.length;c++){const d=i[c];oA(d)&&!aA(d)?d.delete(e):i[a++]=d,d.w&=~Na,d.n&=~Na}i.length=a}},Wv=new WeakMap;let Dd=0,Na=1;const Hv=30;let $s;const Hl=Symbol(""),Zv=Symbol("");class wf{constructor(i,a=null,c){this.fn=i,this.scheduler=a,this.active=!0,this.deps=[],this.parent=void 0,sA(this,c)}run(){if(!this.active)return this.fn();let i=$s,a=Da;for(;i;){if(i===this)return;i=i.parent}try{return this.parent=$s,$s=this,Da=!0,Na=1<<++Dd,Dd<=Hv?PD(this):wT(this),this.fn()}finally{Dd<=Hv&&kD(this),Na=1<<--Dd,$s=this.parent,Da=a,this.parent=void 0,this.deferStop&&this.stop()}}stop(){$s===this?this.deferStop=!0:this.active&&(wT(this),this.onStop&&this.onStop(),this.active=!1)}}function wT(e){const{deps:i}=e;if(i.length){for(let a=0;a<i.length;a++)i[a].delete(e);i.length=0}}function LD(e,i){e.effect&&(e=e.effect.fn);const a=new wf(e);i&&(lr(a,i),i.scope&&sA(a,i.scope)),(!i||!i.lazy)&&a.run();const c=a.run.bind(a);return c.effect=a,c}function zD(e){e.effect.stop()}let Da=!0;const lA=[];function rc(){lA.push(Da),Da=!1}function sc(){const e=lA.pop();Da=e===void 0?!0:e}function cs(e,i,a){if(Da&&$s){let c=Wv.get(e);c||Wv.set(e,c=new Map);let d=c.get(a);d||c.set(a,d=hx()),cA(d)}}function cA(e,i){let a=!1;Dd<=Hv?aA(e)||(e.n|=Na,a=!oA(e)):a=!e.has($s),a&&(e.add($s),$s.deps.push(e))}function Zo(e,i,a,c,d,f){const y=Wv.get(e);if(!y)return;let s=[];if(i==="clear")s=[...y.values()];else if(a==="length"&&si(e))y.forEach((w,C)=>{(C==="length"||C>=c)&&s.push(w)});else switch(a!==void 0&&s.push(y.get(a)),i){case"add":si(e)?cx(a)&&s.push(y.get("length")):(s.push(y.get(Hl)),gu(e)&&s.push(y.get(Zv)));break;case"delete":si(e)||(s.push(y.get(Hl)),gu(e)&&s.push(y.get(Zv)));break;case"set":gu(e)&&s.push(y.get(Hl));break}if(s.length===1)s[0]&&Xv(s[0]);else{const w=[];for(const C of s)C&&w.push(...C);Xv(hx(w))}}function Xv(e,i){const a=si(e)?e:[...e];for(const c of a)c.computed&&TT(c);for(const c of a)c.computed||TT(c)}function TT(e,i){(e!==$s||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const RD=sx("__proto__,__v_isRef,__isVue"),uA=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ax)),DD=Dg(),OD=Dg(!1,!0),FD=Dg(!0),BD=Dg(!0,!0),ET=ND();function ND(){const e={};return["includes","indexOf","lastIndexOf"].forEach(i=>{e[i]=function(...a){const c=Di(this);for(let f=0,y=this.length;f<y;f++)cs(c,"get",f+"");const d=c[i](...a);return d===-1||d===!1?c[i](...a.map(Di)):d}}),["push","pop","shift","unshift","splice"].forEach(i=>{e[i]=function(...a){rc();const c=Di(this)[i].apply(this,a);return sc(),c}}),e}function Dg(e=!1,i=!1){return function(c,d,f){if(d==="__v_isReactive")return!e;if(d==="__v_isReadonly")return e;if(d==="__v_isShallow")return i;if(d==="__v_raw"&&f===(e?i?_A:gA:i?mA:pA).get(c))return c;const y=si(c);if(!e&&y&&Oi(ET,d))return Reflect.get(ET,d,f);const s=Reflect.get(c,d,f);return(ax(d)?uA.has(d):RD(d))||(e||cs(c,"get",d),i)?s:zn(s)?y&&cx(d)?s:s.value:jn(s)?e?px(s):Tf(s):s}}const UD=hA(),VD=hA(!0);function hA(e=!1){return function(a,c,d,f){let y=a[c];if(Cu(y)&&zn(y)&&!zn(d))return!1;if(!e&&!Cu(d)&&($m(d)||(d=Di(d),y=Di(y)),!si(a)&&zn(y)&&!zn(d)))return y.value=d,!0;const s=si(a)&&cx(c)?Number(c)<a.length:Oi(a,c),w=Reflect.set(a,c,d,f);return a===Di(f)&&(s?Au(d,y)&&Zo(a,"set",c,d):Zo(a,"add",c,d)),w}}function $D(e,i){const a=Oi(e,i);e[i];const c=Reflect.deleteProperty(e,i);return c&&a&&Zo(e,"delete",i,void 0),c}function jD(e,i){const a=Reflect.has(e,i);return(!ax(i)||!uA.has(i))&&cs(e,"has",i),a}function GD(e){return cs(e,"iterate",si(e)?"length":Hl),Reflect.ownKeys(e)}const dA={get:DD,set:UD,deleteProperty:$D,has:jD,ownKeys:GD},fA={get:FD,set(e,i){return!0},deleteProperty(e,i){return!0}},qD=lr({},dA,{get:OD,set:VD}),WD=lr({},fA,{get:BD}),dx=e=>e,Og=e=>Reflect.getPrototypeOf(e);function um(e,i,a=!1,c=!1){e=e.__v_raw;const d=Di(e),f=Di(i);a||(i!==f&&cs(d,"get",i),cs(d,"get",f));const{has:y}=Og(d),s=c?dx:a?_x:sf;if(y.call(d,i))return s(e.get(i));if(y.call(d,f))return s(e.get(f));e!==d&&e.get(i)}function hm(e,i=!1){const a=this.__v_raw,c=Di(a),d=Di(e);return i||(e!==d&&cs(c,"has",e),cs(c,"has",d)),e===d?a.has(e):a.has(e)||a.has(d)}function dm(e,i=!1){return e=e.__v_raw,!i&&cs(Di(e),"iterate",Hl),Reflect.get(e,"size",e)}function ST(e){e=Di(e);const i=Di(this);return Og(i).has.call(i,e)||(i.add(e),Zo(i,"add",e,e)),this}function AT(e,i){i=Di(i);const a=Di(this),{has:c,get:d}=Og(a);let f=c.call(a,e);f||(e=Di(e),f=c.call(a,e));const y=d.call(a,e);return a.set(e,i),f?Au(i,y)&&Zo(a,"set",e,i):Zo(a,"add",e,i),this}function CT(e){const i=Di(this),{has:a,get:c}=Og(i);let d=a.call(i,e);d||(e=Di(e),d=a.call(i,e)),c&&c.call(i,e);const f=i.delete(e);return d&&Zo(i,"delete",e,void 0),f}function MT(){const e=Di(this),i=e.size!==0,a=e.clear();return i&&Zo(e,"clear",void 0,void 0),a}function fm(e,i){return function(c,d){const f=this,y=f.__v_raw,s=Di(y),w=i?dx:e?_x:sf;return!e&&cs(s,"iterate",Hl),y.forEach((C,L)=>c.call(d,w(C),w(L),f))}}function pm(e,i,a){return function(...c){const d=this.__v_raw,f=Di(d),y=gu(f),s=e==="entries"||e===Symbol.iterator&&y,w=e==="keys"&&y,C=d[e](...c),L=a?dx:i?_x:sf;return!i&&cs(f,"iterate",w?Zv:Hl),{next(){const{value:k,done:R}=C.next();return R?{value:k,done:R}:{value:s?[L(k[0]),L(k[1])]:L(k),done:R}},[Symbol.iterator](){return this}}}}function Ea(e){return function(...i){return e==="delete"?!1:this}}function HD(){const e={get(f){return um(this,f)},get size(){return dm(this)},has:hm,add:ST,set:AT,delete:CT,clear:MT,forEach:fm(!1,!1)},i={get(f){return um(this,f,!1,!0)},get size(){return dm(this)},has:hm,add:ST,set:AT,delete:CT,clear:MT,forEach:fm(!1,!0)},a={get(f){return um(this,f,!0)},get size(){return dm(this,!0)},has(f){return hm.call(this,f,!0)},add:Ea("add"),set:Ea("set"),delete:Ea("delete"),clear:Ea("clear"),forEach:fm(!0,!1)},c={get(f){return um(this,f,!0,!0)},get size(){return dm(this,!0)},has(f){return hm.call(this,f,!0)},add:Ea("add"),set:Ea("set"),delete:Ea("delete"),clear:Ea("clear"),forEach:fm(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(f=>{e[f]=pm(f,!1,!1),a[f]=pm(f,!0,!1),i[f]=pm(f,!1,!0),c[f]=pm(f,!0,!0)}),[e,a,i,c]}const[ZD,XD,KD,YD]=HD();function Fg(e,i){const a=i?e?YD:KD:e?XD:ZD;return(c,d,f)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?c:Reflect.get(Oi(a,d)&&d in c?a:c,d,f)}const QD={get:Fg(!1,!1)},JD={get:Fg(!1,!0)},eO={get:Fg(!0,!1)},tO={get:Fg(!0,!0)},pA=new WeakMap,mA=new WeakMap,gA=new WeakMap,_A=new WeakMap;function iO(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function nO(e){return e.__v_skip||!Object.isExtensible(e)?0:iO(TD(e))}function Tf(e){return Cu(e)?e:Bg(e,!1,dA,QD,pA)}function fx(e){return Bg(e,!1,qD,JD,mA)}function px(e){return Bg(e,!0,fA,eO,gA)}function rO(e){return Bg(e,!0,WD,tO,_A)}function Bg(e,i,a,c,d){if(!jn(e)||e.__v_raw&&!(i&&e.__v_isReactive))return e;const f=d.get(e);if(f)return f;const y=nO(e);if(y===0)return e;const s=new Proxy(e,y===2?c:a);return d.set(e,s),s}function Zl(e){return Cu(e)?Zl(e.__v_raw):!!(e&&e.__v_isReactive)}function Cu(e){return!!(e&&e.__v_isReadonly)}function $m(e){return!!(e&&e.__v_isShallow)}function mx(e){return Zl(e)||Cu(e)}function Di(e){const i=e&&e.__v_raw;return i?Di(i):e}function gx(e){return Vm(e,"__v_skip",!0),e}const sf=e=>jn(e)?Tf(e):e,_x=e=>jn(e)?px(e):e;function yx(e){Da&&$s&&(e=Di(e),cA(e.dep||(e.dep=hx())))}function Ng(e,i){e=Di(e),e.dep&&Xv(e.dep)}function zn(e){return!!(e&&e.__v_isRef===!0)}function Gd(e){return vA(e,!1)}function yA(e){return vA(e,!0)}function vA(e,i){return zn(e)?e:new sO(e,i)}class sO{constructor(i,a){this.__v_isShallow=a,this.dep=void 0,this.__v_isRef=!0,this._rawValue=a?i:Di(i),this._value=a?i:sf(i)}get value(){return yx(this),this._value}set value(i){i=this.__v_isShallow?i:Di(i),Au(i,this._rawValue)&&(this._rawValue=i,this._value=this.__v_isShallow?i:sf(i),Ng(this))}}function oO(e){Ng(e)}function Xl(e){return zn(e)?e.value:e}const aO={get:(e,i,a)=>Xl(Reflect.get(e,i,a)),set:(e,i,a,c)=>{const d=e[i];return zn(d)&&!zn(a)?(d.value=a,!0):Reflect.set(e,i,a,c)}};function vx(e){return Zl(e)?e:new Proxy(e,aO)}class lO{constructor(i){this.dep=void 0,this.__v_isRef=!0;const{get:a,set:c}=i(()=>yx(this),()=>Ng(this));this._get=a,this._set=c}get value(){return this._get()}set value(i){this._set(i)}}function cO(e){return new lO(e)}function uO(e){const i=si(e)?new Array(e.length):{};for(const a in e)i[a]=xA(e,a);return i}class hO{constructor(i,a,c){this._object=i,this._key=a,this._defaultValue=c,this.__v_isRef=!0}get value(){const i=this._object[this._key];return i===void 0?this._defaultValue:i}set value(i){this._object[this._key]=i}}function xA(e,i,a){const c=e[i];return zn(c)?c:new hO(e,i,a)}class dO{constructor(i,a,c,d){this._setter=a,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new wf(i,()=>{this._dirty||(this._dirty=!0,Ng(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!d,this.__v_isReadonly=c}get value(){const i=Di(this);return yx(i),(i._dirty||!i._cacheable)&&(i._dirty=!1,i._value=i.effect.run()),i._value}set value(i){this._setter(i)}}function fO(e,i,a=!1){let c,d;const f=gi(e);return f?(c=e,d=js):(c=e.get,d=e.set),new dO(c,d,f||!d,a)}const qd=[];function bA(e,...i){rc();const a=qd.length?qd[qd.length-1].component:null,c=a&&a.appContext.config.warnHandler,d=pO();if(c)yo(c,a,11,[e+i.join(""),a&&a.proxy,d.map(({vnode:f})=>`at <${_C(a,f.type)}>`).join(`
`),d]);else{const f=[`[Vue warn]: ${e}`,...i];d.length&&f.push(`
`,...mO(d)),console.warn(...f)}sc()}function pO(){let e=qd[qd.length-1];if(!e)return[];const i=[];for(;e;){const a=i[0];a&&a.vnode===e?a.recurseCount++:i.push({vnode:e,recurseCount:0});const c=e.component&&e.component.parent;e=c&&c.vnode}return i}function mO(e){const i=[];return e.forEach((a,c)=>{i.push(...c===0?[]:[`
`],...gO(a))}),i}function gO({vnode:e,recurseCount:i}){const a=i>0?`... (${i} recursive calls)`:"",c=e.component?e.component.parent==null:!1,d=` at <${_C(e.component,e.type,c)}`,f=">"+a;return e.props?[d,..._O(e.props),f]:[d+f]}function _O(e){const i=[],a=Object.keys(e);return a.slice(0,3).forEach(c=>{i.push(...wA(c,e[c]))}),a.length>3&&i.push(" ..."),i}function wA(e,i,a){return $n(i)?(i=JSON.stringify(i),a?i:[`${e}=${i}`]):typeof i=="number"||typeof i=="boolean"||i==null?a?i:[`${e}=${i}`]:zn(i)?(i=wA(e,Di(i.value),!0),a?i:[`${e}=Ref<`,i,">"]):gi(i)?[`${e}=fn${i.name?`<${i.name}>`:""}`]:(i=Di(i),a?i:[`${e}=`,i])}function yo(e,i,a,c){let d;try{d=c?e(...c):e()}catch(f){oc(f,i,a)}return d}function os(e,i,a,c){if(gi(e)){const f=yo(e,i,a,c);return f&&lx(f)&&f.catch(y=>{oc(y,i,a)}),f}const d=[];for(let f=0;f<e.length;f++)d.push(os(e[f],i,a,c));return d}function oc(e,i,a,c=!0){const d=i?i.vnode:null;if(i){let f=i.parent;const y=i.proxy,s=a;for(;f;){const C=f.ec;if(C){for(let L=0;L<C.length;L++)if(C[L](e,y,s)===!1)return}f=f.parent}const w=i.appContext.config.errorHandler;if(w){yo(w,null,10,[e,y,s]);return}}yO(e,a,d,c)}function yO(e,i,a,c=!0){console.error(e)}let jm=!1,Kv=!1;const rs=[];let Go=0;const Wd=[];let Od=null,cu=0;const Hd=[];let Ma=null,uu=0;const TA=Promise.resolve();let xx=null,Yv=null;function Ug(e){const i=xx||TA;return e?i.then(this?e.bind(this):e):i}function vO(e){let i=Go+1,a=rs.length;for(;i<a;){const c=i+a>>>1;of(rs[c])<e?i=c+1:a=c}return i}function bx(e){(!rs.length||!rs.includes(e,jm&&e.allowRecurse?Go+1:Go))&&e!==Yv&&(e.id==null?rs.push(e):rs.splice(vO(e.id),0,e),EA())}function EA(){!jm&&!Kv&&(Kv=!0,xx=TA.then(AA))}function xO(e){const i=rs.indexOf(e);i>Go&&rs.splice(i,1)}function SA(e,i,a,c){si(e)?a.push(...e):(!i||!i.includes(e,e.allowRecurse?c+1:c))&&a.push(e),EA()}function bO(e){SA(e,Od,Wd,cu)}function wx(e){SA(e,Ma,Hd,uu)}function Vg(e,i=null){if(Wd.length){for(Yv=i,Od=[...new Set(Wd)],Wd.length=0,cu=0;cu<Od.length;cu++)Od[cu]();Od=null,cu=0,Yv=null,Vg(e,i)}}function Gm(e){if(Vg(),Hd.length){const i=[...new Set(Hd)];if(Hd.length=0,Ma){Ma.push(...i);return}for(Ma=i,Ma.sort((a,c)=>of(a)-of(c)),uu=0;uu<Ma.length;uu++)Ma[uu]();Ma=null,uu=0}}const of=e=>e.id==null?1/0:e.id;function AA(e){Kv=!1,jm=!0,Vg(e),rs.sort((a,c)=>of(a)-of(c));const i=js;try{for(Go=0;Go<rs.length;Go++){const a=rs[Go];a&&a.active!==!1&&yo(a,null,14)}}finally{Go=0,rs.length=0,Gm(),jm=!1,xx=null,(rs.length||Wd.length||Hd.length)&&AA(e)}}let hu,mm=[];function CA(e,i){var a,c;hu=e,hu?(hu.enabled=!0,mm.forEach(({event:d,args:f})=>hu.emit(d,...f)),mm=[]):typeof window<"u"&&window.HTMLElement&&!(!((c=(a=window.navigator)===null||a===void 0?void 0:a.userAgent)===null||c===void 0)&&c.includes("jsdom"))?((i.__VUE_DEVTOOLS_HOOK_REPLAY__=i.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(f=>{CA(f,i)}),setTimeout(()=>{hu||(i.__VUE_DEVTOOLS_HOOK_REPLAY__=null,mm=[])},3e3)):mm=[]}function wO(e,i,...a){if(e.isUnmounted)return;const c=e.vnode.props||un;let d=a;const f=i.startsWith("update:"),y=f&&i.slice(7);if(y&&y in c){const L=`${y==="modelValue"?"model":y}Modifiers`,{number:k,trim:R}=c[L]||un;R&&(d=a.map(V=>V.trim())),k&&(d=a.map(rA))}let s,w=c[s=$d(i)]||c[s=$d(Ws(i))];!w&&f&&(w=c[s=$d(zg(i))]),w&&os(w,e,6,d);const C=c[s+"Once"];if(C){if(!e.emitted)e.emitted={};else if(e.emitted[s])return;e.emitted[s]=!0,os(C,e,6,d)}}function MA(e,i,a=!1){const c=i.emitsCache,d=c.get(e);if(d!==void 0)return d;const f=e.emits;let y={},s=!1;if(!gi(e)){const w=C=>{const L=MA(C,i,!0);L&&(s=!0,lr(y,L))};!a&&i.mixins.length&&i.mixins.forEach(w),e.extends&&w(e.extends),e.mixins&&e.mixins.forEach(w)}return!f&&!s?(c.set(e,null),null):(si(f)?f.forEach(w=>y[w]=null):lr(y,f),c.set(e,y),y)}function $g(e,i){return!e||!Pg(i)?!1:(i=i.slice(2).replace(/Once$/,""),Oi(e,i[0].toLowerCase()+i.slice(1))||Oi(e,zg(i))||Oi(e,i))}let yr=null,jg=null;function af(e){const i=yr;return yr=e,jg=e&&e.type.__scopeId||null,i}function IA(e){jg=e}function PA(){jg=null}const TO=e=>Mu;function Mu(e,i=yr,a){if(!i||e._n)return e;const c=(...d)=>{c._d&&r0(-1);const f=af(i),y=e(...d);return af(f),c._d&&r0(1),y};return c._n=!0,c._c=!0,c._d=!0,c}function Pm(e){const{type:i,vnode:a,proxy:c,withProxy:d,props:f,propsOptions:[y],slots:s,attrs:w,emit:C,render:L,renderCache:k,data:R,setupState:V,ctx:H,inheritAttrs:J}=e;let ue,j;const q=af(e);try{if(a.shapeFlag&4){const ge=d||c;ue=ns(L.call(ge,ge,k,f,V,R,H)),j=w}else{const ge=i;ue=ns(ge.length>1?ge(f,{attrs:w,slots:s,emit:C}):ge(f,null)),j=i.props?w:SO(w)}}catch(ge){Yd.length=0,oc(ge,e,1),ue=Hi(xr)}let se=ue;if(j&&J!==!1){const ge=Object.keys(j),{shapeFlag:ie}=se;ge.length&&ie&7&&(y&&ge.some(eA)&&(j=AO(j,y)),se=bo(se,j))}return a.dirs&&(se=bo(se),se.dirs=se.dirs?se.dirs.concat(a.dirs):a.dirs),a.transition&&(se.transition=a.transition),ue=se,af(q),ue}function EO(e){let i;for(let a=0;a<e.length;a++){const c=e[a];if(Ua(c)){if(c.type!==xr||c.children==="v-if"){if(i)return;i=c}}else return}return i}const SO=e=>{let i;for(const a in e)(a==="class"||a==="style"||Pg(a))&&((i||(i={}))[a]=e[a]);return i},AO=(e,i)=>{const a={};for(const c in e)(!eA(c)||!(c.slice(9)in i))&&(a[c]=e[c]);return a};function CO(e,i,a){const{props:c,children:d,component:f}=e,{props:y,children:s,patchFlag:w}=i,C=f.emitsOptions;if(i.dirs||i.transition)return!0;if(a&&w>=0){if(w&1024)return!0;if(w&16)return c?IT(c,y,C):!!y;if(w&8){const L=i.dynamicProps;for(let k=0;k<L.length;k++){const R=L[k];if(y[R]!==c[R]&&!$g(C,R))return!0}}}else return(d||s)&&(!s||!s.$stable)?!0:c===y?!1:c?y?IT(c,y,C):!0:!!y;return!1}function IT(e,i,a){const c=Object.keys(i);if(c.length!==Object.keys(e).length)return!0;for(let d=0;d<c.length;d++){const f=c[d];if(i[f]!==e[f]&&!$g(a,f))return!0}return!1}function Tx({vnode:e,parent:i},a){for(;i&&i.subTree===e;)(e=i.vnode).el=a,i=i.parent}const kA=e=>e.__isSuspense,MO={name:"Suspense",__isSuspense:!0,process(e,i,a,c,d,f,y,s,w,C){e==null?IO(i,a,c,d,f,y,s,w,C):PO(e,i,a,c,d,y,s,w,C)},hydrate:kO,create:Ex,normalize:LO},LA=MO;function lf(e,i){const a=e.props&&e.props[i];gi(a)&&a()}function IO(e,i,a,c,d,f,y,s,w){const{p:C,o:{createElement:L}}=w,k=L("div"),R=e.suspense=Ex(e,d,c,i,k,a,f,y,s,w);C(null,R.pendingBranch=e.ssContent,k,null,c,R,f,y),R.deps>0?(lf(e,"onPending"),lf(e,"onFallback"),C(null,e.ssFallback,i,a,c,null,f,y),_u(R,e.ssFallback)):R.resolve()}function PO(e,i,a,c,d,f,y,s,{p:w,um:C,o:{createElement:L}}){const k=i.suspense=e.suspense;k.vnode=i,i.el=e.el;const R=i.ssContent,V=i.ssFallback,{activeBranch:H,pendingBranch:J,isInFallback:ue,isHydrating:j}=k;if(J)k.pendingBranch=R,go(R,J)?(w(J,R,k.hiddenContainer,null,d,k,f,y,s),k.deps<=0?k.resolve():ue&&(w(H,V,a,c,d,null,f,y,s),_u(k,V))):(k.pendingId++,j?(k.isHydrating=!1,k.activeBranch=J):C(J,d,k),k.deps=0,k.effects.length=0,k.hiddenContainer=L("div"),ue?(w(null,R,k.hiddenContainer,null,d,k,f,y,s),k.deps<=0?k.resolve():(w(H,V,a,c,d,null,f,y,s),_u(k,V))):H&&go(R,H)?(w(H,R,a,c,d,k,f,y,s),k.resolve(!0)):(w(null,R,k.hiddenContainer,null,d,k,f,y,s),k.deps<=0&&k.resolve()));else if(H&&go(R,H))w(H,R,a,c,d,k,f,y,s),_u(k,R);else if(lf(i,"onPending"),k.pendingBranch=R,k.pendingId++,w(null,R,k.hiddenContainer,null,d,k,f,y,s),k.deps<=0)k.resolve();else{const{timeout:q,pendingId:se}=k;q>0?setTimeout(()=>{k.pendingId===se&&k.fallback(V)},q):q===0&&k.fallback(V)}}function Ex(e,i,a,c,d,f,y,s,w,C,L=!1){const{p:k,m:R,um:V,n:H,o:{parentNode:J,remove:ue}}=C,j=rA(e.props&&e.props.timeout),q={vnode:e,parent:i,parentComponent:a,isSVG:y,container:c,hiddenContainer:d,anchor:f,deps:0,pendingId:0,timeout:typeof j=="number"?j:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:L,isUnmounted:!1,effects:[],resolve(se=!1){const{vnode:ge,activeBranch:ie,pendingBranch:Ie,pendingId:ze,effects:Ae,parentComponent:He,container:Ce}=q;if(q.isHydrating)q.isHydrating=!1;else if(!se){const We=ie&&Ie.transition&&Ie.transition.mode==="out-in";We&&(ie.transition.afterLeave=()=>{ze===q.pendingId&&R(Ie,Ce,et,0)});let{anchor:et}=q;ie&&(et=H(ie),V(ie,He,q,!0)),We||R(Ie,Ce,et,0)}_u(q,Ie),q.pendingBranch=null,q.isInFallback=!1;let Ge=q.parent,De=!1;for(;Ge;){if(Ge.pendingBranch){Ge.effects.push(...Ae),De=!0;break}Ge=Ge.parent}De||wx(Ae),q.effects=[],lf(ge,"onResolve")},fallback(se){if(!q.pendingBranch)return;const{vnode:ge,activeBranch:ie,parentComponent:Ie,container:ze,isSVG:Ae}=q;lf(ge,"onFallback");const He=H(ie),Ce=()=>{!q.isInFallback||(k(null,se,ze,He,Ie,null,Ae,s,w),_u(q,se))},Ge=se.transition&&se.transition.mode==="out-in";Ge&&(ie.transition.afterLeave=Ce),q.isInFallback=!0,V(ie,Ie,null,!0),Ge||Ce()},move(se,ge,ie){q.activeBranch&&R(q.activeBranch,se,ge,ie),q.container=se},next(){return q.activeBranch&&H(q.activeBranch)},registerDep(se,ge){const ie=!!q.pendingBranch;ie&&q.deps++;const Ie=se.vnode.el;se.asyncDep.catch(ze=>{oc(ze,se,0)}).then(ze=>{if(se.isUnmounted||q.isUnmounted||q.pendingId!==se.suspenseId)return;se.asyncResolved=!0;const{vnode:Ae}=se;s0(se,ze,!1),Ie&&(Ae.el=Ie);const He=!Ie&&se.subTree.el;ge(se,Ae,J(Ie||se.subTree.el),Ie?null:H(se.subTree),q,y,w),He&&ue(He),Tx(se,Ae.el),ie&&--q.deps===0&&q.resolve()})},unmount(se,ge){q.isUnmounted=!0,q.activeBranch&&V(q.activeBranch,a,se,ge),q.pendingBranch&&V(q.pendingBranch,a,se,ge)}};return q}function kO(e,i,a,c,d,f,y,s,w){const C=i.suspense=Ex(i,c,a,e.parentNode,document.createElement("div"),null,d,f,y,s,!0),L=w(e,C.pendingBranch=i.ssContent,a,C,f,y);return C.deps===0&&C.resolve(),L}function LO(e){const{shapeFlag:i,children:a}=e,c=i&32;e.ssContent=PT(c?a.default:a),e.ssFallback=c?PT(a.fallback):Hi(xr)}function PT(e){let i;if(gi(e)){const a=tc&&e._c;a&&(e._d=!1,Ft()),e=e(),a&&(e._d=!0,i=Ur,oC())}return si(e)&&(e=EO(e)),e=ns(e),i&&!e.dynamicChildren&&(e.dynamicChildren=i.filter(a=>a!==e)),e}function zA(e,i){i&&i.pendingBranch?si(e)?i.effects.push(...e):i.effects.push(e):wx(e)}function _u(e,i){e.activeBranch=i;const{vnode:a,parentComponent:c}=e,d=a.el=i.el;c&&c.subTree===a&&(c.vnode.el=d,Tx(c,d))}function Zd(e,i){if(Un){let a=Un.provides;const c=Un.parent&&Un.parent.provides;c===a&&(a=Un.provides=Object.create(c)),a[e]=i}}function vo(e,i,a=!1){const c=Un||yr;if(c){const d=c.parent==null?c.vnode.appContext&&c.vnode.appContext.provides:c.parent.provides;if(d&&e in d)return d[e];if(arguments.length>1)return a&&gi(i)?i.call(c.proxy):i}}function zO(e,i){return Ef(e,null,i)}function RA(e,i){return Ef(e,null,{flush:"post"})}function RO(e,i){return Ef(e,null,{flush:"sync"})}const kT={};function yu(e,i,a){return Ef(e,i,a)}function Ef(e,i,{immediate:a,deep:c,flush:d,onTrack:f,onTrigger:y}=un){const s=Un;let w,C=!1,L=!1;if(zn(e)?(w=()=>e.value,C=$m(e)):Zl(e)?(w=()=>e,c=!0):si(e)?(L=!0,C=e.some(j=>Zl(j)||$m(j)),w=()=>e.map(j=>{if(zn(j))return j.value;if(Zl(j))return Ul(j);if(gi(j))return yo(j,s,2)})):gi(e)?i?w=()=>yo(e,s,2):w=()=>{if(!(s&&s.isUnmounted))return k&&k(),os(e,s,3,[R])}:w=js,i&&c){const j=w;w=()=>Ul(j())}let k,R=j=>{k=ue.onStop=()=>{yo(j,s,4)}};if(ku)return R=js,i?a&&os(i,s,3,[w(),L?[]:void 0,R]):w(),js;let V=L?[]:kT;const H=()=>{if(!!ue.active)if(i){const j=ue.run();(c||C||(L?j.some((q,se)=>Au(q,V[se])):Au(j,V)))&&(k&&k(),os(i,s,3,[j,V===kT?void 0:V,R]),V=j)}else ue.run()};H.allowRecurse=!!i;let J;d==="sync"?J=H:d==="post"?J=()=>or(H,s&&s.suspense):J=()=>bO(H);const ue=new wf(w,J);return i?a?H():V=ue.run():d==="post"?or(ue.run.bind(ue),s&&s.suspense):ue.run(),()=>{ue.stop(),s&&s.scope&&ox(s.scope.effects,ue)}}function DO(e,i,a){const c=this.proxy,d=$n(e)?e.includes(".")?DA(c,e):()=>c[e]:e.bind(c,c);let f;gi(i)?f=i:(f=i.handler,a=i);const y=Un;Va(this);const s=Ef(d,f.bind(c),a);return y?Va(y):Oa(),s}function DA(e,i){const a=i.split(".");return()=>{let c=e;for(let d=0;d<a.length&&c;d++)c=c[a[d]];return c}}function Ul(e,i){if(!jn(e)||e.__v_skip||(i=i||new Set,i.has(e)))return e;if(i.add(e),zn(e))Ul(e.value,i);else if(si(e))for(let a=0;a<e.length;a++)Ul(e[a],i);else if(tA(e)||gu(e))e.forEach(a=>{Ul(a,i)});else if(nA(e))for(const a in e)Ul(e[a],i);return e}function Sx(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Af(()=>{e.isMounted=!0}),Hg(()=>{e.isUnmounting=!0}),e}const bs=[Function,Array],OO={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:bs,onEnter:bs,onAfterEnter:bs,onEnterCancelled:bs,onBeforeLeave:bs,onLeave:bs,onAfterLeave:bs,onLeaveCancelled:bs,onBeforeAppear:bs,onAppear:bs,onAfterAppear:bs,onAppearCancelled:bs},setup(e,{slots:i}){const a=Ga(),c=Sx();let d;return()=>{const f=i.default&&Gg(i.default(),!0);if(!f||!f.length)return;let y=f[0];if(f.length>1){for(const J of f)if(J.type!==xr){y=J;break}}const s=Di(e),{mode:w}=s;if(c.isLeaving)return tv(y);const C=LT(y);if(!C)return tv(y);const L=Iu(C,s,c,a);ec(C,L);const k=a.subTree,R=k&&LT(k);let V=!1;const{getTransitionKey:H}=C.type;if(H){const J=H();d===void 0?d=J:J!==d&&(d=J,V=!0)}if(R&&R.type!==xr&&(!go(C,R)||V)){const J=Iu(R,s,c,a);if(ec(R,J),w==="out-in")return c.isLeaving=!0,J.afterLeave=()=>{c.isLeaving=!1,a.update()},tv(y);w==="in-out"&&C.type!==xr&&(J.delayLeave=(ue,j,q)=>{const se=OA(c,R);se[String(R.key)]=R,ue._leaveCb=()=>{j(),ue._leaveCb=void 0,delete L.delayedLeave},L.delayedLeave=q})}return y}}},Ax=OO;function OA(e,i){const{leavingVNodes:a}=e;let c=a.get(i.type);return c||(c=Object.create(null),a.set(i.type,c)),c}function Iu(e,i,a,c){const{appear:d,mode:f,persisted:y=!1,onBeforeEnter:s,onEnter:w,onAfterEnter:C,onEnterCancelled:L,onBeforeLeave:k,onLeave:R,onAfterLeave:V,onLeaveCancelled:H,onBeforeAppear:J,onAppear:ue,onAfterAppear:j,onAppearCancelled:q}=i,se=String(e.key),ge=OA(a,e),ie=(Ae,He)=>{Ae&&os(Ae,c,9,He)},Ie=(Ae,He)=>{const Ce=He[1];ie(Ae,He),si(Ae)?Ae.every(Ge=>Ge.length<=1)&&Ce():Ae.length<=1&&Ce()},ze={mode:f,persisted:y,beforeEnter(Ae){let He=s;if(!a.isMounted)if(d)He=J||s;else return;Ae._leaveCb&&Ae._leaveCb(!0);const Ce=ge[se];Ce&&go(e,Ce)&&Ce.el._leaveCb&&Ce.el._leaveCb(),ie(He,[Ae])},enter(Ae){let He=w,Ce=C,Ge=L;if(!a.isMounted)if(d)He=ue||w,Ce=j||C,Ge=q||L;else return;let De=!1;const We=Ae._enterCb=et=>{De||(De=!0,et?ie(Ge,[Ae]):ie(Ce,[Ae]),ze.delayedLeave&&ze.delayedLeave(),Ae._enterCb=void 0)};He?Ie(He,[Ae,We]):We()},leave(Ae,He){const Ce=String(e.key);if(Ae._enterCb&&Ae._enterCb(!0),a.isUnmounting)return He();ie(k,[Ae]);let Ge=!1;const De=Ae._leaveCb=We=>{Ge||(Ge=!0,He(),We?ie(H,[Ae]):ie(V,[Ae]),Ae._leaveCb=void 0,ge[Ce]===e&&delete ge[Ce])};ge[Ce]=e,R?Ie(R,[Ae,De]):De()},clone(Ae){return Iu(Ae,i,a,c)}};return ze}function tv(e){if(Sf(e))return e=bo(e),e.children=null,e}function LT(e){return Sf(e)?e.children?e.children[0]:void 0:e}function ec(e,i){e.shapeFlag&6&&e.component?ec(e.component.subTree,i):e.shapeFlag&128?(e.ssContent.transition=i.clone(e.ssContent),e.ssFallback.transition=i.clone(e.ssFallback)):e.transition=i}function Gg(e,i=!1,a){let c=[],d=0;for(let f=0;f<e.length;f++){let y=e[f];const s=a==null?y.key:String(a)+String(y.key!=null?y.key:f);y.type===dn?(y.patchFlag&128&&d++,c=c.concat(Gg(y.children,i,s))):(i||y.type!==xr)&&c.push(s!=null?bo(y,{key:s}):y)}if(d>1)for(let f=0;f<c.length;f++)c[f].patchFlag=-2;return c}function Gu(e){return gi(e)?{setup:e,name:e.name}:e}const Kl=e=>!!e.type.__asyncLoader;function FA(e){gi(e)&&(e={loader:e});const{loader:i,loadingComponent:a,errorComponent:c,delay:d=200,timeout:f,suspensible:y=!0,onError:s}=e;let w=null,C,L=0;const k=()=>(L++,w=null,R()),R=()=>{let V;return w||(V=w=i().catch(H=>{if(H=H instanceof Error?H:new Error(String(H)),s)return new Promise((J,ue)=>{s(H,()=>J(k()),()=>ue(H),L+1)});throw H}).then(H=>V!==w&&w?w:(H&&(H.__esModule||H[Symbol.toStringTag]==="Module")&&(H=H.default),C=H,H)))};return Gu({name:"AsyncComponentWrapper",__asyncLoader:R,get __asyncResolved(){return C},setup(){const V=Un;if(C)return()=>iv(C,V);const H=q=>{w=null,oc(q,V,13,!c)};if(y&&V.suspense||ku)return R().then(q=>()=>iv(q,V)).catch(q=>(H(q),()=>c?Hi(c,{error:q}):null));const J=Gd(!1),ue=Gd(),j=Gd(!!d);return d&&setTimeout(()=>{j.value=!1},d),f!=null&&setTimeout(()=>{if(!J.value&&!ue.value){const q=new Error(`Async component timed out after ${f}ms.`);H(q),ue.value=q}},f),R().then(()=>{J.value=!0,V.parent&&Sf(V.parent.vnode)&&bx(V.parent.update)}).catch(q=>{H(q),ue.value=q}),()=>{if(J.value&&C)return iv(C,V);if(ue.value&&c)return Hi(c,{error:ue.value});if(a&&!j.value)return Hi(a)}}})}function iv(e,{vnode:{ref:i,props:a,children:c,shapeFlag:d},parent:f}){const y=Hi(e,a,c);return y.ref=i,y}const Sf=e=>e.type.__isKeepAlive,FO={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:i}){const a=Ga(),c=a.ctx;if(!c.renderer)return()=>{const q=i.default&&i.default();return q&&q.length===1?q[0]:q};const d=new Map,f=new Set;let y=null;const s=a.suspense,{renderer:{p:w,m:C,um:L,o:{createElement:k}}}=c,R=k("div");c.activate=(q,se,ge,ie,Ie)=>{const ze=q.component;C(q,se,ge,0,s),w(ze.vnode,q,se,ge,ze,s,ie,q.slotScopeIds,Ie),or(()=>{ze.isDeactivated=!1,ze.a&&jd(ze.a);const Ae=q.props&&q.props.onVnodeMounted;Ae&&Nr(Ae,ze.parent,q)},s)},c.deactivate=q=>{const se=q.component;C(q,R,null,1,s),or(()=>{se.da&&jd(se.da);const ge=q.props&&q.props.onVnodeUnmounted;ge&&Nr(ge,se.parent,q),se.isDeactivated=!0},s)};function V(q){nv(q),L(q,a,s,!0)}function H(q){d.forEach((se,ge)=>{const ie=Xm(se.type);ie&&(!q||!q(ie))&&J(ge)})}function J(q){const se=d.get(q);!y||se.type!==y.type?V(se):y&&nv(y),d.delete(q),f.delete(q)}yu(()=>[e.include,e.exclude],([q,se])=>{q&&H(ge=>Fd(q,ge)),se&&H(ge=>!Fd(se,ge))},{flush:"post",deep:!0});let ue=null;const j=()=>{ue!=null&&d.set(ue,rv(a.subTree))};return Af(j),Wg(j),Hg(()=>{d.forEach(q=>{const{subTree:se,suspense:ge}=a,ie=rv(se);if(q.type===ie.type){nv(ie);const Ie=ie.component.da;Ie&&or(Ie,ge);return}V(q)})}),()=>{if(ue=null,!i.default)return null;const q=i.default(),se=q[0];if(q.length>1)return y=null,q;if(!Ua(se)||!(se.shapeFlag&4)&&!(se.shapeFlag&128))return y=null,se;let ge=rv(se);const ie=ge.type,Ie=Xm(Kl(ge)?ge.type.__asyncResolved||{}:ie),{include:ze,exclude:Ae,max:He}=e;if(ze&&(!Ie||!Fd(ze,Ie))||Ae&&Ie&&Fd(Ae,Ie))return y=ge,se;const Ce=ge.key==null?ie:ge.key,Ge=d.get(Ce);return ge.el&&(ge=bo(ge),se.shapeFlag&128&&(se.ssContent=ge)),ue=Ce,Ge?(ge.el=Ge.el,ge.component=Ge.component,ge.transition&&ec(ge,ge.transition),ge.shapeFlag|=512,f.delete(Ce),f.add(Ce)):(f.add(Ce),He&&f.size>parseInt(He,10)&&J(f.values().next().value)),ge.shapeFlag|=256,y=ge,kA(se.type)?se:ge}}},BO=FO;function Fd(e,i){return si(e)?e.some(a=>Fd(a,i)):$n(e)?e.split(",").includes(i):e.test?e.test(i):!1}function BA(e,i){UA(e,"a",i)}function NA(e,i){UA(e,"da",i)}function UA(e,i,a=Un){const c=e.__wdc||(e.__wdc=()=>{let d=a;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(qg(i,c,a),a){let d=a.parent;for(;d&&d.parent;)Sf(d.parent.vnode)&&NO(c,i,a,d),d=d.parent}}function NO(e,i,a,c){const d=qg(i,e,c,!0);Zg(()=>{ox(c[i],d)},a)}function nv(e){let i=e.shapeFlag;i&256&&(i-=256),i&512&&(i-=512),e.shapeFlag=i}function rv(e){return e.shapeFlag&128?e.ssContent:e}function qg(e,i,a=Un,c=!1){if(a){const d=a[e]||(a[e]=[]),f=i.__weh||(i.__weh=(...y)=>{if(a.isUnmounted)return;rc(),Va(a);const s=os(i,a,e,y);return Oa(),sc(),s});return c?d.unshift(f):d.push(f),f}}const Xo=e=>(i,a=Un)=>(!ku||e==="sp")&&qg(e,i,a),VA=Xo("bm"),Af=Xo("m"),$A=Xo("bu"),Wg=Xo("u"),Hg=Xo("bum"),Zg=Xo("um"),jA=Xo("sp"),GA=Xo("rtg"),qA=Xo("rtc");function WA(e,i=Un){qg("ec",e,i)}function Vs(e,i){const a=yr;if(a===null)return e;const c=Yg(a)||a.proxy,d=e.dirs||(e.dirs=[]);for(let f=0;f<i.length;f++){let[y,s,w,C=un]=i[f];gi(y)&&(y={mounted:y,updated:y}),y.deep&&Ul(s),d.push({dir:y,instance:c,value:s,oldValue:void 0,arg:w,modifiers:C})}return e}function mo(e,i,a,c){const d=e.dirs,f=i&&i.dirs;for(let y=0;y<d.length;y++){const s=d[y];f&&(s.oldValue=f[y].value);let w=s.dir[c];w&&(rc(),os(w,a,8,[e.el,s,e,i]),sc())}}const Cx="components",UO="directives";function Xd(e,i){return Mx(Cx,e,!0,i)||e}const HA=Symbol();function VO(e){return $n(e)?Mx(Cx,e,!1)||e:e||HA}function $O(e){return Mx(UO,e)}function Mx(e,i,a=!0,c=!1){const d=yr||Un;if(d){const f=d.type;if(e===Cx){const s=Xm(f);if(s&&(s===i||s===Ws(i)||s===Rg(Ws(i))))return f}const y=zT(d[e]||f[e],i)||zT(d.appContext[e],i);return!y&&c?f:y}}function zT(e,i){return e&&(e[i]||e[Ws(i)]||e[Rg(Ws(i))])}function Wo(e,i,a,c){let d;const f=a&&a[c];if(si(e)||$n(e)){d=new Array(e.length);for(let y=0,s=e.length;y<s;y++)d[y]=i(e[y],y,void 0,f&&f[y])}else if(typeof e=="number"){d=new Array(e);for(let y=0;y<e;y++)d[y]=i(y+1,y,void 0,f&&f[y])}else if(jn(e))if(e[Symbol.iterator])d=Array.from(e,(y,s)=>i(y,s,void 0,f&&f[s]));else{const y=Object.keys(e);d=new Array(y.length);for(let s=0,w=y.length;s<w;s++){const C=y[s];d[s]=i(e[C],C,s,f&&f[s])}}else d=[];return a&&(a[c]=d),d}function jO(e,i){for(let a=0;a<i.length;a++){const c=i[a];if(si(c))for(let d=0;d<c.length;d++)e[c[d].name]=c[d].fn;else c&&(e[c.name]=c.fn)}return e}function GO(e,i,a={},c,d){if(yr.isCE||yr.parent&&Kl(yr.parent)&&yr.parent.isCE)return Hi("slot",i==="default"?null:{name:i},c&&c());let f=e[i];f&&f._c&&(f._d=!1),Ft();const y=f&&ZA(f(a)),s=Xg(dn,{key:a.key||`_${i}`},y||(c?c():[]),y&&e._===1?64:-2);return!d&&s.scopeId&&(s.slotScopeIds=[s.scopeId+"-s"]),f&&f._c&&(f._d=!0),s}function ZA(e){return e.some(i=>Ua(i)?!(i.type===xr||i.type===dn&&!ZA(i.children)):!0)?e:null}function qO(e){const i={};for(const a in e)i[$d(a)]=e[a];return i}const Qv=e=>e?dC(e)?Yg(e)||e.proxy:Qv(e.parent):null,qm=lr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Qv(e.parent),$root:e=>Qv(e.root),$emit:e=>e.emit,$options:e=>KA(e),$forceUpdate:e=>e.f||(e.f=()=>bx(e.update)),$nextTick:e=>e.n||(e.n=Ug.bind(e.proxy)),$watch:e=>DO.bind(e)}),Jv={get({_:e},i){const{ctx:a,setupState:c,data:d,props:f,accessCache:y,type:s,appContext:w}=e;let C;if(i[0]!=="$"){const V=y[i];if(V!==void 0)switch(V){case 1:return c[i];case 2:return d[i];case 4:return a[i];case 3:return f[i]}else{if(c!==un&&Oi(c,i))return y[i]=1,c[i];if(d!==un&&Oi(d,i))return y[i]=2,d[i];if((C=e.propsOptions[0])&&Oi(C,i))return y[i]=3,f[i];if(a!==un&&Oi(a,i))return y[i]=4,a[i];e0&&(y[i]=0)}}const L=qm[i];let k,R;if(L)return i==="$attrs"&&cs(e,"get",i),L(e);if((k=s.__cssModules)&&(k=k[i]))return k;if(a!==un&&Oi(a,i))return y[i]=4,a[i];if(R=w.config.globalProperties,Oi(R,i))return R[i]},set({_:e},i,a){const{data:c,setupState:d,ctx:f}=e;return d!==un&&Oi(d,i)?(d[i]=a,!0):c!==un&&Oi(c,i)?(c[i]=a,!0):Oi(e.props,i)||i[0]==="$"&&i.slice(1)in e?!1:(f[i]=a,!0)},has({_:{data:e,setupState:i,accessCache:a,ctx:c,appContext:d,propsOptions:f}},y){let s;return!!a[y]||e!==un&&Oi(e,y)||i!==un&&Oi(i,y)||(s=f[0])&&Oi(s,y)||Oi(c,y)||Oi(qm,y)||Oi(d.config.globalProperties,y)},defineProperty(e,i,a){return a.get!=null?e._.accessCache[i]=0:Oi(a,"value")&&this.set(e,i,a.value,null),Reflect.defineProperty(e,i,a)}},WO=lr({},Jv,{get(e,i){if(i!==Symbol.unscopables)return Jv.get(e,i,e)},has(e,i){return i[0]!=="_"&&!mD(i)}});let e0=!0;function HO(e){const i=KA(e),a=e.proxy,c=e.ctx;e0=!1,i.beforeCreate&&RT(i.beforeCreate,e,"bc");const{data:d,computed:f,methods:y,watch:s,provide:w,inject:C,created:L,beforeMount:k,mounted:R,beforeUpdate:V,updated:H,activated:J,deactivated:ue,beforeDestroy:j,beforeUnmount:q,destroyed:se,unmounted:ge,render:ie,renderTracked:Ie,renderTriggered:ze,errorCaptured:Ae,serverPrefetch:He,expose:Ce,inheritAttrs:Ge,components:De,directives:We,filters:et}=i;if(C&&ZO(C,c,null,e.appContext.config.unwrapInjectedRef),y)for(const fi in y){const Yt=y[fi];gi(Yt)&&(c[fi]=Yt.bind(a))}if(d){const fi=d.call(a,a);jn(fi)&&(e.data=Tf(fi))}if(e0=!0,f)for(const fi in f){const Yt=f[fi],_i=gi(Yt)?Yt.bind(a,a):gi(Yt.get)?Yt.get.bind(a,a):js,tn=!gi(Yt)&&gi(Yt.set)?Yt.set.bind(a):js,Mi=Ts({get:_i,set:tn});Object.defineProperty(c,fi,{enumerable:!0,configurable:!0,get:()=>Mi.value,set:yi=>Mi.value=yi})}if(s)for(const fi in s)XA(s[fi],c,a,fi);if(w){const fi=gi(w)?w.call(a):w;Reflect.ownKeys(fi).forEach(Yt=>{Zd(Yt,fi[Yt])})}L&&RT(L,e,"c");function Vt(fi,Yt){si(Yt)?Yt.forEach(_i=>fi(_i.bind(a))):Yt&&fi(Yt.bind(a))}if(Vt(VA,k),Vt(Af,R),Vt($A,V),Vt(Wg,H),Vt(BA,J),Vt(NA,ue),Vt(WA,Ae),Vt(qA,Ie),Vt(GA,ze),Vt(Hg,q),Vt(Zg,ge),Vt(jA,He),si(Ce))if(Ce.length){const fi=e.exposed||(e.exposed={});Ce.forEach(Yt=>{Object.defineProperty(fi,Yt,{get:()=>a[Yt],set:_i=>a[Yt]=_i})})}else e.exposed||(e.exposed={});ie&&e.render===js&&(e.render=ie),Ge!=null&&(e.inheritAttrs=Ge),De&&(e.components=De),We&&(e.directives=We)}function ZO(e,i,a=js,c=!1){si(e)&&(e=t0(e));for(const d in e){const f=e[d];let y;jn(f)?"default"in f?y=vo(f.from||d,f.default,!0):y=vo(f.from||d):y=vo(f),zn(y)&&c?Object.defineProperty(i,d,{enumerable:!0,configurable:!0,get:()=>y.value,set:s=>y.value=s}):i[d]=y}}function RT(e,i,a){os(si(e)?e.map(c=>c.bind(i.proxy)):e.bind(i.proxy),i,a)}function XA(e,i,a,c){const d=c.includes(".")?DA(a,c):()=>a[c];if($n(e)){const f=i[e];gi(f)&&yu(d,f)}else if(gi(e))yu(d,e.bind(a));else if(jn(e))if(si(e))e.forEach(f=>XA(f,i,a,c));else{const f=gi(e.handler)?e.handler.bind(a):i[e.handler];gi(f)&&yu(d,f,e)}}function KA(e){const i=e.type,{mixins:a,extends:c}=i,{mixins:d,optionsCache:f,config:{optionMergeStrategies:y}}=e.appContext,s=f.get(i);let w;return s?w=s:!d.length&&!a&&!c?w=i:(w={},d.length&&d.forEach(C=>Wm(w,C,y,!0)),Wm(w,i,y)),f.set(i,w),w}function Wm(e,i,a,c=!1){const{mixins:d,extends:f}=i;f&&Wm(e,f,a,!0),d&&d.forEach(y=>Wm(e,y,a,!0));for(const y in i)if(!(c&&y==="expose")){const s=XO[y]||a&&a[y];e[y]=s?s(e[y],i[y]):i[y]}return e}const XO={data:DT,props:Bl,emits:Bl,methods:Bl,computed:Bl,beforeCreate:Cr,created:Cr,beforeMount:Cr,mounted:Cr,beforeUpdate:Cr,updated:Cr,beforeDestroy:Cr,beforeUnmount:Cr,destroyed:Cr,unmounted:Cr,activated:Cr,deactivated:Cr,errorCaptured:Cr,serverPrefetch:Cr,components:Bl,directives:Bl,watch:YO,provide:DT,inject:KO};function DT(e,i){return i?e?function(){return lr(gi(e)?e.call(this,this):e,gi(i)?i.call(this,this):i)}:i:e}function KO(e,i){return Bl(t0(e),t0(i))}function t0(e){if(si(e)){const i={};for(let a=0;a<e.length;a++)i[e[a]]=e[a];return i}return e}function Cr(e,i){return e?[...new Set([].concat(e,i))]:i}function Bl(e,i){return e?lr(lr(Object.create(null),e),i):i}function YO(e,i){if(!e)return i;if(!i)return e;const a=lr(Object.create(null),e);for(const c in i)a[c]=Cr(e[c],i[c]);return a}function QO(e,i,a,c=!1){const d={},f={};Vm(f,Kg,1),e.propsDefaults=Object.create(null),YA(e,i,d,f);for(const y in e.propsOptions[0])y in d||(d[y]=void 0);a?e.props=c?d:fx(d):e.type.props?e.props=d:e.props=f,e.attrs=f}function JO(e,i,a,c){const{props:d,attrs:f,vnode:{patchFlag:y}}=e,s=Di(d),[w]=e.propsOptions;let C=!1;if((c||y>0)&&!(y&16)){if(y&8){const L=e.vnode.dynamicProps;for(let k=0;k<L.length;k++){let R=L[k];if($g(e.emitsOptions,R))continue;const V=i[R];if(w)if(Oi(f,R))V!==f[R]&&(f[R]=V,C=!0);else{const H=Ws(R);d[H]=i0(w,s,H,V,e,!1)}else V!==f[R]&&(f[R]=V,C=!0)}}}else{YA(e,i,d,f)&&(C=!0);let L;for(const k in s)(!i||!Oi(i,k)&&((L=zg(k))===k||!Oi(i,L)))&&(w?a&&(a[k]!==void 0||a[L]!==void 0)&&(d[k]=i0(w,s,k,void 0,e,!0)):delete d[k]);if(f!==s)for(const k in f)(!i||!Oi(i,k)&&!0)&&(delete f[k],C=!0)}C&&Zo(e,"set","$attrs")}function YA(e,i,a,c){const[d,f]=e.propsOptions;let y=!1,s;if(i)for(let w in i){if(Vd(w))continue;const C=i[w];let L;d&&Oi(d,L=Ws(w))?!f||!f.includes(L)?a[L]=C:(s||(s={}))[L]=C:$g(e.emitsOptions,w)||(!(w in c)||C!==c[w])&&(c[w]=C,y=!0)}if(f){const w=Di(a),C=s||un;for(let L=0;L<f.length;L++){const k=f[L];a[k]=i0(d,w,k,C[k],e,!Oi(C,k))}}return y}function i0(e,i,a,c,d,f){const y=e[a];if(y!=null){const s=Oi(y,"default");if(s&&c===void 0){const w=y.default;if(y.type!==Function&&gi(w)){const{propsDefaults:C}=d;a in C?c=C[a]:(Va(d),c=C[a]=w.call(null,i),Oa())}else c=w}y[0]&&(f&&!s?c=!1:y[1]&&(c===""||c===zg(a))&&(c=!0))}return c}function QA(e,i,a=!1){const c=i.propsCache,d=c.get(e);if(d)return d;const f=e.props,y={},s=[];let w=!1;if(!gi(e)){const L=k=>{w=!0;const[R,V]=QA(k,i,!0);lr(y,R),V&&s.push(...V)};!a&&i.mixins.length&&i.mixins.forEach(L),e.extends&&L(e.extends),e.mixins&&e.mixins.forEach(L)}if(!f&&!w)return c.set(e,mu),mu;if(si(f))for(let L=0;L<f.length;L++){const k=Ws(f[L]);OT(k)&&(y[k]=un)}else if(f)for(const L in f){const k=Ws(L);if(OT(k)){const R=f[L],V=y[k]=si(R)||gi(R)?{type:R}:R;if(V){const H=NT(Boolean,V.type),J=NT(String,V.type);V[0]=H>-1,V[1]=J<0||H<J,(H>-1||Oi(V,"default"))&&s.push(k)}}}const C=[y,s];return c.set(e,C),C}function OT(e){return e[0]!=="$"}function FT(e){const i=e&&e.toString().match(/^\s*function (\w+)/);return i?i[1]:e===null?"null":""}function BT(e,i){return FT(e)===FT(i)}function NT(e,i){return si(i)?i.findIndex(a=>BT(a,e)):gi(i)&&BT(i,e)?0:-1}const JA=e=>e[0]==="_"||e==="$stable",Ix=e=>si(e)?e.map(ns):[ns(e)],eF=(e,i,a)=>{if(i._n)return i;const c=Mu((...d)=>Ix(i(...d)),a);return c._c=!1,c},eC=(e,i,a)=>{const c=e._ctx;for(const d in e){if(JA(d))continue;const f=e[d];if(gi(f))i[d]=eF(d,f,c);else if(f!=null){const y=Ix(f);i[d]=()=>y}}},tC=(e,i)=>{const a=Ix(i);e.slots.default=()=>a},tF=(e,i)=>{if(e.vnode.shapeFlag&32){const a=i._;a?(e.slots=Di(i),Vm(i,"_",a)):eC(i,e.slots={})}else e.slots={},i&&tC(e,i);Vm(e.slots,Kg,1)},iF=(e,i,a)=>{const{vnode:c,slots:d}=e;let f=!0,y=un;if(c.shapeFlag&32){const s=i._;s?a&&s===1?f=!1:(lr(d,i),!a&&s===1&&delete d._):(f=!i.$stable,eC(i,d)),y=i}else i&&(tC(e,i),y={default:1});if(f)for(const s in d)!JA(s)&&!(s in y)&&delete d[s]};function iC(){return{app:null,config:{isNativeTag:xD,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let nF=0;function rF(e,i){return function(c,d=null){gi(c)||(c=Object.assign({},c)),d!=null&&!jn(d)&&(d=null);const f=iC(),y=new Set;let s=!1;const w=f.app={_uid:nF++,_component:c,_props:d,_container:null,_context:f,_instance:null,version:bC,get config(){return f.config},set config(C){},use(C,...L){return y.has(C)||(C&&gi(C.install)?(y.add(C),C.install(w,...L)):gi(C)&&(y.add(C),C(w,...L))),w},mixin(C){return f.mixins.includes(C)||f.mixins.push(C),w},component(C,L){return L?(f.components[C]=L,w):f.components[C]},directive(C,L){return L?(f.directives[C]=L,w):f.directives[C]},mount(C,L,k){if(!s){const R=Hi(c,d);return R.appContext=f,L&&i?i(R,C):e(R,C,k),s=!0,w._container=C,C.__vue_app__=w,Yg(R.component)||R.component.proxy}},unmount(){s&&(e(null,w._container),delete w._container.__vue_app__)},provide(C,L){return f.provides[C]=L,w}};return w}}function Hm(e,i,a,c,d=!1){if(si(e)){e.forEach((R,V)=>Hm(R,i&&(si(i)?i[V]:i),a,c,d));return}if(Kl(c)&&!d)return;const f=c.shapeFlag&4?Yg(c.component)||c.component.proxy:c.el,y=d?null:f,{i:s,r:w}=e,C=i&&i.r,L=s.refs===un?s.refs={}:s.refs,k=s.setupState;if(C!=null&&C!==w&&($n(C)?(L[C]=null,Oi(k,C)&&(k[C]=null)):zn(C)&&(C.value=null)),gi(w))yo(w,s,12,[y,L]);else{const R=$n(w),V=zn(w);if(R||V){const H=()=>{if(e.f){const J=R?L[w]:w.value;d?si(J)&&ox(J,f):si(J)?J.includes(f)||J.push(f):R?(L[w]=[f],Oi(k,w)&&(k[w]=L[w])):(w.value=[f],e.k&&(L[e.k]=w.value))}else R?(L[w]=y,Oi(k,w)&&(k[w]=y)):zn(w)&&(w.value=y,e.k&&(L[e.k]=y))};y?(H.id=-1,or(H,a)):H()}}}let Sa=!1;const gm=e=>/svg/.test(e.namespaceURI)&&e.tagName!=="foreignObject",_m=e=>e.nodeType===8;function sF(e){const{mt:i,p:a,o:{patchProp:c,createText:d,nextSibling:f,parentNode:y,remove:s,insert:w,createComment:C}}=e,L=(j,q)=>{if(!q.hasChildNodes()){a(null,j,q),Gm();return}Sa=!1,k(q.firstChild,j,null,null,null),Gm(),Sa&&console.error("Hydration completed but contains mismatches.")},k=(j,q,se,ge,ie,Ie=!1)=>{const ze=_m(j)&&j.data==="[",Ae=()=>J(j,q,se,ge,ie,ze),{type:He,ref:Ce,shapeFlag:Ge,patchFlag:De}=q,We=j.nodeType;q.el=j,De===-2&&(Ie=!1,q.dynamicChildren=null);let et=null;switch(He){case Pu:We!==3?q.children===""?(w(q.el=d(""),y(j),j),et=j):et=Ae():(j.data!==q.children&&(Sa=!0,j.data=q.children),et=f(j));break;case xr:We!==8||ze?et=Ae():et=f(j);break;case Yl:if(We!==1)et=Ae();else{et=j;const Gt=!q.children.length;for(let Vt=0;Vt<q.staticCount;Vt++)Gt&&(q.children+=et.outerHTML),Vt===q.staticCount-1&&(q.anchor=et),et=f(et);return et}break;case dn:ze?et=H(j,q,se,ge,ie,Ie):et=Ae();break;default:if(Ge&1)We!==1||q.type.toLowerCase()!==j.tagName.toLowerCase()?et=Ae():et=R(j,q,se,ge,ie,Ie);else if(Ge&6){q.slotScopeIds=ie;const Gt=y(j);if(i(q,Gt,null,se,ge,gm(Gt),Ie),et=ze?ue(j):f(j),et&&_m(et)&&et.data==="teleport end"&&(et=f(et)),Kl(q)){let Vt;ze?(Vt=Hi(dn),Vt.anchor=et?et.previousSibling:Gt.lastChild):Vt=j.nodeType===3?Ir(""):Hi("div"),Vt.el=j,q.component.subTree=Vt}}else Ge&64?We!==8?et=Ae():et=q.type.hydrate(j,q,se,ge,ie,Ie,e,V):Ge&128&&(et=q.type.hydrate(j,q,se,ge,gm(y(j)),ie,Ie,e,k))}return Ce!=null&&Hm(Ce,null,ge,q),et},R=(j,q,se,ge,ie,Ie)=>{Ie=Ie||!!q.dynamicChildren;const{type:ze,props:Ae,patchFlag:He,shapeFlag:Ce,dirs:Ge}=q,De=ze==="input"&&Ge||ze==="option";if(De||He!==-1){if(Ge&&mo(q,null,se,"created"),Ae)if(De||!Ie||He&48)for(const et in Ae)(De&&et.endsWith("value")||Pg(et)&&!Vd(et))&&c(j,et,null,Ae[et],!1,void 0,se);else Ae.onClick&&c(j,"onClick",null,Ae.onClick,!1,void 0,se);let We;if((We=Ae&&Ae.onVnodeBeforeMount)&&Nr(We,se,q),Ge&&mo(q,null,se,"beforeMount"),((We=Ae&&Ae.onVnodeMounted)||Ge)&&zA(()=>{We&&Nr(We,se,q),Ge&&mo(q,null,se,"mounted")},ge),Ce&16&&!(Ae&&(Ae.innerHTML||Ae.textContent))){let et=V(j.firstChild,q,j,se,ge,ie,Ie);for(;et;){Sa=!0;const Gt=et;et=et.nextSibling,s(Gt)}}else Ce&8&&j.textContent!==q.children&&(Sa=!0,j.textContent=q.children)}return j.nextSibling},V=(j,q,se,ge,ie,Ie,ze)=>{ze=ze||!!q.dynamicChildren;const Ae=q.children,He=Ae.length;for(let Ce=0;Ce<He;Ce++){const Ge=ze?Ae[Ce]:Ae[Ce]=ns(Ae[Ce]);if(j)j=k(j,Ge,ge,ie,Ie,ze);else{if(Ge.type===Pu&&!Ge.children)continue;Sa=!0,a(null,Ge,se,null,ge,ie,gm(se),Ie)}}return j},H=(j,q,se,ge,ie,Ie)=>{const{slotScopeIds:ze}=q;ze&&(ie=ie?ie.concat(ze):ze);const Ae=y(j),He=V(f(j),q,Ae,se,ge,ie,Ie);return He&&_m(He)&&He.data==="]"?f(q.anchor=He):(Sa=!0,w(q.anchor=C("]"),Ae,He),He)},J=(j,q,se,ge,ie,Ie)=>{if(Sa=!0,q.el=null,Ie){const He=ue(j);for(;;){const Ce=f(j);if(Ce&&Ce!==He)s(Ce);else break}}const ze=f(j),Ae=y(j);return s(j),a(null,q,Ae,ze,se,ge,gm(Ae),ie),ze},ue=j=>{let q=0;for(;j;)if(j=f(j),j&&_m(j)&&(j.data==="["&&q++,j.data==="]")){if(q===0)return f(j);q--}return j};return[L,k]}const or=zA;function nC(e){return sC(e)}function rC(e){return sC(e,sF)}function sC(e,i){const a=AD();a.__VUE__=!0;const{insert:c,remove:d,patchProp:f,createElement:y,createText:s,createComment:w,setText:C,setElementText:L,parentNode:k,nextSibling:R,setScopeId:V=js,cloneNode:H,insertStaticContent:J}=e,ue=(he,de,Ne,at=null,Ye=null,gt=null,It=!1,tt=null,xt=!!de.dynamicChildren)=>{if(he===de)return;he&&!go(he,de)&&(at=Pt(he),Kt(he,Ye,gt,!0),he=null),de.patchFlag===-2&&(xt=!1,de.dynamicChildren=null);const{type:ut,ref:Ot,shapeFlag:Dt}=de;switch(ut){case Pu:j(he,de,Ne,at);break;case xr:q(he,de,Ne,at);break;case Yl:he==null&&se(de,Ne,at,It);break;case dn:We(he,de,Ne,at,Ye,gt,It,tt,xt);break;default:Dt&1?Ie(he,de,Ne,at,Ye,gt,It,tt,xt):Dt&6?et(he,de,Ne,at,Ye,gt,It,tt,xt):(Dt&64||Dt&128)&&ut.process(he,de,Ne,at,Ye,gt,It,tt,xt,Lt)}Ot!=null&&Ye&&Hm(Ot,he&&he.ref,gt,de||he,!de)},j=(he,de,Ne,at)=>{if(he==null)c(de.el=s(de.children),Ne,at);else{const Ye=de.el=he.el;de.children!==he.children&&C(Ye,de.children)}},q=(he,de,Ne,at)=>{he==null?c(de.el=w(de.children||""),Ne,at):de.el=he.el},se=(he,de,Ne,at)=>{[he.el,he.anchor]=J(he.children,de,Ne,at,he.el,he.anchor)},ge=({el:he,anchor:de},Ne,at)=>{let Ye;for(;he&&he!==de;)Ye=R(he),c(he,Ne,at),he=Ye;c(de,Ne,at)},ie=({el:he,anchor:de})=>{let Ne;for(;he&&he!==de;)Ne=R(he),d(he),he=Ne;d(de)},Ie=(he,de,Ne,at,Ye,gt,It,tt,xt)=>{It=It||de.type==="svg",he==null?ze(de,Ne,at,Ye,gt,It,tt,xt):Ce(he,de,Ye,gt,It,tt,xt)},ze=(he,de,Ne,at,Ye,gt,It,tt)=>{let xt,ut;const{type:Ot,props:Dt,shapeFlag:$t,transition:Zt,patchFlag:ci,dirs:oi}=he;if(he.el&&H!==void 0&&ci===-1)xt=he.el=H(he.el);else{if(xt=he.el=y(he.type,gt,Dt&&Dt.is,Dt),$t&8?L(xt,he.children):$t&16&&He(he.children,xt,null,at,Ye,gt&&Ot!=="foreignObject",It,tt),oi&&mo(he,null,at,"created"),Dt){for(const bi in Dt)bi!=="value"&&!Vd(bi)&&f(xt,bi,null,Dt[bi],gt,he.children,at,Ye,Ke);"value"in Dt&&f(xt,"value",null,Dt.value),(ut=Dt.onVnodeBeforeMount)&&Nr(ut,at,he)}Ae(xt,he,he.scopeId,It,at)}oi&&mo(he,null,at,"beforeMount");const ui=(!Ye||Ye&&!Ye.pendingBranch)&&Zt&&!Zt.persisted;ui&&Zt.beforeEnter(xt),c(xt,de,Ne),((ut=Dt&&Dt.onVnodeMounted)||ui||oi)&&or(()=>{ut&&Nr(ut,at,he),ui&&Zt.enter(xt),oi&&mo(he,null,at,"mounted")},Ye)},Ae=(he,de,Ne,at,Ye)=>{if(Ne&&V(he,Ne),at)for(let gt=0;gt<at.length;gt++)V(he,at[gt]);if(Ye){let gt=Ye.subTree;if(de===gt){const It=Ye.vnode;Ae(he,It,It.scopeId,It.slotScopeIds,Ye.parent)}}},He=(he,de,Ne,at,Ye,gt,It,tt,xt=0)=>{for(let ut=xt;ut<he.length;ut++){const Ot=he[ut]=tt?ka(he[ut]):ns(he[ut]);ue(null,Ot,de,Ne,at,Ye,gt,It,tt)}},Ce=(he,de,Ne,at,Ye,gt,It)=>{const tt=de.el=he.el;let{patchFlag:xt,dynamicChildren:ut,dirs:Ot}=de;xt|=he.patchFlag&16;const Dt=he.props||un,$t=de.props||un;let Zt;Ne&&Dl(Ne,!1),(Zt=$t.onVnodeBeforeUpdate)&&Nr(Zt,Ne,de,he),Ot&&mo(de,he,Ne,"beforeUpdate"),Ne&&Dl(Ne,!0);const ci=Ye&&de.type!=="foreignObject";if(ut?Ge(he.dynamicChildren,ut,tt,Ne,at,ci,gt):It||_i(he,de,tt,null,Ne,at,ci,gt,!1),xt>0){if(xt&16)De(tt,de,Dt,$t,Ne,at,Ye);else if(xt&2&&Dt.class!==$t.class&&f(tt,"class",null,$t.class,Ye),xt&4&&f(tt,"style",Dt.style,$t.style,Ye),xt&8){const oi=de.dynamicProps;for(let ui=0;ui<oi.length;ui++){const bi=oi[ui],nn=Dt[bi],Zi=$t[bi];(Zi!==nn||bi==="value")&&f(tt,bi,nn,Zi,Ye,he.children,Ne,at,Ke)}}xt&1&&he.children!==de.children&&L(tt,de.children)}else!It&&ut==null&&De(tt,de,Dt,$t,Ne,at,Ye);((Zt=$t.onVnodeUpdated)||Ot)&&or(()=>{Zt&&Nr(Zt,Ne,de,he),Ot&&mo(de,he,Ne,"updated")},at)},Ge=(he,de,Ne,at,Ye,gt,It)=>{for(let tt=0;tt<de.length;tt++){const xt=he[tt],ut=de[tt],Ot=xt.el&&(xt.type===dn||!go(xt,ut)||xt.shapeFlag&70)?k(xt.el):Ne;ue(xt,ut,Ot,null,at,Ye,gt,It,!0)}},De=(he,de,Ne,at,Ye,gt,It)=>{if(Ne!==at){for(const tt in at){if(Vd(tt))continue;const xt=at[tt],ut=Ne[tt];xt!==ut&&tt!=="value"&&f(he,tt,ut,xt,It,de.children,Ye,gt,Ke)}if(Ne!==un)for(const tt in Ne)!Vd(tt)&&!(tt in at)&&f(he,tt,Ne[tt],null,It,de.children,Ye,gt,Ke);"value"in at&&f(he,"value",Ne.value,at.value)}},We=(he,de,Ne,at,Ye,gt,It,tt,xt)=>{const ut=de.el=he?he.el:s(""),Ot=de.anchor=he?he.anchor:s("");let{patchFlag:Dt,dynamicChildren:$t,slotScopeIds:Zt}=de;Zt&&(tt=tt?tt.concat(Zt):Zt),he==null?(c(ut,Ne,at),c(Ot,Ne,at),He(de.children,Ne,Ot,Ye,gt,It,tt,xt)):Dt>0&&Dt&64&&$t&&he.dynamicChildren?(Ge(he.dynamicChildren,$t,Ne,Ye,gt,It,tt),(de.key!=null||Ye&&de===Ye.subTree)&&Px(he,de,!0)):_i(he,de,Ne,Ot,Ye,gt,It,tt,xt)},et=(he,de,Ne,at,Ye,gt,It,tt,xt)=>{de.slotScopeIds=tt,he==null?de.shapeFlag&512?Ye.ctx.activate(de,Ne,at,It,xt):Gt(de,Ne,at,Ye,gt,It,xt):Vt(he,de,xt)},Gt=(he,de,Ne,at,Ye,gt,It)=>{const tt=he.component=hC(he,at,Ye);if(Sf(he)&&(tt.ctx.renderer=Lt),fC(tt),tt.asyncDep){if(Ye&&Ye.registerDep(tt,fi),!he.el){const xt=tt.subTree=Hi(xr);q(null,xt,de,Ne)}return}fi(tt,he,de,Ne,Ye,gt,It)},Vt=(he,de,Ne)=>{const at=de.component=he.component;if(CO(he,de,Ne))if(at.asyncDep&&!at.asyncResolved){Yt(at,de,Ne);return}else at.next=de,xO(at.update),at.update();else de.el=he.el,at.vnode=de},fi=(he,de,Ne,at,Ye,gt,It)=>{const tt=()=>{if(he.isMounted){let{next:Ot,bu:Dt,u:$t,parent:Zt,vnode:ci}=he,oi=Ot,ui;Dl(he,!1),Ot?(Ot.el=ci.el,Yt(he,Ot,It)):Ot=ci,Dt&&jd(Dt),(ui=Ot.props&&Ot.props.onVnodeBeforeUpdate)&&Nr(ui,Zt,Ot,ci),Dl(he,!0);const bi=Pm(he),nn=he.subTree;he.subTree=bi,ue(nn,bi,k(nn.el),Pt(nn),he,Ye,gt),Ot.el=bi.el,oi===null&&Tx(he,bi.el),$t&&or($t,Ye),(ui=Ot.props&&Ot.props.onVnodeUpdated)&&or(()=>Nr(ui,Zt,Ot,ci),Ye)}else{let Ot;const{el:Dt,props:$t}=de,{bm:Zt,m:ci,parent:oi}=he,ui=Kl(de);if(Dl(he,!1),Zt&&jd(Zt),!ui&&(Ot=$t&&$t.onVnodeBeforeMount)&&Nr(Ot,oi,de),Dl(he,!0),Dt&&Ai){const bi=()=>{he.subTree=Pm(he),Ai(Dt,he.subTree,he,Ye,null)};ui?de.type.__asyncLoader().then(()=>!he.isUnmounted&&bi()):bi()}else{const bi=he.subTree=Pm(he);ue(null,bi,Ne,at,he,Ye,gt),de.el=bi.el}if(ci&&or(ci,Ye),!ui&&(Ot=$t&&$t.onVnodeMounted)){const bi=de;or(()=>Nr(Ot,oi,bi),Ye)}(de.shapeFlag&256||oi&&Kl(oi.vnode)&&oi.vnode.shapeFlag&256)&&he.a&&or(he.a,Ye),he.isMounted=!0,de=Ne=at=null}},xt=he.effect=new wf(tt,()=>bx(ut),he.scope),ut=he.update=()=>xt.run();ut.id=he.uid,Dl(he,!0),ut()},Yt=(he,de,Ne)=>{de.component=he;const at=he.vnode.props;he.vnode=de,he.next=null,JO(he,de.props,at,Ne),iF(he,de.children,Ne),rc(),Vg(void 0,he.update),sc()},_i=(he,de,Ne,at,Ye,gt,It,tt,xt=!1)=>{const ut=he&&he.children,Ot=he?he.shapeFlag:0,Dt=de.children,{patchFlag:$t,shapeFlag:Zt}=de;if($t>0){if($t&128){Mi(ut,Dt,Ne,at,Ye,gt,It,tt,xt);return}else if($t&256){tn(ut,Dt,Ne,at,Ye,gt,It,tt,xt);return}}Zt&8?(Ot&16&&Ke(ut,Ye,gt),Dt!==ut&&L(Ne,Dt)):Ot&16?Zt&16?Mi(ut,Dt,Ne,at,Ye,gt,It,tt,xt):Ke(ut,Ye,gt,!0):(Ot&8&&L(Ne,""),Zt&16&&He(Dt,Ne,at,Ye,gt,It,tt,xt))},tn=(he,de,Ne,at,Ye,gt,It,tt,xt)=>{he=he||mu,de=de||mu;const ut=he.length,Ot=de.length,Dt=Math.min(ut,Ot);let $t;for($t=0;$t<Dt;$t++){const Zt=de[$t]=xt?ka(de[$t]):ns(de[$t]);ue(he[$t],Zt,Ne,null,Ye,gt,It,tt,xt)}ut>Ot?Ke(he,Ye,gt,!0,!1,Dt):He(de,Ne,at,Ye,gt,It,tt,xt,Dt)},Mi=(he,de,Ne,at,Ye,gt,It,tt,xt)=>{let ut=0;const Ot=de.length;let Dt=he.length-1,$t=Ot-1;for(;ut<=Dt&&ut<=$t;){const Zt=he[ut],ci=de[ut]=xt?ka(de[ut]):ns(de[ut]);if(go(Zt,ci))ue(Zt,ci,Ne,null,Ye,gt,It,tt,xt);else break;ut++}for(;ut<=Dt&&ut<=$t;){const Zt=he[Dt],ci=de[$t]=xt?ka(de[$t]):ns(de[$t]);if(go(Zt,ci))ue(Zt,ci,Ne,null,Ye,gt,It,tt,xt);else break;Dt--,$t--}if(ut>Dt){if(ut<=$t){const Zt=$t+1,ci=Zt<Ot?de[Zt].el:at;for(;ut<=$t;)ue(null,de[ut]=xt?ka(de[ut]):ns(de[ut]),Ne,ci,Ye,gt,It,tt,xt),ut++}}else if(ut>$t)for(;ut<=Dt;)Kt(he[ut],Ye,gt,!0),ut++;else{const Zt=ut,ci=ut,oi=new Map;for(ut=ci;ut<=$t;ut++){const Xi=de[ut]=xt?ka(de[ut]):ns(de[ut]);Xi.key!=null&&oi.set(Xi.key,ut)}let ui,bi=0;const nn=$t-ci+1;let Zi=!1,Gn=0;const ur=new Array(nn);for(ut=0;ut<nn;ut++)ur[ut]=0;for(ut=Zt;ut<=Dt;ut++){const Xi=he[ut];if(bi>=nn){Kt(Xi,Ye,gt,!0);continue}let Mn;if(Xi.key!=null)Mn=oi.get(Xi.key);else for(ui=ci;ui<=$t;ui++)if(ur[ui-ci]===0&&go(Xi,de[ui])){Mn=ui;break}Mn===void 0?Kt(Xi,Ye,gt,!0):(ur[Mn-ci]=ut+1,Mn>=Gn?Gn=Mn:Zi=!0,ue(Xi,de[Mn],Ne,null,Ye,gt,It,tt,xt),bi++)}const fs=Zi?oF(ur):mu;for(ui=fs.length-1,ut=nn-1;ut>=0;ut--){const Xi=ci+ut,Mn=de[Xi],ps=Xi+1<Ot?de[Xi+1].el:at;ur[ut]===0?ue(null,Mn,Ne,ps,Ye,gt,It,tt,xt):Zi&&(ui<0||ut!==fs[ui]?yi(Mn,Ne,ps,2):ui--)}}},yi=(he,de,Ne,at,Ye=null)=>{const{el:gt,type:It,transition:tt,children:xt,shapeFlag:ut}=he;if(ut&6){yi(he.component.subTree,de,Ne,at);return}if(ut&128){he.suspense.move(de,Ne,at);return}if(ut&64){It.move(he,de,Ne,Lt);return}if(It===dn){c(gt,de,Ne);for(let Dt=0;Dt<xt.length;Dt++)yi(xt[Dt],de,Ne,at);c(he.anchor,de,Ne);return}if(It===Yl){ge(he,de,Ne);return}if(at!==2&&ut&1&&tt)if(at===0)tt.beforeEnter(gt),c(gt,de,Ne),or(()=>tt.enter(gt),Ye);else{const{leave:Dt,delayLeave:$t,afterLeave:Zt}=tt,ci=()=>c(gt,de,Ne),oi=()=>{Dt(gt,()=>{ci(),Zt&&Zt()})};$t?$t(gt,ci,oi):oi()}else c(gt,de,Ne)},Kt=(he,de,Ne,at=!1,Ye=!1)=>{const{type:gt,props:It,ref:tt,children:xt,dynamicChildren:ut,shapeFlag:Ot,patchFlag:Dt,dirs:$t}=he;if(tt!=null&&Hm(tt,null,Ne,he,!0),Ot&256){de.ctx.deactivate(he);return}const Zt=Ot&1&&$t,ci=!Kl(he);let oi;if(ci&&(oi=It&&It.onVnodeBeforeUnmount)&&Nr(oi,de,he),Ot&6)xn(he.component,Ne,at);else{if(Ot&128){he.suspense.unmount(Ne,at);return}Zt&&mo(he,null,de,"beforeUnmount"),Ot&64?he.type.remove(he,de,Ne,Ye,Lt,at):ut&&(gt!==dn||Dt>0&&Dt&64)?Ke(ut,de,Ne,!1,!0):(gt===dn&&Dt&384||!Ye&&Ot&16)&&Ke(xt,de,Ne),at&&fn(he)}(ci&&(oi=It&&It.onVnodeUnmounted)||Zt)&&or(()=>{oi&&Nr(oi,de,he),Zt&&mo(he,null,de,"unmounted")},Ne)},fn=he=>{const{type:de,el:Ne,anchor:at,transition:Ye}=he;if(de===dn){gn(Ne,at);return}if(de===Yl){ie(he);return}const gt=()=>{d(Ne),Ye&&!Ye.persisted&&Ye.afterLeave&&Ye.afterLeave()};if(he.shapeFlag&1&&Ye&&!Ye.persisted){const{leave:It,delayLeave:tt}=Ye,xt=()=>It(Ne,gt);tt?tt(he.el,gt,xt):xt()}else gt()},gn=(he,de)=>{let Ne;for(;he!==de;)Ne=R(he),d(he),he=Ne;d(de)},xn=(he,de,Ne)=>{const{bum:at,scope:Ye,update:gt,subTree:It,um:tt}=he;at&&jd(at),Ye.stop(),gt&&(gt.active=!1,Kt(It,he,de,Ne)),tt&&or(tt,de),or(()=>{he.isUnmounted=!0},de),de&&de.pendingBranch&&!de.isUnmounted&&he.asyncDep&&!he.asyncResolved&&he.suspenseId===de.pendingId&&(de.deps--,de.deps===0&&de.resolve())},Ke=(he,de,Ne,at=!1,Ye=!1,gt=0)=>{for(let It=gt;It<he.length;It++)Kt(he[It],de,Ne,at,Ye)},Pt=he=>he.shapeFlag&6?Pt(he.component.subTree):he.shapeFlag&128?he.suspense.next():R(he.anchor||he.el),Mt=(he,de,Ne)=>{he==null?de._vnode&&Kt(de._vnode,null,null,!0):ue(de._vnode||null,he,de,null,null,null,Ne),Gm(),de._vnode=he},Lt={p:ue,um:Kt,m:yi,r:fn,mt:Gt,mc:He,pc:_i,pbc:Ge,n:Pt,o:e};let li,Ai;return i&&([li,Ai]=i(Lt)),{render:Mt,hydrate:li,createApp:rF(Mt,li)}}function Dl({effect:e,update:i},a){e.allowRecurse=i.allowRecurse=a}function Px(e,i,a=!1){const c=e.children,d=i.children;if(si(c)&&si(d))for(let f=0;f<c.length;f++){const y=c[f];let s=d[f];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=d[f]=ka(d[f]),s.el=y.el),a||Px(y,s))}}function oF(e){const i=e.slice(),a=[0];let c,d,f,y,s;const w=e.length;for(c=0;c<w;c++){const C=e[c];if(C!==0){if(d=a[a.length-1],e[d]<C){i[c]=d,a.push(c);continue}for(f=0,y=a.length-1;f<y;)s=f+y>>1,e[a[s]]<C?f=s+1:y=s;C<e[a[f]]&&(f>0&&(i[c]=a[f-1]),a[f]=c)}}for(f=a.length,y=a[f-1];f-- >0;)a[f]=y,y=i[y];return a}const aF=e=>e.__isTeleport,Kd=e=>e&&(e.disabled||e.disabled===""),UT=e=>typeof SVGElement<"u"&&e instanceof SVGElement,n0=(e,i)=>{const a=e&&e.to;return $n(a)?i?i(a):null:a},lF={__isTeleport:!0,process(e,i,a,c,d,f,y,s,w,C){const{mc:L,pc:k,pbc:R,o:{insert:V,querySelector:H,createText:J,createComment:ue}}=C,j=Kd(i.props);let{shapeFlag:q,children:se,dynamicChildren:ge}=i;if(e==null){const ie=i.el=J(""),Ie=i.anchor=J("");V(ie,a,c),V(Ie,a,c);const ze=i.target=n0(i.props,H),Ae=i.targetAnchor=J("");ze&&(V(Ae,ze),y=y||UT(ze));const He=(Ce,Ge)=>{q&16&&L(se,Ce,Ge,d,f,y,s,w)};j?He(a,Ie):ze&&He(ze,Ae)}else{i.el=e.el;const ie=i.anchor=e.anchor,Ie=i.target=e.target,ze=i.targetAnchor=e.targetAnchor,Ae=Kd(e.props),He=Ae?a:Ie,Ce=Ae?ie:ze;if(y=y||UT(Ie),ge?(R(e.dynamicChildren,ge,He,d,f,y,s),Px(e,i,!0)):w||k(e,i,He,Ce,d,f,y,s,!1),j)Ae||ym(i,a,ie,C,1);else if((i.props&&i.props.to)!==(e.props&&e.props.to)){const Ge=i.target=n0(i.props,H);Ge&&ym(i,Ge,null,C,0)}else Ae&&ym(i,Ie,ze,C,1)}},remove(e,i,a,c,{um:d,o:{remove:f}},y){const{shapeFlag:s,children:w,anchor:C,targetAnchor:L,target:k,props:R}=e;if(k&&f(L),(y||!Kd(R))&&(f(C),s&16))for(let V=0;V<w.length;V++){const H=w[V];d(H,i,a,!0,!!H.dynamicChildren)}},move:ym,hydrate:cF};function ym(e,i,a,{o:{insert:c},m:d},f=2){f===0&&c(e.targetAnchor,i,a);const{el:y,anchor:s,shapeFlag:w,children:C,props:L}=e,k=f===2;if(k&&c(y,i,a),(!k||Kd(L))&&w&16)for(let R=0;R<C.length;R++)d(C[R],i,a,2);k&&c(s,i,a)}function cF(e,i,a,c,d,f,{o:{nextSibling:y,parentNode:s,querySelector:w}},C){const L=i.target=n0(i.props,w);if(L){const k=L._lpa||L.firstChild;if(i.shapeFlag&16)if(Kd(i.props))i.anchor=C(y(e),i,s(e),a,c,d,f),i.targetAnchor=k;else{i.anchor=y(e);let R=k;for(;R;)if(R=y(R),R&&R.nodeType===8&&R.data==="teleport anchor"){i.targetAnchor=R,L._lpa=i.targetAnchor&&y(i.targetAnchor);break}C(k,i,L,a,c,d,f)}}return i.anchor&&y(i.anchor)}const uF=lF,dn=Symbol(void 0),Pu=Symbol(void 0),xr=Symbol(void 0),Yl=Symbol(void 0),Yd=[];let Ur=null;function Ft(e=!1){Yd.push(Ur=e?null:[])}function oC(){Yd.pop(),Ur=Yd[Yd.length-1]||null}let tc=1;function r0(e){tc+=e}function aC(e){return e.dynamicChildren=tc>0?Ur||mu:null,oC(),tc>0&&Ur&&Ur.push(e),e}function Nt(e,i,a,c,d,f){return aC(Fe(e,i,a,c,d,f,!0))}function Xg(e,i,a,c,d){return aC(Hi(e,i,a,c,d,!0))}function Ua(e){return e?e.__v_isVNode===!0:!1}function go(e,i){return e.type===i.type&&e.key===i.key}function hF(e){}const Kg="__vInternal",lC=({key:e})=>e!=null?e:null,km=({ref:e,ref_key:i,ref_for:a})=>e!=null?$n(e)||zn(e)||gi(e)?{i:yr,r:e,k:i,f:!!a}:e:null;function Fe(e,i=null,a=null,c=0,d=null,f=e===dn?0:1,y=!1,s=!1){const w={__v_isVNode:!0,__v_skip:!0,type:e,props:i,key:i&&lC(i),ref:i&&km(i),scopeId:jg,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:c,dynamicProps:d,dynamicChildren:null,appContext:null};return s?(kx(w,a),f&128&&e.normalize(w)):a&&(w.shapeFlag|=$n(a)?8:16),tc>0&&!y&&Ur&&(w.patchFlag>0||f&6)&&w.patchFlag!==32&&Ur.push(w),w}const Hi=dF;function dF(e,i=null,a=null,c=0,d=null,f=!1){if((!e||e===HA)&&(e=xr),Ua(e)){const s=bo(e,i,!0);return a&&kx(s,a),tc>0&&!f&&Ur&&(s.shapeFlag&6?Ur[Ur.indexOf(e)]=s:Ur.push(s)),s.patchFlag|=-2,s}if(xF(e)&&(e=e.__vccOpts),i){i=cC(i);let{class:s,style:w}=i;s&&!$n(s)&&(i.class=$i(s)),jn(w)&&(mx(w)&&!si(w)&&(w=lr({},w)),i.style=bf(w))}const y=$n(e)?1:kA(e)?128:aF(e)?64:jn(e)?4:gi(e)?2:0;return Fe(e,i,a,c,d,y,f,!0)}function cC(e){return e?mx(e)||Kg in e?lr({},e):e:null}function bo(e,i,a=!1){const{props:c,ref:d,patchFlag:f,children:y}=e,s=i?uC(c||{},i):c;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:s,key:s&&lC(s),ref:i&&i.ref?a&&d?si(d)?d.concat(km(i)):[d,km(i)]:km(i):d,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:y,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:i&&e.type!==dn?f===-1?16:f|16:f,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&bo(e.ssContent),ssFallback:e.ssFallback&&bo(e.ssFallback),el:e.el,anchor:e.anchor}}function Ir(e=" ",i=0){return Hi(Pu,null,e,i)}function qu(e,i){const a=Hi(Yl,null,e);return a.staticCount=i,a}function Ri(e="",i=!1){return i?(Ft(),Xg(xr,null,e)):Hi(xr,null,e)}function ns(e){return e==null||typeof e=="boolean"?Hi(xr):si(e)?Hi(dn,null,e.slice()):typeof e=="object"?ka(e):Hi(Pu,null,String(e))}function ka(e){return e.el===null||e.memo?e:bo(e)}function kx(e,i){let a=0;const{shapeFlag:c}=e;if(i==null)i=null;else if(si(i))a=16;else if(typeof i=="object")if(c&65){const d=i.default;d&&(d._c&&(d._d=!1),kx(e,d()),d._c&&(d._d=!0));return}else{a=32;const d=i._;!d&&!(Kg in i)?i._ctx=yr:d===3&&yr&&(yr.slots._===1?i._=1:(i._=2,e.patchFlag|=1024))}else gi(i)?(i={default:i,_ctx:yr},a=32):(i=String(i),c&64?(a=16,i=[Ir(i)]):a=8);e.children=i,e.shapeFlag|=a}function uC(...e){const i={};for(let a=0;a<e.length;a++){const c=e[a];for(const d in c)if(d==="class")i.class!==c.class&&(i.class=$i([i.class,c.class]));else if(d==="style")i.style=bf([i.style,c.style]);else if(Pg(d)){const f=i[d],y=c[d];y&&f!==y&&!(si(f)&&f.includes(y))&&(i[d]=f?[].concat(f,y):y)}else d!==""&&(i[d]=c[d])}return i}function Nr(e,i,a,c=null){os(e,i,7,[a,c])}const fF=iC();let pF=0;function hC(e,i,a){const c=e.type,d=(i?i.appContext:e.appContext)||fF,f={uid:pF++,vnode:e,type:c,parent:i,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,scope:new ux(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:i?i.provides:Object.create(d.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:QA(c,d),emitsOptions:MA(c,d),emit:null,emitted:null,propsDefaults:un,inheritAttrs:c.inheritAttrs,ctx:un,data:un,props:un,attrs:un,slots:un,refs:un,setupState:un,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=i?i.root:f,f.emit=wO.bind(null,f),e.ce&&e.ce(f),f}let Un=null;const Ga=()=>Un||yr,Va=e=>{Un=e,e.scope.on()},Oa=()=>{Un&&Un.scope.off(),Un=null};function dC(e){return e.vnode.shapeFlag&4}let ku=!1;function fC(e,i=!1){ku=i;const{props:a,children:c}=e.vnode,d=dC(e);QO(e,a,d,i),tF(e,c);const f=d?mF(e,i):void 0;return ku=!1,f}function mF(e,i){const a=e.type;e.accessCache=Object.create(null),e.proxy=gx(new Proxy(e.ctx,Jv));const{setup:c}=a;if(c){const d=e.setupContext=c.length>1?gC(e):null;Va(e),rc();const f=yo(c,e,0,[e.props,d]);if(sc(),Oa(),lx(f)){if(f.then(Oa,Oa),i)return f.then(y=>{s0(e,y,i)}).catch(y=>{oc(y,e,0)});e.asyncDep=f}else s0(e,f,i)}else mC(e,i)}function s0(e,i,a){gi(i)?e.type.__ssrInlineRender?e.ssrRender=i:e.render=i:jn(i)&&(e.setupState=vx(i)),mC(e,a)}let Zm,o0;function pC(e){Zm=e,o0=i=>{i.render._rc&&(i.withProxy=new Proxy(i.ctx,WO))}}const gF=()=>!Zm;function mC(e,i,a){const c=e.type;if(!e.render){if(!i&&Zm&&!c.render){const d=c.template;if(d){const{isCustomElement:f,compilerOptions:y}=e.appContext.config,{delimiters:s,compilerOptions:w}=c,C=lr(lr({isCustomElement:f,delimiters:s},y),w);c.render=Zm(d,C)}}e.render=c.render||js,o0&&o0(e)}Va(e),rc(),HO(e),sc(),Oa()}function _F(e){return new Proxy(e.attrs,{get(i,a){return cs(e,"get","$attrs"),i[a]}})}function gC(e){const i=c=>{e.exposed=c||{}};let a;return{get attrs(){return a||(a=_F(e))},slots:e.slots,emit:e.emit,expose:i}}function Yg(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(vx(gx(e.exposed)),{get(i,a){if(a in i)return i[a];if(a in qm)return qm[a](e)}}))}const yF=/(?:^|[-_])(\w)/g,vF=e=>e.replace(yF,i=>i.toUpperCase()).replace(/[-_]/g,"");function Xm(e){return gi(e)&&e.displayName||e.name}function _C(e,i,a=!1){let c=Xm(i);if(!c&&i.__file){const d=i.__file.match(/([^/\\]+)\.\w+$/);d&&(c=d[1])}if(!c&&e&&e.parent){const d=f=>{for(const y in f)if(f[y]===i)return y};c=d(e.components||e.parent.type.components)||d(e.appContext.components)}return c?vF(c):a?"App":"Anonymous"}function xF(e){return gi(e)&&"__vccOpts"in e}const Ts=(e,i)=>fO(e,i,ku);function bF(){return null}function wF(){return null}function TF(e){}function EF(e,i){return null}function SF(){return yC().slots}function AF(){return yC().attrs}function yC(){const e=Ga();return e.setupContext||(e.setupContext=gC(e))}function CF(e,i){const a=si(e)?e.reduce((c,d)=>(c[d]={},c),{}):e;for(const c in i){const d=a[c];d?si(d)||gi(d)?a[c]={type:d,default:i[c]}:d.default=i[c]:d===null&&(a[c]={default:i[c]})}return a}function MF(e,i){const a={};for(const c in e)i.includes(c)||Object.defineProperty(a,c,{enumerable:!0,get:()=>e[c]});return a}function IF(e){const i=Ga();let a=e();return Oa(),lx(a)&&(a=a.catch(c=>{throw Va(i),c})),[a,()=>Va(i)]}function Cf(e,i,a){const c=arguments.length;return c===2?jn(i)&&!si(i)?Ua(i)?Hi(e,null,[i]):Hi(e,i):Hi(e,null,i):(c>3?a=Array.prototype.slice.call(arguments,2):c===3&&Ua(a)&&(a=[a]),Hi(e,i,a))}const vC=Symbol(""),PF=()=>{{const e=vo(vC);return e||bA("Server rendering context not provided. Make sure to only call useSSRContext() conditionally in the server build."),e}};function kF(){}function LF(e,i,a,c){const d=a[c];if(d&&xC(d,e))return d;const f=i();return f.memo=e.slice(),a[c]=f}function xC(e,i){const a=e.memo;if(a.length!=i.length)return!1;for(let c=0;c<a.length;c++)if(Au(a[c],i[c]))return!1;return tc>0&&Ur&&Ur.push(e),!0}const bC="3.2.36",zF={createComponentInstance:hC,setupComponent:fC,renderComponentRoot:Pm,setCurrentRenderingInstance:af,isVNode:Ua,normalizeVNode:ns},RF=zF,DF=null,OF=null;function FF(e,i){const a=Object.create(null),c=e.split(",");for(let d=0;d<c.length;d++)a[c[d]]=!0;return i?d=>!!a[d.toLowerCase()]:d=>!!a[d]}const BF="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",NF=FF(BF);function wC(e){return!!e||e===""}function UF(e,i){if(e.length!==i.length)return!1;let a=!0;for(let c=0;a&&c<e.length;c++)a=$a(e[c],i[c]);return a}function $a(e,i){if(e===i)return!0;let a=VT(e),c=VT(i);if(a||c)return a&&c?e.getTime()===i.getTime():!1;if(a=$T(e),c=$T(i),a||c)return e===i;if(a=us(e),c=us(i),a||c)return a&&c?UF(e,i):!1;if(a=a0(e),c=a0(i),a||c){if(!a||!c)return!1;const d=Object.keys(e).length,f=Object.keys(i).length;if(d!==f)return!1;for(const y in e){const s=e.hasOwnProperty(y),w=i.hasOwnProperty(y);if(s&&!w||!s&&w||!$a(e[y],i[y]))return!1}}return String(e)===String(i)}function Qg(e,i){return e.findIndex(a=>$a(a,i))}const sv={},VF=/^on[^a-z]/,$F=e=>VF.test(e),jF=e=>e.startsWith("onUpdate:"),Mf=Object.assign,us=Array.isArray,If=e=>EC(e)==="[object Set]",VT=e=>EC(e)==="[object Date]",TC=e=>typeof e=="function",Km=e=>typeof e=="string",$T=e=>typeof e=="symbol",a0=e=>e!==null&&typeof e=="object",GF=Object.prototype.toString,EC=e=>GF.call(e),Lx=e=>{const i=Object.create(null);return a=>i[a]||(i[a]=e(a))},qF=/-(\w)/g,jT=Lx(e=>e.replace(qF,(i,a)=>a?a.toUpperCase():"")),WF=/\B([A-Z])/g,vu=Lx(e=>e.replace(WF,"-$1").toLowerCase()),HF=Lx(e=>e.charAt(0).toUpperCase()+e.slice(1)),ZF=(e,i)=>{for(let a=0;a<e.length;a++)e[a](i)},Lu=e=>{const i=parseFloat(e);return isNaN(i)?e:i},XF="http://www.w3.org/2000/svg",Nl=typeof document<"u"?document:null,GT=Nl&&Nl.createElement("template"),KF={insert:(e,i,a)=>{i.insertBefore(e,a||null)},remove:e=>{const i=e.parentNode;i&&i.removeChild(e)},createElement:(e,i,a,c)=>{const d=i?Nl.createElementNS(XF,e):Nl.createElement(e,a?{is:a}:void 0);return e==="select"&&c&&c.multiple!=null&&d.setAttribute("multiple",c.multiple),d},createText:e=>Nl.createTextNode(e),createComment:e=>Nl.createComment(e),setText:(e,i)=>{e.nodeValue=i},setElementText:(e,i)=>{e.textContent=i},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Nl.querySelector(e),setScopeId(e,i){e.setAttribute(i,"")},cloneNode(e){const i=e.cloneNode(!0);return"_value"in e&&(i._value=e._value),i},insertStaticContent(e,i,a,c,d,f){const y=a?a.previousSibling:i.lastChild;if(d&&(d===f||d.nextSibling))for(;i.insertBefore(d.cloneNode(!0),a),!(d===f||!(d=d.nextSibling)););else{GT.innerHTML=c?`<svg>${e}</svg>`:e;const s=GT.content;if(c){const w=s.firstChild;for(;w.firstChild;)s.appendChild(w.firstChild);s.removeChild(w)}i.insertBefore(s,a)}return[y?y.nextSibling:i.firstChild,a?a.previousSibling:i.lastChild]}};function YF(e,i,a){const c=e._vtc;c&&(i=(i?[i,...c]:[...c]).join(" ")),i==null?e.removeAttribute("class"):a?e.setAttribute("class",i):e.className=i}function QF(e,i,a){const c=e.style,d=Km(a);if(a&&!d){for(const f in a)l0(c,f,a[f]);if(i&&!Km(i))for(const f in i)a[f]==null&&l0(c,f,"")}else{const f=c.display;d?i!==a&&(c.cssText=a):i&&e.removeAttribute("style"),"_vod"in e&&(c.display=f)}}const qT=/\s*!important$/;function l0(e,i,a){if(us(a))a.forEach(c=>l0(e,i,c));else if(a==null&&(a=""),i.startsWith("--"))e.setProperty(i,a);else{const c=JF(e,i);qT.test(a)?e.setProperty(vu(c),a.replace(qT,""),"important"):e[c]=a}}const WT=["Webkit","Moz","ms"],ov={};function JF(e,i){const a=ov[i];if(a)return a;let c=Ws(i);if(c!=="filter"&&c in e)return ov[i]=c;c=HF(c);for(let d=0;d<WT.length;d++){const f=WT[d]+c;if(f in e)return ov[i]=f}return i}const HT="http://www.w3.org/1999/xlink";function eB(e,i,a,c,d){if(c&&i.startsWith("xlink:"))a==null?e.removeAttributeNS(HT,i.slice(6,i.length)):e.setAttributeNS(HT,i,a);else{const f=NF(i);a==null||f&&!wC(a)?e.removeAttribute(i):e.setAttribute(i,f?"":a)}}function tB(e,i,a,c,d,f,y){if(i==="innerHTML"||i==="textContent"){c&&y(c,d,f),e[i]=a==null?"":a;return}if(i==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=a;const w=a==null?"":a;(e.value!==w||e.tagName==="OPTION")&&(e.value=w),a==null&&e.removeAttribute(i);return}let s=!1;if(a===""||a==null){const w=typeof e[i];w==="boolean"?a=wC(a):a==null&&w==="string"?(a="",s=!0):w==="number"&&(a=0,s=!0)}try{e[i]=a}catch{}s&&e.removeAttribute(i)}const[SC,iB]=(()=>{let e=Date.now,i=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const a=navigator.userAgent.match(/firefox\/(\d+)/i);i=!!(a&&Number(a[1])<=53)}return[e,i]})();let c0=0;const nB=Promise.resolve(),rB=()=>{c0=0},sB=()=>c0||(nB.then(rB),c0=SC());function qo(e,i,a,c){e.addEventListener(i,a,c)}function oB(e,i,a,c){e.removeEventListener(i,a,c)}function aB(e,i,a,c,d=null){const f=e._vei||(e._vei={}),y=f[i];if(c&&y)y.value=c;else{const[s,w]=lB(i);if(c){const C=f[i]=cB(c,d);qo(e,s,C,w)}else y&&(oB(e,s,y,w),f[i]=void 0)}}const ZT=/(?:Once|Passive|Capture)$/;function lB(e){let i;if(ZT.test(e)){i={};let a;for(;a=e.match(ZT);)e=e.slice(0,e.length-a[0].length),i[a[0].toLowerCase()]=!0}return[vu(e.slice(2)),i]}function cB(e,i){const a=c=>{const d=c.timeStamp||SC();(iB||d>=a.attached-1)&&os(uB(c,a.value),i,5,[c])};return a.value=e,a.attached=sB(),a}function uB(e,i){if(us(i)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},i.map(c=>d=>!d._stopped&&c&&c(d))}else return i}const XT=/^on[a-z]/,hB=(e,i,a,c,d=!1,f,y,s,w)=>{i==="class"?YF(e,c,d):i==="style"?QF(e,a,c):$F(i)?jF(i)||aB(e,i,a,c,y):(i[0]==="."?(i=i.slice(1),!0):i[0]==="^"?(i=i.slice(1),!1):dB(e,i,c,d))?tB(e,i,c,f,y,s,w):(i==="true-value"?e._trueValue=c:i==="false-value"&&(e._falseValue=c),eB(e,i,c,d))};function dB(e,i,a,c){return c?!!(i==="innerHTML"||i==="textContent"||i in e&&XT.test(i)&&TC(a)):i==="spellcheck"||i==="draggable"||i==="translate"||i==="form"||i==="list"&&e.tagName==="INPUT"||i==="type"&&e.tagName==="TEXTAREA"||XT.test(i)&&Km(a)?!1:i in e}function AC(e,i){const a=Gu(e);class c extends Jg{constructor(f){super(a,f,i)}}return c.def=a,c}const fB=e=>AC(e,UC),pB=typeof HTMLElement<"u"?HTMLElement:class{};class Jg extends pB{constructor(i,a={},c){super(),this._def=i,this._props=a,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&c?c(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,Ug(()=>{this._connected||(h0(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let c=0;c<this.attributes.length;c++)this._setAttr(this.attributes[c].name);new MutationObserver(c=>{for(const d of c)this._setAttr(d.attributeName)}).observe(this,{attributes:!0});const i=c=>{const{props:d,styles:f}=c,y=!us(d),s=d?y?Object.keys(d):d:[];let w;if(y)for(const C in this._props){const L=d[C];(L===Number||L&&L.type===Number)&&(this._props[C]=Lu(this._props[C]),(w||(w=Object.create(null)))[C]=!0)}this._numberProps=w;for(const C of Object.keys(this))C[0]!=="_"&&this._setProp(C,this[C],!0,!1);for(const C of s.map(jT))Object.defineProperty(this,C,{get(){return this._getProp(C)},set(L){this._setProp(C,L)}});this._applyStyles(f),this._update()},a=this._def.__asyncLoader;a?a().then(i):i(this._def)}_setAttr(i){let a=this.getAttribute(i);this._numberProps&&this._numberProps[i]&&(a=Lu(a)),this._setProp(jT(i),a,!1)}_getProp(i){return this._props[i]}_setProp(i,a,c=!0,d=!0){a!==this._props[i]&&(this._props[i]=a,d&&this._instance&&this._update(),c&&(a===!0?this.setAttribute(vu(i),""):typeof a=="string"||typeof a=="number"?this.setAttribute(vu(i),a+""):a||this.removeAttribute(vu(i))))}_update(){h0(this._createVNode(),this.shadowRoot)}_createVNode(){const i=Hi(this._def,Mf({},this._props));return this._instance||(i.ce=a=>{this._instance=a,a.isCE=!0,a.emit=(d,...f)=>{this.dispatchEvent(new CustomEvent(d,{detail:f}))};let c=this;for(;c=c&&(c.parentNode||c.host);)if(c instanceof Jg){a.parent=c._instance;break}}),i}_applyStyles(i){i&&i.forEach(a=>{const c=document.createElement("style");c.textContent=a,this.shadowRoot.appendChild(c)})}}function mB(e="$style"){{const i=Ga();if(!i)return sv;const a=i.type.__cssModules;if(!a)return sv;const c=a[e];return c||sv}}function gB(e){const i=Ga();if(!i)return;const a=()=>u0(i.subTree,e(i.proxy));RA(a),Af(()=>{const c=new MutationObserver(a);c.observe(i.subTree.el.parentNode,{childList:!0}),Zg(()=>c.disconnect())})}function u0(e,i){if(e.shapeFlag&128){const a=e.suspense;e=a.activeBranch,a.pendingBranch&&!a.isHydrating&&a.effects.push(()=>{u0(a.activeBranch,i)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)KT(e.el,i);else if(e.type===dn)e.children.forEach(a=>u0(a,i));else if(e.type===Yl){let{el:a,anchor:c}=e;for(;a&&(KT(a,i),a!==c);)a=a.nextSibling}}function KT(e,i){if(e.nodeType===1){const a=e.style;for(const c in i)a.setProperty(`--${c}`,i[c])}}const Aa="transition",Ed="animation",e_=(e,{slots:i})=>Cf(Ax,MC(e),i);e_.displayName="Transition";const CC={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},_B=e_.props=Mf({},Ax.props,CC),Ol=(e,i=[])=>{us(e)?e.forEach(a=>a(...i)):e&&e(...i)},YT=e=>e?us(e)?e.some(i=>i.length>1):e.length>1:!1;function MC(e){const i={};for(const De in e)De in CC||(i[De]=e[De]);if(e.css===!1)return i;const{name:a="v",type:c,duration:d,enterFromClass:f=`${a}-enter-from`,enterActiveClass:y=`${a}-enter-active`,enterToClass:s=`${a}-enter-to`,appearFromClass:w=f,appearActiveClass:C=y,appearToClass:L=s,leaveFromClass:k=`${a}-leave-from`,leaveActiveClass:R=`${a}-leave-active`,leaveToClass:V=`${a}-leave-to`}=e,H=yB(d),J=H&&H[0],ue=H&&H[1],{onBeforeEnter:j,onEnter:q,onEnterCancelled:se,onLeave:ge,onLeaveCancelled:ie,onBeforeAppear:Ie=j,onAppear:ze=q,onAppearCancelled:Ae=se}=i,He=(De,We,et)=>{Ia(De,We?L:s),Ia(De,We?C:y),et&&et()},Ce=(De,We)=>{De._isLeaving=!1,Ia(De,k),Ia(De,V),Ia(De,R),We&&We()},Ge=De=>(We,et)=>{const Gt=De?ze:q,Vt=()=>He(We,De,et);Ol(Gt,[We,Vt]),QT(()=>{Ia(We,De?w:f),jo(We,De?L:s),YT(Gt)||JT(We,c,J,Vt)})};return Mf(i,{onBeforeEnter(De){Ol(j,[De]),jo(De,f),jo(De,y)},onBeforeAppear(De){Ol(Ie,[De]),jo(De,w),jo(De,C)},onEnter:Ge(!1),onAppear:Ge(!0),onLeave(De,We){De._isLeaving=!0;const et=()=>Ce(De,We);jo(De,k),PC(),jo(De,R),QT(()=>{!De._isLeaving||(Ia(De,k),jo(De,V),YT(ge)||JT(De,c,ue,et))}),Ol(ge,[De,et])},onEnterCancelled(De){He(De,!1),Ol(se,[De])},onAppearCancelled(De){He(De,!0),Ol(Ae,[De])},onLeaveCancelled(De){Ce(De),Ol(ie,[De])}})}function yB(e){if(e==null)return null;if(a0(e))return[av(e.enter),av(e.leave)];{const i=av(e);return[i,i]}}function av(e){return Lu(e)}function jo(e,i){i.split(/\s+/).forEach(a=>a&&e.classList.add(a)),(e._vtc||(e._vtc=new Set)).add(i)}function Ia(e,i){i.split(/\s+/).forEach(c=>c&&e.classList.remove(c));const{_vtc:a}=e;a&&(a.delete(i),a.size||(e._vtc=void 0))}function QT(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let vB=0;function JT(e,i,a,c){const d=e._endId=++vB,f=()=>{d===e._endId&&c()};if(a)return setTimeout(f,a);const{type:y,timeout:s,propCount:w}=IC(e,i);if(!y)return c();const C=y+"end";let L=0;const k=()=>{e.removeEventListener(C,R),f()},R=V=>{V.target===e&&++L>=w&&k()};setTimeout(()=>{L<w&&k()},s+1),e.addEventListener(C,R)}function IC(e,i){const a=window.getComputedStyle(e),c=H=>(a[H]||"").split(", "),d=c(Aa+"Delay"),f=c(Aa+"Duration"),y=eE(d,f),s=c(Ed+"Delay"),w=c(Ed+"Duration"),C=eE(s,w);let L=null,k=0,R=0;i===Aa?y>0&&(L=Aa,k=y,R=f.length):i===Ed?C>0&&(L=Ed,k=C,R=w.length):(k=Math.max(y,C),L=k>0?y>C?Aa:Ed:null,R=L?L===Aa?f.length:w.length:0);const V=L===Aa&&/\b(transform|all)(,|$)/.test(a[Aa+"Property"]);return{type:L,timeout:k,propCount:R,hasTransform:V}}function eE(e,i){for(;e.length<i.length;)e=e.concat(e);return Math.max(...i.map((a,c)=>tE(a)+tE(e[c])))}function tE(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function PC(){return document.body.offsetHeight}const kC=new WeakMap,LC=new WeakMap,xB={name:"TransitionGroup",props:Mf({},_B,{tag:String,moveClass:String}),setup(e,{slots:i}){const a=Ga(),c=Sx();let d,f;return Wg(()=>{if(!d.length)return;const y=e.moveClass||`${e.name||"v"}-move`;if(!SB(d[0].el,a.vnode.el,y))return;d.forEach(wB),d.forEach(TB);const s=d.filter(EB);PC(),s.forEach(w=>{const C=w.el,L=C.style;jo(C,y),L.transform=L.webkitTransform=L.transitionDuration="";const k=C._moveCb=R=>{R&&R.target!==C||(!R||/transform$/.test(R.propertyName))&&(C.removeEventListener("transitionend",k),C._moveCb=null,Ia(C,y))};C.addEventListener("transitionend",k)})}),()=>{const y=Di(e),s=MC(y);let w=y.tag||dn;d=f,f=i.default?Gg(i.default()):[];for(let C=0;C<f.length;C++){const L=f[C];L.key!=null&&ec(L,Iu(L,s,c,a))}if(d)for(let C=0;C<d.length;C++){const L=d[C];ec(L,Iu(L,s,c,a)),kC.set(L,L.el.getBoundingClientRect())}return Hi(w,null,f)}}},bB=xB;function wB(e){const i=e.el;i._moveCb&&i._moveCb(),i._enterCb&&i._enterCb()}function TB(e){LC.set(e,e.el.getBoundingClientRect())}function EB(e){const i=kC.get(e),a=LC.get(e),c=i.left-a.left,d=i.top-a.top;if(c||d){const f=e.el.style;return f.transform=f.webkitTransform=`translate(${c}px,${d}px)`,f.transitionDuration="0s",e}}function SB(e,i,a){const c=e.cloneNode();e._vtc&&e._vtc.forEach(y=>{y.split(/\s+/).forEach(s=>s&&c.classList.remove(s))}),a.split(/\s+/).forEach(y=>y&&c.classList.add(y)),c.style.display="none";const d=i.nodeType===1?i:i.parentNode;d.appendChild(c);const{hasTransform:f}=IC(c);return d.removeChild(c),f}const ja=e=>{const i=e.props["onUpdate:modelValue"]||!1;return us(i)?a=>ZF(i,a):i};function AB(e){e.target.composing=!0}function iE(e){const i=e.target;i.composing&&(i.composing=!1,i.dispatchEvent(new Event("input")))}const xo={created(e,{modifiers:{lazy:i,trim:a,number:c}},d){e._assign=ja(d);const f=c||d.props&&d.props.type==="number";qo(e,i?"change":"input",y=>{if(y.target.composing)return;let s=e.value;a&&(s=s.trim()),f&&(s=Lu(s)),e._assign(s)}),a&&qo(e,"change",()=>{e.value=e.value.trim()}),i||(qo(e,"compositionstart",AB),qo(e,"compositionend",iE),qo(e,"change",iE))},mounted(e,{value:i}){e.value=i==null?"":i},beforeUpdate(e,{value:i,modifiers:{lazy:a,trim:c,number:d}},f){if(e._assign=ja(f),e.composing||document.activeElement===e&&e.type!=="range"&&(a||c&&e.value.trim()===i||(d||e.type==="number")&&Lu(e.value)===i))return;const y=i==null?"":i;e.value!==y&&(e.value=y)}},zx={deep:!0,created(e,i,a){e._assign=ja(a),qo(e,"change",()=>{const c=e._modelValue,d=zu(e),f=e.checked,y=e._assign;if(us(c)){const s=Qg(c,d),w=s!==-1;if(f&&!w)y(c.concat(d));else if(!f&&w){const C=[...c];C.splice(s,1),y(C)}}else if(If(c)){const s=new Set(c);f?s.add(d):s.delete(d),y(s)}else y(RC(e,f))})},mounted:nE,beforeUpdate(e,i,a){e._assign=ja(a),nE(e,i,a)}};function nE(e,{value:i,oldValue:a},c){e._modelValue=i,us(i)?e.checked=Qg(i,c.props.value)>-1:If(i)?e.checked=i.has(c.props.value):i!==a&&(e.checked=$a(i,RC(e,!0)))}const cf={created(e,{value:i},a){e.checked=$a(i,a.props.value),e._assign=ja(a),qo(e,"change",()=>{e._assign(zu(e))})},beforeUpdate(e,{value:i,oldValue:a},c){e._assign=ja(c),i!==a&&(e.checked=$a(i,c.props.value))}},zC={deep:!0,created(e,{value:i,modifiers:{number:a}},c){const d=If(i);qo(e,"change",()=>{const f=Array.prototype.filter.call(e.options,y=>y.selected).map(y=>a?Lu(zu(y)):zu(y));e._assign(e.multiple?d?new Set(f):f:f[0])}),e._assign=ja(c)},mounted(e,{value:i}){rE(e,i)},beforeUpdate(e,i,a){e._assign=ja(a)},updated(e,{value:i}){rE(e,i)}};function rE(e,i){const a=e.multiple;if(!(a&&!us(i)&&!If(i))){for(let c=0,d=e.options.length;c<d;c++){const f=e.options[c],y=zu(f);if(a)us(i)?f.selected=Qg(i,y)>-1:f.selected=i.has(y);else if($a(zu(f),i)){e.selectedIndex!==c&&(e.selectedIndex=c);return}}!a&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function zu(e){return"_value"in e?e._value:e.value}function RC(e,i){const a=i?"_trueValue":"_falseValue";return a in e?e[a]:i}const DC={created(e,i,a){vm(e,i,a,null,"created")},mounted(e,i,a){vm(e,i,a,null,"mounted")},beforeUpdate(e,i,a,c){vm(e,i,a,c,"beforeUpdate")},updated(e,i,a,c){vm(e,i,a,c,"updated")}};function OC(e,i){switch(e){case"SELECT":return zC;case"TEXTAREA":return xo;default:switch(i){case"checkbox":return zx;case"radio":return cf;default:return xo}}}function vm(e,i,a,c,d){const y=OC(e.tagName,a.props&&a.props.type)[d];y&&y(e,i,a,c)}function CB(){xo.getSSRProps=({value:e})=>({value:e}),cf.getSSRProps=({value:e},i)=>{if(i.props&&$a(i.props.value,e))return{checked:!0}},zx.getSSRProps=({value:e},i)=>{if(us(e)){if(i.props&&Qg(e,i.props.value)>-1)return{checked:!0}}else if(If(e)){if(i.props&&e.has(i.props.value))return{checked:!0}}else if(e)return{checked:!0}},DC.getSSRProps=(e,i)=>{if(typeof i.type!="string")return;const a=OC(i.type.toUpperCase(),i.props&&i.props.type);if(a.getSSRProps)return a.getSSRProps(e,i)}}const MB=["ctrl","shift","alt","meta"],IB={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,i)=>MB.some(a=>e[`${a}Key`]&&!i.includes(a))},Rx=(e,i)=>(a,...c)=>{for(let d=0;d<i.length;d++){const f=IB[i[d]];if(f&&f(a,i))return}return e(a,...c)},PB={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},kB=(e,i)=>a=>{if(!("key"in a))return;const c=vu(a.key);if(i.some(d=>d===c||PB[d]===c))return e(a)},t_={beforeMount(e,{value:i},{transition:a}){e._vod=e.style.display==="none"?"":e.style.display,a&&i?a.beforeEnter(e):Sd(e,i)},mounted(e,{value:i},{transition:a}){a&&i&&a.enter(e)},updated(e,{value:i,oldValue:a},{transition:c}){!i!=!a&&(c?i?(c.beforeEnter(e),Sd(e,!0),c.enter(e)):c.leave(e,()=>{Sd(e,!1)}):Sd(e,i))},beforeUnmount(e,{value:i}){Sd(e,i)}};function Sd(e,i){e.style.display=i?e._vod:"none"}function LB(){t_.getSSRProps=({value:e})=>{if(!e)return{style:{display:"none"}}}}const FC=Mf({patchProp:hB},KF);let Qd,sE=!1;function BC(){return Qd||(Qd=nC(FC))}function NC(){return Qd=sE?Qd:rC(FC),sE=!0,Qd}const h0=(...e)=>{BC().render(...e)},UC=(...e)=>{NC().hydrate(...e)},ac=(...e)=>{const i=BC().createApp(...e),{mount:a}=i;return i.mount=c=>{const d=VC(c);if(!d)return;const f=i._component;!TC(f)&&!f.render&&!f.template&&(f.template=d.innerHTML),d.innerHTML="";const y=a(d,!1,d instanceof SVGElement);return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),y},i},zB=(...e)=>{const i=NC().createApp(...e),{mount:a}=i;return i.mount=c=>{const d=VC(c);if(d)return a(d,!0,d instanceof SVGElement)},i};function VC(e){return Km(e)?document.querySelector(e):e}let oE=!1;const RB=()=>{oE||(oE=!0,CB(),LB())},DB=Object.freeze(Object.defineProperty({__proto__:null,Transition:e_,TransitionGroup:bB,VueElement:Jg,createApp:ac,createSSRApp:zB,defineCustomElement:AC,defineSSRCustomElement:fB,hydrate:UC,initDirectivesForSSR:RB,render:h0,useCssModule:mB,useCssVars:gB,vModelCheckbox:zx,vModelDynamic:DC,vModelRadio:cf,vModelSelect:zC,vModelText:xo,vShow:t_,withKeys:kB,withModifiers:Rx,EffectScope:ux,ReactiveEffect:wf,customRef:cO,effect:LD,effectScope:CD,getCurrentScope:MD,isProxy:mx,isReactive:Zl,isReadonly:Cu,isRef:zn,isShallow:$m,markRaw:gx,onScopeDispose:ID,proxyRefs:vx,reactive:Tf,readonly:px,ref:Gd,shallowReactive:fx,shallowReadonly:rO,shallowRef:yA,stop:zD,toRaw:Di,toRef:xA,toRefs:uO,triggerRef:oO,unref:Xl,camelize:Ws,capitalize:Rg,normalizeClass:$i,normalizeProps:vD,normalizeStyle:bf,toDisplayString:Pi,toHandlerKey:$d,BaseTransition:Ax,Comment:xr,Fragment:dn,KeepAlive:BO,Static:Yl,Suspense:LA,Teleport:uF,Text:Pu,callWithAsyncErrorHandling:os,callWithErrorHandling:yo,cloneVNode:bo,compatUtils:OF,computed:Ts,createBlock:Xg,createCommentVNode:Ri,createElementBlock:Nt,createElementVNode:Fe,createHydrationRenderer:rC,createPropsRestProxy:MF,createRenderer:nC,createSlots:jO,createStaticVNode:qu,createTextVNode:Ir,createVNode:Hi,defineAsyncComponent:FA,defineComponent:Gu,defineEmits:wF,defineExpose:TF,defineProps:bF,get devtools(){return hu},getCurrentInstance:Ga,getTransitionRawChildren:Gg,guardReactiveProps:cC,h:Cf,handleError:oc,initCustomFormatter:kF,inject:vo,isMemoSame:xC,isRuntimeOnly:gF,isVNode:Ua,mergeDefaults:CF,mergeProps:uC,nextTick:Ug,onActivated:BA,onBeforeMount:VA,onBeforeUnmount:Hg,onBeforeUpdate:$A,onDeactivated:NA,onErrorCaptured:WA,onMounted:Af,onRenderTracked:qA,onRenderTriggered:GA,onServerPrefetch:jA,onUnmounted:Zg,onUpdated:Wg,openBlock:Ft,popScopeId:PA,provide:Zd,pushScopeId:IA,queuePostFlushCb:wx,registerRuntimeCompiler:pC,renderList:Wo,renderSlot:GO,resolveComponent:Xd,resolveDirective:$O,resolveDynamicComponent:VO,resolveFilter:DF,resolveTransitionHooks:Iu,setBlockTracking:r0,setDevtoolsHook:CA,setTransitionHooks:ec,ssrContextKey:vC,ssrUtils:RF,toHandlers:qO,transformVNodeArgs:hF,useAttrs:AF,useSSRContext:PF,useSlots:SF,useTransitionState:Sx,version:bC,warn:bA,watch:yu,watchEffect:zO,watchPostEffect:RA,watchSyncEffect:RO,withAsyncContext:IF,withCtx:Mu,withDefaults:EF,withDirectives:Vs,withMemo:LF,withScopeId:TO},Symbol.toStringTag,{value:"Module"}));/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const du=typeof window<"u";function OB(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Ji=Object.assign;function lv(e,i){const a={};for(const c in i){const d=i[c];a[c]=Hs(d)?d.map(e):e(d)}return a}const Jd=()=>{},Hs=Array.isArray,FB=/\/$/,BB=e=>e.replace(FB,"");function cv(e,i,a="/"){let c,d={},f="",y="";const s=i.indexOf("#");let w=i.indexOf("?");return s<w&&s>=0&&(w=-1),w>-1&&(c=i.slice(0,w),f=i.slice(w+1,s>-1?s:i.length),d=e(f)),s>-1&&(c=c||i.slice(0,s),y=i.slice(s,i.length)),c=$B(c!=null?c:i,a),{fullPath:c+(f&&"?")+f+y,path:c,query:d,hash:y}}function NB(e,i){const a=i.query?e(i.query):"";return i.path+(a&&"?")+a+(i.hash||"")}function aE(e,i){return!i||!e.toLowerCase().startsWith(i.toLowerCase())?e:e.slice(i.length)||"/"}function UB(e,i,a){const c=i.matched.length-1,d=a.matched.length-1;return c>-1&&c===d&&Ru(i.matched[c],a.matched[d])&&$C(i.params,a.params)&&e(i.query)===e(a.query)&&i.hash===a.hash}function Ru(e,i){return(e.aliasOf||e)===(i.aliasOf||i)}function $C(e,i){if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const a in e)if(!VB(e[a],i[a]))return!1;return!0}function VB(e,i){return Hs(e)?lE(e,i):Hs(i)?lE(i,e):e===i}function lE(e,i){return Hs(i)?e.length===i.length&&e.every((a,c)=>a===i[c]):e.length===1&&e[0]===i}function $B(e,i){if(e.startsWith("/"))return e;if(!e)return i;const a=i.split("/"),c=e.split("/"),d=c[c.length-1];(d===".."||d===".")&&c.push("");let f=a.length-1,y,s;for(y=0;y<c.length;y++)if(s=c[y],s!==".")if(s==="..")f>1&&f--;else break;return a.slice(0,f).join("/")+"/"+c.slice(y-(y===c.length?1:0)).join("/")}var uf;(function(e){e.pop="pop",e.push="push"})(uf||(uf={}));var ef;(function(e){e.back="back",e.forward="forward",e.unknown=""})(ef||(ef={}));function jB(e){if(!e)if(du){const i=document.querySelector("base");e=i&&i.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),BB(e)}const GB=/^[^#]+#/;function qB(e,i){return e.replace(GB,"#")+i}function WB(e,i){const a=document.documentElement.getBoundingClientRect(),c=e.getBoundingClientRect();return{behavior:i.behavior,left:c.left-a.left-(i.left||0),top:c.top-a.top-(i.top||0)}}const i_=()=>({left:window.pageXOffset,top:window.pageYOffset});function HB(e){let i;if("el"in e){const a=e.el,c=typeof a=="string"&&a.startsWith("#"),d=typeof a=="string"?c?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!d)return;i=WB(d,e)}else i=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(i):window.scrollTo(i.left!=null?i.left:window.pageXOffset,i.top!=null?i.top:window.pageYOffset)}function cE(e,i){return(history.state?history.state.position-i:-1)+e}const d0=new Map;function ZB(e,i){d0.set(e,i)}function XB(e){const i=d0.get(e);return d0.delete(e),i}let KB=()=>location.protocol+"//"+location.host;function jC(e,i){const{pathname:a,search:c,hash:d}=i,f=e.indexOf("#");if(f>-1){let s=d.includes(e.slice(f))?e.slice(f).length:1,w=d.slice(s);return w[0]!=="/"&&(w="/"+w),aE(w,"")}return aE(a,e)+c+d}function YB(e,i,a,c){let d=[],f=[],y=null;const s=({state:R})=>{const V=jC(e,location),H=a.value,J=i.value;let ue=0;if(R){if(a.value=V,i.value=R,y&&y===H){y=null;return}ue=J?R.position-J.position:0}else c(V);d.forEach(j=>{j(a.value,H,{delta:ue,type:uf.pop,direction:ue?ue>0?ef.forward:ef.back:ef.unknown})})};function w(){y=a.value}function C(R){d.push(R);const V=()=>{const H=d.indexOf(R);H>-1&&d.splice(H,1)};return f.push(V),V}function L(){const{history:R}=window;!R.state||R.replaceState(Ji({},R.state,{scroll:i_()}),"")}function k(){for(const R of f)R();f=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",L)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",L,{passive:!0}),{pauseListeners:w,listen:C,destroy:k}}function uE(e,i,a,c=!1,d=!1){return{back:e,current:i,forward:a,replaced:c,position:window.history.length,scroll:d?i_():null}}function QB(e){const{history:i,location:a}=window,c={value:jC(e,a)},d={value:i.state};d.value||f(c.value,{back:null,current:c.value,forward:null,position:i.length-1,replaced:!0,scroll:null},!0);function f(w,C,L){const k=e.indexOf("#"),R=k>-1?(a.host&&document.querySelector("base")?e:e.slice(k))+w:KB()+e+w;try{i[L?"replaceState":"pushState"](C,"",R),d.value=C}catch(V){console.error(V),a[L?"replace":"assign"](R)}}function y(w,C){const L=Ji({},i.state,uE(d.value.back,w,d.value.forward,!0),C,{position:d.value.position});f(w,L,!0),c.value=w}function s(w,C){const L=Ji({},d.value,i.state,{forward:w,scroll:i_()});f(L.current,L,!0);const k=Ji({},uE(c.value,w,null),{position:L.position+1},C);f(w,k,!1),c.value=w}return{location:c,state:d,push:s,replace:y}}function JB(e){e=jB(e);const i=QB(e),a=YB(e,i.state,i.location,i.replace);function c(f,y=!0){y||a.pauseListeners(),history.go(f)}const d=Ji({location:"",base:e,go:c,createHref:qB.bind(null,e)},i,a);return Object.defineProperty(d,"location",{enumerable:!0,get:()=>i.location.value}),Object.defineProperty(d,"state",{enumerable:!0,get:()=>i.state.value}),d}function e3(e){return typeof e=="string"||e&&typeof e=="object"}function GC(e){return typeof e=="string"||typeof e=="symbol"}const Ca={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},qC=Symbol("");var hE;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(hE||(hE={}));function Du(e,i){return Ji(new Error,{type:e,[qC]:!0},i)}function $o(e,i){return e instanceof Error&&qC in e&&(i==null||!!(e.type&i))}const dE="[^/]+?",t3={sensitive:!1,strict:!1,start:!0,end:!0},i3=/[.+*?^${}()[\]/\\]/g;function n3(e,i){const a=Ji({},t3,i),c=[];let d=a.start?"^":"";const f=[];for(const C of e){const L=C.length?[]:[90];a.strict&&!C.length&&(d+="/");for(let k=0;k<C.length;k++){const R=C[k];let V=40+(a.sensitive?.25:0);if(R.type===0)k||(d+="/"),d+=R.value.replace(i3,"\\$&"),V+=40;else if(R.type===1){const{value:H,repeatable:J,optional:ue,regexp:j}=R;f.push({name:H,repeatable:J,optional:ue});const q=j||dE;if(q!==dE){V+=10;try{new RegExp(`(${q})`)}catch(ge){throw new Error(`Invalid custom RegExp for param "${H}" (${q}): `+ge.message)}}let se=J?`((?:${q})(?:/(?:${q}))*)`:`(${q})`;k||(se=ue&&C.length<2?`(?:/${se})`:"/"+se),ue&&(se+="?"),d+=se,V+=20,ue&&(V+=-8),J&&(V+=-20),q===".*"&&(V+=-50)}L.push(V)}c.push(L)}if(a.strict&&a.end){const C=c.length-1;c[C][c[C].length-1]+=.7000000000000001}a.strict||(d+="/?"),a.end?d+="$":a.strict&&(d+="(?:/|$)");const y=new RegExp(d,a.sensitive?"":"i");function s(C){const L=C.match(y),k={};if(!L)return null;for(let R=1;R<L.length;R++){const V=L[R]||"",H=f[R-1];k[H.name]=V&&H.repeatable?V.split("/"):V}return k}function w(C){let L="",k=!1;for(const R of e){(!k||!L.endsWith("/"))&&(L+="/"),k=!1;for(const V of R)if(V.type===0)L+=V.value;else if(V.type===1){const{value:H,repeatable:J,optional:ue}=V,j=H in C?C[H]:"";if(Hs(j)&&!J)throw new Error(`Provided param "${H}" is an array but it is not repeatable (* or + modifiers)`);const q=Hs(j)?j.join("/"):j;if(!q)if(ue)R.length<2&&(L.endsWith("/")?L=L.slice(0,-1):k=!0);else throw new Error(`Missing required param "${H}"`);L+=q}}return L||"/"}return{re:y,score:c,keys:f,parse:s,stringify:w}}function r3(e,i){let a=0;for(;a<e.length&&a<i.length;){const c=i[a]-e[a];if(c)return c;a++}return e.length<i.length?e.length===1&&e[0]===40+40?-1:1:e.length>i.length?i.length===1&&i[0]===40+40?1:-1:0}function s3(e,i){let a=0;const c=e.score,d=i.score;for(;a<c.length&&a<d.length;){const f=r3(c[a],d[a]);if(f)return f;a++}if(Math.abs(d.length-c.length)===1){if(fE(c))return 1;if(fE(d))return-1}return d.length-c.length}function fE(e){const i=e[e.length-1];return e.length>0&&i[i.length-1]<0}const o3={type:0,value:""},a3=/[a-zA-Z0-9_]/;function l3(e){if(!e)return[[]];if(e==="/")return[[o3]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function i(V){throw new Error(`ERR (${a})/"${C}": ${V}`)}let a=0,c=a;const d=[];let f;function y(){f&&d.push(f),f=[]}let s=0,w,C="",L="";function k(){!C||(a===0?f.push({type:0,value:C}):a===1||a===2||a===3?(f.length>1&&(w==="*"||w==="+")&&i(`A repeatable param (${C}) must be alone in its segment. eg: '/:ids+.`),f.push({type:1,value:C,regexp:L,repeatable:w==="*"||w==="+",optional:w==="*"||w==="?"})):i("Invalid state to consume buffer"),C="")}function R(){C+=w}for(;s<e.length;){if(w=e[s++],w==="\\"&&a!==2){c=a,a=4;continue}switch(a){case 0:w==="/"?(C&&k(),y()):w===":"?(k(),a=1):R();break;case 4:R(),a=c;break;case 1:w==="("?a=2:a3.test(w)?R():(k(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&s--);break;case 2:w===")"?L[L.length-1]=="\\"?L=L.slice(0,-1)+w:a=3:L+=w;break;case 3:k(),a=0,w!=="*"&&w!=="?"&&w!=="+"&&s--,L="";break;default:i("Unknown state");break}}return a===2&&i(`Unfinished custom RegExp for param "${C}"`),k(),y(),d}function c3(e,i,a){const c=n3(l3(e.path),a),d=Ji(c,{record:e,parent:i,children:[],alias:[]});return i&&!d.record.aliasOf==!i.record.aliasOf&&i.children.push(d),d}function u3(e,i){const a=[],c=new Map;i=gE({strict:!1,end:!0,sensitive:!1},i);function d(L){return c.get(L)}function f(L,k,R){const V=!R,H=h3(L);H.aliasOf=R&&R.record;const J=gE(i,L),ue=[H];if("alias"in L){const se=typeof L.alias=="string"?[L.alias]:L.alias;for(const ge of se)ue.push(Ji({},H,{components:R?R.record.components:H.components,path:ge,aliasOf:R?R.record:H}))}let j,q;for(const se of ue){const{path:ge}=se;if(k&&ge[0]!=="/"){const ie=k.record.path,Ie=ie[ie.length-1]==="/"?"":"/";se.path=k.record.path+(ge&&Ie+ge)}if(j=c3(se,k,J),R?R.alias.push(j):(q=q||j,q!==j&&q.alias.push(j),V&&L.name&&!mE(j)&&y(L.name)),H.children){const ie=H.children;for(let Ie=0;Ie<ie.length;Ie++)f(ie[Ie],j,R&&R.children[Ie])}R=R||j,(j.record.components&&Object.keys(j.record.components).length||j.record.name||j.record.redirect)&&w(j)}return q?()=>{y(q)}:Jd}function y(L){if(GC(L)){const k=c.get(L);k&&(c.delete(L),a.splice(a.indexOf(k),1),k.children.forEach(y),k.alias.forEach(y))}else{const k=a.indexOf(L);k>-1&&(a.splice(k,1),L.record.name&&c.delete(L.record.name),L.children.forEach(y),L.alias.forEach(y))}}function s(){return a}function w(L){let k=0;for(;k<a.length&&s3(L,a[k])>=0&&(L.record.path!==a[k].record.path||!WC(L,a[k]));)k++;a.splice(k,0,L),L.record.name&&!mE(L)&&c.set(L.record.name,L)}function C(L,k){let R,V={},H,J;if("name"in L&&L.name){if(R=c.get(L.name),!R)throw Du(1,{location:L});J=R.record.name,V=Ji(pE(k.params,R.keys.filter(q=>!q.optional).map(q=>q.name)),L.params&&pE(L.params,R.keys.map(q=>q.name))),H=R.stringify(V)}else if("path"in L)H=L.path,R=a.find(q=>q.re.test(H)),R&&(V=R.parse(H),J=R.record.name);else{if(R=k.name?c.get(k.name):a.find(q=>q.re.test(k.path)),!R)throw Du(1,{location:L,currentLocation:k});J=R.record.name,V=Ji({},k.params,L.params),H=R.stringify(V)}const ue=[];let j=R;for(;j;)ue.unshift(j.record),j=j.parent;return{name:J,path:H,params:V,matched:ue,meta:f3(ue)}}return e.forEach(L=>f(L)),{addRoute:f,resolve:C,removeRoute:y,getRoutes:s,getRecordMatcher:d}}function pE(e,i){const a={};for(const c of i)c in e&&(a[c]=e[c]);return a}function h3(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:d3(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function d3(e){const i={},a=e.props||!1;if("component"in e)i.default=a;else for(const c in e.components)i[c]=typeof a=="object"?a[c]:a;return i}function mE(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function f3(e){return e.reduce((i,a)=>Ji(i,a.meta),{})}function gE(e,i){const a={};for(const c in e)a[c]=c in i?i[c]:e[c];return a}function WC(e,i){return i.children.some(a=>a===e||WC(e,a))}const HC=/#/g,p3=/&/g,m3=/\//g,g3=/=/g,_3=/\?/g,ZC=/\+/g,y3=/%5B/g,v3=/%5D/g,XC=/%5E/g,x3=/%60/g,KC=/%7B/g,b3=/%7C/g,YC=/%7D/g,w3=/%20/g;function Dx(e){return encodeURI(""+e).replace(b3,"|").replace(y3,"[").replace(v3,"]")}function T3(e){return Dx(e).replace(KC,"{").replace(YC,"}").replace(XC,"^")}function f0(e){return Dx(e).replace(ZC,"%2B").replace(w3,"+").replace(HC,"%23").replace(p3,"%26").replace(x3,"`").replace(KC,"{").replace(YC,"}").replace(XC,"^")}function E3(e){return f0(e).replace(g3,"%3D")}function S3(e){return Dx(e).replace(HC,"%23").replace(_3,"%3F")}function A3(e){return e==null?"":S3(e).replace(m3,"%2F")}function Ym(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function C3(e){const i={};if(e===""||e==="?")return i;const c=(e[0]==="?"?e.slice(1):e).split("&");for(let d=0;d<c.length;++d){const f=c[d].replace(ZC," "),y=f.indexOf("="),s=Ym(y<0?f:f.slice(0,y)),w=y<0?null:Ym(f.slice(y+1));if(s in i){let C=i[s];Hs(C)||(C=i[s]=[C]),C.push(w)}else i[s]=w}return i}function _E(e){let i="";for(let a in e){const c=e[a];if(a=E3(a),c==null){c!==void 0&&(i+=(i.length?"&":"")+a);continue}(Hs(c)?c.map(f=>f&&f0(f)):[c&&f0(c)]).forEach(f=>{f!==void 0&&(i+=(i.length?"&":"")+a,f!=null&&(i+="="+f))})}return i}function M3(e){const i={};for(const a in e){const c=e[a];c!==void 0&&(i[a]=Hs(c)?c.map(d=>d==null?null:""+d):c==null?c:""+c)}return i}const I3=Symbol(""),yE=Symbol(""),Ox=Symbol(""),QC=Symbol(""),p0=Symbol("");function Ad(){let e=[];function i(c){return e.push(c),()=>{const d=e.indexOf(c);d>-1&&e.splice(d,1)}}function a(){e=[]}return{add:i,list:()=>e.slice(),reset:a}}function La(e,i,a,c,d){const f=c&&(c.enterCallbacks[d]=c.enterCallbacks[d]||[]);return()=>new Promise((y,s)=>{const w=k=>{k===!1?s(Du(4,{from:a,to:i})):k instanceof Error?s(k):e3(k)?s(Du(2,{from:i,to:k})):(f&&c.enterCallbacks[d]===f&&typeof k=="function"&&f.push(k),y())},C=e.call(c&&c.instances[d],i,a,w);let L=Promise.resolve(C);e.length<3&&(L=L.then(w)),L.catch(k=>s(k))})}function uv(e,i,a,c){const d=[];for(const f of e)for(const y in f.components){let s=f.components[y];if(!(i!=="beforeRouteEnter"&&!f.instances[y]))if(P3(s)){const C=(s.__vccOpts||s)[i];C&&d.push(La(C,a,c,f,y))}else{let w=s();d.push(()=>w.then(C=>{if(!C)return Promise.reject(new Error(`Couldn't resolve component "${y}" at "${f.path}"`));const L=OB(C)?C.default:C;f.components[y]=L;const R=(L.__vccOpts||L)[i];return R&&La(R,a,c,f,y)()}))}}return d}function P3(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function vE(e){const i=vo(Ox),a=vo(QC),c=Ts(()=>i.resolve(Xl(e.to))),d=Ts(()=>{const{matched:w}=c.value,{length:C}=w,L=w[C-1],k=a.matched;if(!L||!k.length)return-1;const R=k.findIndex(Ru.bind(null,L));if(R>-1)return R;const V=xE(w[C-2]);return C>1&&xE(L)===V&&k[k.length-1].path!==V?k.findIndex(Ru.bind(null,w[C-2])):R}),f=Ts(()=>d.value>-1&&R3(a.params,c.value.params)),y=Ts(()=>d.value>-1&&d.value===a.matched.length-1&&$C(a.params,c.value.params));function s(w={}){return z3(w)?i[Xl(e.replace)?"replace":"push"](Xl(e.to)).catch(Jd):Promise.resolve()}return{route:c,href:Ts(()=>c.value.href),isActive:f,isExactActive:y,navigate:s}}const k3=Gu({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:vE,setup(e,{slots:i}){const a=Tf(vE(e)),{options:c}=vo(Ox),d=Ts(()=>({[bE(e.activeClass,c.linkActiveClass,"router-link-active")]:a.isActive,[bE(e.exactActiveClass,c.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const f=i.default&&i.default(a);return e.custom?f:Cf("a",{"aria-current":a.isExactActive?e.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:d.value},f)}}}),L3=k3;function z3(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const i=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(i))return}return e.preventDefault&&e.preventDefault(),!0}}function R3(e,i){for(const a in i){const c=i[a],d=e[a];if(typeof c=="string"){if(c!==d)return!1}else if(!Hs(d)||d.length!==c.length||c.some((f,y)=>f!==d[y]))return!1}return!0}function xE(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const bE=(e,i,a)=>e!=null?e:i!=null?i:a,D3=Gu({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:i,slots:a}){const c=vo(p0),d=Ts(()=>e.route||c.value),f=vo(yE,0),y=Ts(()=>{let C=Xl(f);const{matched:L}=d.value;let k;for(;(k=L[C])&&!k.components;)C++;return C}),s=Ts(()=>d.value.matched[y.value]);Zd(yE,Ts(()=>y.value+1)),Zd(I3,s),Zd(p0,d);const w=Gd();return yu(()=>[w.value,s.value,e.name],([C,L,k],[R,V,H])=>{L&&(L.instances[k]=C,V&&V!==L&&C&&C===R&&(L.leaveGuards.size||(L.leaveGuards=V.leaveGuards),L.updateGuards.size||(L.updateGuards=V.updateGuards))),C&&L&&(!V||!Ru(L,V)||!R)&&(L.enterCallbacks[k]||[]).forEach(J=>J(C))},{flush:"post"}),()=>{const C=d.value,L=e.name,k=s.value,R=k&&k.components[L];if(!R)return wE(a.default,{Component:R,route:C});const V=k.props[L],H=V?V===!0?C.params:typeof V=="function"?V(C):V:null,ue=Cf(R,Ji({},H,i,{onVnodeUnmounted:j=>{j.component.isUnmounted&&(k.instances[L]=null)},ref:w}));return wE(a.default,{Component:ue,route:C})||ue}}});function wE(e,i){if(!e)return null;const a=e(i);return a.length===1?a[0]:a}const O3=D3;function F3(e){const i=u3(e.routes,e),a=e.parseQuery||C3,c=e.stringifyQuery||_E,d=e.history,f=Ad(),y=Ad(),s=Ad(),w=yA(Ca);let C=Ca;du&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const L=lv.bind(null,Ke=>""+Ke),k=lv.bind(null,A3),R=lv.bind(null,Ym);function V(Ke,Pt){let Mt,Lt;return GC(Ke)?(Mt=i.getRecordMatcher(Ke),Lt=Pt):Lt=Ke,i.addRoute(Lt,Mt)}function H(Ke){const Pt=i.getRecordMatcher(Ke);Pt&&i.removeRoute(Pt)}function J(){return i.getRoutes().map(Ke=>Ke.record)}function ue(Ke){return!!i.getRecordMatcher(Ke)}function j(Ke,Pt){if(Pt=Ji({},Pt||w.value),typeof Ke=="string"){const de=cv(a,Ke,Pt.path),Ne=i.resolve({path:de.path},Pt),at=d.createHref(de.fullPath);return Ji(de,Ne,{params:R(Ne.params),hash:Ym(de.hash),redirectedFrom:void 0,href:at})}let Mt;if("path"in Ke)Mt=Ji({},Ke,{path:cv(a,Ke.path,Pt.path).path});else{const de=Ji({},Ke.params);for(const Ne in de)de[Ne]==null&&delete de[Ne];Mt=Ji({},Ke,{params:k(de)}),Pt.params=k(Pt.params)}const Lt=i.resolve(Mt,Pt),li=Ke.hash||"";Lt.params=L(R(Lt.params));const Ai=NB(c,Ji({},Ke,{hash:T3(li),path:Lt.path})),he=d.createHref(Ai);return Ji({fullPath:Ai,hash:li,query:c===_E?M3(Ke.query):Ke.query||{}},Lt,{redirectedFrom:void 0,href:he})}function q(Ke){return typeof Ke=="string"?cv(a,Ke,w.value.path):Ji({},Ke)}function se(Ke,Pt){if(C!==Ke)return Du(8,{from:Pt,to:Ke})}function ge(Ke){return ze(Ke)}function ie(Ke){return ge(Ji(q(Ke),{replace:!0}))}function Ie(Ke){const Pt=Ke.matched[Ke.matched.length-1];if(Pt&&Pt.redirect){const{redirect:Mt}=Pt;let Lt=typeof Mt=="function"?Mt(Ke):Mt;return typeof Lt=="string"&&(Lt=Lt.includes("?")||Lt.includes("#")?Lt=q(Lt):{path:Lt},Lt.params={}),Ji({query:Ke.query,hash:Ke.hash,params:"path"in Lt?{}:Ke.params},Lt)}}function ze(Ke,Pt){const Mt=C=j(Ke),Lt=w.value,li=Ke.state,Ai=Ke.force,he=Ke.replace===!0,de=Ie(Mt);if(de)return ze(Ji(q(de),{state:typeof de=="object"?Ji({},li,de.state):li,force:Ai,replace:he}),Pt||Mt);const Ne=Mt;Ne.redirectedFrom=Pt;let at;return!Ai&&UB(c,Lt,Mt)&&(at=Du(16,{to:Ne,from:Lt}),Mi(Lt,Lt,!0,!1)),(at?Promise.resolve(at):Ce(Ne,Lt)).catch(Ye=>$o(Ye)?$o(Ye,2)?Ye:tn(Ye):Yt(Ye,Ne,Lt)).then(Ye=>{if(Ye){if($o(Ye,2))return ze(Ji({replace:he},q(Ye.to),{state:typeof Ye.to=="object"?Ji({},li,Ye.to.state):li,force:Ai}),Pt||Ne)}else Ye=De(Ne,Lt,!0,he,li);return Ge(Ne,Lt,Ye),Ye})}function Ae(Ke,Pt){const Mt=se(Ke,Pt);return Mt?Promise.reject(Mt):Promise.resolve()}function He(Ke){const Pt=fn.values().next().value;return Pt&&typeof Pt.runWithContext=="function"?Pt.runWithContext(Ke):Ke()}function Ce(Ke,Pt){let Mt;const[Lt,li,Ai]=B3(Ke,Pt);Mt=uv(Lt.reverse(),"beforeRouteLeave",Ke,Pt);for(const de of Lt)de.leaveGuards.forEach(Ne=>{Mt.push(La(Ne,Ke,Pt))});const he=Ae.bind(null,Ke,Pt);return Mt.push(he),xn(Mt).then(()=>{Mt=[];for(const de of f.list())Mt.push(La(de,Ke,Pt));return Mt.push(he),xn(Mt)}).then(()=>{Mt=uv(li,"beforeRouteUpdate",Ke,Pt);for(const de of li)de.updateGuards.forEach(Ne=>{Mt.push(La(Ne,Ke,Pt))});return Mt.push(he),xn(Mt)}).then(()=>{Mt=[];for(const de of Ai)if(de.beforeEnter)if(Hs(de.beforeEnter))for(const Ne of de.beforeEnter)Mt.push(La(Ne,Ke,Pt));else Mt.push(La(de.beforeEnter,Ke,Pt));return Mt.push(he),xn(Mt)}).then(()=>(Ke.matched.forEach(de=>de.enterCallbacks={}),Mt=uv(Ai,"beforeRouteEnter",Ke,Pt),Mt.push(he),xn(Mt))).then(()=>{Mt=[];for(const de of y.list())Mt.push(La(de,Ke,Pt));return Mt.push(he),xn(Mt)}).catch(de=>$o(de,8)?de:Promise.reject(de))}function Ge(Ke,Pt,Mt){s.list().forEach(Lt=>He(()=>Lt(Ke,Pt,Mt)))}function De(Ke,Pt,Mt,Lt,li){const Ai=se(Ke,Pt);if(Ai)return Ai;const he=Pt===Ca,de=du?history.state:{};Mt&&(Lt||he?d.replace(Ke.fullPath,Ji({scroll:he&&de&&de.scroll},li)):d.push(Ke.fullPath,li)),w.value=Ke,Mi(Ke,Pt,Mt,he),tn()}let We;function et(){We||(We=d.listen((Ke,Pt,Mt)=>{if(!gn.listening)return;const Lt=j(Ke),li=Ie(Lt);if(li){ze(Ji(li,{replace:!0}),Lt).catch(Jd);return}C=Lt;const Ai=w.value;du&&ZB(cE(Ai.fullPath,Mt.delta),i_()),Ce(Lt,Ai).catch(he=>$o(he,12)?he:$o(he,2)?(ze(he.to,Lt).then(de=>{$o(de,20)&&!Mt.delta&&Mt.type===uf.pop&&d.go(-1,!1)}).catch(Jd),Promise.reject()):(Mt.delta&&d.go(-Mt.delta,!1),Yt(he,Lt,Ai))).then(he=>{he=he||De(Lt,Ai,!1),he&&(Mt.delta&&!$o(he,8)?d.go(-Mt.delta,!1):Mt.type===uf.pop&&$o(he,20)&&d.go(-1,!1)),Ge(Lt,Ai,he)}).catch(Jd)}))}let Gt=Ad(),Vt=Ad(),fi;function Yt(Ke,Pt,Mt){tn(Ke);const Lt=Vt.list();return Lt.length?Lt.forEach(li=>li(Ke,Pt,Mt)):console.error(Ke),Promise.reject(Ke)}function _i(){return fi&&w.value!==Ca?Promise.resolve():new Promise((Ke,Pt)=>{Gt.add([Ke,Pt])})}function tn(Ke){return fi||(fi=!Ke,et(),Gt.list().forEach(([Pt,Mt])=>Ke?Mt(Ke):Pt()),Gt.reset()),Ke}function Mi(Ke,Pt,Mt,Lt){const{scrollBehavior:li}=e;if(!du||!li)return Promise.resolve();const Ai=!Mt&&XB(cE(Ke.fullPath,0))||(Lt||!Mt)&&history.state&&history.state.scroll||null;return Ug().then(()=>li(Ke,Pt,Ai)).then(he=>he&&HB(he)).catch(he=>Yt(he,Ke,Pt))}const yi=Ke=>d.go(Ke);let Kt;const fn=new Set,gn={currentRoute:w,listening:!0,addRoute:V,removeRoute:H,hasRoute:ue,getRoutes:J,resolve:j,options:e,push:ge,replace:ie,go:yi,back:()=>yi(-1),forward:()=>yi(1),beforeEach:f.add,beforeResolve:y.add,afterEach:s.add,onError:Vt.add,isReady:_i,install(Ke){const Pt=this;Ke.component("RouterLink",L3),Ke.component("RouterView",O3),Ke.config.globalProperties.$router=Pt,Object.defineProperty(Ke.config.globalProperties,"$route",{enumerable:!0,get:()=>Xl(w)}),du&&!Kt&&w.value===Ca&&(Kt=!0,ge(d.location).catch(li=>{}));const Mt={};for(const li in Ca)Object.defineProperty(Mt,li,{get:()=>w.value[li],enumerable:!0});Ke.provide(Ox,Pt),Ke.provide(QC,fx(Mt)),Ke.provide(p0,w);const Lt=Ke.unmount;fn.add(Ke),Ke.unmount=function(){fn.delete(Ke),fn.size<1&&(C=Ca,We&&We(),We=null,w.value=Ca,Kt=!1,fi=!1),Lt()}}};function xn(Ke){return Ke.reduce((Pt,Mt)=>Pt.then(()=>He(Mt)),Promise.resolve())}return gn}function B3(e,i){const a=[],c=[],d=[],f=Math.max(i.matched.length,e.matched.length);for(let y=0;y<f;y++){const s=i.matched[y];s&&(e.matched.find(C=>Ru(C,s))?c.push(s):a.push(s));const w=e.matched[y];w&&(i.matched.find(C=>Ru(C,w))||d.push(w))}return[a,c,d]}var Fx={},Bx={};(function(e){const i=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",a=i+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",c="["+i+"]["+a+"]*",d=new RegExp("^"+c+"$"),f=function(s,w){const C=[];let L=w.exec(s);for(;L;){const k=[];k.startIndex=w.lastIndex-L[0].length;const R=L.length;for(let V=0;V<R;V++)k.push(L[V]);C.push(k),L=w.exec(s)}return C},y=function(s){const w=d.exec(s);return!(w===null||typeof w>"u")};e.isExist=function(s){return typeof s<"u"},e.isEmptyObject=function(s){return Object.keys(s).length===0},e.merge=function(s,w,C){if(w){const L=Object.keys(w),k=L.length;for(let R=0;R<k;R++)C==="strict"?s[L[R]]=[w[L[R]]]:s[L[R]]=w[L[R]]}},e.getValue=function(s){return e.isExist(s)?s:""},e.isName=y,e.getAllMatches=f,e.nameRegexp=c})(Bx);const Nx=Bx,N3={allowBooleanAttributes:!1,unpairedTags:[]};Fx.validate=function(e,i){i=Object.assign({},N3,i);const a=[];let c=!1,d=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let f=0;f<e.length;f++)if(e[f]==="<"&&e[f+1]==="?"){if(f+=2,f=EE(e,f),f.err)return f}else if(e[f]==="<"){let y=f;if(f++,e[f]==="!"){f=SE(e,f);continue}else{let s=!1;e[f]==="/"&&(s=!0,f++);let w="";for(;f<e.length&&e[f]!==">"&&e[f]!==" "&&e[f]!=="	"&&e[f]!==`
`&&e[f]!=="\r";f++)w+=e[f];if(w=w.trim(),w[w.length-1]==="/"&&(w=w.substring(0,w.length-1),f--),!H3(w)){let k;return w.trim().length===0?k="Invalid space after '<'.":k="Tag '"+w+"' is an invalid name.",kn("InvalidTag",k,Br(e,f))}const C=$3(e,f);if(C===!1)return kn("InvalidAttr","Attributes for '"+w+"' have open quote.",Br(e,f));let L=C.value;if(f=C.index,L[L.length-1]==="/"){const k=f-L.length;L=L.substring(0,L.length-1);const R=AE(L,i);if(R===!0)c=!0;else return kn(R.err.code,R.err.msg,Br(e,k+R.err.line))}else if(s)if(C.tagClosed){if(L.trim().length>0)return kn("InvalidTag","Closing tag '"+w+"' can't have attributes or invalid starting.",Br(e,y));{const k=a.pop();if(w!==k.tagName){let R=Br(e,k.tagStartPos);return kn("InvalidTag","Expected closing tag '"+k.tagName+"' (opened in line "+R.line+", col "+R.col+") instead of closing tag '"+w+"'.",Br(e,y))}a.length==0&&(d=!0)}}else return kn("InvalidTag","Closing tag '"+w+"' doesn't have proper closing.",Br(e,f));else{const k=AE(L,i);if(k!==!0)return kn(k.err.code,k.err.msg,Br(e,f-L.length+k.err.line));if(d===!0)return kn("InvalidXml","Multiple possible root nodes found.",Br(e,f));i.unpairedTags.indexOf(w)!==-1||a.push({tagName:w,tagStartPos:y}),c=!0}for(f++;f<e.length;f++)if(e[f]==="<")if(e[f+1]==="!"){f++,f=SE(e,f);continue}else if(e[f+1]==="?"){if(f=EE(e,++f),f.err)return f}else break;else if(e[f]==="&"){const k=q3(e,f);if(k==-1)return kn("InvalidChar","char '&' is not expected.",Br(e,f));f=k}else if(d===!0&&!TE(e[f]))return kn("InvalidXml","Extra text at the end",Br(e,f));e[f]==="<"&&f--}}else{if(TE(e[f]))continue;return kn("InvalidChar","char '"+e[f]+"' is not expected.",Br(e,f))}if(c){if(a.length==1)return kn("InvalidTag","Unclosed tag '"+a[0].tagName+"'.",Br(e,a[0].tagStartPos));if(a.length>0)return kn("InvalidXml","Invalid '"+JSON.stringify(a.map(f=>f.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return kn("InvalidXml","Start tag expected.",1);return!0};function TE(e){return e===" "||e==="	"||e===`
`||e==="\r"}function EE(e,i){const a=i;for(;i<e.length;i++)if(e[i]=="?"||e[i]==" "){const c=e.substr(a,i-a);if(i>5&&c==="xml")return kn("InvalidXml","XML declaration allowed only at the start of the document.",Br(e,i));if(e[i]=="?"&&e[i+1]==">"){i++;break}else continue}return i}function SE(e,i){if(e.length>i+5&&e[i+1]==="-"&&e[i+2]==="-"){for(i+=3;i<e.length;i++)if(e[i]==="-"&&e[i+1]==="-"&&e[i+2]===">"){i+=2;break}}else if(e.length>i+8&&e[i+1]==="D"&&e[i+2]==="O"&&e[i+3]==="C"&&e[i+4]==="T"&&e[i+5]==="Y"&&e[i+6]==="P"&&e[i+7]==="E"){let a=1;for(i+=8;i<e.length;i++)if(e[i]==="<")a++;else if(e[i]===">"&&(a--,a===0))break}else if(e.length>i+9&&e[i+1]==="["&&e[i+2]==="C"&&e[i+3]==="D"&&e[i+4]==="A"&&e[i+5]==="T"&&e[i+6]==="A"&&e[i+7]==="["){for(i+=8;i<e.length;i++)if(e[i]==="]"&&e[i+1]==="]"&&e[i+2]===">"){i+=2;break}}return i}const U3='"',V3="'";function $3(e,i){let a="",c="",d=!1;for(;i<e.length;i++){if(e[i]===U3||e[i]===V3)c===""?c=e[i]:c!==e[i]||(c="");else if(e[i]===">"&&c===""){d=!0;break}a+=e[i]}return c!==""?!1:{value:a,index:i,tagClosed:d}}const j3=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function AE(e,i){const a=Nx.getAllMatches(e,j3),c={};for(let d=0;d<a.length;d++){if(a[d][1].length===0)return kn("InvalidAttr","Attribute '"+a[d][2]+"' has no space in starting.",Cd(a[d]));if(a[d][3]!==void 0&&a[d][4]===void 0)return kn("InvalidAttr","Attribute '"+a[d][2]+"' is without value.",Cd(a[d]));if(a[d][3]===void 0&&!i.allowBooleanAttributes)return kn("InvalidAttr","boolean attribute '"+a[d][2]+"' is not allowed.",Cd(a[d]));const f=a[d][2];if(!W3(f))return kn("InvalidAttr","Attribute '"+f+"' is an invalid name.",Cd(a[d]));if(!c.hasOwnProperty(f))c[f]=1;else return kn("InvalidAttr","Attribute '"+f+"' is repeated.",Cd(a[d]))}return!0}function G3(e,i){let a=/\d/;for(e[i]==="x"&&(i++,a=/[\da-fA-F]/);i<e.length;i++){if(e[i]===";")return i;if(!e[i].match(a))break}return-1}function q3(e,i){if(i++,e[i]===";")return-1;if(e[i]==="#")return i++,G3(e,i);let a=0;for(;i<e.length;i++,a++)if(!(e[i].match(/\w/)&&a<20)){if(e[i]===";")break;return-1}return i}function kn(e,i,a){return{err:{code:e,msg:i,line:a.line||a,col:a.col}}}function W3(e){return Nx.isName(e)}function H3(e){return Nx.isName(e)}function Br(e,i){const a=e.substring(0,i).split(/\r?\n/);return{line:a.length,col:a[a.length-1].length+1}}function Cd(e){return e.startIndex+e[1].length}var Ux={};const JC={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0},tagValueProcessor:function(e,i){return i},attributeValueProcessor:function(e,i){return i},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1},Z3=function(e){return Object.assign({},JC,e)};Ux.buildOptions=Z3;Ux.defaultOptions=JC;class X3{constructor(i){this.tagname=i,this.child=[],this[":@"]={}}add(i,a){this.child.push({[i]:a})}addChild(i){i[":@"]&&Object.keys(i[":@"]).length>0?this.child.push({[i.tagname]:i.child,[":@"]:i[":@"]}):this.child.push({[i.tagname]:i.child})}}var K3=X3;function Y3(e,i){const a={};if(e[i+3]==="O"&&e[i+4]==="C"&&e[i+5]==="T"&&e[i+6]==="Y"&&e[i+7]==="P"&&e[i+8]==="E"){i=i+9;let c=1,d=!1,f=!1,y=!1,s="";for(;i<e.length;i++)if(e[i]==="<"){if(d&&e[i+1]==="!"&&e[i+2]==="E"&&e[i+3]==="N"&&e[i+4]==="T"&&e[i+5]==="I"&&e[i+6]==="T"&&e[i+7]==="Y")i+=7,f=!0;else if(d&&e[i+1]==="!"&&e[i+2]==="E"&&e[i+3]==="L"&&e[i+4]==="E"&&e[i+5]==="M"&&e[i+6]==="E"&&e[i+7]==="N"&&e[i+8]==="T")i+=8;else if(d&&e[i+1]==="!"&&e[i+2]==="A"&&e[i+3]==="T"&&e[i+4]==="T"&&e[i+5]==="L"&&e[i+6]==="I"&&e[i+7]==="S"&&e[i+8]==="T")i+=8;else if(d&&e[i+1]==="!"&&e[i+2]==="N"&&e[i+3]==="O"&&e[i+4]==="T"&&e[i+5]==="A"&&e[i+6]==="T"&&e[i+7]==="I"&&e[i+8]==="O"&&e[i+9]==="N")i+=9;else if(e[i+1]==="!"&&e[i+2]==="-"&&e[i+3]==="-")y=!0;else throw new Error("Invalid DOCTYPE");c++,s=""}else if(e[i]===">"){if(y)if(e[i-1]==="-"&&e[i-2]==="-")y=!1;else throw new Error("Invalid XML comment in DOCTYPE");else f&&(J3(s,a),f=!1);if(c--,c===0)break}else e[i]==="["?d=!0:s+=e[i];if(c!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:a,i}}const Q3=RegExp(`^\\s([a-zA-z0-0]+)[ 	](['"])([^&]+)\\2`);function J3(e,i){const a=Q3.exec(e);a&&(i[a[1]]={regx:RegExp(`&${a[1]};`,"g"),val:a[3]})}var eN=Y3;const tN=/^[-+]?0x[a-fA-F0-9]+$/,iN=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const nN={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function rN(e,i={}){if(i=Object.assign({},nN,i),!e||typeof e!="string")return e;let a=e.trim();if(i.skipLike!==void 0&&i.skipLike.test(a))return e;if(i.hex&&tN.test(a))return Number.parseInt(a,16);{const c=iN.exec(a);if(c){const d=c[1],f=c[2];let y=sN(c[3]);const s=c[4]||c[6];if(!i.leadingZeros&&f.length>0&&d&&a[2]!==".")return e;if(!i.leadingZeros&&f.length>0&&!d&&a[1]!==".")return e;{const w=Number(a),C=""+w;return C.search(/[eE]/)!==-1||s?i.eNotation?w:e:a.indexOf(".")!==-1?C==="0"&&y===""||C===y||d&&C==="-"+y?w:e:f?y===C||d+y===C?w:e:a===C||a===d+C?w:e}}else return e}}function sN(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}var oN=rN;const Vx=Bx,Md=K3,aN=eN,lN=oN;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,Vx.nameRegexp);class cN{constructor(i){this.options=i,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={amp:{regex:/&(amp|#38|#x26);/g,val:"&"},apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"}},this.addExternalEntities=uN,this.parseXml=mN,this.parseTextData=hN,this.resolveNameSpace=dN,this.buildAttributesMap=pN,this.isItStopNode=yN,this.replaceEntitiesValue=gN,this.readStopNodeData=xN,this.saveTextToParentTag=_N}}function uN(e){const i=Object.keys(e);for(let a=0;a<i.length;a++){const c=i[a];this.lastEntities[c]={regex:new RegExp("&"+c+";","g"),val:e[c]}}}function hN(e,i,a,c,d,f,y){if(e!==void 0&&(this.options.trimValues&&!c&&(e=e.trim()),e.length>0)){y||(e=this.replaceEntitiesValue(e));const s=this.options.tagValueProcessor(i,e,a,d,f);return s==null?e:typeof s!=typeof e||s!==e?s:this.options.trimValues?g0(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?g0(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function dN(e){if(this.options.removeNSPrefix){const i=e.split(":"),a=e.charAt(0)==="/"?"/":"";if(i[0]==="xmlns")return"";i.length===2&&(e=a+i[1])}return e}const fN=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function pN(e,i){if(!this.options.ignoreAttributes&&typeof e=="string"){const a=Vx.getAllMatches(e,fN),c=a.length,d={};for(let f=0;f<c;f++){const y=this.resolveNameSpace(a[f][1]);let s=a[f][4];const w=this.options.attributeNamePrefix+y;if(y.length)if(s!==void 0){this.options.trimValues&&(s=s.trim()),s=this.replaceEntitiesValue(s);const C=this.options.attributeValueProcessor(y,s,i);C==null?d[w]=s:typeof C!=typeof s||C!==s?d[w]=C:d[w]=g0(s,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(d[w]=!0)}if(!Object.keys(d).length)return;if(this.options.attributesGroupName){const f={};return f[this.options.attributesGroupName]=d,f}return d}}const mN=function(e){e=e.replace(/\r\n?/g,`
`);const i=new Md("!xml");let a=i,c="",d="";for(let f=0;f<e.length;f++)if(e[f]==="<")if(e[f+1]==="/"){const s=Vl(e,">",f,"Closing Tag is not closed.");let w=e.substring(f+2,s).trim();if(this.options.removeNSPrefix){const C=w.indexOf(":");C!==-1&&(w=w.substr(C+1))}this.options.transformTagName&&(w=this.options.transformTagName(w)),a&&(c=this.saveTextToParentTag(c,a,d)),d=d.substr(0,d.lastIndexOf(".")),a=this.tagsNodeStack.pop(),c="",f=s}else if(e[f+1]==="?"){let s=m0(e,f,!1,"?>");if(!s)throw new Error("Pi Tag is not closed.");if(c=this.saveTextToParentTag(c,a,d),!(this.options.ignoreDeclaration&&s.tagName==="?xml"||this.options.ignorePiTags)){const w=new Md(s.tagName);w.add(this.options.textNodeName,""),s.tagName!==s.tagExp&&s.attrExpPresent&&(w[":@"]=this.buildAttributesMap(s.tagExp,d)),a.addChild(w)}f=s.closeIndex+1}else if(e.substr(f+1,3)==="!--"){const s=Vl(e,"-->",f+4,"Comment is not closed.");if(this.options.commentPropName){const w=e.substring(f+4,s-2);c=this.saveTextToParentTag(c,a,d),a.add(this.options.commentPropName,[{[this.options.textNodeName]:w}])}f=s}else if(e.substr(f+1,2)==="!D"){const s=aN(e,f);this.docTypeEntities=s.entities,f=s.i}else if(e.substr(f+1,2)==="!["){const s=Vl(e,"]]>",f,"CDATA is not closed.")-2,w=e.substring(f+9,s);if(c=this.saveTextToParentTag(c,a,d),this.options.cdataPropName)a.add(this.options.cdataPropName,[{[this.options.textNodeName]:w}]);else{let C=this.parseTextData(w,a.tagname,d,!0,!1,!0);C==null&&(C=""),a.add(this.options.textNodeName,C)}f=s+2}else{let s=m0(e,f,this.options.removeNSPrefix),w=s.tagName,C=s.tagExp,L=s.attrExpPresent,k=s.closeIndex;this.options.transformTagName&&(w=this.options.transformTagName(w)),a&&c&&a.tagname!=="!xml"&&(c=this.saveTextToParentTag(c,a,d,!1)),w!==i.tagname&&(d+=d?"."+w:w);const R=a;if(R&&this.options.unpairedTags.indexOf(R.tagname)!==-1&&(a=this.tagsNodeStack.pop()),this.isItStopNode(this.options.stopNodes,d,w)){let V="";if(C.length>0&&C.lastIndexOf("/")===C.length-1)f=s.closeIndex;else if(this.options.unpairedTags.indexOf(w)!==-1)f=s.closeIndex;else{const J=this.readStopNodeData(e,w,k+1);if(!J)throw new Error(`Unexpected end of ${w}`);f=J.i,V=J.tagContent}const H=new Md(w);w!==C&&L&&(H[":@"]=this.buildAttributesMap(C,d)),V&&(V=this.parseTextData(V,w,d,!0,L,!0,!0)),d=d.substr(0,d.lastIndexOf(".")),H.add(this.options.textNodeName,V),a.addChild(H)}else{if(C.length>0&&C.lastIndexOf("/")===C.length-1){w[w.length-1]==="/"?(w=w.substr(0,w.length-1),C=w):C=C.substr(0,C.length-1),this.options.transformTagName&&(w=this.options.transformTagName(w));const V=new Md(w);w!==C&&L&&(V[":@"]=this.buildAttributesMap(C,d)),d=d.substr(0,d.lastIndexOf(".")),a.addChild(V)}else{const V=new Md(w);this.tagsNodeStack.push(a),w!==C&&L&&(V[":@"]=this.buildAttributesMap(C,d)),a.addChild(V),a=V}c="",f=k}}else c+=e[f];return i.child},gN=function(e){if(this.options.processEntities){for(let i in this.docTypeEntities){const a=this.docTypeEntities[i];e=e.replace(a.regx,a.val)}for(let i in this.lastEntities){const a=this.lastEntities[i];e=e.replace(a.regex,a.val)}if(this.options.htmlEntities)for(let i in this.htmlEntities){const a=this.htmlEntities[i];e=e.replace(a.regex,a.val)}}return e};function _N(e,i,a,c){return e&&(c===void 0&&(c=Object.keys(i.child).length===0),e=this.parseTextData(e,i.tagname,a,!1,i[":@"]?Object.keys(i[":@"]).length!==0:!1,c),e!==void 0&&e!==""&&i.add(this.options.textNodeName,e),e=""),e}function yN(e,i,a){const c="*."+a;for(const d in e){const f=e[d];if(c===f||i===f)return!0}return!1}function vN(e,i,a=">"){let c,d="";for(let f=i;f<e.length;f++){let y=e[f];if(c)y===c&&(c="");else if(y==='"'||y==="'")c=y;else if(y===a[0])if(a[1]){if(e[f+1]===a[1])return{data:d,index:f}}else return{data:d,index:f};else y==="	"&&(y=" ");d+=y}}function Vl(e,i,a,c){const d=e.indexOf(i,a);if(d===-1)throw new Error(c);return d+i.length-1}function m0(e,i,a,c=">"){const d=vN(e,i+1,c);if(!d)return;let f=d.data;const y=d.index,s=f.search(/\s/);let w=f,C=!0;if(s!==-1&&(w=f.substr(0,s).replace(/\s\s*$/,""),f=f.substr(s+1)),a){const L=w.indexOf(":");L!==-1&&(w=w.substr(L+1),C=w!==d.data.substr(L+1))}return{tagName:w,tagExp:f,closeIndex:y,attrExpPresent:C}}function xN(e,i,a){const c=a;let d=1;for(;a<e.length;a++)if(e[a]==="<")if(e[a+1]==="/"){const f=Vl(e,">",a,`${i} is not closed`);if(e.substring(a+2,f).trim()===i&&(d--,d===0))return{tagContent:e.substring(c,a),i:f};a=f}else if(e[a+1]==="?")a=Vl(e,"?>",a+1,"StopNode is not closed.");else if(e.substr(a+1,3)==="!--")a=Vl(e,"-->",a+3,"StopNode is not closed.");else if(e.substr(a+1,2)==="![")a=Vl(e,"]]>",a,"StopNode is not closed.")-2;else{const f=m0(e,a,">");f&&((f&&f.tagName)===i&&f.tagExp[f.tagExp.length-1]!=="/"&&d++,a=f.closeIndex)}}function g0(e,i,a){if(i&&typeof e=="string"){const c=e.trim();return c==="true"?!0:c==="false"?!1:lN(e,a)}else return Vx.isExist(e)?e:""}var bN=cN,eM={};function wN(e,i){return tM(e,i)}function tM(e,i,a){let c;const d={};for(let f=0;f<e.length;f++){const y=e[f],s=TN(y);let w="";if(a===void 0?w=s:w=a+"."+s,s===i.textNodeName)c===void 0?c=y[s]:c+=""+y[s];else{if(s===void 0)continue;if(y[s]){let C=tM(y[s],i,w);const L=SN(C,i);y[":@"]?EN(C,y[":@"],w,i):Object.keys(C).length===1&&C[i.textNodeName]!==void 0&&!i.alwaysCreateTextNode?C=C[i.textNodeName]:Object.keys(C).length===0&&(i.alwaysCreateTextNode?C[i.textNodeName]="":C=""),d[s]!==void 0&&d.hasOwnProperty(s)?(Array.isArray(d[s])||(d[s]=[d[s]]),d[s].push(C)):i.isArray(s,w,L)?d[s]=[C]:d[s]=C}}}return typeof c=="string"?c.length>0&&(d[i.textNodeName]=c):c!==void 0&&(d[i.textNodeName]=c),d}function TN(e){const i=Object.keys(e);for(let a=0;a<i.length;a++){const c=i[a];if(c!==":@")return c}}function EN(e,i,a,c){if(i){const d=Object.keys(i),f=d.length;for(let y=0;y<f;y++){const s=d[y];c.isArray(s,a+"."+s,!0,!0)?e[s]=[i[s]]:e[s]=i[s]}}}function SN(e,i){const a=Object.keys(e).length;return!!(a===0||a===1&&e[i.textNodeName])}eM.prettify=wN;const{buildOptions:AN}=Ux,CN=bN,{prettify:MN}=eM,IN=Fx;class PN{constructor(i){this.externalEntities={},this.options=AN(i)}parse(i,a){if(typeof i!="string")if(i.toString)i=i.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(a){a===!0&&(a={});const f=IN.validate(i,a);if(f!==!0)throw Error(`${f.err.msg}:${f.err.line}:${f.err.col}`)}const c=new CN(this.options);c.addExternalEntities(this.externalEntities);const d=c.parseXml(i);return this.options.preserveOrder||d===void 0?d:MN(d,this.options)}addEntity(i,a){if(a.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(i.indexOf("&")!==-1||i.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");this.externalEntities[i]=a}}var kN=PN;const LN=`
`;function zN(e,i){return iM(e,i,"",0)}function iM(e,i,a,c){let d="",f="";i.format&&i.indentBy.length>0&&(f=LN+""+i.indentBy.repeat(c));for(let y=0;y<e.length;y++){const s=e[y],w=RN(s);let C="";if(a.length===0?C=w:C=`${a}.${w}`,w===i.textNodeName){let V=s[w];DN(C,i)||(V=i.tagValueProcessor(w,V),V=nM(V,i)),d+=f+V;continue}else if(w===i.cdataPropName){d+=f+`<![CDATA[${s[w][0][i.textNodeName]}]]>`;continue}else if(w===i.commentPropName){d+=f+`<!--${s[w][0][i.textNodeName]}-->`;continue}else if(w[0]==="?"){const V=CE(s[":@"],i),H=w==="?xml"?"":f;let J=s[w][0][i.textNodeName];J=J.length!==0?" "+J:"",d+=H+`<${w}${J}${V}?>`;continue}const L=CE(s[":@"],i);let k=f+`<${w}${L}`,R=iM(s[w],i,C,c+1);i.unpairedTags.indexOf(w)!==-1?i.suppressUnpairedNode?d+=k+">":d+=k+"/>":(!R||R.length===0)&&i.suppressEmptyNode?d+=k+"/>":d+=k+`>${R}${f}</${w}>`}return d}function RN(e){const i=Object.keys(e);for(let a=0;a<i.length;a++){const c=i[a];if(c!==":@")return c}}function CE(e,i){let a="";if(e&&!i.ignoreAttributes)for(let c in e){let d=i.attributeValueProcessor(c,e[c]);d=nM(d,i),d===!0&&i.suppressBooleanAttributes?a+=` ${c.substr(i.attributeNamePrefix.length)}`:a+=` ${c.substr(i.attributeNamePrefix.length)}="${d}"`}return a}function DN(e,i){e=e.substr(0,e.length-i.textNodeName.length-1);let a=e.substr(e.lastIndexOf(".")+1);for(let c in i.stopNodes)if(i.stopNodes[c]===e||i.stopNodes[c]==="*."+a)return!0;return!1}function nM(e,i){if(e&&e.length>0&&i.processEntities)for(let a=0;a<i.entities.length;a++){const c=i.entities[a];e=e.replace(c.regex,c.val)}return e}var ON=zN;const FN=ON,BN={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,i){return i},attributeValueProcessor:function(e,i){return i},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],transformTagName:!1};function $x(e){this.options=Object.assign({},BN,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=qN),this.processTextOrObjNode=UN,this.options.format?(this.indentate=GN,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.suppressEmptyNode?(this.buildTextNode=jN,this.buildObjNode=VN):(this.buildTextNode=IE,this.buildObjNode=ME),this.buildTextValNode=IE,this.buildObjectNode=ME,this.replaceEntitiesValue=$N,this.buildAttrPairStr=NN}$x.prototype.build=function(e){return this.options.preserveOrder?FN(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)};$x.prototype.j2x=function(e,i){let a="",c="";for(let d in e)if(!(typeof e[d]>"u"))if(e[d]===null)d[0]==="?"?c+=this.indentate(i)+"<"+d+"?"+this.tagEndChar:c+=this.indentate(i)+"<"+d+"/"+this.tagEndChar;else if(e[d]instanceof Date)c+=this.buildTextNode(e[d],d,"",i);else if(typeof e[d]!="object"){const f=this.isAttribute(d);if(f)a+=this.buildAttrPairStr(f,""+e[d]);else if(d===this.options.textNodeName){let y=this.options.tagValueProcessor(d,""+e[d]);c+=this.replaceEntitiesValue(y)}else c+=this.buildTextNode(e[d],d,"",i)}else if(Array.isArray(e[d])){const f=e[d].length;for(let y=0;y<f;y++){const s=e[d][y];typeof s>"u"||(s===null?d[0]==="?"?c+=this.indentate(i)+"<"+d+"?"+this.tagEndChar:c+=this.indentate(i)+"<"+d+"/"+this.tagEndChar:typeof s=="object"?c+=this.processTextOrObjNode(s,d,i):c+=this.buildTextNode(s,d,"",i))}}else if(this.options.attributesGroupName&&d===this.options.attributesGroupName){const f=Object.keys(e[d]),y=f.length;for(let s=0;s<y;s++)a+=this.buildAttrPairStr(f[s],""+e[d][f[s]])}else c+=this.processTextOrObjNode(e[d],d,i);return{attrStr:a,val:c}};function NN(e,i){return i=this.options.attributeValueProcessor(e,""+i),i=this.replaceEntitiesValue(i),this.options.suppressBooleanAttributes&&i==="true"?" "+e:" "+e+'="'+i+'"'}function UN(e,i,a){const c=this.j2x(e,a+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextNode(e[this.options.textNodeName],i,c.attrStr,a):this.buildObjNode(c.val,i,c.attrStr,a)}function ME(e,i,a,c){let d="</"+i+this.tagEndChar,f="";return i[0]==="?"&&(f="?",d=""),a&&e.indexOf("<")===-1?this.indentate(c)+"<"+i+a+f+">"+e+d:this.options.commentPropName!==!1&&i===this.options.commentPropName&&f.length===0?this.indentate(c)+`<!--${e}-->`+this.newLine:this.indentate(c)+"<"+i+a+f+this.tagEndChar+e+this.indentate(c)+d}function VN(e,i,a,c){return e!==""?this.buildObjectNode(e,i,a,c):i[0]==="?"?this.indentate(c)+"<"+i+a+"?"+this.tagEndChar:this.indentate(c)+"<"+i+a+"/"+this.tagEndChar}function IE(e,i,a,c){if(this.options.cdataPropName!==!1&&i===this.options.cdataPropName)return this.indentate(c)+`<![CDATA[${e}]]>`+this.newLine;if(this.options.commentPropName!==!1&&i===this.options.commentPropName)return this.indentate(c)+`<!--${e}-->`+this.newLine;{let d=this.options.tagValueProcessor(i,e);return d=this.replaceEntitiesValue(d),d===""&&this.options.unpairedTags.indexOf(i)!==-1?this.options.suppressUnpairedNode?this.indentate(c)+"<"+i+this.tagEndChar:this.indentate(c)+"<"+i+"/"+this.tagEndChar:this.indentate(c)+"<"+i+a+">"+d+"</"+i+this.tagEndChar}}function $N(e){if(e&&e.length>0&&this.options.processEntities)for(let i=0;i<this.options.entities.length;i++){const a=this.options.entities[i];e=e.replace(a.regex,a.val)}return e}function jN(e,i,a,c){return e===""&&this.options.unpairedTags.indexOf(i)!==-1?this.options.suppressUnpairedNode?this.indentate(c)+"<"+i+this.tagEndChar:this.indentate(c)+"<"+i+"/"+this.tagEndChar:e!==""?this.buildTextValNode(e,i,a,c):i[0]==="?"?this.indentate(c)+"<"+i+a+"?"+this.tagEndChar:this.indentate(c)+"<"+i+a+"/"+this.tagEndChar}function GN(e){return this.options.indentBy.repeat(e)}function qN(e){return e.startsWith(this.options.attributeNamePrefix)?e.substr(this.attrPrefixLen):!1}var WN=$x;const HN=Fx,ZN=kN,XN=WN;var KN={XMLParser:ZN,XMLValidator:HN,XMLBuilder:XN},rM={exports:{}};(function(e,i){(function(a,c,d){e.exports=d(),e.exports.default=d()})("slugify",K0,function(){var a=JSON.parse(`{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","\xA2":"cent","\xA3":"pound","\xA4":"currency","\xA5":"yen","\xA9":"(c)","\xAA":"a","\xAE":"(r)","\xBA":"o","\xC0":"A","\xC1":"A","\xC2":"A","\xC3":"A","\xC4":"A","\xC5":"A","\xC6":"AE","\xC7":"C","\xC8":"E","\xC9":"E","\xCA":"E","\xCB":"E","\xCC":"I","\xCD":"I","\xCE":"I","\xCF":"I","\xD0":"D","\xD1":"N","\xD2":"O","\xD3":"O","\xD4":"O","\xD5":"O","\xD6":"O","\xD8":"O","\xD9":"U","\xDA":"U","\xDB":"U","\xDC":"U","\xDD":"Y","\xDE":"TH","\xDF":"ss","\xE0":"a","\xE1":"a","\xE2":"a","\xE3":"a","\xE4":"a","\xE5":"a","\xE6":"ae","\xE7":"c","\xE8":"e","\xE9":"e","\xEA":"e","\xEB":"e","\xEC":"i","\xED":"i","\xEE":"i","\xEF":"i","\xF0":"d","\xF1":"n","\xF2":"o","\xF3":"o","\xF4":"o","\xF5":"o","\xF6":"o","\xF8":"o","\xF9":"u","\xFA":"u","\xFB":"u","\xFC":"u","\xFD":"y","\xFE":"th","\xFF":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010C":"C","\u010D":"c","\u010E":"D","\u010F":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011A":"E","\u011B":"e","\u011E":"G","\u011F":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012A":"i","\u012B":"i","\u012E":"I","\u012F":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013B":"L","\u013C":"l","\u013D":"L","\u013E":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014C":"O","\u014D":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0154":"R","\u0155":"r","\u0158":"R","\u0159":"r","\u015A":"S","\u015B":"s","\u015E":"S","\u015F":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016A":"u","\u016B":"u","\u016E":"U","\u016F":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017A":"z","\u017B":"Z","\u017C":"z","\u017D":"Z","\u017E":"z","\u018F":"E","\u0192":"f","\u01A0":"O","\u01A1":"o","\u01AF":"U","\u01B0":"u","\u01C8":"LJ","\u01C9":"lj","\u01CB":"NJ","\u01CC":"nj","\u0218":"S","\u0219":"s","\u021A":"T","\u021B":"t","\u0259":"e","\u02DA":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038A":"I","\u038C":"O","\u038E":"Y","\u038F":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039A":"K","\u039B":"L","\u039C":"M","\u039D":"N","\u039E":"3","\u039F":"O","\u03A0":"P","\u03A1":"R","\u03A3":"S","\u03A4":"T","\u03A5":"Y","\u03A6":"F","\u03A7":"X","\u03A8":"PS","\u03A9":"W","\u03AA":"I","\u03AB":"Y","\u03AC":"a","\u03AD":"e","\u03AE":"h","\u03AF":"i","\u03B0":"y","\u03B1":"a","\u03B2":"b","\u03B3":"g","\u03B4":"d","\u03B5":"e","\u03B6":"z","\u03B7":"h","\u03B8":"8","\u03B9":"i","\u03BA":"k","\u03BB":"l","\u03BC":"m","\u03BD":"n","\u03BE":"3","\u03BF":"o","\u03C0":"p","\u03C1":"r","\u03C2":"s","\u03C3":"s","\u03C4":"t","\u03C5":"y","\u03C6":"f","\u03C7":"x","\u03C8":"ps","\u03C9":"w","\u03CA":"i","\u03CB":"y","\u03CC":"o","\u03CD":"y","\u03CE":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040A":"NJ","\u040B":"C","\u040F":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041A":"K","\u041B":"L","\u041C":"M","\u041D":"N","\u041E":"O","\u041F":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042A":"U","\u042B":"Y","\u042C":"","\u042D":"E","\u042E":"Yu","\u042F":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043A":"k","\u043B":"l","\u043C":"m","\u043D":"n","\u043E":"o","\u043F":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044A":"u","\u044B":"y","\u044C":"","\u044D":"e","\u044E":"yu","\u044F":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045A":"nj","\u045B":"c","\u045D":"u","\u045F":"dz","\u0490":"G","\u0491":"g","\u0492":"GH","\u0493":"gh","\u049A":"KH","\u049B":"kh","\u04A2":"NG","\u04A3":"ng","\u04AE":"UE","\u04AF":"ue","\u04B0":"U","\u04B1":"u","\u04BA":"H","\u04BB":"h","\u04D8":"AE","\u04D9":"ae","\u04E8":"OE","\u04E9":"oe","\u0531":"A","\u0532":"B","\u0533":"G","\u0534":"D","\u0535":"E","\u0536":"Z","\u0537":"E'","\u0538":"Y'","\u0539":"T'","\u053A":"JH","\u053B":"I","\u053C":"L","\u053D":"X","\u053E":"C'","\u053F":"K","\u0540":"H","\u0541":"D'","\u0542":"GH","\u0543":"TW","\u0544":"M","\u0545":"Y","\u0546":"N","\u0547":"SH","\u0549":"CH","\u054A":"P","\u054B":"J","\u054C":"R'","\u054D":"S","\u054E":"V","\u054F":"T","\u0550":"R","\u0551":"C","\u0553":"P'","\u0554":"Q'","\u0555":"O''","\u0556":"F","\u0587":"EV","\u0621":"a","\u0622":"aa","\u0623":"a","\u0624":"u","\u0625":"i","\u0626":"e","\u0627":"a","\u0628":"b","\u0629":"h","\u062A":"t","\u062B":"th","\u062C":"j","\u062D":"h","\u062E":"kh","\u062F":"d","\u0630":"th","\u0631":"r","\u0632":"z","\u0633":"s","\u0634":"sh","\u0635":"s","\u0636":"dh","\u0637":"t","\u0638":"z","\u0639":"a","\u063A":"gh","\u0641":"f","\u0642":"q","\u0643":"k","\u0644":"l","\u0645":"m","\u0646":"n","\u0647":"h","\u0648":"w","\u0649":"a","\u064A":"y","\u064B":"an","\u064C":"on","\u064D":"en","\u064E":"a","\u064F":"u","\u0650":"e","\u0652":"","\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u067E":"p","\u0686":"ch","\u0698":"zh","\u06A9":"k","\u06AF":"g","\u06CC":"y","\u06F0":"0","\u06F1":"1","\u06F2":"2","\u06F3":"3","\u06F4":"4","\u06F5":"5","\u06F6":"6","\u06F7":"7","\u06F8":"8","\u06F9":"9","\u0E3F":"baht","\u10D0":"a","\u10D1":"b","\u10D2":"g","\u10D3":"d","\u10D4":"e","\u10D5":"v","\u10D6":"z","\u10D7":"t","\u10D8":"i","\u10D9":"k","\u10DA":"l","\u10DB":"m","\u10DC":"n","\u10DD":"o","\u10DE":"p","\u10DF":"zh","\u10E0":"r","\u10E1":"s","\u10E2":"t","\u10E3":"u","\u10E4":"f","\u10E5":"k","\u10E6":"gh","\u10E7":"q","\u10E8":"sh","\u10E9":"ch","\u10EA":"ts","\u10EB":"dz","\u10EC":"ts","\u10ED":"ch","\u10EE":"kh","\u10EF":"j","\u10F0":"h","\u1E62":"S","\u1E63":"s","\u1E80":"W","\u1E81":"w","\u1E82":"W","\u1E83":"w","\u1E84":"W","\u1E85":"w","\u1E9E":"SS","\u1EA0":"A","\u1EA1":"a","\u1EA2":"A","\u1EA3":"a","\u1EA4":"A","\u1EA5":"a","\u1EA6":"A","\u1EA7":"a","\u1EA8":"A","\u1EA9":"a","\u1EAA":"A","\u1EAB":"a","\u1EAC":"A","\u1EAD":"a","\u1EAE":"A","\u1EAF":"a","\u1EB0":"A","\u1EB1":"a","\u1EB2":"A","\u1EB3":"a","\u1EB4":"A","\u1EB5":"a","\u1EB6":"A","\u1EB7":"a","\u1EB8":"E","\u1EB9":"e","\u1EBA":"E","\u1EBB":"e","\u1EBC":"E","\u1EBD":"e","\u1EBE":"E","\u1EBF":"e","\u1EC0":"E","\u1EC1":"e","\u1EC2":"E","\u1EC3":"e","\u1EC4":"E","\u1EC5":"e","\u1EC6":"E","\u1EC7":"e","\u1EC8":"I","\u1EC9":"i","\u1ECA":"I","\u1ECB":"i","\u1ECC":"O","\u1ECD":"o","\u1ECE":"O","\u1ECF":"o","\u1ED0":"O","\u1ED1":"o","\u1ED2":"O","\u1ED3":"o","\u1ED4":"O","\u1ED5":"o","\u1ED6":"O","\u1ED7":"o","\u1ED8":"O","\u1ED9":"o","\u1EDA":"O","\u1EDB":"o","\u1EDC":"O","\u1EDD":"o","\u1EDE":"O","\u1EDF":"o","\u1EE0":"O","\u1EE1":"o","\u1EE2":"O","\u1EE3":"o","\u1EE4":"U","\u1EE5":"u","\u1EE6":"U","\u1EE7":"u","\u1EE8":"U","\u1EE9":"u","\u1EEA":"U","\u1EEB":"u","\u1EEC":"U","\u1EED":"u","\u1EEE":"U","\u1EEF":"u","\u1EF0":"U","\u1EF1":"u","\u1EF2":"Y","\u1EF3":"y","\u1EF4":"Y","\u1EF5":"y","\u1EF6":"Y","\u1EF7":"y","\u1EF8":"Y","\u1EF9":"y","\u2013":"-","\u2018":"'","\u2019":"'","\u201C":"\\"","\u201D":"\\"","\u201E":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20A0":"ecu","\u20A2":"cruzeiro","\u20A3":"french franc","\u20A4":"lira","\u20A5":"mill","\u20A6":"naira","\u20A7":"peseta","\u20A8":"rupee","\u20A9":"won","\u20AA":"new shequel","\u20AB":"dong","\u20AC":"euro","\u20AD":"kip","\u20AE":"tugrik","\u20AF":"drachma","\u20B0":"penny","\u20B1":"peso","\u20B2":"guarani","\u20B3":"austral","\u20B4":"hryvnia","\u20B5":"cedi","\u20B8":"kazakhstani tenge","\u20B9":"indian rupee","\u20BA":"turkish lira","\u20BD":"russian ruble","\u20BF":"bitcoin","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221E":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\uFDFC":"rial","\uFEF5":"laa","\uFEF7":"laa","\uFEF9":"lai","\uFEFB":"la"}`),c=JSON.parse('{"bg":{"\u0419":"Y","\u0426":"Ts","\u0429":"Sht","\u042A":"A","\u042C":"Y","\u0439":"y","\u0446":"ts","\u0449":"sht","\u044A":"a","\u044C":"y"},"de":{"\xC4":"AE","\xE4":"ae","\xD6":"OE","\xF6":"oe","\xDC":"UE","\xFC":"ue","\xDF":"ss","%":"prozent","&":"und","|":"oder","\u2211":"summe","\u221E":"unendlich","\u2665":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","\xA2":"centavos","\xA3":"libras","\xA4":"moneda","\u20A3":"francos","\u2211":"suma","\u221E":"infinito","\u2665":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","\xA2":"centime","\xA3":"livre","\xA4":"devise","\u20A3":"franc","\u2211":"somme","\u221E":"infini","\u2665":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","\xA2":"centavo","\u2211":"soma","\xA3":"libra","\u221E":"infinito","\u2665":"amor"},"uk":{"\u0418":"Y","\u0438":"y","\u0419":"Y","\u0439":"y","\u0426":"Ts","\u0446":"ts","\u0425":"Kh","\u0445":"kh","\u0429":"Shch","\u0449":"shch","\u0413":"H","\u0433":"h"},"vi":{"\u0110":"D","\u0111":"d"},"da":{"\xD8":"OE","\xF8":"oe","\xC5":"AA","\xE5":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"st\xF8rre end"},"nb":{"&":"og","\xC5":"AA","\xC6":"AE","\xD8":"OE","\xE5":"aa","\xE6":"ae","\xF8":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","\xC5":"AA","\xC4":"AE","\xD6":"OE","\xE5":"aa","\xE4":"ae","\xF6":"oe"}}');function d(f,y){if(typeof f!="string")throw new Error("slugify: string argument expected");y=typeof y=="string"?{replacement:y}:y||{};var s=c[y.locale]||{},w=y.replacement===void 0?"-":y.replacement,C=y.trim===void 0?!0:y.trim,L=f.normalize().split("").reduce(function(k,R){var V=s[R]||a[R]||R;return V===w&&(V=" "),k+V.replace(y.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")},"");return y.strict&&(L=L.replace(/[^A-Za-z0-9\s]/g,"")),C&&(L=L.trim()),L=L.replace(/\s+/g,w),y.lower&&(L=L.toLowerCase()),L}return d.extend=function(f){Object.assign(a,f)},d})})(rM);const YN=rM.exports,qa=(e,i)=>{const a=e.__vccOpts||e;for(const[c,d]of i)a[c]=d;return a},QN=new KN.XMLParser,JN={name:"JobList",props:["extended"],data(){return{departments:[],jobs:{}}},methods:{async getJobs(){await er.get("https://dida.jobs.personio.de/xml/?language=en").then(e=>{const i=QN.parse(e.data);this.jobs=i["workzag-jobs"],this.extended||(this.jobs=this.jobs.position.slice(0,5))}).then(()=>{this.jobs.position.forEach(e=>{this.departments.includes(e.department)||this.departments.push(e.department)})})},slugifyString(e){return YN(e)}},async mounted(){await this.getJobs()}},e4={class:"w-full"},t4={key:0,class:"w-full m-auto mb-16"},i4=Fe("h2",{class:"mb-4 text-5xl font-PoppinsSemiBold tracking-tight"}," Jobs ",-1),n4=Fe("p",{class:"text-lg max-w-2xl"}," We\u2019re hiring talented people in a variety of technical and nontechnical roles to join our team in Berlin. Check out open vacancies below. ",-1),r4=[i4,n4],s4={key:1},o4={class:"mb-4 text-xl font-PoppinsSemiBold tracking-tight block"},a4=["href"],l4={class:"w-full flex flex-row items-start justify-start"},c4={key:0,class:"mr-2 text-xs uppercase"},u4={key:1,class:"mr-2 text-xs uppercase"},h4={key:2,class:"mr-2 text-xs uppercase"},d4={key:3,class:"mr-2 text-xs uppercase"},f4=Fe("p",{class:"mr-2 text-xs uppercase"},"\u2022",-1),p4={class:"mr-2 text-xs uppercase"},m4=["href"],g4={class:"w-full flex flex-row items-start justify-start"},_4={key:0,class:"mr-2 text-xs uppercase"},y4={key:1,class:"mr-2 text-xs uppercase"},v4={key:2,class:"mr-2 text-xs uppercase"},x4={key:3,class:"mr-2 text-xs uppercase"},b4=Fe("p",{class:"mr-2 text-xs uppercase"},"\u2022",-1),w4={class:"mr-2 text-xs uppercase"};function T4(e,i,a,c,d,f){return Ft(),Nt("div",e4,[a.extended?(Ft(),Nt("div",t4,r4)):Ri("",!0),a.extended?(Ft(),Nt("div",s4,[(Ft(!0),Nt(dn,null,Wo(d.departments,y=>(Ft(),Nt("div",{key:y,class:"mb-8"},[Fe("h3",o4,Pi(y),1),e.job.department==y?(Ft(!0),Nt(dn,{key:0},Wo(d.jobs.position,(s,w)=>(Ft(),Nt("a",{href:"https://dida.do/jobs/"+f.slugifyString(s.name)+"/"+s.id,class:"w-full p-6 rounded bg-gray-100 text-lg hover:bg-gray-200 transition duration-150 ease-in-out my-2 cursor-pointer block",key:w},[Ir(Pi(s.name)+" ",1),Fe("div",l4,[s.employmentType=="intern"?(Ft(),Nt("p",c4," Intern/Student, ")):(Ft(),Nt("p",u4,"Permanent,")),s.schedule=="part-time"?(Ft(),Nt("p",h4," Part time ")):(Ft(),Nt("p",d4,"Full time")),f4,Fe("p",p4,Pi(s.office),1)])],8,a4))),128)):Ri("",!0)]))),128))])):Ri("",!0),a.extended?Ri("",!0):(Ft(!0),Nt(dn,{key:2},Wo(d.jobs,(y,s)=>(Ft(),Nt("a",{href:"https://dida.jobs.personio.de/job/"+y.id,class:"w-full p-4 rounded bg-neutral-100 text-sm hover:bg-neutral-200 transition duration-150 ease-in-out mb-4 cursor-pointer block",key:s},[Ir(Pi(y.name)+" ",1),Fe("div",g4,[y.employmentType=="intern"?(Ft(),Nt("p",_4," Intern/Student, ")):(Ft(),Nt("p",y4,"Permanent,")),y.schedule=="part-time"?(Ft(),Nt("p",v4," Part time ")):(Ft(),Nt("p",x4,"Full time")),b4,Fe("p",w4,Pi(y.office),1)])],8,m4))),128))])}const E4=qa(JN,[["render",T4]]);var sM={exports:{}};(function(e,i){(function(a,c){e.exports=c()})(K0,function(){var a,c,d;function f(s,w){if(!a)a=w;else if(!c)c=w;else{var C="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",L={};a(L),d=w(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}f(["exports"],function(s){var w=typeof self<"u"?self:{},C=L;function L(r,t,n,l){this.cx=3*r,this.bx=3*(n-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=l,this.p2x=n,this.p2y=l}L.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r},L.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r},L.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},L.prototype.solveCurveX=function(r,t){var n,l,h,m,_;for(t===void 0&&(t=1e-6),h=r,_=0;_<8;_++){if(m=this.sampleCurveX(h)-r,Math.abs(m)<t)return h;var v=this.sampleCurveDerivativeX(h);if(Math.abs(v)<1e-6)break;h-=m/v}if((h=r)<(n=0))return n;if(h>(l=1))return l;for(;n<l;){if(m=this.sampleCurveX(h),Math.abs(m-r)<t)return h;r>m?n=h:l=h,h=.5*(l-n)+n}return h},L.prototype.solve=function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))};var k=R;function R(r,t){this.x=r,this.y=t}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,n=r.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),n=Math.sin(r),l=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=l,this},_rotateAround:function(r,t){var n=Math.cos(r),l=Math.sin(r),h=t.y+l*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},R.convert=function(r){return r instanceof R?r:Array.isArray(r)?new R(r[0],r[1]):r};const V=Math.PI/180,H=180/Math.PI;function J(r){return r*V}function ue(r){return r*H}const j=[[0,0],[1,0],[1,1],[0,1]];function q(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,n=t*r;return 4*(r<.5?n:3*(r-t)+n-.75)}function se(r,t,n,l){const h=new C(r,t,n,l);return function(m){return h.solve(m)}}const ge=se(.25,.1,.25,1);function ie(r,t,n){return Math.min(n,Math.max(t,r))}function Ie(r,t,n){return(n=ie((n-r)/(t-r),0,1))*n*(3-2*n)}function ze(r,t,n){const l=n-t,h=((r-t)%l+l)%l+t;return h===t?n:h}function Ae(r,t,n){if(!r.length)return n(null,[]);let l=r.length;const h=new Array(r.length);let m=null;r.forEach((_,v)=>{t(_,(T,E)=>{T&&(m=T),h[v]=E,--l==0&&n(m,h)})})}function He(r){const t=[];for(const n in r)t.push(r[n]);return t}function Ce(r,...t){for(const n of t)for(const l in n)r[l]=n[l];return r}let Ge=1;function De(){return Ge++}function We(){return function r(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function et(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Gt(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function Vt(r,t){r.forEach(n=>{t[n]&&(t[n]=t[n].bind(t))})}function fi(r,t){return r.indexOf(t,r.length-t.length)!==-1}function Yt(r,t,n){const l={};for(const h in r)l[h]=t.call(n||this,r[h],h,r);return l}function _i(r,t,n){const l={};for(const h in r)t.call(n||this,r[h],h,r)&&(l[h]=r[h]);return l}function tn(r){return Array.isArray(r)?r.map(tn):typeof r=="object"&&r?Yt(r,tn):r}const Mi={};function yi(r){Mi[r]||(typeof console<"u"&&console.warn(r),Mi[r]=!0)}function Kt(r,t,n){return(n.y-r.y)*(t.x-r.x)>(t.y-r.y)*(n.x-r.x)}function fn(r){let t=0;for(let n,l,h=0,m=r.length,_=m-1;h<m;_=h++)n=r[h],l=r[_],t+=(l.x-n.x)*(n.y+l.y);return t}function gn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function xn(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,l,h,m)=>{const _=h||m;return t[l]=!_||_.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t}let Ke=null;function Pt(r){if(Ke==null){const t=r.navigator?r.navigator.userAgent:null;Ke=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ke}function Mt(r){try{const t=w[r];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Lt(r,t){return[r[4*t],r[4*t+1],r[4*t+2],r[4*t+3]]}const li=w.performance;function Ai(r){const t=r?r.url.toString():void 0;return li.getEntriesByName(t)}var he="2.10.0";let de,Ne,at,Ye;const gt={now:()=>at!==void 0?at:w.performance.now(),setNow(r){at=r},restoreNow(){at=void 0},frame(r){const t=w.requestAnimationFrame(r);return{cancel:()=>w.cancelAnimationFrame(t)}},getImageData(r,t=0){const{width:n,height:l}=r;Ye||(Ye=w.document.createElement("canvas"));const h=Ye.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return(n>Ye.width||l>Ye.height)&&(Ye.width=n,Ye.height=l),h.clearRect(-t,-t,n+2*t,l+2*t),h.drawImage(r,0,0,n,l),h.getImageData(-t,-t,n+2*t,l+2*t)},resolveURL:r=>(de||(de=w.document.createElement("a")),de.href=r,de.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(Ne==null&&(Ne=w.matchMedia("(prefers-reduced-motion: reduce)")),Ne.matches)}};let It;const tt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(It==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{It=process.env.API_URL_REGEX!=null?new RegExp(process.env.API_URL_REGEX):r}catch{It=r}}return It},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},xt={supported:!1,testSupport:function(r){!Dt&&Ot&&($t?Zt(r):ut=r)}};let ut,Ot,Dt=!1,$t=!1;function Zt(r){const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,Ot),r.isContextLost())return;xt.supported=!0}catch{}r.deleteTexture(t),Dt=!0}w.document&&(Ot=w.document.createElement("img"),Ot.onload=function(){ut&&Zt(ut),ut=null,$t=!0},Ot.onerror=function(){Dt=!0,ut=null},Ot.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ci="01",oi="NO_ACCESS_TOKEN";function ui(r){return r.indexOf("mapbox:")===0}function bi(r){return tt.API_URL_REGEX.test(r)}const nn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Zi(r){const t=r.match(nn);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Gn(r){const t=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${t}`}function ur(r){if(!r)return null;const t=r.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(t[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class fs{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const n=ur(tt.ACCESS_TOKEN);let l="";return l=n&&n.u?w.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(h,m)=>String.fromCharCode(Number("0x"+m)))):tt.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${l}`:`mapbox.eventData:${l}`}fetchEventData(){const t=Mt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{const h=w.localStorage.getItem(n);h&&(this.eventData=JSON.parse(h));const m=w.localStorage.getItem(l);m&&(this.anonId=m)}catch{yi("Unable to read from LocalStorage")}}saveEventData(){const t=Mt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{w.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{yi("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,n,l,h){if(!tt.EVENTS_URL)return;const m=Zi(tt.EVENTS_URL);m.params.push(`access_token=${h||tt.ACCESS_TOKEN||""}`);const _={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:he,skuId:ci,userId:this.anonId},v=n?Ce(_,n):_,T={url:Gn(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=rt(T,E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(h)})}queueRequest(t,n){this.queue.push(t),this.processRequests(n)}}const Xi=new class extends fs{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,t){tt.EVENTS_URL&&tt.ACCESS_TOKEN&&Array.isArray(r)&&r.some(n=>ui(n)||bi(n))&&this.queueRequest(Date.now(),t)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=ur(tt.ACCESS_TOKEN),n=t?t.u:tt.ACCESS_TOKEN;let l=n!==this.eventData.tokenU;Gt(this.anonId)||(this.anonId=We(),l=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),_=new Date(h),v=(h-this.eventData.lastSuccess)/864e5;l=l||v>=1||v<-1||m.getDate()!==_.getDate()}else l=!0;l?this.postEvent(h,{"enabled.telemetry":!1},m=>{m||(this.eventData.lastSuccess=h,this.eventData.tokenU=n)},r):this.processRequests()}},Mn=Xi.postTurnstileEvent.bind(Xi),ps=new class extends fs{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,t,n,l){this.skuToken=t,this.errorCb=l,tt.EVENTS_URL&&(n||tt.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},n):this.errorCb(new Error(oi)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Gt(this.anonId)||(this.anonId=We()),this.postEvent(n,{skuToken:this.skuToken},l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},r))}},pn=ps.postMapLoadEvent.bind(ps),$r=new class extends fs{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,t,n,l){if(!tt.API_URL||!tt.SESSION_PATH)return;const h=Zi(tt.API_URL+tt.SESSION_PATH);h.params.push(`sku=${t||""}`),h.params.push(`access_token=${l||tt.ACCESS_TOKEN||""}`);const m={url:Gn(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=wt(m,_=>{this.pendingRequest=null,n(_),this.saveEventData(),this.processRequests(l)})}getSessionAPI(r,t,n,l){this.skuToken=t,this.errorCb=l,tt.SESSION_PATH&&tt.API_URL&&(n||tt.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},n):this.errorCb(new Error(oi)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||this.getSession(n,this.skuToken,l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},r)}},Ha=$r.getSessionAPI.bind($r),jr=new Set;let wr,Ms=500,wo=50,qn={};function ms(r){const t=$(r);let n,l;t&&t.forEach(m=>{const _=m.split("=");_[0]==="language"?n=_[1]:_[0]==="worldview"&&(l=_[1])});let h="mapbox-tiles";return n&&(h+=`-${n}`),l&&(h+=`-${l}`),h}function re(){try{return w.caches}catch{}}function N(r){const t=re();t&&!qn[r]&&(qn[r]=t.open(r))}function $(r){const t=r.indexOf("?");return t>0?r.slice(t+1).split("&"):[]}function ne(r){const t=r.indexOf("?");if(t<0)return r;const n=$(r).filter(l=>{const h=l.split("=");return h[0]==="language"||h[0]==="worldview"});return n.length?`${r.slice(0,t)}?${n.join("&")}`:r.slice(0,t)}let ce=1/0;const Te={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Te);class Le extends Error{constructor(t,n,l){n===401&&bi(l)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=n,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Pe=gn()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,be=function(r,t){if(!(/^file:/.test(n=r.url)||/^file:/.test(Pe())&&!/^\w+:/.test(n))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(l,h){const m=new w.AbortController,_=new w.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Pe(),signal:m.signal});let v=!1,T=!1;const E=(M=_.url).indexOf("sku=")>0&&bi(M);var M;l.type==="json"&&_.headers.set("Accept","application/json");const P=(F,B,G)=>{if(T)return;if(F&&F.message!=="SecurityError"&&yi(F),B&&G)return z(B);const Z=Date.now();w.fetch(_).then(oe=>{if(oe.ok){const me=E?oe.clone():null;return z(oe,me,Z)}return h(new Le(oe.statusText,oe.status,l.url))}).catch(oe=>{oe.code!==20&&h(new Error(oe.message))})},z=(F,B,G)=>{(l.type==="arrayBuffer"?F.arrayBuffer():l.type==="json"?F.json():F.text()).then(Z=>{T||(B&&G&&function(oe,me,le){const fe=ms(oe.url);if(N(fe),!qn[fe])return;const Se={status:me.status,statusText:me.statusText,headers:new w.Headers};me.headers.forEach((Be,Ze)=>Se.headers.set(Ze,Be));const ye=xn(me.headers.get("Cache-Control")||"");if(ye["no-store"])return;ye["max-age"]&&Se.headers.set("Expires",new Date(le+1e3*ye["max-age"]).toUTCString());const Ue=Se.headers.get("Expires");Ue&&(new Date(Ue).getTime()-le<42e4||function(Be,Ze){if(wr===void 0)try{new Response(new ReadableStream),wr=!0}catch{wr=!1}wr?Ze(Be.body):Be.blob().then(Ze)}(me,Be=>{const Ze=new w.Response(Be,Se);N(fe),qn[fe]&&qn[fe].then(mt=>mt.put(ne(oe.url),Ze)).catch(mt=>yi(mt.message))}))}(_,B,G),v=!0,h(null,Z,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(Z=>{T||h(new Error(Z.message))})};return E?function(F,B){const G=ms(F.url);if(N(G),!qn[G])return B(null);const Z=ne(F.url);qn[G].then(oe=>{oe.match(Z).then(me=>{const le=function(fe){if(!fe)return!1;const Se=new Date(fe.headers.get("Expires")||0),ye=xn(fe.headers.get("Cache-Control")||"");return Se>Date.now()&&!ye["no-cache"]}(me);oe.delete(Z),le&&oe.put(Z,me.clone()),B(null,me,le)}).catch(B)}).catch(B)}(_,P):P(null,null),{cancel:()=>{T=!0,v||m.abort()}}}(r,t);if(gn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,t,void 0,!0)}var n;return function(l,h){const m=new w.XMLHttpRequest;m.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const _ in l.headers)m.setRequestHeader(_,l.headers[_]);return l.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=l.credentials==="include",m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let _=m.response;if(l.type==="json")try{_=JSON.parse(m.response)}catch(v){return h(v)}h(null,_,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else h(new Le(m.statusText,m.status,l.url))},m.send(l.body),{cancel:()=>m.abort()}}(r,t)},Re=function(r,t){return be(Ce(r,{type:"arrayBuffer"}),t)},rt=function(r,t){return be(Ce(r,{method:"POST"}),t)},wt=function(r,t){return be(Ce(r,{method:"GET"}),t)};function ct(r){const t=w.document.createElement("a");return t.href=r,t.protocol===w.document.location.protocol&&t.host===w.document.location.host}const jt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let lt,_e;lt=[],_e=0;const qe=function(r,t){if(xt.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),_e>=tt.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:r,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return lt.push(m),m}_e++;let n=!1;const l=()=>{if(!n)for(n=!0,_e--;lt.length&&_e<tt.MAX_PARALLEL_IMAGE_REQUESTS;){const m=lt.shift(),{requestParameters:_,callback:v,cancelled:T}=m;T||(m.cancel=qe(_,v).cancel)}},h=Re(r,(m,_,v,T)=>{l(),m?t(m):_&&(w.createImageBitmap?function(E,M){const P=new w.Blob([new Uint8Array(E)],{type:"image/png"});w.createImageBitmap(P).then(z=>{M(null,z)}).catch(z=>{M(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(E,M)=>t(E,M,v,T)):function(E,M){const P=new w.Image,z=w.URL;P.onload=()=>{M(null,P),z.revokeObjectURL(P.src),P.onload=null,w.requestAnimationFrame(()=>{P.src=jt})},P.onerror=()=>M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const F=new w.Blob([new Uint8Array(E)],{type:"image/png"});P.src=E.byteLength?z.createObjectURL(F):jt}(_,(E,M)=>t(E,M,v,T)))});return{cancel:()=>{h.cancel(),l()}}};function pt(r,t,n){n[r]&&n[r].indexOf(t)!==-1||(n[r]=n[r]||[],n[r].push(t))}function qt(r,t,n){if(n&&n[r]){const l=n[r].indexOf(t);l!==-1&&n[r].splice(l,1)}}class ti{constructor(t,n={}){Ce(this,n),this.type=t}}class Jt extends ti{constructor(t,n={}){super("error",Ce({error:t},n))}}class kt{on(t,n){return this._listeners=this._listeners||{},pt(t,n,this._listeners),this}off(t,n){return qt(t,n,this._listeners),qt(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},pt(t,n,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,n){typeof t=="string"&&(t=new ti(t,n||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const v of h)v.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const v of m)qt(l,v,this._oneTimeListeners),v.call(this,t);const _=this._eventedParent;_&&(Ce(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof Jt&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var Ve=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Sn(r,...t){for(const n of t)for(const l in n)r[l]=n[l];return r}function vi(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Gr(r){if(Array.isArray(r))return r.map(Gr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const n in r)t[n]=Gr(r[n]);return t}return vi(r)}class To extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}var qr=To;class lc{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[l,h]of n)this.bindings[l]=h}concat(t){return new lc(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var c_=lc;const Ko={kind:"null"},Et={kind:"number"},hi={kind:"string"},di={kind:"boolean"},Wr={kind:"color"},Hr={kind:"object"},ii={kind:"value"},Za={kind:"collator"},Xa={kind:"formatted"},Ka={kind:"resolvedImage"};function Tr(r,t){return{kind:"array",itemType:r,N:t}}function an(r){if(r.kind==="array"){const t=an(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Rf=[Ko,Et,hi,di,Wr,Xa,Hr,Tr(ii),Ka];function Yo(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Yo(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const n of Rf)if(!Yo(n,t))return null}}return`Expected ${an(r)} but found ${an(t)} instead.`}function cc(r,t){return t.some(n=>n.kind===r.kind)}function Ks(r,t){return t.some(n=>n==="null"?r===null:n==="array"?Array.isArray(r):n==="object"?r&&!Array.isArray(r)&&typeof r=="object":n===typeof r)}function Hu(r){var t={exports:{}};return r(t,t.exports),t.exports}var Ys=Hu(function(r,t){var n={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l(v){return(v=Math.round(v))<0?0:v>255?255:v}function h(v){return l(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function m(v){return(T=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:T>1?1:T;var T}function _(v,T,E){return E<0?E+=1:E>1&&(E-=1),6*E<1?v+(T-v)*E*6:2*E<1?T:3*E<2?v+(T-v)*(2/3-E)*6:v}try{t.parseCSSColor=function(v){var T,E=v.replace(/ /g,"").toLowerCase();if(E in n)return n[E].slice();if(E[0]==="#")return E.length===4?(T=parseInt(E.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:E.length===7&&(T=parseInt(E.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var M=E.indexOf("("),P=E.indexOf(")");if(M!==-1&&P+1===E.length){var z=E.substr(0,M),F=E.substr(M+1,P-(M+1)).split(","),B=1;switch(z){case"rgba":if(F.length!==4)return null;B=m(F.pop());case"rgb":return F.length!==3?null:[h(F[0]),h(F[1]),h(F[2]),B];case"hsla":if(F.length!==4)return null;B=m(F.pop());case"hsl":if(F.length!==3)return null;var G=(parseFloat(F[0])%360+360)%360/360,Z=m(F[1]),oe=m(F[2]),me=oe<=.5?oe*(Z+1):oe+Z-oe*Z,le=2*oe-me;return[l(255*_(le,me,G+1/3)),l(255*_(le,me,G)),l(255*_(le,me,G-1/3)),B];default:return null}}return null}}catch{}});class ir{constructor(t,n,l,h=1){this.r=t,this.g=n,this.b=l,this.a=h}static parse(t){if(!t)return;if(t instanceof ir)return t;if(typeof t!="string")return;const n=Ys.parseCSSColor(t);return n?new ir(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[t,n,l,h]=this.toArray();return`rgba(${Math.round(t)},${Math.round(n)},${Math.round(l)},${h})`}toArray(){const{r:t,g:n,b:l,a:h}=this;return h===0?[0,0,0,0]:[255*t/h,255*n/h,255*l/h,h]}toArray01(){const{r:t,g:n,b:l,a:h}=this;return h===0?[0,0,0,0]:[t/h,n/h,l/h,h]}toArray01PremultipliedAlpha(){const{r:t,g:n,b:l,a:h}=this;return[t,n,l,h]}}ir.black=new ir(0,0,0,1),ir.white=new ir(1,1,1,1),ir.transparent=new ir(0,0,0,0),ir.red=new ir(1,0,0,1),ir.blue=new ir(0,0,1,1);var Fi=ir;class Zu{constructor(t,n,l){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ya{constructor(t,n,l,h,m){this.text=t.normalize?t.normalize():t,this.image=n,this.scale=l,this.fontStack=h,this.textColor=m}}class hr{constructor(t){this.sections=t}static fromString(t){return new hr([new Ya(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof hr?t:hr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const n of this.sections){if(n.image){t.push(["image",n.image.name]);continue}t.push(n.text);const l={};n.fontStack&&(l["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(l["font-scale"]=n.scale),n.textColor&&(l["text-color"]=["rgba"].concat(n.textColor.toArray())),t.push(l)}return t}}class dr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new dr({name:t,available:!1}):null}serialize(){return["image",this.name]}}function Xu(r,t,n,l){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,t,n,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,t,n,l]:[r,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qs(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Fi||r instanceof Zu||r instanceof hr||r instanceof dr)return!0;if(Array.isArray(r)){for(const t of r)if(!Qs(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Qs(r[t]))return!1;return!0}return!1}function _n(r){if(r===null)return Ko;if(typeof r=="string")return hi;if(typeof r=="boolean")return di;if(typeof r=="number")return Et;if(r instanceof Fi)return Wr;if(r instanceof Zu)return Za;if(r instanceof hr)return Xa;if(r instanceof dr)return Ka;if(Array.isArray(r)){const t=r.length;let n;for(const l of r){const h=_n(l);if(n){if(n===h)continue;n=ii;break}n=h}return Tr(n||ii,t)}return Hr}function Qa(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Fi||r instanceof hr||r instanceof dr?r.toString():JSON.stringify(r)}class Ku{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Qs(t[1]))return n.error("invalid value");const l=t[1];let h=_n(l);const m=n.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Ku(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Fi?["rgba"].concat(this.value.toArray()):this.value instanceof hr?this.value.serialize():this.value}}var Ja=Ku,In=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const el={string:hi,number:Et,boolean:di,object:Hr};class Yu{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let l,h=1;const m=t[0];if(m==="array"){let v,T;if(t.length>2){const E=t[1];if(typeof E!="string"||!(E in el)||E==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=el[E],h++}else v=ii;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);T=t[2],h++}l=Tr(v,T)}else l=el[m];const _=[];for(;h<t.length;h++){const v=n.parse(t[h],h,ii);if(!v)return null;_.push(v)}return new Yu(l,_)}evaluate(t){for(let n=0;n<this.args.length;n++){const l=this.args[n].evaluate(t);if(!Yo(this.type,_n(l)))return l;if(n===this.args.length-1)throw new In(`Expected value to be of type ${an(this.type)}, but found ${an(_n(l))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,n=[t.kind];if(t.kind==="array"){const l=t.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){n.push(l.kind);const h=t.N;(typeof h=="number"||this.args.length>1)&&n.push(h)}}return n.concat(this.args.map(l=>l.serialize()))}}var kr=Yu;class tl{constructor(t){this.type=Xa,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");const h=[];let m=!1;for(let _=1;_<=t.length-1;++_){const v=t[_];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let T=null;if(v["font-scale"]&&(T=n.parse(v["font-scale"],1,Et),!T))return null;let E=null;if(v["text-font"]&&(E=n.parse(v["text-font"],1,Tr(hi)),!E))return null;let M=null;if(v["text-color"]&&(M=n.parse(v["text-color"],1,Wr),!M))return null;const P=h[h.length-1];P.scale=T,P.font=E,P.textColor=M}else{const T=n.parse(t[_],1,ii);if(!T)return null;const E=T.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:T,scale:null,font:null,textColor:null})}}return new tl(h)}evaluate(t){return new hr(this.sections.map(n=>{const l=n.content.evaluate(t);return _n(l)===Ka?new Ya("",l,null,null,null):new Ya(Qa(l),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const n of this.sections){t.push(n.content.serialize());const l={};n.scale&&(l["font-scale"]=n.scale.serialize()),n.font&&(l["text-font"]=n.font.serialize()),n.textColor&&(l["text-color"]=n.textColor.serialize()),t.push(l)}return t}}class uc{constructor(t){this.type=Ka,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const l=n.parse(t[1],1,hi);return l?new uc(l):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),l=dr.fromString(n);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(n)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const u_={"to-boolean":di,"to-color":Wr,"to-number":Et,"to-string":hi};class Qu{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const l=t[0];if((l==="to-boolean"||l==="to-string")&&t.length!==2)return n.error("Expected one argument.");const h=u_[l],m=[];for(let _=1;_<t.length;_++){const v=n.parse(t[_],_,ii);if(!v)return null;m.push(v)}return new Qu(h,m)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let n,l;for(const h of this.args){if(n=h.evaluate(t),l=null,n instanceof Fi)return n;if(typeof n=="string"){const m=t.parseColor(n);if(m)return m}else if(Array.isArray(n)&&(l=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Xu(n[0],n[1],n[2],n[3]),!l))return new Fi(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new In(l||`Could not parse color from value '${typeof n=="string"?n:String(JSON.stringify(n))}'`)}if(this.type.kind==="number"){let n=null;for(const l of this.args){if(n=l.evaluate(t),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new In(`Could not convert ${JSON.stringify(n)} to number.`)}return this.type.kind==="formatted"?hr.fromString(Qa(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?dr.fromString(Qa(this.args[0].evaluate(t))):Qa(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new tl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new uc(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(n=>{t.push(n.serialize())}),t}}var Qo=Qu;const h_=["Unknown","Point","LineString","Polygon"];var Df=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?h_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:n,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*t-r[0])+this.featureDistanceData.bearing[1]*(l*t-r[1])}return 0}parseColor(r){let t=this._parseColorCache[r];return t||(t=this._parseColorCache[r]=Fi.parse(r)),t}};class Eo{constructor(t,n,l,h){this.name=t,this.type=n,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,n){const l=t[0],h=Eo.definitions[l];if(!h)return n.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,_=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=_.filter(([E])=>!Array.isArray(E)||E.length===t.length-1);let T=null;for(const[E,M]of v){T=new Ao(n.registry,n.path,null,n.scope);const P=[];let z=!1;for(let F=1;F<t.length;F++){const B=t[F],G=Array.isArray(E)?E[F-1]:E.type,Z=T.parse(B,1+P.length,G);if(!Z){z=!0;break}P.push(Z)}if(!z)if(Array.isArray(E)&&E.length!==P.length)T.error(`Expected ${E.length} arguments, but found ${P.length} instead.`);else{for(let F=0;F<P.length;F++){const B=Array.isArray(E)?E[F]:E.type,G=P[F];T.concat(F+1).checkSubtype(B,G.type)}if(T.errors.length===0)return new Eo(l,m,M,P)}}if(v.length===1)n.errors.push(...T.errors);else{const E=(v.length?v:_).map(([P])=>{return z=P,Array.isArray(z)?`(${z.map(an).join(", ")})`:`(${an(z.type)}...)`;var z}).join(" | "),M=[];for(let P=1;P<t.length;P++){const z=n.parse(t[P],1+M.length);if(!z)return null;M.push(an(z.type))}n.error(`Expected arguments of type ${E}, but found (${M.join(", ")}) instead.`)}return null}static register(t,n){Eo.definitions=n;for(const l in n)t[l]=Eo}}var Zr=Eo;class hc{constructor(t,n,l){this.type=Za,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");const h=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,di);if(!h)return null;const m=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,di);if(!m)return null;let _=null;return l.locale&&(_=n.parse(l.locale,1,hi),!_)?null:new hc(h,m,_)}evaluate(t){return new Zu(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Js=8192;function Ju(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function dc(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function d_(r,t){const n=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(n*h*Js),Math.round(l*h*Js)]}function f_(r,t,n){const l=r[0]-t[0],h=r[1]-t[1],m=r[0]-n[0],_=r[1]-n[1];return l*_-m*h==0&&l*m<=0&&h*_<=0}function fc(r,t){let n=!1;for(let _=0,v=t.length;_<v;_++){const T=t[_];for(let E=0,M=T.length;E<M-1;E++){if(f_(r,T[E],T[E+1]))return!1;(h=T[E])[1]>(l=r)[1]!=(m=T[E+1])[1]>l[1]&&l[0]<(m[0]-h[0])*(l[1]-h[1])/(m[1]-h[1])+h[0]&&(n=!n)}}var l,h,m;return n}function pc(r,t){for(let n=0;n<t.length;n++)if(fc(r,t[n]))return!0;return!1}function Of(r,t,n,l){const h=l[0]-n[0],m=l[1]-n[1],_=(r[0]-n[0])*m-h*(r[1]-n[1]),v=(t[0]-n[0])*m-h*(t[1]-n[1]);return _>0&&v<0||_<0&&v>0}function p_(r,t,n){for(const E of n)for(let M=0;M<E.length-1;++M)if((v=[(_=E[M+1])[0]-(m=E[M])[0],_[1]-m[1]])[0]*(T=[(h=t)[0]-(l=r)[0],h[1]-l[1]])[1]-v[1]*T[0]!=0&&Of(l,h,m,_)&&Of(m,_,l,h))return!0;var l,h,m,_,v,T;return!1}function Ff(r,t){for(let n=0;n<r.length;++n)if(!fc(r[n],t))return!1;for(let n=0;n<r.length-1;++n)if(p_(r[n],r[n+1],t))return!1;return!0}function m_(r,t){for(let n=0;n<t.length;n++)if(Ff(r,t[n]))return!0;return!1}function Lr(r,t,n){const l=[];for(let h=0;h<r.length;h++){const m=[];for(let _=0;_<r[h].length;_++){const v=d_(r[h][_],n);Ju(t,v),m.push(v)}l.push(m)}return l}function eh(r,t,n){const l=[];for(let h=0;h<r.length;h++){const m=Lr(r[h],t,n);l.push(m)}return l}function th(r,t,n,l){if(r[0]<n[0]||r[0]>n[2]){const h=.5*l;let m=r[0]-n[0]>h?-l:n[0]-r[0]>h?l:0;m===0&&(m=r[0]-n[2]>h?-l:n[2]-r[0]>h?l:0),r[0]+=m}Ju(t,r)}function ih(r,t,n,l){const h=Math.pow(2,l.z)*Js,m=[l.x*Js,l.y*Js],_=[];if(!r)return _;for(const v of r)for(const T of v){const E=[T.x+m[0],T.y+m[1]];th(E,t,n,h),_.push(E)}return _}function nh(r,t,n,l){const h=Math.pow(2,l.z)*Js,m=[l.x*Js,l.y*Js],_=[];if(!r)return _;for(const T of r){const E=[];for(const M of T){const P=[M.x+m[0],M.y+m[1]];Ju(t,P),E.push(P)}_.push(E)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const T of _)for(const E of T)th(E,t,n,h)}var v;return _}class Jo{constructor(t,n){this.type=di,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qs(t[1])){const l=t[1];if(l.type==="FeatureCollection")for(let h=0;h<l.features.length;++h){const m=l.features[h].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Jo(l,l.features[h].geometry)}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Jo(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Jo(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(!_)return!1;if(l.type==="Polygon"){const v=Lr(l.coordinates,m,_),T=ih(n.geometry(),h,m,_);if(!dc(h,m))return!1;for(const E of T)if(!fc(E,v))return!1}if(l.type==="MultiPolygon"){const v=eh(l.coordinates,m,_),T=ih(n.geometry(),h,m,_);if(!dc(h,m))return!1;for(const E of T)if(!pc(E,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(!_)return!1;if(l.type==="Polygon"){const v=Lr(l.coordinates,m,_),T=nh(n.geometry(),h,m,_);if(!dc(h,m))return!1;for(const E of T)if(!Ff(E,v))return!1}if(l.type==="MultiPolygon"){const v=eh(l.coordinates,m,_),T=nh(n.geometry(),h,m,_);if(!dc(h,m))return!1;for(const E of T)if(!m_(E,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var mc=Jo;function So(r){if(r instanceof Zr&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof mc)return!1;let t=!0;return r.eachChild(n=>{t&&!So(n)&&(t=!1)}),t}function eo(r){if(r instanceof Zr&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(n=>{t&&!eo(n)&&(t=!1)}),t}function il(r,t){if(r instanceof Zr&&t.indexOf(r.name)>=0)return!1;let n=!0;return r.eachChild(l=>{n&&!il(l,t)&&(n=!1)}),n}class gc{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const l=t[1];return n.scope.has(l)?new gc(l,n.scope.get(l)):n.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var _c=gc;class yc{constructor(t,n=[],l,h=new c_,m=[]){this.registry=t,this.path=n,this.key=n.map(_=>`[${_}]`).join(""),this.scope=h,this.errors=m,this.expectedType=l}parse(t,n,l,h,m={}){return n?this.concat(n,l,h)._parse(t,m):this._parse(t,m)}_parse(t,n){function l(h,m,_){return _==="assert"?new kr(m,[h]):_==="coerce"?new Qo(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let _=m.parse(t,this);if(!_)return null;if(this.expectedType){const v=this.expectedType,T=_.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else _=l(_,v,n.typeAnnotation||"coerce");else _=l(_,v,n.typeAnnotation||"assert")}if(!(_ instanceof Ja)&&_.type.kind!=="resolvedImage"&&Ii(_)){const v=new Df;try{_=new Ja(_.type,_.evaluate(v))}catch(T){return this.error(T.message),null}}return _}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,l){const h=typeof t=="number"?this.path.concat(t):this.path,m=l?this.scope.concat(l):this.scope;return new yc(this.registry,h,n||null,m,this.errors)}error(t,...n){const l=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new qr(l,t))}checkSubtype(t,n){const l=Yo(t,n);return l&&this.error(l),l}}var Ao=yc;function Ii(r){if(r instanceof _c)return Ii(r.boundExpression);if(r instanceof Zr&&r.name==="error"||r instanceof hc||r instanceof mc)return!1;const t=r instanceof Qo||r instanceof kr;let n=!0;return r.eachChild(l=>{n=t?n&&Ii(l):n&&l instanceof Ja}),!!n&&So(r)&&il(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function vc(r,t){const n=r.length-1;let l,h,m=0,_=n,v=0;for(;m<=_;)if(v=Math.floor((m+_)/2),l=r[v],h=r[v+1],l<=t){if(v===n||t<h)return v;m=v+1}else{if(!(l>t))throw new In("Input is not a number.");_=v-1}return 0}class rh{constructor(t,n,l){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[h,m]of l)this.labels.push(h),this.outputs.push(m)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const l=n.parse(t[1],1,Et);if(!l)return null;const h=[];let m=null;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);for(let _=1;_<t.length;_+=2){const v=_===1?-1/0:t[_],T=t[_+1],E=_,M=_+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(h.length&&h[h.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const P=n.parse(T,M,m);if(!P)return null;m=m||P.type,h.push([v,P])}return new rh(m,l,h)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return l[0].evaluate(t);const m=n.length;return h>=n[m-1]?l[m-1].evaluate(t):l[vc(n,h)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&t.push(this.labels[n]),t.push(this.outputs[n].serialize());return t}}var sh=rh;function Ti(r,t,n){return r*(1-n)+t*n}function ea(r,t,n){return r.map((l,h)=>Ti(l,t[h],n))}var nl=Object.freeze({__proto__:null,number:Ti,color:function(r,t,n){return new Fi(Ti(r.r,t.r,n),Ti(r.g,t.g,n),Ti(r.b,t.b,n),Ti(r.a,t.a,n))},array:ea});const oh=.95047,ah=1.08883,lh=4/29,to=6/29,rl=3*to*to,g_=Math.PI/180,ch=180/Math.PI;function xc(r){return r>.008856451679035631?Math.pow(r,1/3):r/rl+lh}function uh(r){return r>to?r*r*r:rl*(r-lh)}function hh(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function bc(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Bf(r){const t=bc(r.r),n=bc(r.g),l=bc(r.b),h=xc((.4124564*t+.3575761*n+.1804375*l)/oh),m=xc((.2126729*t+.7151522*n+.072175*l)/1);return{l:116*m-16,a:500*(h-m),b:200*(m-xc((.0193339*t+.119192*n+.9503041*l)/ah)),alpha:r.a}}function dh(r){let t=(r.l+16)/116,n=isNaN(r.a)?t:t+r.a/500,l=isNaN(r.b)?t:t-r.b/200;return t=1*uh(t),n=oh*uh(n),l=ah*uh(l),new Fi(hh(3.2404542*n-1.5371385*t-.4985314*l),hh(-.969266*n+1.8760108*t+.041556*l),hh(.0556434*n-.2040259*t+1.0572252*l),r.alpha)}function Nf(r,t,n){const l=t-r;return r+n*(l>180||l<-180?l-360*Math.round(l/360):l)}const sl={forward:Bf,reverse:dh,interpolate:function(r,t,n){return{l:Ti(r.l,t.l,n),a:Ti(r.a,t.a,n),b:Ti(r.b,t.b,n),alpha:Ti(r.alpha,t.alpha,n)}}},ta={forward:function(r){const{l:t,a:n,b:l}=Bf(r),h=Math.atan2(l,n)*ch;return{h:h<0?h+360:h,c:Math.sqrt(n*n+l*l),l:t,alpha:r.a}},reverse:function(r){const t=r.h*g_,n=r.c;return dh({l:r.l,a:Math.cos(t)*n,b:Math.sin(t)*n,alpha:r.alpha})},interpolate:function(r,t,n){return{h:Nf(r.h,t.h,n),c:Ti(r.c,t.c,n),l:Ti(r.l,t.l,n),alpha:Ti(r.alpha,t.alpha,n)}}};var Uf=Object.freeze({__proto__:null,lab:sl,hcl:ta});class ol{constructor(t,n,l,h,m){this.type=t,this.operator=n,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[_,v]of m)this.labels.push(_),this.outputs.push(v)}static interpolationFactor(t,n,l,h){let m=0;if(t.name==="exponential")m=wc(n,t.base,l,h);else if(t.name==="linear")m=wc(n,1,l,h);else if(t.name==="cubic-bezier"){const _=t.controlPoints;m=new C(_[0],_[1],_[2],_[3]).solve(wc(n,1,l,h))}return m}static parse(t,n){let[l,h,m,..._]=t;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const E=h[1];if(typeof E!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:E}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const E=h.slice(1);if(E.length!==4||E.some(M=>typeof M!="number"||M<0||M>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:E}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(m=n.parse(m,2,Et),!m)return null;const v=[];let T=null;l==="interpolate-hcl"||l==="interpolate-lab"?T=Wr:n.expectedType&&n.expectedType.kind!=="value"&&(T=n.expectedType);for(let E=0;E<_.length;E+=2){const M=_[E],P=_[E+1],z=E+3,F=E+4;if(typeof M!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(v.length&&v[v.length-1][0]>=M)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const B=n.parse(P,F,T);if(!B)return null;T=T||B.type,v.push([M,B])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new ol(T,l,h,m,v):n.error(`Type ${an(T)} is not interpolatable.`)}evaluate(t){const n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=n[0])return l[0].evaluate(t);const m=n.length;if(h>=n[m-1])return l[m-1].evaluate(t);const _=vc(n,h),v=ol.interpolationFactor(this.interpolation,h,n[_],n[_+1]),T=l[_].evaluate(t),E=l[_+1].evaluate(t);return this.operator==="interpolate"?nl[this.type.kind.toLowerCase()](T,E,v):this.operator==="interpolate-hcl"?ta.reverse(ta.interpolate(ta.forward(T),ta.forward(E),v)):sl.reverse(sl.interpolate(sl.forward(T),sl.forward(E),v))}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,t,this.input.serialize()];for(let l=0;l<this.labels.length;l++)n.push(this.labels[l],this.outputs[l].serialize());return n}}function wc(r,t,n,l){const h=l-n,m=r-n;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}var gs=ol;class fh{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expectected at least one argument.");let l=null;const h=n.expectedType;h&&h.kind!=="value"&&(l=h);const m=[];for(const v of t.slice(1)){const T=n.parse(v,1+m.length,l,void 0,{typeAnnotation:"omit"});if(!T)return null;l=l||T.type,m.push(T)}const _=h&&m.some(v=>Yo(h,v.type));return new fh(_?ii:l,m)}evaluate(t){let n,l=null,h=0;for(const m of this.args){if(h++,l=m.evaluate(t),l&&l instanceof dr&&!l.available&&(n||(n=l),l=null,h===this.args.length))return n;if(l!==null)break}return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(n=>{t.push(n.serialize())}),t}}var Vf=fh;class ph{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let m=1;m<t.length-1;m+=2){const _=t[m];if(typeof _!="string")return n.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return n.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=n.parse(t[m+1],m+1);if(!v)return null;l.push([_,v])}const h=n.parse(t[t.length-1],t.length-1,n.expectedType,l);return h?new ph(l,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[n,l]of this.bindings)t.push(n,l.serialize());return t.push(this.result.serialize()),t}}var $f=ph;class mh{constructor(t,n,l){this.type=t,this.index=n,this.input=l}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,Et),h=n.parse(t[2],2,Tr(n.expectedType||ii));return l&&h?new mh(h.type.itemType,l,h):null}evaluate(t){const n=this.index.evaluate(t),l=this.input.evaluate(t);if(n<0)throw new In(`Array index out of bounds: ${n} < 0.`);if(n>=l.length)throw new In(`Array index out of bounds: ${n} > ${l.length-1}.`);if(n!==Math.floor(n))throw new In(`Array index must be an integer, but found ${n} instead.`);return l[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var jf=mh;class gh{constructor(t,n){this.type=di,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ii),h=n.parse(t[2],2,ii);return l&&h?cc(l.type,[di,hi,Et,Ko,ii])?new gh(l,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(l.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(l==null)return!1;if(!Ks(n,["boolean","string","number","null"]))throw new In(`Expected first argument to be of type boolean, string, number or null, but found ${an(_n(n))} instead.`);if(!Ks(l,["string","array"]))throw new In(`Expected second argument to be of type array or string, but found ${an(_n(l))} instead.`);return l.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var __=gh;class Tc{constructor(t,n,l){this.type=Et,this.needle=t,this.haystack=n,this.fromIndex=l}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ii),h=n.parse(t[2],2,ii);if(!l||!h)return null;if(!cc(l.type,[di,hi,Et,Ko,ii]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(l.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,Et);return m?new Tc(l,h,m):null}return new Tc(l,h)}evaluate(t){const n=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!Ks(n,["boolean","string","number","null"]))throw new In(`Expected first argument to be of type boolean, string, number or null, but found ${an(_n(n))} instead.`);if(!Ks(l,["string","array"]))throw new In(`Expected second argument to be of type array or string, but found ${an(_n(l))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(t);return l.indexOf(n,h)}return l.indexOf(n)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var y_=Tc;class Ec{constructor(t,n,l,h,m,_){this.inputType=t,this.type=n,this.input=l,this.cases=h,this.outputs=m,this.otherwise=_}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let l,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m={},_=[];for(let E=2;E<t.length-1;E+=2){let M=t[E];const P=t[E+1];Array.isArray(M)||(M=[M]);const z=n.concat(E);if(M.length===0)return z.error("Expected at least one branch label.");for(const B of M){if(typeof B!="number"&&typeof B!="string")return z.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return z.error("Numeric branch labels must be integer values.");if(l){if(z.checkSubtype(l,_n(B)))return null}else l=_n(B);if(m[String(B)]!==void 0)return z.error("Branch labels must be unique.");m[String(B)]=_.length}const F=n.parse(P,E,h);if(!F)return null;h=h||F.type,_.push(F)}const v=n.parse(t[1],1,ii);if(!v)return null;const T=n.parse(t[t.length-1],t.length-1,h);return T?v.type.kind!=="value"&&n.concat(1).checkSubtype(l,v.type)?null:new Ec(l,h,v,m,_,T):null}evaluate(t){const n=this.input.evaluate(t);return(_n(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),l=[],h={};for(const _ of n){const v=h[this.cases[_]];v===void 0?(h[this.cases[_]]=l.length,l.push([this.cases[_],[_]])):l[v][1].push(_)}const m=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,v]of l)t.push(v.length===1?m(v[0]):v.map(m)),t.push(this.outputs[_].serialize());return t.push(this.otherwise.serialize()),t}}var Gf=Ec;class Sc{constructor(t,n,l){this.type=t,this.branches=n,this.otherwise=l}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);const h=[];for(let _=1;_<t.length-1;_+=2){const v=n.parse(t[_],_,di);if(!v)return null;const T=n.parse(t[_+1],_+1,l);if(!T)return null;h.push([v,T]),l=l||T.type}const m=n.parse(t[t.length-1],t.length-1,l);return m?new Sc(l,h,m):null}evaluate(t){for(const[n,l]of this.branches)if(n.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,l]of this.branches)t(n),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(n=>{t.push(n.serialize())}),t}}var v_=Sc;class Ac{constructor(t,n,l,h){this.type=t,this.input=n,this.beginIndex=l,this.endIndex=h}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=n.parse(t[1],1,ii),h=n.parse(t[2],2,Et);if(!l||!h)return null;if(!cc(l.type,[Tr(ii),hi,ii]))return n.error(`Expected first argument to be of type array or string, but found ${an(l.type)} instead`);if(t.length===4){const m=n.parse(t[3],3,Et);return m?new Ac(l.type,l,h,m):null}return new Ac(l.type,l,h)}evaluate(t){const n=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!Ks(n,["string","array"]))throw new In(`Expected first argument to be of type array or string, but found ${an(_n(n))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(t);return n.slice(l,h)}return n.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var qf=Ac;function _h(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function yh(r,t,n,l){return l.compare(t,n)===0}function ia(r,t,n){const l=r!=="=="&&r!=="!=";return class oM{constructor(m,_,v){this.type=di,this.lhs=m,this.rhs=_,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const v=m[0];let T=_.parse(m[1],1,ii);if(!T)return null;if(!_h(v,T.type))return _.concat(1).error(`"${v}" comparisons are not supported for type '${an(T.type)}'.`);let E=_.parse(m[2],2,ii);if(!E)return null;if(!_h(v,E.type))return _.concat(2).error(`"${v}" comparisons are not supported for type '${an(E.type)}'.`);if(T.type.kind!==E.type.kind&&T.type.kind!=="value"&&E.type.kind!=="value")return _.error(`Cannot compare types '${an(T.type)}' and '${an(E.type)}'.`);l&&(T.type.kind==="value"&&E.type.kind!=="value"?T=new kr(E.type,[T]):T.type.kind!=="value"&&E.type.kind==="value"&&(E=new kr(T.type,[E])));let M=null;if(m.length===4){if(T.type.kind!=="string"&&E.type.kind!=="string"&&T.type.kind!=="value"&&E.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(M=_.parse(m[3],3,Za),!M)return null}return new oM(T,E,M)}evaluate(m){const _=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){const T=_n(_),E=_n(v);if(T.kind!==E.kind||T.kind!=="string"&&T.kind!=="number")throw new In(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${T.kind}, ${E.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const T=_n(_),E=_n(v);if(T.kind!=="string"||E.kind!=="string")return t(m,_,v)}return this.collator?n(m,_,v,this.collator.evaluate(m)):t(m,_,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[r];return this.eachChild(_=>{m.push(_.serialize())}),m}}}const x_=ia("==",function(r,t,n){return t===n},yh),b_=ia("!=",function(r,t,n){return t!==n},function(r,t,n,l){return!yh(0,t,n,l)}),w_=ia("<",function(r,t,n){return t<n},function(r,t,n,l){return l.compare(t,n)<0}),Cc=ia(">",function(r,t,n){return t>n},function(r,t,n,l){return l.compare(t,n)>0}),Wf=ia("<=",function(r,t,n){return t<=n},function(r,t,n,l){return l.compare(t,n)<=0}),Hf=ia(">=",function(r,t,n){return t>=n},function(r,t,n,l){return l.compare(t,n)>=0});class vh{constructor(t,n,l,h,m,_){this.type=hi,this.number=t,this.locale=n,this.currency=l,this.unit=h,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const l=n.parse(t[1],1,Et);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=n.parse(h.locale,1,hi),!m))return null;let _=null;if(h.currency&&(_=n.parse(h.currency,1,hi),!_))return null;let v=null;if(h.unit&&(v=n.parse(h.unit,1,hi),!v))return null;let T=null;if(h["min-fraction-digits"]&&(T=n.parse(h["min-fraction-digits"],1,Et),!T))return null;let E=null;return h["max-fraction-digits"]&&(E=n.parse(h["max-fraction-digits"],1,Et),!E)?null:new vh(l,m,_,v,T,E)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class xh{constructor(t){this.type=Et,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=n.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${an(l.type)} instead.`):new xh(l):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string"||Array.isArray(n))return n.length;throw new In(`Expected value to be of type string or array, but found ${an(_n(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(n=>{t.push(n.serialize())}),t}}const Zf={"==":x_,"!=":b_,">":Cc,"<":w_,">=":Hf,"<=":Wf,array:kr,at:jf,boolean:kr,case:v_,coalesce:Vf,collator:hc,format:tl,image:uc,in:__,"index-of":y_,interpolate:gs,"interpolate-hcl":gs,"interpolate-lab":gs,length:xh,let:$f,literal:Ja,match:Gf,number:kr,"number-format":vh,object:kr,slice:qf,step:sh,string:kr,"to-boolean":Qo,"to-color":Qo,"to-number":Qo,"to-string":Qo,var:_c,within:mc};function bh(r,[t,n,l,h]){t=t.evaluate(r),n=n.evaluate(r),l=l.evaluate(r);const m=h?h.evaluate(r):1,_=Xu(t,n,l,m);if(_)throw new In(_);return new Fi(t/255*m,n/255*m,l/255*m,m)}function wh(r,t){return r in t}function Mc(r,t){const n=t[r];return n===void 0?null:n}function Is(r){return{type:r}}Zr.register(Zf,{error:[{kind:"error"},[hi],(r,[t])=>{throw new In(t.evaluate(r))}],typeof:[hi,[ii],(r,[t])=>an(_n(t.evaluate(r)))],"to-rgba":[Tr(Et,4),[Wr],(r,[t])=>t.evaluate(r).toArray()],rgb:[Wr,[Et,Et,Et],bh],rgba:[Wr,[Et,Et,Et,Et],bh],has:{type:di,overloads:[[[hi],(r,[t])=>wh(t.evaluate(r),r.properties())],[[hi,Hr],(r,[t,n])=>wh(t.evaluate(r),n.evaluate(r))]]},get:{type:ii,overloads:[[[hi],(r,[t])=>Mc(t.evaluate(r),r.properties())],[[hi,Hr],(r,[t,n])=>Mc(t.evaluate(r),n.evaluate(r))]]},"feature-state":[ii,[hi],(r,[t])=>Mc(t.evaluate(r),r.featureState||{})],properties:[Hr,[],r=>r.properties()],"geometry-type":[hi,[],r=>r.geometryType()],id:[ii,[],r=>r.id()],zoom:[Et,[],r=>r.globals.zoom],pitch:[Et,[],r=>r.globals.pitch||0],"distance-from-center":[Et,[],r=>r.distanceFromCenter()],"heatmap-density":[Et,[],r=>r.globals.heatmapDensity||0],"line-progress":[Et,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[Et,[],r=>r.globals.skyRadialProgress||0],accumulated:[ii,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Et,Is(Et),(r,t)=>{let n=0;for(const l of t)n+=l.evaluate(r);return n}],"*":[Et,Is(Et),(r,t)=>{let n=1;for(const l of t)n*=l.evaluate(r);return n}],"-":{type:Et,overloads:[[[Et,Et],(r,[t,n])=>t.evaluate(r)-n.evaluate(r)],[[Et],(r,[t])=>-t.evaluate(r)]]},"/":[Et,[Et,Et],(r,[t,n])=>t.evaluate(r)/n.evaluate(r)],"%":[Et,[Et,Et],(r,[t,n])=>t.evaluate(r)%n.evaluate(r)],ln2:[Et,[],()=>Math.LN2],pi:[Et,[],()=>Math.PI],e:[Et,[],()=>Math.E],"^":[Et,[Et,Et],(r,[t,n])=>Math.pow(t.evaluate(r),n.evaluate(r))],sqrt:[Et,[Et],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Et,[Et],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Et,[Et],(r,[t])=>Math.log(t.evaluate(r))],log2:[Et,[Et],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Et,[Et],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Et,[Et],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Et,[Et],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Et,[Et],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Et,[Et],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Et,[Et],(r,[t])=>Math.atan(t.evaluate(r))],min:[Et,Is(Et),(r,t)=>Math.min(...t.map(n=>n.evaluate(r)))],max:[Et,Is(Et),(r,t)=>Math.max(...t.map(n=>n.evaluate(r)))],abs:[Et,[Et],(r,[t])=>Math.abs(t.evaluate(r))],round:[Et,[Et],(r,[t])=>{const n=t.evaluate(r);return n<0?-Math.round(-n):Math.round(n)}],floor:[Et,[Et],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Et,[Et],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[di,[hi,ii],(r,[t,n])=>r.properties()[t.value]===n.value],"filter-id-==":[di,[ii],(r,[t])=>r.id()===t.value],"filter-type-==":[di,[hi],(r,[t])=>r.geometryType()===t.value],"filter-<":[di,[hi,ii],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l<h}],"filter-id-<":[di,[ii],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n<l}],"filter->":[di,[hi,ii],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l>h}],"filter-id->":[di,[ii],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n>l}],"filter-<=":[di,[hi,ii],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[di,[ii],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n<=l}],"filter->=":[di,[hi,ii],(r,[t,n])=>{const l=r.properties()[t.value],h=n.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[di,[ii],(r,[t])=>{const n=r.id(),l=t.value;return typeof n==typeof l&&n>=l}],"filter-has":[di,[ii],(r,[t])=>t.value in r.properties()],"filter-has-id":[di,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[di,[Tr(hi)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[di,[Tr(ii)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[di,[hi,Tr(ii)],(r,[t,n])=>n.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[di,[hi,Tr(ii)],(r,[t,n])=>function(l,h,m,_){for(;m<=_;){const v=m+_>>1;if(h[v]===l)return!0;h[v]>l?_=v-1:m=v+1}return!1}(r.properties()[t.value],n.value,0,n.value.length-1)],all:{type:di,overloads:[[[di,di],(r,[t,n])=>t.evaluate(r)&&n.evaluate(r)],[Is(di),(r,t)=>{for(const n of t)if(!n.evaluate(r))return!1;return!0}]]},any:{type:di,overloads:[[[di,di],(r,[t,n])=>t.evaluate(r)||n.evaluate(r)],[Is(di),(r,t)=>{for(const n of t)if(n.evaluate(r))return!0;return!1}]]},"!":[di,[di],(r,[t])=>!t.evaluate(r)],"is-supported-script":[di,[hi],(r,[t])=>{const n=r.globals&&r.globals.isSupportedScript;return!n||n(t.evaluate(r))}],upcase:[hi,[hi],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[hi,[hi],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[hi,Is(ii),(r,t)=>t.map(n=>Qa(n.evaluate(r))).join("")],"resolved-locale":[hi,[Za],(r,[t])=>t.evaluate(r).resolvedLocale()]});var al=Zf;function Xf(r){return{result:"success",value:r}}function na(r){return{result:"error",value:r}}function ra(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Kf(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Th(r){return!!r.expression&&r.expression.interpolated}function ki(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function ll(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Yf(r){return r}function cl(r,t){const n=t.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",h=l||!(l||r.property!==void 0),m=r.type||(Th(t)?"exponential":"interval");if(n&&((r=Sn({},r)).stops&&(r.stops=r.stops.map(E=>[E[0],Fi.parse(E[1])])),r.default=Fi.parse(r.default?r.default:t.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!Uf[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let _,v,T;if(m==="exponential")_=Eh;else if(m==="interval")_=io;else if(m==="categorical"){_=T_,v=Object.create(null);for(const E of r.stops)v[E[0]]=E[1];T=typeof r.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=sa}if(l){const E={},M=[];for(let F=0;F<r.stops.length;F++){const B=r.stops[F],G=B[0].zoom;E[G]===void 0&&(E[G]={zoom:G,type:r.type,property:r.property,default:r.default,stops:[]},M.push(G)),E[G].stops.push([B[0].value,B[1]])}const P=[];for(const F of M)P.push([E[F].zoom,cl(E[F],t)]);const z={name:"linear"};return{kind:"composite",interpolationType:z,interpolationFactor:gs.interpolationFactor.bind(void 0,z),zoomStops:P.map(F=>F[0]),evaluate:({zoom:F},B)=>Eh({stops:P,base:r.base},t,F).evaluate(F,B)}}if(h){const E=m==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:gs.interpolationFactor.bind(void 0,E),zoomStops:r.stops.map(M=>M[0]),evaluate:({zoom:M})=>_(r,t,M,v,T)}}return{kind:"source",evaluate(E,M){const P=M&&M.properties?M.properties[r.property]:void 0;return P===void 0?ul(r.default,t.default):_(r,t,P,v,T)}}}function ul(r,t,n){return r!==void 0?r:t!==void 0?t:n!==void 0?n:void 0}function T_(r,t,n,l,h){return ul(typeof n===h?l[n]:void 0,r.default,t.default)}function io(r,t,n){if(ki(n)!=="number")return ul(r.default,t.default);const l=r.stops.length;if(l===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[l-1][0])return r.stops[l-1][1];const h=vc(r.stops.map(m=>m[0]),n);return r.stops[h][1]}function Eh(r,t,n){const l=r.base!==void 0?r.base:1;if(ki(n)!=="number")return ul(r.default,t.default);const h=r.stops.length;if(h===1||n<=r.stops[0][0])return r.stops[0][1];if(n>=r.stops[h-1][0])return r.stops[h-1][1];const m=vc(r.stops.map(M=>M[0]),n),_=function(M,P,z,F){const B=F-z,G=M-z;return B===0?0:P===1?G/B:(Math.pow(P,G)-1)/(Math.pow(P,B)-1)}(n,l,r.stops[m][0],r.stops[m+1][0]),v=r.stops[m][1],T=r.stops[m+1][1];let E=nl[t.type]||Yf;if(r.colorSpace&&r.colorSpace!=="rgb"){const M=Uf[r.colorSpace];E=(P,z)=>M.reverse(M.interpolate(M.forward(P),M.forward(z),_))}return typeof v.evaluate=="function"?{evaluate(...M){const P=v.evaluate.apply(void 0,M),z=T.evaluate.apply(void 0,M);if(P!==void 0&&z!==void 0)return E(P,z,_)}}:E(v,T,_)}function sa(r,t,n){return t.type==="color"?n=Fi.parse(n):t.type==="formatted"?n=hr.fromString(n.toString()):t.type==="resolvedImage"?n=dr.fromString(n.toString()):ki(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0),ul(n,r.default,t.default)}class Sh{constructor(t,n){this.expression=t,this._warningHistory={},this._evaluator=new Df,this._defaultValue=n?function(l){return l.type==="color"&&(ll(l.default)||Array.isArray(l.default))?new Fi(0,0,0,0):l.type==="color"?Fi.parse(l.default)||null:l.default===void 0?null:l.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,l,h,m,_,v,T){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(t,n,l,h,m,_,v,T){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=T||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new In(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function Ic(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in al}function oa(r,t){const n=new Ao(al,[],t?function(h){const m={color:Wr,string:hi,number:Et,enum:hi,boolean:di,formatted:Xa,resolvedImage:Ka};return h.type==="array"?Tr(m[h.value]||ii,h.length):m[h.type]}(t):void 0),l=n.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Xf(new Sh(l,t)):na(n.errors)}class Ah{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!eo(n.expression)}evaluateWithoutErrorHandling(t,n,l,h,m,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,h,m,_)}evaluate(t,n,l,h,m,_){return this._styleExpression.evaluate(t,n,l,h,m,_)}}class hl{constructor(t,n,l,h){this.kind=t,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!eo(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,n,l,h,m,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,l,h,m,_)}evaluate(t,n,l,h,m,_){return this._styleExpression.evaluate(t,n,l,h,m,_)}interpolationFactor(t,n,l){return this.interpolationType?gs.interpolationFactor(this.interpolationType,t,n,l):0}}function Ch(r,t){if((r=oa(r,t)).result==="error")return r;const n=r.value.expression,l=So(n);if(!l&&!ra(t))return na([new qr("","data expressions not supported")]);const h=il(n,["zoom","pitch","distance-from-center"]);if(!h&&!Kf(t))return na([new qr("","zoom expressions not supported")]);const m=la(n);return m||h?m instanceof qr?na([m]):m instanceof gs&&!Th(t)?na([new qr("",'"interpolate" expressions cannot be used with this property')]):Xf(m?new hl(l?"camera":"composite",r.value,m.labels,m instanceof gs?m.interpolation:void 0):new Ah(l?"constant":"source",r.value)):na([new qr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class aa{constructor(t,n){this._parameters=t,this._specification=n,Sn(this,cl(this._parameters,this._specification))}static deserialize(t){return new aa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function la(r){let t=null;if(r instanceof $f)t=la(r.result);else if(r instanceof Vf){for(const n of r.args)if(t=la(n),t)break}else(r instanceof sh||r instanceof gs)&&r.input instanceof Zr&&r.input.name==="zoom"&&(t=r);return t instanceof qr||r.eachChild(n=>{const l=la(n);l instanceof qr?t=l:!t&&l?t=new qr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new qr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class St{constructor(t,n,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function Er(r){const t=r.key,n=r.value,l=r.valueSpec||{},h=r.objectElementValidators||{},m=r.style,_=r.styleSpec;let v=[];const T=ki(n);if(T!=="object")return[new St(t,n,`object expected, ${T} found`)];for(const E in n){const M=E.split(".")[0],P=l[M]||l["*"];let z;h[M]?z=h[M]:l[M]?z=Dn:h["*"]?z=h["*"]:l["*"]&&(z=Dn),z?v=v.concat(z({key:(t&&`${t}.`)+E,value:n[E],valueSpec:P,style:m,styleSpec:_,object:n,objectKey:E},n)):v.push(new St(t,n[E],`unknown property "${E}"`))}for(const E in l)h[E]||l[E].required&&l[E].default===void 0&&n[E]===void 0&&v.push(new St(t,n,`missing required property "${E}"`));return v}function Mh(r){const t=r.value,n=r.valueSpec,l=r.style,h=r.styleSpec,m=r.key,_=r.arrayElementValidator||Dn;if(ki(t)!=="array")return[new St(m,t,`array expected, ${ki(t)} found`)];if(n.length&&t.length!==n.length)return[new St(m,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new St(m,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let v={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};h.$version<7&&(v.function=n.function),ki(n.value)==="object"&&(v=n.value);let T=[];for(let E=0;E<t.length;E++)T=T.concat(_({array:t,arrayIndex:E,value:t[E],valueSpec:v,style:l,styleSpec:h,key:`${m}[${E}]`}));return T}function Ih(r){const t=r.key,n=r.value,l=r.valueSpec;let h=ki(n);if(h==="number"&&n!=n&&(h="NaN"),h!=="number")return[new St(t,n,`number expected, ${h} found`)];if("minimum"in l){let m=l.minimum;if(ki(l.minimum)==="array"&&(m=l.minimum[r.arrayIndex]),n<m)return[new St(t,n,`${n} is less than the minimum value ${m}`)]}if("maximum"in l){let m=l.maximum;if(ki(l.maximum)==="array"&&(m=l.maximum[r.arrayIndex]),n>m)return[new St(t,n,`${n} is greater than the maximum value ${m}`)]}return[]}function dl(r){const t=r.valueSpec,n=vi(r.value.type);let l,h,m,_={};const v=n!=="categorical"&&r.value.property===void 0,T=!v,E=ki(r.value.stops)==="array"&&ki(r.value.stops[0])==="array"&&ki(r.value.stops[0][0])==="object",M=Er({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(F){if(n==="identity")return[new St(F.key,F.value,'identity function may not have a "stops" property')];let B=[];const G=F.value;return B=B.concat(Mh({key:F.key,value:G,valueSpec:F.valueSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:P})),ki(G)==="array"&&G.length===0&&B.push(new St(F.key,G,"array must have at least one stop")),B},default:function(F){return Dn({key:F.key,value:F.value,valueSpec:t,style:F.style,styleSpec:F.styleSpec})}}});return n==="identity"&&v&&M.push(new St(r.key,r.value,'missing required property "property"')),n==="identity"||r.value.stops||M.push(new St(r.key,r.value,'missing required property "stops"')),n==="exponential"&&r.valueSpec.expression&&!Th(r.valueSpec)&&M.push(new St(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(T&&!ra(r.valueSpec)?M.push(new St(r.key,r.value,"property functions not supported")):v&&!Kf(r.valueSpec)&&M.push(new St(r.key,r.value,"zoom functions not supported"))),n!=="categorical"&&!E||r.value.property!==void 0||M.push(new St(r.key,r.value,'"property" property is required')),M;function P(F){let B=[];const G=F.value,Z=F.key;if(ki(G)!=="array")return[new St(Z,G,`array expected, ${ki(G)} found`)];if(G.length!==2)return[new St(Z,G,`array length 2 expected, length ${G.length} found`)];if(E){if(ki(G[0])!=="object")return[new St(Z,G,`object expected, ${ki(G[0])} found`)];if(G[0].zoom===void 0)return[new St(Z,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new St(Z,G,"object stop key must have value")];const oe=vi(G[0].zoom);if(typeof oe!="number")return[new St(Z,G[0].zoom,"stop zoom values must be numbers")];if(m&&m>oe)return[new St(Z,G[0].zoom,"stop zoom values must appear in ascending order")];oe!==m&&(m=oe,h=void 0,_={}),B=B.concat(Er({key:`${Z}[0]`,value:G[0],valueSpec:{zoom:{}},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:Ih,value:z}}))}else B=B.concat(z({key:`${Z}[0]`,value:G[0],valueSpec:{},style:F.style,styleSpec:F.styleSpec},G));return Ic(Gr(G[1]))?B.concat([new St(`${Z}[1]`,G[1],"expressions are not allowed in function stops.")]):B.concat(Dn({key:`${Z}[1]`,value:G[1],valueSpec:t,style:F.style,styleSpec:F.styleSpec}))}function z(F,B){const G=ki(F.value),Z=vi(F.value),oe=F.value!==null?F.value:B;if(l){if(G!==l)return[new St(F.key,oe,`${G} stop domain type must match previous stop domain type ${l}`)]}else l=G;if(G!=="number"&&G!=="string"&&G!=="boolean"&&typeof Z!="number"&&typeof Z!="string"&&typeof Z!="boolean")return[new St(F.key,oe,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&n!=="categorical"){let me=`number expected, ${G} found`;return ra(t)&&n===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new St(F.key,oe,me)]}return n!=="categorical"||G!=="number"||typeof Z=="number"&&isFinite(Z)&&Math.floor(Z)===Z?n!=="categorical"&&G==="number"&&typeof Z=="number"&&typeof h=="number"&&h!==void 0&&Z<h?[new St(F.key,oe,"stop domain values must appear in ascending order")]:(h=Z,n==="categorical"&&Z in _?[new St(F.key,oe,"stop domain values must be unique")]:(_[Z]=!0,[])):[new St(F.key,oe,`integer expected, found ${String(Z)}`)]}}function Xr(r){const t=(r.expressionContext==="property"?Ch:oa)(Gr(r.value),r.valueSpec);if(t.result==="error")return t.value.map(l=>new St(`${r.key}${l.key}`,r.value,l.message));const n=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!n.outputDefined())return[new St(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!eo(n))return[new St(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return Ph(n,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!il(n,["zoom","feature-state"]))return[new St(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!So(n))return[new St(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ph(r,t){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const h of t.valueSpec.expression.parameters)n.delete(h);if(n.size===0)return[];const l=[];return r instanceof Zr&&n.has(r.name)?[new St(t.key,t.value,`["${r.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(r.eachChild(h=>{l.push(...Ph(h,t))}),l)}function fl(r){const t=r.key,n=r.value,l=r.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(vi(n))===-1&&h.push(new St(t,n,`expected one of [${l.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(l.values).indexOf(vi(n))===-1&&h.push(new St(t,n,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function pl(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!pl(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function ml(r,t="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};pl(r)||(r=Pc(r));const n=r;let l=!0;try{l=function(E){if(!Ps(E))return E;let M=Gr(E);return kh(M),M=Qf(M),M}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(n,null,2)}
        `)}const h=Ve[`filter_${t}`],m=oa(l,h);let _=null;if(m.result==="error")throw new Error(m.value.map(E=>`${E.key}: ${E.message}`).join(", "));_=(E,M,P)=>m.value.evaluate(E,M,{},P);let v=null,T=null;if(l!==n){const E=oa(n,h);if(E.result==="error")throw new Error(E.value.map(M=>`${M.key}: ${M.message}`).join(", "));v=(M,P,z,F,B)=>E.value.evaluate(M,P,{},z,void 0,void 0,F,B),T=!So(E.value.expression)}return _=_,{filter:_,dynamicFilter:v||void 0,needGeometry:Jf(l),needFeature:!!T}}function Qf(r){if(!Array.isArray(r))return r;const t=function(n){if(E_.has(n[0])){for(let l=1;l<n.length;l++)if(Ps(n[l]))return!0}return n}(r);return t===!0?t:t.map(n=>Qf(n))}function kh(r){let t=!1;const n=[];if(r[0]==="case"){for(let l=1;l<r.length-1;l+=2)t=t||Ps(r[l]),n.push(r[l+1]);n.push(r[r.length-1])}else if(r[0]==="match"){t=t||Ps(r[1]);for(let l=2;l<r.length-1;l+=2)n.push(r[l+1]);n.push(r[r.length-1])}else if(r[0]==="step"){t=t||Ps(r[1]);for(let l=1;l<r.length-1;l+=2)n.push(r[l+1])}t&&(r.length=0,r.push("any",...n));for(let l=1;l<r.length;l++)kh(r[l])}function Ps(r){if(!Array.isArray(r))return!1;if((t=r[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let n=1;n<r.length;n++)if(Ps(r[n]))return!0;return!1}const E_=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function S_(r,t){return r<t?-1:r>t?1:0}function Jf(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let t=1;t<r.length;t++)if(Jf(r[t]))return!0;return!1}function Pc(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?Lh(r[1],r[2],"=="):t==="!="?Wn(Lh(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Lh(r[1],r[2],t):t==="any"?(n=r.slice(1),["any"].concat(n.map(Pc))):t==="all"?["all"].concat(r.slice(1).map(Pc)):t==="none"?["all"].concat(r.slice(1).map(Pc).map(Wn)):t==="in"?gl(r[1],r.slice(2)):t==="!in"?Wn(gl(r[1],r.slice(2))):t==="has"?_l(r[1]):t==="!has"?Wn(_l(r[1])):t!=="within"||r;var n}function Lh(r,t,n){switch(r){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,r,t]}}function gl(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",r,["literal",t.sort(S_)]]:["filter-in-small",r,["literal",t]]}}function _l(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Wn(r){return["!",r]}function ca(r){return pl(Gr(r.value))?Xr(Sn({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):ep(r)}function ep(r){const t=r.value,n=r.key;if(ki(t)!=="array")return[new St(n,t,`array expected, ${ki(t)} found`)];const l=r.styleSpec;let h,m=[];if(t.length<1)return[new St(n,t,"filter array must have at least 1 element")];switch(m=m.concat(fl({key:`${n}[0]`,value:t[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),vi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&vi(t[1])==="$type"&&m.push(new St(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new St(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=ki(t[1]),h!=="string"&&m.push(new St(`${n}[1]`,t[1],`string expected, ${h} found`)));for(let _=2;_<t.length;_++)h=ki(t[_]),vi(t[1])==="$type"?m=m.concat(fl({key:`${n}[${_}]`,value:t[_],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new St(`${n}[${_}]`,t[_],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)m=m.concat(ep({key:`${n}[${_}]`,value:t[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":h=ki(t[1]),t.length!==2?m.push(new St(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new St(`${n}[1]`,t[1],`string expected, ${h} found`));break;case"within":h=ki(t[1]),t.length!==2?m.push(new St(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="object"&&m.push(new St(`${n}[1]`,t[1],`object expected, ${h} found`))}return m}function tp(r,t){const n=r.key,l=r.style,h=r.styleSpec,m=r.value,_=r.objectKey,v=h[`${t}_${r.layerType}`];if(!v)return[];const T=_.match(/^(.*)-transition$/);if(t==="paint"&&T&&v[T[1]]&&v[T[1]].transition)return Dn({key:n,value:m,valueSpec:h.transition,style:l,styleSpec:h});const E=r.valueSpec||v[_];if(!E)return[new St(n,m,`unknown property "${_}"`)];let M;if(ki(m)==="string"&&ra(E)&&!E.tokens&&(M=/^{([^}]+)}$/.exec(m)))return[new St(n,m,`"${_}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const P=[];return r.layerType==="symbol"&&(_==="text-field"&&l&&!l.glyphs&&P.push(new St(n,m,'use of "text-field" requires a style "glyphs" property')),_==="text-font"&&ll(Gr(m))&&vi(m.type)==="identity"&&P.push(new St(n,m,'"text-font" does not support identity functions'))),P.concat(Dn({key:r.key,value:m,valueSpec:E,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:_}))}function ip(r){return tp(r,"paint")}function np(r){return tp(r,"layout")}function kc(r){let t=[];const n=r.value,l=r.key,h=r.style,m=r.styleSpec;n.type||n.ref||t.push(new St(l,n,'either "type" or "ref" is required'));let _=vi(n.type);const v=vi(n.ref);if(n.id){const T=vi(n.id);for(let E=0;E<r.arrayIndex;E++){const M=h.layers[E];vi(M.id)===T&&t.push(new St(l,n.id,`duplicate layer id "${n.id}", previously used at line ${M.id.__line__}`))}}if("ref"in n){let T;["type","source","source-layer","filter","layout"].forEach(E=>{E in n&&t.push(new St(l,n[E],`"${E}" is prohibited for ref layers`))}),h.layers.forEach(E=>{vi(E.id)===v&&(T=E)}),T?T.ref?t.push(new St(l,n.ref,"ref cannot reference another ref layer")):_=vi(T.type):typeof v=="string"&&t.push(new St(l,n.ref,`ref layer "${v}" not found`))}else if(_!=="background"&&_!=="sky")if(n.source){const T=h.sources&&h.sources[n.source],E=T&&vi(T.type);T?E==="vector"&&_==="raster"?t.push(new St(l,n.source,`layer "${n.id}" requires a raster source`)):E==="raster"&&_!=="raster"?t.push(new St(l,n.source,`layer "${n.id}" requires a vector source`)):E!=="vector"||n["source-layer"]?E==="raster-dem"&&_!=="hillshade"?t.push(new St(l,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||E==="geojson"&&T.lineMetrics||t.push(new St(l,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new St(l,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new St(l,n.source,`source "${n.source}" not found`))}else t.push(new St(l,n,'missing required property "source"'));return t=t.concat(Er({key:l,value:n,valueSpec:m.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Dn({key:`${l}.type`,value:n.type,valueSpec:m.layer.type,style:r.style,styleSpec:r.styleSpec,object:n,objectKey:"type"}),filter:T=>ca(Sn({layerType:_},T)),layout:T=>Er({layer:n,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":E=>np(Sn({layerType:_},E))}}),paint:T=>Er({layer:n,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":E=>ip(Sn({layerType:_},E))}})}})),t}function ua(r){const t=r.value,n=r.key,l=ki(t);return l!=="string"?[new St(n,t,`string expected, ${l} found`)]:[]}const Lc={promoteId:function({key:r,value:t}){if(ki(t)==="string")return ua({key:r,value:t});{const n=[];for(const l in t)n.push(...ua({key:`${r}.${l}`,value:t[l]}));return n}}};function rp(r){const t=r.value,n=r.key,l=r.styleSpec,h=r.style;if(!t.type)return[new St(n,t,'"type" is required')];const m=vi(t.type);let _;switch(m){case"vector":case"raster":case"raster-dem":return _=Er({key:n,value:t,valueSpec:l[`source_${m.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:Lc}),_;case"geojson":if(_=Er({key:n,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,objectElementValidators:Lc}),t.cluster)for(const v in t.clusterProperties){const[T,E]=t.clusterProperties[v],M=typeof T=="string"?[T,["accumulated"],["get",v]]:T;_.push(...Xr({key:`${n}.${v}.map`,value:E,expressionContext:"cluster-map"})),_.push(...Xr({key:`${n}.${v}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return _;case"video":return Er({key:n,value:t,valueSpec:l.source_video,style:h,styleSpec:l});case"image":return Er({key:n,value:t,valueSpec:l.source_image,style:h,styleSpec:l});case"canvas":return[new St(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fl({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:l})}}function sp(r){const t=r.value,n=r.styleSpec,l=n.light,h=r.style;let m=[];const _=ki(t);if(t===void 0)return m;if(_!=="object")return m=m.concat([new St("light",t,`object expected, ${_} found`)]),m;for(const v in t){const T=v.match(/^(.*)-transition$/);m=m.concat(T&&l[T[1]]&&l[T[1]].transition?Dn({key:v,value:t[v],valueSpec:n.transition,style:h,styleSpec:n}):l[v]?Dn({key:v,value:t[v],valueSpec:l[v],style:h,styleSpec:n}):[new St(v,t[v],`unknown property "${v}"`)])}return m}function zc(r){const t=r.value,n=r.key,l=r.style,h=r.styleSpec,m=h.terrain;let _=[];const v=ki(t);if(t===void 0)return _;if(v!=="object")return _=_.concat([new St("terrain",t,`object expected, ${v} found`)]),_;for(const T in t){const E=T.match(/^(.*)-transition$/);_=_.concat(E&&m[E[1]]&&m[E[1]].transition?Dn({key:T,value:t[T],valueSpec:h.transition,style:l,styleSpec:h}):m[T]?Dn({key:T,value:t[T],valueSpec:m[T],style:l,styleSpec:h}):[new St(T,t[T],`unknown property "${T}"`)])}if(t.source){const T=l.sources&&l.sources[t.source],E=T&&vi(T.type);T?E!=="raster-dem"&&_.push(new St(n,t.source,`terrain cannot be used with a source of type ${String(E)}, it only be used with a "raster-dem" source type`)):_.push(new St(n,t.source,`source "${t.source}" not found`))}else _.push(new St(n,t,'terrain is missing required property "source"'));return _}function op(r){const t=r.value,n=r.style,l=r.styleSpec,h=l.fog;let m=[];const _=ki(t);if(t===void 0)return m;if(_!=="object")return m=m.concat([new St("fog",t,`object expected, ${_} found`)]),m;for(const v in t){const T=v.match(/^(.*)-transition$/);m=m.concat(T&&h[T[1]]&&h[T[1]].transition?Dn({key:v,value:t[v],valueSpec:l.transition,style:n,styleSpec:l}):h[v]?Dn({key:v,value:t[v],valueSpec:h[v],style:n,styleSpec:l}):[new St(v,t[v],`unknown property "${v}"`)])}return m}const zh={"*":()=>[],array:Mh,boolean:function(r){const t=r.value,n=r.key,l=ki(t);return l!=="boolean"?[new St(n,t,`boolean expected, ${l} found`)]:[]},number:Ih,color:function(r){const t=r.key,n=r.value,l=ki(n);return l!=="string"?[new St(t,n,`color expected, ${l} found`)]:Ys.parseCSSColor(n)===null?[new St(t,n,`color expected, "${n}" found`)]:[]},enum:fl,filter:ca,function:dl,layer:kc,object:Er,source:rp,light:sp,terrain:zc,fog:op,string:ua,formatted:function(r){return ua(r).length===0?[]:Xr(r)},resolvedImage:function(r){return ua(r).length===0?[]:Xr(r)},projection:function(r){const t=r.value,n=r.styleSpec,l=n.projection,h=r.style;let m=[];const _=ki(t);if(_==="object")for(const v in t)m=m.concat(Dn({key:v,value:t[v],valueSpec:l[v],style:h,styleSpec:n}));else _!=="string"&&(m=m.concat([new St("projection",t,`object or string expected, ${_} found`)]));return m}};function Dn(r){const t=r.value,n=r.valueSpec,l=r.styleSpec;return n.expression&&ll(vi(t))?dl(r):n.expression&&Ic(Gr(t))?Xr(r):n.type&&zh[n.type]?zh[n.type](r):Er(Sn({},r,{valueSpec:n.type?l[n.type]:n}))}function A_(r){const t=r.value,n=r.key,l=ua(r);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new St(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new St(n,t,'"glyphs" url must include a "{range}" token'))),l}function Rc(r,t=Ve){return ks(Dn({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,objectElementValidators:{glyphs:A_,"*":()=>[]}}))}const Dc=r=>ks(ip(r)),ap=r=>ks(np(r));function ks(r){return r.slice().sort((t,n)=>t.line&&n.line?t.line-n.line:0)}function Rh(r,t){let n=!1;if(t&&t.length)for(const l of t)r.fire(new Jt(new Error(l.message))),n=!0;return n}var ha=zr;function zr(r,t,n){var l=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var h=new Int32Array(this.arrayBuffer);r=h[0],this.d=(t=h[1])+2*(n=h[2]);for(var m=0;m<this.d*this.d;m++){var _=h[3+m],v=h[3+m+1];l.push(_===v?null:h.subarray(_,v))}var T=h[3+l.length+1];this.keys=h.subarray(h[3+l.length],T),this.bboxes=h.subarray(T),this.insert=this._insertReadonly}else{this.d=t+2*n;for(var E=0;E<this.d*this.d;E++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=r,this.padding=n,this.scale=t/r,this.uid=0;var M=n/t*r;this.min=-M,this.max=r+M}zr.prototype.insert=function(r,t,n,l,h){this._forEachCell(t,n,l,h,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(h)},zr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},zr.prototype._insertCell=function(r,t,n,l,h,m){this.cells[h].push(m)},zr.prototype.query=function(r,t,n,l,h){var m=this.min,_=this.max;if(r<=m&&t<=m&&_<=n&&_<=l&&!h)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(r,t,n,l,this._queryCell,v,{},h),v},zr.prototype._queryCell=function(r,t,n,l,h,m,_,v){var T=this.cells[h];if(T!==null)for(var E=this.keys,M=this.bboxes,P=0;P<T.length;P++){var z=T[P];if(_[z]===void 0){var F=4*z;(v?v(M[F+0],M[F+1],M[F+2],M[F+3]):r<=M[F+2]&&t<=M[F+3]&&n>=M[F+0]&&l>=M[F+1])?(_[z]=!0,m.push(E[z])):_[z]=!1}}},zr.prototype._forEachCell=function(r,t,n,l,h,m,_,v){for(var T=this._convertToCellCoord(r),E=this._convertToCellCoord(t),M=this._convertToCellCoord(n),P=this._convertToCellCoord(l),z=T;z<=M;z++)for(var F=E;F<=P;F++){var B=this.d*F+z;if((!v||v(this._convertFromCellCoord(z),this._convertFromCellCoord(F),this._convertFromCellCoord(z+1),this._convertFromCellCoord(F+1)))&&h.call(this,r,t,n,l,B,m,_,v))return}},zr.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},zr.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},zr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,t=3+this.cells.length+1+1,n=0,l=0;l<this.cells.length;l++)n+=this.cells[l].length;var h=new Int32Array(t+n+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var m=t,_=0;_<r.length;_++){var v=r[_];h[3+_]=m,h.set(v,m),m+=v.length}return h[3+r.length]=m,h.set(this.keys,m),h[3+r.length+1]=m+=this.keys.length,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer};const Oc={};function Ct(r,t,n={}){Object.defineProperty(r,"_classRegistryKey",{value:t,writeable:!1}),Oc[t]={klass:r,omit:n.omit||[]}}Ct(Object,"Object"),ha.serialize=function(r,t){const n=r.toArrayBuffer();return t&&t.push(n),{buffer:n}},ha.deserialize=function(r){return new ha(r.buffer)},Object.defineProperty(ha,"name",{value:"Grid"}),Ct(ha,"Grid"),Ct(Fi,"Color"),Ct(Error,"Error"),Ct(Le,"AJAXError"),Ct(dr,"ResolvedImage"),Ct(aa,"StylePropertyFunction"),Ct(Sh,"StyleExpression",{omit:["_evaluator"]}),Ct(hl,"ZoomDependentExpression"),Ct(Ah,"ZoomConstantExpression"),Ct(Zr,"CompoundExpression",{omit:["_evaluate"]});for(const r in al)Oc[al[r]._classRegistryKey]||Ct(al[r],`Expression${r}`);function lp(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function cp(r){return w.ImageBitmap&&r instanceof w.ImageBitmap}function da(r,t){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(lp(r)||cp(r))return t&&t.push(r),r;if(ArrayBuffer.isView(r)){const n=r;return t&&t.push(n.buffer),n}if(r instanceof w.ImageData)return t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const n=[];for(const l of r)n.push(da(l,t));return n}if(typeof r=="object"){const n=r.constructor,l=n._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const h=n.serialize?n.serialize(r,t):{};if(!n.serialize){for(const m in r)r.hasOwnProperty(m)&&(Oc[l].omit.indexOf(m)>=0||(h[m]=da(r[m],t)));r instanceof Error&&(h.message=r.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof r)}function yl(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||lp(r)||cp(r)||ArrayBuffer.isView(r)||r instanceof w.ImageData)return r;if(Array.isArray(r))return r.map(yl);if(typeof r=="object"){const t=r.$name||"Object",{klass:n}=Oc[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(r);const l=Object.create(n.prototype);for(const h of Object.keys(r))h!=="$name"&&(l[h]=yl(r[h]));return l}throw new Error("can't deserialize object of type "+typeof r)}class up{constructor(){this.first=!0}update(t,n){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const hp=r=>r>=1536&&r<=1791,dp=r=>r>=1872&&r<=1919,fp=r=>r>=2208&&r<=2303,pp=r=>r>=11904&&r<=12031,mp=r=>r>=12032&&r<=12255,vl=r=>r>=12272&&r<=12287,Fc=r=>r>=12288&&r<=12351,Dh=r=>r>=12352&&r<=12447,Co=r=>r>=12448&&r<=12543,gp=r=>r>=12544&&r<=12591,Oh=r=>r>=12704&&r<=12735,_p=r=>r>=12736&&r<=12783,Fh=r=>r>=12784&&r<=12799,Bh=r=>r>=12800&&r<=13055,Nh=r=>r>=13056&&r<=13311,Uh=r=>r>=13312&&r<=19903,xl=r=>r>=19968&&r<=40959,Bc=r=>r>=40960&&r<=42127,yp=r=>r>=42128&&r<=42191,vp=r=>r>=44032&&r<=55215,xp=r=>r>=63744&&r<=64255,bl=r=>r>=64336&&r<=65023,bp=r=>r>=65040&&r<=65055,Vh=r=>r>=65072&&r<=65103,wp=r=>r>=65104&&r<=65135,$h=r=>r>=65136&&r<=65279,jh=r=>r>=65280&&r<=65519;function Nc(r){for(const t of r)if(Uc(t.charCodeAt(0)))return!0;return!1}function C_(r){for(const t of r)if(!M_(t.charCodeAt(0)))return!1;return!0}function M_(r){return!(hp(r)||dp(r)||fp(r)||bl(r)||$h(r))}function Uc(r){return!(r!==746&&r!==747&&(r<4352||!(Oh(r)||gp(r)||Vh(r)&&!(r>=65097&&r<=65103)||xp(r)||Nh(r)||pp(r)||_p(r)||!(!Fc(r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||Uh(r)||xl(r)||Bh(r)||(t=>t>=12592&&t<=12687)(r)||(t=>t>=43360&&t<=43391)(r)||(t=>t>=55216&&t<=55295)(r)||(t=>t>=4352&&t<=4607)(r)||vp(r)||Dh(r)||vl(r)||(t=>t>=12688&&t<=12703)(r)||mp(r)||Fh(r)||Co(r)&&r!==12540||!(!jh(r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!wp(r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||(t=>t>=5120&&t<=5759)(r)||(t=>t>=6320&&t<=6399)(r)||bp(r)||(t=>t>=19904&&t<=19967)(r)||Bc(r)||yp(r))))}function wl(r){return!(Uc(r)||function(t){return!!((n=>n>=128&&n<=255)(t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||(n=>n>=8192&&n<=8303)(t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||(n=>n>=8448&&n<=8527)(t)||(n=>n>=8528&&n<=8591)(t)||(n=>n>=8960&&n<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||(n=>n>=9216&&n<=9279)(t)&&t!==9251||(n=>n>=9280&&n<=9311)(t)||(n=>n>=9312&&n<=9471)(t)||(n=>n>=9632&&n<=9727)(t)||(n=>n>=9728&&n<=9983)(t)&&!(t>=9754&&t<=9759)||(n=>n>=11008&&n<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Fc(t)||Co(t)||(n=>n>=57344&&n<=63743)(t)||Vh(t)||wp(t)||jh(t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}function p(r){return r>=1424&&r<=2303||bl(r)||$h(r)}function o(r,t){return!(!t&&p(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||(n=>n>=6016&&n<=6143)(r))}function u(r){for(const t of r)if(p(t.charCodeAt(0)))return!0;return!1}const g="deferred",x="loading",b="loaded";let S=null,A="unavailable",I=null;const D=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(A="error"),S&&S(r)};function O(){U.fire(new ti("pluginStateChange",{pluginStatus:A,pluginURL:I}))}const U=new kt,W=function(){return A},ee=function(){if(A!==g||!I)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");A=x,O(),I&&Re({url:I},r=>{r?D(r):(A=b,O())})},K={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>A===b||K.applyArabicShaping!=null,isLoading:()=>A===x,setState(r){A=r.pluginStatus,I=r.pluginURL},isParsed:()=>K.applyArabicShaping!=null&&K.processBidirectionalText!=null&&K.processStyledBidirectionalText!=null,getPluginURL:()=>I};class Y{constructor(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new up,this.transition={},this.pitch=0)}isSupportedScript(t){return function(n,l){for(const h of n)if(!o(h.charCodeAt(0),l))return!1;return!0}(t,K.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}}}class Q{constructor(t,n){this.property=t,this.value=n,this.expression=function(l,h){if(ll(l))return new aa(l,h);if(Ic(l)){const m=Ch(l,h);if(m.result==="error")throw new Error(m.value.map(_=>`${_.key}: ${_.message}`).join(", "));return m.value}{let m=l;return typeof l=="string"&&h.type==="color"&&(m=Fi.parse(l)),{kind:"constant",evaluate:()=>m}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,n,l){return this.property.possiblyEvaluate(this,t,n,l)}}class X{constructor(t){this.property=t,this.value=new Q(t,void 0)}transitioned(t,n){return new te(this.property,this.value,n,Ce({},t.transition,this.transition),t.now)}untransitioned(){return new te(this.property,this.value,null,{},0)}}class ae{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return tn(this._values[t].value.value)}setValue(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new X(this._values[t].property)),this._values[t].value=new Q(this._values[t].property,n===null?void 0:tn(n))}getTransition(t){return tn(this._values[t].transition)}setTransition(t,n){this._values.hasOwnProperty(t)||(this._values[t]=new X(this._values[t].property)),this._values[t].transition=tn(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l);const h=this.getTransition(n);h!==void 0&&(t[`${n}-transition`]=h)}return t}transitioned(t,n){const l=new Ee(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,n._values[h]);return l}untransitioned(){const t=new Ee(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class te{constructor(t,n,l,h,m){const _=h.delay||0,v=h.duration||0;m=m||0,this.property=t,this.value=n,this.begin=m+_,this.end=this.begin+v,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,n,l){const h=t.now||0,m=this.value.possiblyEvaluate(t,n,l),_=this.prior;if(_){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return _.possiblyEvaluate(t,n,l);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,n,l),m,q(v))}}return m}}class Ee{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,l){const h=new we(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class xe{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return tn(this._values[t].value)}setValue(t,n){this._values[t]=new Q(this._values[t].property,n===null?void 0:tn(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const l=this.getValue(n);l!==void 0&&(t[n]=l)}return t}possiblyEvaluate(t,n,l){const h=new we(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,n,l);return h}}class pe{constructor(t,n,l){this.property=t,this.value=n,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,l,h){return this.property.evaluate(this.value,this.parameters,t,n,l,h)}}class we{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class ve{constructor(t){this.specification=t}possiblyEvaluate(t,n){return t.expression.evaluate(n)}interpolate(t,n,l){const h=nl[this.specification.type];return h?h(t,n,l):t}}class Me{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,l,h){return new pe(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},l,h)}:t.expression,n)}interpolate(t,n,l){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new pe(this,{kind:"constant",value:void 0},t.parameters);const h=nl[this.specification.type];return h?new pe(this,{kind:"constant",value:h(t.value.value,n.value.value,l)},t.parameters):t}evaluate(t,n,l,h,m,_){return t.kind==="constant"?t.value:t.evaluate(n,l,h,m,_)}}class Oe extends Me{possiblyEvaluate(t,n,l,h){if(t.value===void 0)return new pe(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},l,h),_=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(_,_,_,n);return new pe(this,{kind:"constant",value:v},n)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new pe(this,{kind:"constant",value:m},n)}return new pe(this,t.expression,n)}evaluate(t,n,l,h,m,_){if(t.kind==="source"){const v=t.evaluate(n,l,h,m,_);return this._calculate(v,v,v,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},l,h),t.evaluate({zoom:Math.floor(n.zoom)},l,h),t.evaluate({zoom:Math.floor(n.zoom)+1},l,h),n):t.value}_calculate(t,n,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n,other:l}:{from:l,to:n,other:t}}interpolate(t){return t}}class ht{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(n,null,{},l,h);return this._calculate(m,m,m,n)}return this._calculate(t.expression.evaluate(new Y(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Y(Math.floor(n.zoom),n)),t.expression.evaluate(new Y(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:l,to:n}}interpolate(t){return t}}class ke{constructor(t){this.specification=t}possiblyEvaluate(t,n,l,h){return!!t.expression.evaluate(n,null,{},l,h)}interpolate(){return!1}}class Xe{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new Y(0,{});for(const l in t){const h=t[l];h.specification.overridable&&this.overridableProperties.push(l);const m=this.defaultPropertyValues[l]=new Q(h,void 0),_=this.defaultTransitionablePropertyValues[l]=new X(h);this.defaultTransitioningPropertyValues[l]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate(n)}}}function nt(r,t){return 256*(r=ie(Math.floor(r),0,255))+ie(Math.floor(t),0,255)}Ct(Me,"DataDrivenProperty"),Ct(ve,"DataConstantProperty"),Ct(Oe,"CrossFadedDataDrivenProperty"),Ct(ht,"CrossFadedProperty"),Ct(ke,"ColorRampProperty");const _t={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class je{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ft{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function it(r,t=1){let n=0,l=0;return{members:r.map(h=>{const m=_t[h.type].BYTES_PER_ELEMENT,_=n=bt(n,Math.max(t,m)),v=h.components||1;return l=Math.max(l,m),n+=m*v,{name:h.name,type:h.type,components:v,offset:_}}),size:bt(n,Math.max(l,t)),alignment:t}}function bt(r,t){return Math.ceil(r/t)*t}class vt extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.int16[h+0]=n,this.int16[h+1]=l,t}}vt.prototype.bytesPerElement=4,Ct(vt,"StructArrayLayout2i4");class zt extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=3*t;return this.int16[m+0]=n,this.int16[m+1]=l,this.int16[m+2]=h,t}}zt.prototype.bytesPerElement=6,Ct(zt,"StructArrayLayout3i6");class Ut extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l,h)}emplace(t,n,l,h,m){const _=4*t;return this.int16[_+0]=n,this.int16[_+1]=l,this.int16[_+2]=h,this.int16[_+3]=m,t}}Ut.prototype.bytesPerElement=8,Ct(Ut,"StructArrayLayout4i8");class Ht extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,l,h,m,_,v)}emplace(t,n,l,h,m,_,v,T){const E=6*t,M=12*t,P=3*t;return this.int16[E+0]=n,this.int16[E+1]=l,this.uint8[M+4]=h,this.uint8[M+5]=m,this.uint8[M+6]=_,this.uint8[M+7]=v,this.float32[P+2]=T,t}}Ht.prototype.bytesPerElement=12,Ct(Ht,"StructArrayLayout2i4ub1f12");class pi extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l,h)}emplace(t,n,l,h,m){const _=4*t;return this.float32[_+0]=n,this.float32[_+1]=l,this.float32[_+2]=h,this.float32[_+3]=m,t}}pi.prototype.bytesPerElement=16,Ct(pi,"StructArrayLayout4f16");class Rt extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v,T,E,M){const P=this.length;return this.resize(P+1),this.emplace(P,t,n,l,h,m,_,v,T,E,M)}emplace(t,n,l,h,m,_,v,T,E,M,P){const z=10*t;return this.uint16[z+0]=n,this.uint16[z+1]=l,this.uint16[z+2]=h,this.uint16[z+3]=m,this.uint16[z+4]=_,this.uint16[z+5]=v,this.uint16[z+6]=T,this.uint16[z+7]=E,this.uint16[z+8]=M,this.uint16[z+9]=P,t}}Rt.prototype.bytesPerElement=20,Ct(Rt,"StructArrayLayout10ui20");class Qt extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v,T){const E=this.length;return this.resize(E+1),this.emplace(E,t,n,l,h,m,_,v,T)}emplace(t,n,l,h,m,_,v,T,E){const M=8*t;return this.uint16[M+0]=n,this.uint16[M+1]=l,this.uint16[M+2]=h,this.uint16[M+3]=m,this.uint16[M+4]=_,this.uint16[M+5]=v,this.uint16[M+6]=T,this.uint16[M+7]=E,t}}Qt.prototype.bytesPerElement=16,Ct(Qt,"StructArrayLayout8ui16");class Ei extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,l,h,m,_)}emplace(t,n,l,h,m,_,v){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=l,this.int16[T+2]=h,this.int16[T+3]=m,this.int16[T+4]=_,this.int16[T+5]=v,t}}Ei.prototype.bytesPerElement=12,Ct(Ei,"StructArrayLayout6i12");class Ki extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v,T,E,M,P,z){const F=this.length;return this.resize(F+1),this.emplace(F,t,n,l,h,m,_,v,T,E,M,P,z)}emplace(t,n,l,h,m,_,v,T,E,M,P,z,F){const B=12*t;return this.int16[B+0]=n,this.int16[B+1]=l,this.int16[B+2]=h,this.int16[B+3]=m,this.uint16[B+4]=_,this.uint16[B+5]=v,this.uint16[B+6]=T,this.uint16[B+7]=E,this.int16[B+8]=M,this.int16[B+9]=P,this.int16[B+10]=z,this.int16[B+11]=F,t}}Ki.prototype.bytesPerElement=24,Ct(Ki,"StructArrayLayout4i4ui4i24");class hn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_){const v=this.length;return this.resize(v+1),this.emplace(v,t,n,l,h,m,_)}emplace(t,n,l,h,m,_,v){const T=10*t,E=5*t;return this.int16[T+0]=n,this.int16[T+1]=l,this.int16[T+2]=h,this.float32[E+2]=m,this.float32[E+3]=_,this.float32[E+4]=v,t}}hn.prototype.bytesPerElement=20,Ct(hn,"StructArrayLayout3i3f20");class Bi extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}Bi.prototype.bytesPerElement=4,Ct(Bi,"StructArrayLayout1ul4");class On extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v,T,E,M,P,z,F){const B=this.length;return this.resize(B+1),this.emplace(B,t,n,l,h,m,_,v,T,E,M,P,z,F)}emplace(t,n,l,h,m,_,v,T,E,M,P,z,F,B){const G=20*t,Z=10*t;return this.int16[G+0]=n,this.int16[G+1]=l,this.int16[G+2]=h,this.int16[G+3]=m,this.int16[G+4]=_,this.float32[Z+3]=v,this.float32[Z+4]=T,this.float32[Z+5]=E,this.float32[Z+6]=M,this.int16[G+14]=P,this.uint32[Z+8]=z,this.uint16[G+18]=F,this.uint16[G+19]=B,t}}On.prototype.bytesPerElement=40,Ct(On,"StructArrayLayout5i4f1i1ul2ui40");class Kr extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v){const T=this.length;return this.resize(T+1),this.emplace(T,t,n,l,h,m,_,v)}emplace(t,n,l,h,m,_,v,T){const E=8*t;return this.int16[E+0]=n,this.int16[E+1]=l,this.int16[E+2]=h,this.int16[E+4]=m,this.int16[E+5]=_,this.int16[E+6]=v,this.int16[E+7]=T,t}}Kr.prototype.bytesPerElement=16,Ct(Kr,"StructArrayLayout3i2i2i16");class Ls extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,l,h,m)}emplace(t,n,l,h,m,_){const v=4*t,T=8*t;return this.float32[v+0]=n,this.float32[v+1]=l,this.float32[v+2]=h,this.int16[T+6]=m,this.int16[T+7]=_,t}}Ls.prototype.bytesPerElement=16,Ct(Ls,"StructArrayLayout2f1f2i16");class Yi extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l,h)}emplace(t,n,l,h,m){const _=12*t,v=3*t;return this.uint8[_+0]=n,this.uint8[_+1]=l,this.float32[v+1]=h,this.float32[v+2]=m,t}}Yi.prototype.bytesPerElement=12,Ct(Yi,"StructArrayLayout2ub2f12");class rn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=3*t;return this.float32[m+0]=n,this.float32[m+1]=l,this.float32[m+2]=h,t}}rn.prototype.bytesPerElement=12,Ct(rn,"StructArrayLayout3f12");class ai extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,n,l)}emplace(t,n,l,h){const m=3*t;return this.uint16[m+0]=n,this.uint16[m+1]=l,this.uint16[m+2]=h,t}}ai.prototype.bytesPerElement=6,Ct(ai,"StructArrayLayout3ui6");class bn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v,T,E,M,P,z,F,B,G,Z,oe,me,le,fe,Se){const ye=this.length;return this.resize(ye+1),this.emplace(ye,t,n,l,h,m,_,v,T,E,M,P,z,F,B,G,Z,oe,me,le,fe,Se)}emplace(t,n,l,h,m,_,v,T,E,M,P,z,F,B,G,Z,oe,me,le,fe,Se,ye){const Ue=30*t,Be=15*t,Ze=60*t;return this.int16[Ue+0]=n,this.int16[Ue+1]=l,this.int16[Ue+2]=h,this.float32[Be+2]=m,this.float32[Be+3]=_,this.uint16[Ue+8]=v,this.uint16[Ue+9]=T,this.uint32[Be+5]=E,this.uint32[Be+6]=M,this.uint32[Be+7]=P,this.uint16[Ue+16]=z,this.uint16[Ue+17]=F,this.uint16[Ue+18]=B,this.float32[Be+10]=G,this.float32[Be+11]=Z,this.uint8[Ze+48]=oe,this.uint8[Ze+49]=me,this.uint8[Ze+50]=le,this.uint32[Be+13]=fe,this.int16[Ue+28]=Se,this.uint8[Ze+58]=ye,t}}bn.prototype.bytesPerElement=60,Ct(bn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Hn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m,_,v,T,E,M,P,z,F,B,G,Z,oe,me,le,fe,Se,ye,Ue,Be,Ze,mt,$e,Qe,st,Je){const dt=this.length;return this.resize(dt+1),this.emplace(dt,t,n,l,h,m,_,v,T,E,M,P,z,F,B,G,Z,oe,me,le,fe,Se,ye,Ue,Be,Ze,mt,$e,Qe,st,Je)}emplace(t,n,l,h,m,_,v,T,E,M,P,z,F,B,G,Z,oe,me,le,fe,Se,ye,Ue,Be,Ze,mt,$e,Qe,st,Je,dt){const ot=38*t,Tt=19*t;return this.int16[ot+0]=n,this.int16[ot+1]=l,this.int16[ot+2]=h,this.float32[Tt+2]=m,this.float32[Tt+3]=_,this.int16[ot+8]=v,this.int16[ot+9]=T,this.int16[ot+10]=E,this.int16[ot+11]=M,this.int16[ot+12]=P,this.int16[ot+13]=z,this.uint16[ot+14]=F,this.uint16[ot+15]=B,this.uint16[ot+16]=G,this.uint16[ot+17]=Z,this.uint16[ot+18]=oe,this.uint16[ot+19]=me,this.uint16[ot+20]=le,this.uint16[ot+21]=fe,this.uint16[ot+22]=Se,this.uint16[ot+23]=ye,this.uint16[ot+24]=Ue,this.uint16[ot+25]=Be,this.uint16[ot+26]=Ze,this.uint16[ot+27]=mt,this.uint16[ot+28]=$e,this.uint32[Tt+15]=Qe,this.float32[Tt+16]=st,this.float32[Tt+17]=Je,this.float32[Tt+18]=dt,t}}Hn.prototype.bytesPerElement=76,Ct(Hn,"StructArrayLayout3i2f6i15ui1ul3f76");class ji extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}ji.prototype.bytesPerElement=4,Ct(ji,"StructArrayLayout1f4");class Zn extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,l,h,m)}emplace(t,n,l,h,m,_){const v=5*t;return this.float32[v+0]=n,this.float32[v+1]=l,this.float32[v+2]=h,this.float32[v+3]=m,this.float32[v+4]=_,t}}Zn.prototype.bytesPerElement=20,Ct(Zn,"StructArrayLayout5f20");class Mo extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,n,l,h)}emplace(t,n,l,h,m){const _=6*t;return this.uint32[3*t+0]=n,this.uint16[_+2]=l,this.uint16[_+3]=h,this.uint16[_+4]=m,t}}Mo.prototype.bytesPerElement=12,Ct(Mo,"StructArrayLayout1ul3ui12");class nr extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.uint16[h+0]=n,this.uint16[h+1]=l,t}}nr.prototype.bytesPerElement=4,Ct(nr,"StructArrayLayout2ui4");class Io extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}Io.prototype.bytesPerElement=2,Ct(Io,"StructArrayLayout1ui2");class Po extends ft{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const l=this.length;return this.resize(l+1),this.emplace(l,t,n)}emplace(t,n,l){const h=2*t;return this.float32[h+0]=n,this.float32[h+1]=l,t}}Po.prototype.bytesPerElement=8,Ct(Po,"StructArrayLayout2f8");class ko extends je{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}ko.prototype.size=12;class rr extends Ei{get(t){return new ko(this,t)}}Ct(rr,"FillExtrusionExtArray");class Lo extends je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Lo.prototype.size=40;class no extends On{get(t){return new Lo(this,t)}}Ct(no,"CollisionBoxArray");class Tl extends je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}Tl.prototype.size=60;class d1 extends bn{get(t){return new Tl(this,t)}}Ct(d1,"PlacedSymbolArray");class f1 extends je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}f1.prototype.size=76;class p1 extends Hn{get(t){return new f1(this,t)}}Ct(p1,"SymbolInstanceArray");class m1 extends ji{getoffsetX(t){return this.float32[1*t+0]}}Ct(m1,"GlyphOffsetArray");class g1 extends zt{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ct(g1,"SymbolLineVertexArray");class _1 extends je{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}_1.prototype.size=12;class y1 extends Mo{get(t){return new _1(this,t)}}Ct(y1,"FeatureIndexArray");class v1 extends je{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}v1.prototype.size=4;class x1 extends nr{get(t){return new v1(this,t)}}Ct(x1,"FillExtrusionCentroidArray");class b1 extends je{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}b1.prototype.size=12;class w1 extends Ei{get(t){return new b1(this,t)}}Ct(w1,"CircleGlobeExtArray");const cI=it([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),uI=it([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var T1=Hu(function(r){r.exports=function(t,n){var l,h,m,_,v,T,E,M;for(h=t.length-(l=3&t.length),m=n,v=3432918353,T=461845907,M=0;M<h;)E=255&t.charCodeAt(M)|(255&t.charCodeAt(++M))<<8|(255&t.charCodeAt(++M))<<16|(255&t.charCodeAt(++M))<<24,++M,m=27492+(65535&(_=5*(65535&(m=(m^=E=(65535&(E=(E=(65535&E)*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*T+(((E>>>16)*T&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(E=0,l){case 3:E^=(255&t.charCodeAt(M+2))<<16;case 2:E^=(255&t.charCodeAt(M+1))<<8;case 1:m^=E=(65535&(E=(E=(65535&(E^=255&t.charCodeAt(M)))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*T+(((E>>>16)*T&65535)<<16)&4294967295}return m^=t.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),hI=Hu(function(r){r.exports=function(t,n){for(var l,h=t.length,m=n^h,_=0;h>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(_)|(255&t.charCodeAt(++_))<<8|(255&t.charCodeAt(++_))<<16|(255&t.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),h-=4,++_;switch(h){case 3:m^=(255&t.charCodeAt(_+2))<<16;case 2:m^=(255&t.charCodeAt(_+1))<<8;case 1:m=1540483477*(65535&(m^=255&t.charCodeAt(_)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),Gh=T1,dI=hI;Gh.murmur3=T1,Gh.murmur2=dI;class Tp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,l,h){this.ids.push(E1(t)),this.positions.push(n,l,h)}getPositions(t){const n=E1(t);let l=0,h=this.ids.length-1;for(;l<h;){const _=l+h>>1;this.ids[_]>=n?h=_:l=_+1}const m=[];for(;this.ids[l]===n;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m}static serialize(t,n){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return I_(l,h,0,l.length-1),n&&n.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const n=new Tp;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function E1(r){const t=+r;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Gh(String(r))}function I_(r,t,n,l){for(;n<l;){const h=r[n+l>>1];let m=n-1,_=l+1;for(;;){do m++;while(r[m]<h);do _--;while(r[_]>h);if(m>=_)break;Ep(r,m,_),Ep(t,3*m,3*_),Ep(t,3*m+1,3*_+1),Ep(t,3*m+2,3*_+2)}_-n<l-_?(I_(r,t,n,_),n=_+1):(I_(r,t,_+1,l),l=_)}}function Ep(r,t,n){const l=r[t];r[t]=r[n],r[n]=l}Ct(Tp,"FeaturePositionMap");class zo{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,n),this.initialized=!0),!!this.location}}class Sp extends zo{constructor(t){super(t),this.current=0}set(t,n,l){this.fetchUniformLocation(t,n)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class S1 extends zo{constructor(t){super(t),this.current=[0,0,0,0]}set(t,n,l){this.fetchUniformLocation(t,n)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class A1 extends zo{constructor(t){super(t),this.current=Fi.transparent}set(t,n,l){this.fetchUniformLocation(t,n)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const fI=new Float32Array(16),pI=new Float32Array(9),mI=new Float32Array(4);function P_(r){return[nt(255*r.r,255*r.g),nt(255*r.b,255*r.a)]}class qh{constructor(t,n,l){this.value=t,this.uniformNames=n.map(h=>`u_${h}`),this.type=l}setUniform(t,n,l,h,m){n.set(t,m,h.constantOr(this.value))}getBinding(t,n){return this.type==="color"?new A1(t):new Sp(t)}}class Vc{constructor(t,n){this.uniformNames=n.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio||1,this.pixelRatioTo=t.pixelRatio||1,this.patternFrom=n.tl.concat(n.br),this.patternTo=t.tl.concat(t.br)}setUniform(t,n,l,h,m){const _=m==="u_pattern_to"||m==="u_dash_to"?this.patternTo:m==="u_pattern_from"||m==="u_dash_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&n.set(t,m,_)}getBinding(t,n){return n==="u_pattern_from"||n==="u_pattern_to"||n==="u_dash_from"||n==="u_dash_to"?new S1(t):new Sp(t)}}class Ro{constructor(t,n,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map(m=>({name:`a_${m}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,n,l,h,m,_){const v=this.paintVertexArray.length,T=this.expression.evaluate(new Y(0),n,{},m,h,_);this.paintVertexArray.resize(t),this._setPaintValue(v,t,T)}updatePaintArray(t,n,l,h,m){const _=this.expression.evaluate({zoom:0},l,h,void 0,m);this._setPaintValue(t,n,_)}_setPaintValue(t,n,l){if(this.type==="color"){const h=P_(l);for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<n;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zs{constructor(t,n,l,h,m,_){this.expression=t,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=l,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,n,l,h,m,_){const v=this.expression.evaluate(new Y(this.zoom),n,{},m,h,_),T=this.expression.evaluate(new Y(this.zoom+1),n,{},m,h,_),E=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(E,t,v,T)}updatePaintArray(t,n,l,h,m){const _=this.expression.evaluate({zoom:this.zoom},l,h,void 0,m),v=this.expression.evaluate({zoom:this.zoom+1},l,h,void 0,m);this._setPaintValue(t,n,_,v)}_setPaintValue(t,n,l,h){if(this.type==="color"){const m=P_(l),_=P_(h);for(let v=t;v<n;v++)this.paintVertexArray.emplace(v,m[0],m[1],_[0],_[1])}else{for(let m=t;m<n;m++)this.paintVertexArray.emplace(m,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n,l,h,m){const _=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,v=ie(this.expression.interpolationFactor(_,this.zoom,this.zoom+1),0,1);n.set(t,m,v)}getBinding(t,n){return new Sp(t)}}class fa{constructor(t,n,l,h,m,_,v){this.expression=t,this.type=l,this.useIntegerZoom=h,this.zoom=m,this.layerId=v,this.paintVertexAttributes=(l==="array"?uI:cI).members;for(let T=0;T<n.length;++T);this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(t,n,l){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,n.patterns&&n.patterns[this.layerId],l)}updatePaintArray(t,n,l,h,m,_){this._setPaintValues(t,n,l.patterns&&l.patterns[this.layerId],_)}_setPaintValues(t,n,l,h){if(!h||!l)return;const{min:m,mid:_,max:v}=l,T=h[m],E=h[_],M=h[v];if(T&&E&&M)for(let P=t;P<n;P++)this._setPaintValue(this.zoomInPaintVertexArray,P,E,T),this._setPaintValue(this.zoomOutPaintVertexArray,P,E,M)}_setPaintValue(t,n,l,h){t.emplace(n,l.tl[0],l.tl[1],l.br[0],l.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],l.pixelRatio,h.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class pa{constructor(t,n,l=()=>!0){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!l(m))continue;const _=t.paint.get(m);if(!(_ instanceof pe&&ra(_.property.specification)))continue;const v=_I(m,t.type),T=_.value,E=_.property.specification.type,M=_.property.useIntegerZoom,P=_.property.specification["property-type"],z=P==="cross-faded"||P==="cross-faded-data-driven",F=String(m)==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(T.kind!=="constant"||F)if(T.kind==="source"||F||z){const B=C1(m,E,"source");this.binders[m]=z?new fa(T,v,E,M,n,B,t.id):new Ro(T,v,E,B),h.push(`/a_${m}`)}else{const B=C1(m,E,"composite");this.binders[m]=new zs(T,v,E,M,n,B),h.push(`/z_${m}`)}else this.binders[m]=z?new Vc(T.value,v):new qh(T.value,v,E),h.push(`/u_${m}`)}this.cacheKey=h.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof Ro||n instanceof zs?n.maxValue:0}populatePaintArrays(t,n,l,h,m,_){for(const v in this.binders){const T=this.binders[v];(T instanceof Ro||T instanceof zs||T instanceof fa)&&T.populatePaintArray(t,n,l,h,m,_)}}setConstantPatternPositions(t,n){for(const l in this.binders){const h=this.binders[l];h instanceof Vc&&h.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,l,h,m,_){let v=!1;for(const T in t){const E=n.getPositions(T);for(const M of E){const P=l.feature(M.index);for(const z in this.binders){const F=this.binders[z];if((F instanceof Ro||F instanceof zs||F instanceof fa)&&F.expression.isStateDependent===!0){const B=h.paint.get(z);F.expression=B.value,F.updatePaintArray(M.start,M.end,P,t[T],m,_),v=!0}}}}return v}defines(){const t=[];for(const n in this.binders){const l=this.binders[n];(l instanceof qh||l instanceof Vc)&&t.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof Ro||l instanceof zs||l instanceof fa)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const l=this.binders[n];if(l instanceof qh||l instanceof Vc||l instanceof zs)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const n=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof qh||h instanceof Vc||h instanceof zs)for(const m of h.uniformNames)n.push({name:m,property:l,binding:h.getBinding(t,m)})}return n}setUniforms(t,n,l,h,m){for(const{name:_,property:v,binding:T}of l)this.binders[v].setUniform(t,T,m,h.get(v),_)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const l=this.binders[n];if(t&&l instanceof fa){const h=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(l instanceof Ro||l instanceof zs)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const n in this.binders){const l=this.binders[n];(l instanceof Ro||l instanceof zs||l instanceof fa)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof Ro||n instanceof zs||n instanceof fa)&&n.destroy()}}}class El{constructor(t,n,l=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new pa(h,n,l);this.needsUpload=!1,this._featureMap=new Tp,this._bufferOffset=0}populatePaintArrays(t,n,l,h,m,_,v){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(t,n,h,m,_,v);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,l,h,m){for(const _ of l)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(t,this._featureMap,n,_,h,m)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const gI={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function _I(r,t){return gI[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}const yI={"line-pattern":{source:Rt,composite:Rt},"fill-pattern":{source:Rt,composite:Rt},"fill-extrusion-pattern":{source:Rt,composite:Rt},"line-dasharray":{source:Qt,composite:Qt}},vI={color:{source:Po,composite:pi},number:{source:ji,composite:Po}};function C1(r,t,n){const l=yI[r];return l&&l[n]||vI[t][n]}Ct(qh,"ConstantBinder"),Ct(Vc,"CrossFadedConstantBinder"),Ct(Ro,"SourceExpressionBinder"),Ct(fa,"CrossFadedCompositeBinder"),Ct(zs,"CompositeExpressionBinder"),Ct(pa,"ProgramConfiguration",{omit:["_buffers"]}),Ct(El,"ProgramConfigurationSet");const Ap="-transition";class Rs extends kt{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),n.layout&&(this._unevaluatedLayout=new xe(n.layout)),n.paint)){this._transitionablePaint=new ae(n.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new we(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,n,l={}){n!=null&&this._validate(ap,`layers.${this.id}.layout.${t}`,t,n,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return fi(t,Ap)?this._transitionablePaint.getTransition(t.slice(0,-Ap.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,l={}){if(n!=null&&this._validate(Dc,`layers.${this.id}.paint.${t}`,t,n,l))return!1;if(fi(t,Ap))return this._transitionablePaint.setTransition(t.slice(0,-Ap.length),n||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",_=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||_||m||this._handleOverridablePaintPropertyUpdate(t,v,T)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,n,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),_i(t,(n,l)=>!(n===void 0||l==="layout"&&!Object.keys(n).length||l==="paint"&&!Object.keys(n).length))}_validate(t,n,l,h,m={}){return(!m||m.validate!==!1)&&Rh(this,t.call(Rc,{key:n,layerType:this.type,objectKey:l,value:h,styleSpec:Ve,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof pe&&ra(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ml(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const xI=it([{name:"a_pos",components:2,type:"Int16"}],4),bI=it([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class En{constructor(t=[]){this.segments=t}prepareSegment(t,n,l,h){let m=this.segments[this.segments.length-1];return t>En.MAX_VERTEX_ARRAY_LENGTH&&yi(`Max vertices per segment is ${En.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>En.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:n.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,l,h){return new En([{vertexOffset:t,primitiveOffset:n,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}En.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ct(En,"SegmentVector");var Wt=8192;class ma{constructor(t,n){t&&(n?this.setSouthWest(t).setNorthEast(n):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof zi?new zi(t.lng,t.lat):zi.convert(t),this}setSouthWest(t){return this._sw=t instanceof zi?new zi(t.lng,t.lat):zi.convert(t),this}extend(t){const n=this._sw,l=this._ne;let h,m;if(t instanceof zi)h=t,m=t;else{if(!(t instanceof ma))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(ma.convert(t)):this.extend(zi.convert(t)):this;if(h=t._sw,m=t._ne,!h||!m)return this}return n||l?(n.lng=Math.min(h.lng,n.lng),n.lat=Math.min(h.lat,n.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new zi(h.lng,h.lat),this._ne=new zi(m.lng,m.lat)),this}getCenter(){return new zi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new zi(this.getWest(),this.getNorth())}getSouthEast(){return new zi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:n,lat:l}=zi.convert(t);let h=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(t){return!t||t instanceof ma?t:new ma(t)}}const k_=63710088e-1;class zi{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new zi(ze(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,l=this.lat*n,h=t.lat*n,m=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*n);return k_*Math.acos(Math.min(m,1))}toBounds(t=0){const n=360*t/40075017,l=n/Math.cos(Math.PI/180*this.lat);return new ma(new zi(this.lng-l,this.lat-n),new zi(this.lng+l,this.lat+n))}static convert(t){if(t instanceof zi)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new zi(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new zi(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const M1=2*Math.PI*k_;function L_(r){return M1*Math.cos(r*Math.PI/180)}function ro(r){return(180+r)/360}function Do(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function _s(r,t){return r/L_(t)}function ys(r){return 360*r-180}function Xn(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function I1(r,t){return r*L_(Xn(t))}const so=85.051129;function P1(r){return 1/Math.cos(r*Math.PI/180)}class $c{constructor(t,n,l=0){this.x=+t,this.y=+n,this.z=+l}static fromLngLat(t,n=0){const l=zi.convert(t);return new $c(ro(l.lng),Do(l.lat),_s(n,l.lat))}toLngLat(){return new zi(ys(this.x),Xn(this.y))}toAltitude(){return I1(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/M1*P1(Xn(this.y))}}function z_(r,t,n,l,h,m,_,v,T){const E=(t+l)/2,M=(n+h)/2,P=new k(E,M);v(P),function(z,F,B,G,Z,oe){const me=B-Z,le=G-oe;return Math.abs((G-F)*me-(B-z)*le)/Math.hypot(me,le)}(P.x,P.y,m.x,m.y,_.x,_.y)>=T?(z_(r,t,n,E,M,m,P,v,T),z_(r,E,M,l,h,P,_,v,T)):r.push(_)}function k1(r,t,n){let l=r[0],h=l.x,m=l.y;t(l);const _=[l];for(let v=1;v<r.length;v++){const T=r[v],{x:E,y:M}=T;t(T),z_(_,h,m,E,M,l,T,t,n),h=E,m=M,l=T}return _}function R_(r,t,n,l,h){if(h(t,n)){const m=t.add(n).mult(.5);l(m),R_(r,t,m,l,h),R_(r,m,n,l,h)}else r.push(n)}function wI(r,t,n){let l=r[0];t(l);const h=[l];for(let m=1;m<r.length;m++){const _=r[m];t(_),R_(h,l,_,t,n),l=_}return h}const D_=Math.pow(2,14)-1,L1=-D_-1;function TI(r,t){const n=Math.round(r.x*t),l=Math.round(r.y*t);return r.x=ie(n,L1,D_),r.y=ie(l,L1,D_),(n<r.x||n>r.x+1||l<r.y||l>r.y+1)&&yi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function Oo(r,t,n){const l=r.loadGeometry(),h=r.extent,m=Wt/h;if(t&&n&&n.projection.isReprojectedInTileSpace){const _=1<<t.z,{scale:v,x:T,y:E,projection:M}=n,P=z=>{const F=ys((t.x+z.x/h)/_),B=Xn((t.y+z.y/h)/_),G=M.project(F,B);z.x=(G.x*v-T)*h,z.y=(G.y*v-E)*h};for(let z=0;z<l.length;z++)if(r.type!==1)l[z]=k1(l[z],P,1);else{const F=[];for(const B of l[z])B.x<0||B.x>=h||B.y<0||B.y>=h||(P(B),F.push(B));l[z]=F}}for(const _ of l)for(const v of _)TI(v,m);return l}function Sl(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Oo(r):[]}}function Cp(r,t,n,l,h){r.emplaceBack(2*t+(l+1)/2,2*n+(h+1)/2)}function Mp(r,t,n){r.emplaceBack(t.x,t.y,t.z,n[0]*16384,n[1]*16384,n[2]*16384)}class O_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new vt,this.indexArray=new ai,this.segments=new En,this.programConfigurations=new El(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l,h){const m=this.layers[0],_=[];let v=null;m.type==="circle"&&(v=m.layout.get("circle-sort-key"));for(const{feature:E,id:M,index:P,sourceLayerIndex:z}of t){const F=this.layers[0]._featureFilter.needGeometry,B=Sl(E,F);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),B,l))continue;const G=v?v.evaluate(B,{},l):void 0,Z={id:M,properties:E.properties,type:E.type,sourceLayerIndex:z,index:P,geometry:F?B.geometry:Oo(E,l,h),patterns:{},sortKey:G};_.push(Z)}v&&_.sort((E,M)=>E.sortKey-M.sortKey);let T=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new w1,T=h.projection);for(const E of _){const{geometry:M,index:P,sourceLayerIndex:z}=E,F=t[P].feature;this.addFeature(E,M,P,n.availableImages,l,T),n.featureIndex.insert(F,M,P,z,this.index)}}update(t,n,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xI.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,bI.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,n,l,h,m,_){for(const v of n)for(const T of v){const E=T.x,M=T.y;if(E<0||E>=Wt||M<0||M>=Wt)continue;if(_){const F=_.projectTilePoint(E,M,m),B=_.upVector(m,E,M),G=this.globeExtVertexArray;Mp(G,F,B),Mp(G,F,B),Mp(G,F,B),Mp(G,F,B)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),z=P.vertexLength;Cp(this.layoutVertexArray,E,M,-1,-1),Cp(this.layoutVertexArray,E,M,1,-1),Cp(this.layoutVertexArray,E,M,1,1),Cp(this.layoutVertexArray,E,M,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+2,z+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},h,m)}}function z1(r,t){for(let n=0;n<r.length;n++)if(Al(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(Al(r,t[n]))return!0;return!!F_(r,t)}function EI(r,t,n){return!!Al(r,t)||!!B_(t,r,n)}function R1(r,t){if(r.length===1)return O1(t,r[0]);for(let n=0;n<t.length;n++){const l=t[n];for(let h=0;h<l.length;h++)if(Al(r,l[h]))return!0}for(let n=0;n<r.length;n++)if(O1(t,r[n]))return!0;for(let n=0;n<t.length;n++)if(F_(r,t[n]))return!0;return!1}function SI(r,t,n){if(r.length>1){if(F_(r,t))return!0;for(let l=0;l<t.length;l++)if(B_(t[l],r,n))return!0}for(let l=0;l<r.length;l++)if(B_(r[l],t,n))return!0;return!1}function F_(r,t){if(r.length===0||t.length===0)return!1;for(let n=0;n<r.length-1;n++){const l=r[n],h=r[n+1];for(let m=0;m<t.length-1;m++)if(AI(l,h,t[m],t[m+1]))return!0}return!1}function AI(r,t,n,l){return Kt(r,n,l)!==Kt(t,n,l)&&Kt(r,t,n)!==Kt(r,t,l)}function B_(r,t,n){const l=n*n;if(t.length===1)return r.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(D1(r,t[h-1],t[h])<l)return!0;return!1}function D1(r,t,n){const l=t.distSqr(n);if(l===0)return r.distSqr(t);const h=((r.x-t.x)*(n.x-t.x)+(r.y-t.y)*(n.y-t.y))/l;return r.distSqr(h<0?t:h>1?n:n.sub(t)._mult(h)._add(t))}function O1(r,t){let n,l,h,m=!1;for(let _=0;_<r.length;_++){n=r[_];for(let v=0,T=n.length-1;v<n.length;T=v++)l=n[v],h=n[T],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(m=!m)}return m}function Al(r,t){let n=!1;for(let l=0,h=r.length-1;l<r.length;h=l++){const m=r[l],_=r[h];m.y>t.y!=_.y>t.y&&t.x<(_.x-m.x)*(t.y-m.y)/(_.y-m.y)+m.x&&(n=!n)}return n}function F1(r,t,n,l,h){for(const _ of r)if(t<=_.x&&n<=_.y&&l>=_.x&&h>=_.y)return!0;const m=[new k(t,n),new k(t,h),new k(l,h),new k(l,n)];if(r.length>2){for(const _ of m)if(Al(r,_))return!0}for(let _=0;_<r.length-1;_++)if(CI(r[_],r[_+1],m))return!0;return!1}function CI(r,t,n){const l=n[0],h=n[2];if(r.x<l.x&&t.x<l.x||r.x>h.x&&t.x>h.x||r.y<l.y&&t.y<l.y||r.y>h.y&&t.y>h.y)return!1;const m=Kt(r,t,n[0]);return m!==Kt(r,t,n[1])||m!==Kt(r,t,n[2])||m!==Kt(r,t,n[3])}function jc(r,t,n){const l=t.paint.get(r).value;return l.kind==="constant"?l.value:n.programConfigurations.get(t.id).getMaxValue(r)}function Ip(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function B1(r,t,n,l,h){if(!t[0]&&!t[1])return r;const m=k.convert(t)._mult(h);n==="viewport"&&m._rotate(-l);const _=[];for(let v=0;v<r.length;v++)_.push(r[v].sub(m));return _}function N1(r,t,n,l){const h=k.convert(r)._mult(l);return t==="viewport"&&h._rotate(-n),h}Ct(O_,"CircleBucket",{omit:["layers"]});const MI=new Xe({"circle-sort-key":new Me(Ve.layout_circle["circle-sort-key"])});var II={paint:new Xe({"circle-radius":new Me(Ve.paint_circle["circle-radius"]),"circle-color":new Me(Ve.paint_circle["circle-color"]),"circle-blur":new Me(Ve.paint_circle["circle-blur"]),"circle-opacity":new Me(Ve.paint_circle["circle-opacity"]),"circle-translate":new ve(Ve.paint_circle["circle-translate"]),"circle-translate-anchor":new ve(Ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ve(Ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ve(Ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Me(Ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Me(Ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Me(Ve.paint_circle["circle-stroke-opacity"])}),layout:MI},Pp=1e-6,Rr=typeof Float32Array<"u"?Float32Array:Array;function U1(){var r=new Rr(9);return Rr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function oo(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function N_(r,t){var n=t[0],l=t[1],h=t[2],m=t[3],_=t[4],v=t[5],T=t[6],E=t[7],M=t[8],P=t[9],z=t[10],F=t[11],B=t[12],G=t[13],Z=t[14],oe=t[15],me=n*v-l*_,le=n*T-h*_,fe=n*E-m*_,Se=l*T-h*v,ye=l*E-m*v,Ue=h*E-m*T,Be=M*G-P*B,Ze=M*Z-z*B,mt=M*oe-F*B,$e=P*Z-z*G,Qe=P*oe-F*G,st=z*oe-F*Z,Je=me*st-le*Qe+fe*$e+Se*mt-ye*Ze+Ue*Be;return Je?(r[0]=(v*st-T*Qe+E*$e)*(Je=1/Je),r[1]=(h*Qe-l*st-m*$e)*Je,r[2]=(G*Ue-Z*ye+oe*Se)*Je,r[3]=(z*ye-P*Ue-F*Se)*Je,r[4]=(T*mt-_*st-E*Ze)*Je,r[5]=(n*st-h*mt+m*Ze)*Je,r[6]=(Z*fe-B*Ue-oe*le)*Je,r[7]=(M*Ue-z*fe+F*le)*Je,r[8]=(_*Qe-v*mt+E*Be)*Je,r[9]=(l*mt-n*Qe-m*Be)*Je,r[10]=(B*ye-G*fe+oe*me)*Je,r[11]=(P*fe-M*ye-F*me)*Je,r[12]=(v*Ze-_*$e-T*Be)*Je,r[13]=(n*$e-l*Ze+h*Be)*Je,r[14]=(G*le-B*Se-Z*me)*Je,r[15]=(M*Se-P*le+z*me)*Je,r):null}function Gc(r,t,n){var l=t[0],h=t[1],m=t[2],_=t[3],v=t[4],T=t[5],E=t[6],M=t[7],P=t[8],z=t[9],F=t[10],B=t[11],G=t[12],Z=t[13],oe=t[14],me=t[15],le=n[0],fe=n[1],Se=n[2],ye=n[3];return r[0]=le*l+fe*v+Se*P+ye*G,r[1]=le*h+fe*T+Se*z+ye*Z,r[2]=le*m+fe*E+Se*F+ye*oe,r[3]=le*_+fe*M+Se*B+ye*me,r[4]=(le=n[4])*l+(fe=n[5])*v+(Se=n[6])*P+(ye=n[7])*G,r[5]=le*h+fe*T+Se*z+ye*Z,r[6]=le*m+fe*E+Se*F+ye*oe,r[7]=le*_+fe*M+Se*B+ye*me,r[8]=(le=n[8])*l+(fe=n[9])*v+(Se=n[10])*P+(ye=n[11])*G,r[9]=le*h+fe*T+Se*z+ye*Z,r[10]=le*m+fe*E+Se*F+ye*oe,r[11]=le*_+fe*M+Se*B+ye*me,r[12]=(le=n[12])*l+(fe=n[13])*v+(Se=n[14])*P+(ye=n[15])*G,r[13]=le*h+fe*T+Se*z+ye*Z,r[14]=le*m+fe*E+Se*F+ye*oe,r[15]=le*_+fe*M+Se*B+ye*me,r}function Wh(r,t,n){var l,h,m,_,v,T,E,M,P,z,F,B,G=n[0],Z=n[1],oe=n[2];return t===r?(r[12]=t[0]*G+t[4]*Z+t[8]*oe+t[12],r[13]=t[1]*G+t[5]*Z+t[9]*oe+t[13],r[14]=t[2]*G+t[6]*Z+t[10]*oe+t[14],r[15]=t[3]*G+t[7]*Z+t[11]*oe+t[15]):(h=t[1],m=t[2],_=t[3],v=t[4],T=t[5],E=t[6],M=t[7],P=t[8],z=t[9],F=t[10],B=t[11],r[0]=l=t[0],r[1]=h,r[2]=m,r[3]=_,r[4]=v,r[5]=T,r[6]=E,r[7]=M,r[8]=P,r[9]=z,r[10]=F,r[11]=B,r[12]=l*G+v*Z+P*oe+t[12],r[13]=h*G+T*Z+z*oe+t[13],r[14]=m*G+E*Z+F*oe+t[14],r[15]=_*G+M*Z+B*oe+t[15]),r}function Cl(r,t,n){var l=n[0],h=n[1],m=n[2];return r[0]=t[0]*l,r[1]=t[1]*l,r[2]=t[2]*l,r[3]=t[3]*l,r[4]=t[4]*h,r[5]=t[5]*h,r[6]=t[6]*h,r[7]=t[7]*h,r[8]=t[8]*m,r[9]=t[9]*m,r[10]=t[10]*m,r[11]=t[11]*m,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function U_(r,t,n){var l=Math.sin(n),h=Math.cos(n),m=t[4],_=t[5],v=t[6],T=t[7],E=t[8],M=t[9],P=t[10],z=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=m*h+E*l,r[5]=_*h+M*l,r[6]=v*h+P*l,r[7]=T*h+z*l,r[8]=E*h-m*l,r[9]=M*h-_*l,r[10]=P*h-v*l,r[11]=z*h-T*l,r}function kp(r,t,n){var l=Math.sin(n),h=Math.cos(n),m=t[0],_=t[1],v=t[2],T=t[3],E=t[8],M=t[9],P=t[10],z=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=m*h-E*l,r[1]=_*h-M*l,r[2]=v*h-P*l,r[3]=T*h-z*l,r[8]=m*l+E*h,r[9]=_*l+M*h,r[10]=v*l+P*h,r[11]=T*l+z*h,r}function V1(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function $1(r,t,n){var l,h,m,_=n[0],v=n[1],T=n[2],E=Math.hypot(_,v,T);return E<Pp?null:(_*=E=1/E,v*=E,T*=E,l=Math.sin(t),h=Math.cos(t),r[0]=_*_*(m=1-h)+h,r[1]=v*_*m+T*l,r[2]=T*_*m-v*l,r[3]=0,r[4]=_*v*m-T*l,r[5]=v*v*m+h,r[6]=T*v*m+_*l,r[7]=0,r[8]=_*T*m+v*l,r[9]=v*T*m-_*l,r[10]=T*T*m+h,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var PI=Gc;function V_(){var r=new Rr(3);return Rr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function j1(r){var t=new Rr(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function Hh(r){return Math.hypot(r[0],r[1],r[2])}function qc(r,t,n){var l=new Rr(3);return l[0]=r,l[1]=t,l[2]=n,l}function ga(r,t,n){return r[0]=t[0]+n[0],r[1]=t[1]+n[1],r[2]=t[2]+n[2],r}function $_(r,t,n){return r[0]=t[0]-n[0],r[1]=t[1]-n[1],r[2]=t[2]-n[2],r}function G1(r,t,n){return r[0]=t[0]*n[0],r[1]=t[1]*n[1],r[2]=t[2]*n[2],r}function j_(r,t,n){return r[0]=Math.min(t[0],n[0]),r[1]=Math.min(t[1],n[1]),r[2]=Math.min(t[2],n[2]),r}function G_(r,t,n){return r[0]=Math.max(t[0],n[0]),r[1]=Math.max(t[1],n[1]),r[2]=Math.max(t[2],n[2]),r}function Ds(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r}function Lp(r,t,n,l){return r[0]=t[0]+n[0]*l,r[1]=t[1]+n[1]*l,r[2]=t[2]+n[2]*l,r}function fr(r,t){var n=t[0],l=t[1],h=t[2],m=n*n+l*l+h*h;return m>0&&(m=1/Math.sqrt(m)),r[0]=t[0]*m,r[1]=t[1]*m,r[2]=t[2]*m,r}function vs(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function q_(r,t,n){var l=t[0],h=t[1],m=t[2],_=n[0],v=n[1],T=n[2];return r[0]=h*T-m*v,r[1]=m*_-l*T,r[2]=l*v-h*_,r}function An(r,t,n){var l=t[0],h=t[1],m=t[2],_=n[3]*l+n[7]*h+n[11]*m+n[15];return r[0]=(n[0]*l+n[4]*h+n[8]*m+n[12])/(_=_||1),r[1]=(n[1]*l+n[5]*h+n[9]*m+n[13])/_,r[2]=(n[2]*l+n[6]*h+n[10]*m+n[14])/_,r}function q1(r,t,n){var l=n[0],h=n[1],m=n[2],_=t[0],v=t[1],T=t[2],E=h*T-m*v,M=m*_-l*T,P=l*v-h*_,z=h*P-m*M,F=m*E-l*P,B=l*M-h*E,G=2*n[3];return M*=G,P*=G,F*=2,B*=2,r[0]=_+(E*=G)+(z*=2),r[1]=v+M+F,r[2]=T+P+B,r}var Zh,Os=$_,kI=G1,LI=Hh;function W1(r,t,n){return r[0]=t[0]*n,r[1]=t[1]*n,r[2]=t[2]*n,r[3]=t[3]*n,r}function Ml(r,t,n){var l=t[0],h=t[1],m=t[2],_=t[3];return r[0]=n[0]*l+n[4]*h+n[8]*m+n[12]*_,r[1]=n[1]*l+n[5]*h+n[9]*m+n[13]*_,r[2]=n[2]*l+n[6]*h+n[10]*m+n[14]*_,r[3]=n[3]*l+n[7]*h+n[11]*m+n[15]*_,r}function H1(){var r=new Rr(4);return Rr!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Z1(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function X1(r,t,n){n*=.5;var l=t[0],h=t[1],m=t[2],_=t[3],v=Math.sin(n),T=Math.cos(n);return r[0]=l*T+_*v,r[1]=h*T+m*v,r[2]=m*T-h*v,r[3]=_*T-l*v,r}function K1(r,t,n){n*=.5;var l=t[0],h=t[1],m=t[2],_=t[3],v=Math.sin(n),T=Math.cos(n);return r[0]=l*T-m*v,r[1]=h*T+_*v,r[2]=m*T+l*v,r[3]=_*T-h*v,r}V_(),Zh=new Rr(4),Rr!=Float32Array&&(Zh[0]=0,Zh[1]=0,Zh[2]=0,Zh[3]=0),V_(),qc(1,0,0),qc(0,1,0),H1(),H1(),U1();class W_{constructor(t,n){this.pos=t,this.dir=n}intersectsPlane(t,n,l){const h=vs(n,this.dir);if(Math.abs(h)<1e-6)return!1;const m=((t[0]-this.pos[0])*n[0]+(t[1]-this.pos[1])*n[1]+(t[2]-this.pos[2])*n[2])/h;return l[0]=this.pos[0]+this.dir[0]*m,l[1]=this.pos[1]+this.dir[1]*m,l[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(t,n,l){if(function(F,B){var G=F[0],Z=F[1],oe=F[2],me=B[0],le=B[1],fe=B[2];return Math.abs(G-me)<=Pp*Math.max(1,Math.abs(G),Math.abs(me))&&Math.abs(Z-le)<=Pp*Math.max(1,Math.abs(Z),Math.abs(le))&&Math.abs(oe-fe)<=Pp*Math.max(1,Math.abs(oe),Math.abs(fe))}(this.pos,t)||n===0)return l[0]=l[1]=l[2]=0,!1;const[h,m,_]=this.dir,v=this.pos[0]-t[0],T=this.pos[1]-t[1],E=this.pos[2]-t[2],M=h*h+m*m+_*_,P=2*(v*h+T*m+E*_),z=P*P-4*M*(v*v+T*T+E*E-n*n);if(z<0){const F=Math.max(-P/2,0),B=v+h*F,G=T+m*F,Z=E+_*F,oe=Math.hypot(B,G,Z);return l[0]=B*n/oe,l[1]=G*n/oe,l[2]=Z*n/oe,!1}{const F=(-P-Math.sqrt(z))/(2*M);if(F<0){const B=Math.hypot(v,T,E);return l[0]=v*n/B,l[1]=T*n/B,l[2]=E*n/B,!1}return l[0]=v+h*F,l[1]=T+m*F,l[2]=E+_*F,!0}}}class H_{constructor(t,n,l,h,m){this.TL=t,this.TR=n,this.BR=l,this.BL=h,this.horizon=m}static fromInvProjectionMatrix(t,n,l){const h=[-1,1,1],m=[1,1,1],_=[1,-1,1],v=[-1,-1,1],T=An(h,h,t),E=An(m,m,t),M=An(_,_,t),P=An(v,v,t);return new H_(T,E,M,P,n/l)}}class Z_{constructor(t,n){this.points=t,this.planes=n}static fromInvProjectionMatrix(t,n,l,h){const m=Math.pow(2,l),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const E=Ml([],T,t),M=1/E[3]/n*m;return function(P,z,F){return P[0]=z[0]*F[0],P[1]=z[1]*F[1],P[2]=z[2]*F[2],P[3]=z[3]*F[3],P}(E,E,[M,M,h?1/E[3]:M,M])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const E=fr([],q_([],Os([],_[T[0]],_[T[1]]),Os([],_[T[2]],_[T[1]]))),M=-vs(E,_[T[1]]);return E.concat(M)});return new Z_(_,v)}}class Sr{static fromPoints(t){const n=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],l=[Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];for(const h of t)n[0]=Math.min(n[0],h[0]),n[1]=Math.min(n[1],h[1]),n[2]=Math.min(n[2],h[2]),l[0]=Math.max(l[0],h[0]),l[1]=Math.max(l[1],h[1]),l[2]=Math.max(l[2],h[2]);return new Sr(n,l)}constructor(t,n){this.min=t,this.max=n,this.center=Ds([],ga([],this.min,this.max),.5)}quadrant(t){const n=[t%2==0,t<2],l=j1(this.min),h=j1(this.max);for(let m=0;m<n.length;m++)l[m]=n[m]?this.min[m]:this.center[m],h[m]=n[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Sr(l,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,n=this.max;return[[t[0],t[1],t[2]],[n[0],t[1],t[2]],[n[0],n[1],t[2]],[t[0],n[1],t[2]],[t[0],t[1],n[2]],[n[0],t[1],n[2]],[n[0],n[1],n[2]],[t[0],n[1],n[2]]]}intersects(t){const n=this.getCorners();let l=!0;for(let h=0;h<t.planes.length;h++){const m=t.planes[h];let _=0;for(let v=0;v<n.length;v++)_+=vs(m,n[v])+m[3]>=0;if(_===0)return 0;_!==n.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let v=0;v<t.points.length;v++){const T=t.points[v][h]-this.min[h];m=Math.min(m,T),_=Math.max(_,T)}if(_<0||m>this.max[h]-this.min[h])return 0}return 1}}function Y1(r,t,n,l,h,m,_,v,T){if(m&&r.queryGeometry.isAboveHorizon)return!1;m&&(T*=r.pixelToTileUnitsFactor);const E=r.tileID.canonical,M=n.projection.upVectorScale(E,n.center.lat,n.worldSize).metersToTile;for(const P of t)for(const z of P){const F=z.add(v),B=h&&n.elevation?n.elevation.exaggeration()*h.getElevationAt(F.x,F.y,!0):0,G=n.projection.projectTilePoint(F.x,F.y,E);if(B>0){const le=n.projection.upVector(E,F.x,F.y);G.x+=le[0]*M*B,G.y+=le[1]*M*B,G.z+=le[2]*M*B}const Z=m?F:zI(G.x,G.y,G.z,l),oe=m?r.tilespaceRays.map(le=>DI(le,B)):r.queryGeometry.screenGeometry,me=Ml([],[G.x,G.y,G.z,1],l);if(!_&&m?T*=me[3]/n.cameraToCenterDistance:_&&!m&&(T*=n.cameraToCenterDistance/me[3]),m){const le=Xn((z.y/Wt+E.y)/(1<<E.z));T/=n.projection.pixelsPerMeter(le,1)/_s(1,le)}if(EI(oe,Z,T))return!0}return!1}function zI(r,t,n,l){const h=Ml([],[r,t,n,1],l);return new k(h[0]/h[3],h[1]/h[3])}const Q1=qc(0,0,0),RI=qc(0,0,1);function DI(r,t){const n=V_();return Q1[2]=t,r.intersectsPlane(Q1,RI,n),new k(n[0],n[1])}class J1 extends O_{}function eb(r,{width:t,height:n},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*n*l)throw new RangeError("mismatched image size")}else h=new Uint8Array(t*n*l);return r.width=t,r.height=n,r.data=h,r}function tb(r,t,n){const{width:l,height:h}=t;l===r.width&&h===r.height||(X_(r,t,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,l),height:Math.min(r.height,h)},n),r.width=l,r.height=h,r.data=t.data)}function X_(r,t,n,l,h,m){if(h.width===0||h.height===0)return t;if(h.width>r.width||h.height>r.height||n.x>r.width-h.width||n.y>r.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const _=r.data,v=t.data;for(let T=0;T<h.height;T++){const E=((n.y+T)*r.width+n.x)*m,M=((l.y+T)*t.width+l.x)*m;for(let P=0;P<h.width*m;P++)v[M+P]=_[E+P]}return t}Ct(J1,"HeatmapBucket",{omit:["layers"]});class Fo{constructor(t,n){eb(this,t,1,n)}resize(t){tb(this,new Fo(t),1)}clone(){return new Fo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,h,m){X_(t,n,l,h,m,1)}}class Dr{constructor(t,n){eb(this,t,4,n)}resize(t){tb(this,new Dr(t),4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Dr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,l,h,m){X_(t,n,l,h,m,4)}}Ct(Fo,"AlphaImage"),Ct(Dr,"RGBAImage");var OI={paint:new Xe({"heatmap-radius":new Me(Ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Me(Ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ve(Ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ke(Ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ve(Ve.paint_heatmap["heatmap-opacity"])})};function K_(r){const t={},n=r.resolution||256,l=r.clips?r.clips.length:1,h=r.image||new Dr({width:n,height:l}),m=(_,v,T)=>{t[r.evaluationKey]=T;const E=r.expression.evaluate(t);h.data[_+v+0]=Math.floor(255*E.r/E.a),h.data[_+v+1]=Math.floor(255*E.g/E.a),h.data[_+v+2]=Math.floor(255*E.b/E.a),h.data[_+v+3]=Math.floor(255*E.a)};if(r.clips)for(let _=0,v=0;_<l;++_,v+=4*n)for(let T=0,E=0;T<n;T++,E+=4){const M=T/(n-1),{start:P,end:z}=r.clips[_];m(v,E,P*(1-M)+z*M)}else for(let _=0,v=0;_<n;_++,v+=4)m(0,v,_/(n-1));return h}var FI={paint:new Xe({"hillshade-illumination-direction":new ve(Ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ve(Ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ve(Ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ve(Ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ve(Ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ve(Ve.paint_hillshade["hillshade-accent-color"])})};const BI=it([{name:"a_pos",components:2,type:"Int16"}],4),{members:NI}=BI;var zp=Rp,UI=Rp;function Rp(r,t,n){n=n||2;var l,h,m,_,v,T,E,M=t&&t.length,P=M?t[0]*n:r.length,z=ib(r,0,P,n,!0),F=[];if(!z||z.next===z.prev)return F;if(M&&(z=function(G,Z,oe,me){var le,fe,Se,ye=[];for(le=0,fe=Z.length;le<fe;le++)(Se=ib(G,Z[le]*me,le<fe-1?Z[le+1]*me:G.length,me,!1))===Se.next&&(Se.steiner=!0),ye.push(ZI(Se));for(ye.sort(qI),le=0;le<ye.length;le++)oe=WI(ye[le],oe);return oe}(r,t,z,n)),r.length>80*n){l=m=r[0],h=_=r[1];for(var B=n;B<P;B+=n)(v=r[B])<l&&(l=v),(T=r[B+1])<h&&(h=T),v>m&&(m=v),T>_&&(_=T);E=(E=Math.max(m-l,_-h))!==0?32767/E:0}return Xh(z,F,n,l,h,E,0),F}function ib(r,t,n,l,h){var m,_;if(h===J_(r,t,n,l)>0)for(m=t;m<n;m+=l)_=sb(m,r[m],r[m+1],_);else for(m=n-l;m>=t;m-=l)_=sb(m,r[m],r[m+1],_);return _&&Dp(_,_.next)&&(Yh(_),_=_.next),_}function Il(r,t){if(!r)return r;t||(t=r);var n,l=r;do if(n=!1,l.steiner||!Dp(l,l.next)&&wn(l.prev,l,l.next)!==0)l=l.next;else{if(Yh(l),(l=t=l.prev)===l.next)break;n=!0}while(n||l!==t);return t}function Xh(r,t,n,l,h,m,_){if(r){!_&&m&&function(M,P,z,F){var B=M;do B.z===0&&(B.z=Y_(B.x,B.y,P,z,F)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==M);B.prevZ.nextZ=null,B.prevZ=null,function(G){var Z,oe,me,le,fe,Se,ye,Ue,Be=1;do{for(oe=G,G=null,fe=null,Se=0;oe;){for(Se++,me=oe,ye=0,Z=0;Z<Be&&(ye++,me=me.nextZ);Z++);for(Ue=Be;ye>0||Ue>0&&me;)ye!==0&&(Ue===0||!me||oe.z<=me.z)?(le=oe,oe=oe.nextZ,ye--):(le=me,me=me.nextZ,Ue--),fe?fe.nextZ=le:G=le,le.prevZ=fe,fe=le;oe=me}fe.nextZ=null,Be*=2}while(Se>1)}(B)}(r,l,h,m);for(var v,T,E=r;r.prev!==r.next;)if(v=r.prev,T=r.next,m?$I(r,l,h,m):VI(r))t.push(v.i/n|0),t.push(r.i/n|0),t.push(T.i/n|0),Yh(r),r=T.next,E=T.next;else if((r=T)===E){_?_===1?Xh(r=jI(Il(r),t,n),t,n,l,h,m,2):_===2&&GI(r,t,n,l,h,m):Xh(Il(r),t,n,l,h,m,1);break}}}function VI(r){var t=r.prev,n=r,l=r.next;if(wn(t,n,l)>=0)return!1;for(var h=t.x,m=n.x,_=l.x,v=t.y,T=n.y,E=l.y,M=h<m?h<_?h:_:m<_?m:_,P=v<T?v<E?v:E:T<E?T:E,z=h>m?h>_?h:_:m>_?m:_,F=v>T?v>E?v:E:T>E?T:E,B=l.next;B!==t;){if(B.x>=M&&B.x<=z&&B.y>=P&&B.y<=F&&Wc(h,v,m,T,_,E,B.x,B.y)&&wn(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function $I(r,t,n,l){var h=r.prev,m=r,_=r.next;if(wn(h,m,_)>=0)return!1;for(var v=h.x,T=m.x,E=_.x,M=h.y,P=m.y,z=_.y,F=v<T?v<E?v:E:T<E?T:E,B=M<P?M<z?M:z:P<z?P:z,G=v>T?v>E?v:E:T>E?T:E,Z=M>P?M>z?M:z:P>z?P:z,oe=Y_(F,B,t,n,l),me=Y_(G,Z,t,n,l),le=r.prevZ,fe=r.nextZ;le&&le.z>=oe&&fe&&fe.z<=me;){if(le.x>=F&&le.x<=G&&le.y>=B&&le.y<=Z&&le!==h&&le!==_&&Wc(v,M,T,P,E,z,le.x,le.y)&&wn(le.prev,le,le.next)>=0||(le=le.prevZ,fe.x>=F&&fe.x<=G&&fe.y>=B&&fe.y<=Z&&fe!==h&&fe!==_&&Wc(v,M,T,P,E,z,fe.x,fe.y)&&wn(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;le&&le.z>=oe;){if(le.x>=F&&le.x<=G&&le.y>=B&&le.y<=Z&&le!==h&&le!==_&&Wc(v,M,T,P,E,z,le.x,le.y)&&wn(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;fe&&fe.z<=me;){if(fe.x>=F&&fe.x<=G&&fe.y>=B&&fe.y<=Z&&fe!==h&&fe!==_&&Wc(v,M,T,P,E,z,fe.x,fe.y)&&wn(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function jI(r,t,n){var l=r;do{var h=l.prev,m=l.next.next;!Dp(h,m)&&nb(h,l,l.next,m)&&Kh(h,m)&&Kh(m,h)&&(t.push(h.i/n|0),t.push(l.i/n|0),t.push(m.i/n|0),Yh(l),Yh(l.next),l=r=m),l=l.next}while(l!==r);return Il(l)}function GI(r,t,n,l,h,m){var _=r;do{for(var v=_.next.next;v!==_.prev;){if(_.i!==v.i&&XI(_,v)){var T=rb(_,v);return _=Il(_,_.next),T=Il(T,T.next),Xh(_,t,n,l,h,m,0),void Xh(T,t,n,l,h,m,0)}v=v.next}_=_.next}while(_!==r)}function qI(r,t){return r.x-t.x}function WI(r,t){var n=function(h,m){var _,v=m,T=h.x,E=h.y,M=-1/0;do{if(E<=v.y&&E>=v.next.y&&v.next.y!==v.y){var P=v.x+(E-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(P<=T&&P>M&&(M=P,_=v.x<v.next.x?v:v.next,P===T))return _}v=v.next}while(v!==m);if(!_)return null;var z,F=_,B=_.x,G=_.y,Z=1/0;v=_;do T>=v.x&&v.x>=B&&T!==v.x&&Wc(E<G?T:M,E,B,G,E<G?M:T,E,v.x,v.y)&&(z=Math.abs(E-v.y)/(T-v.x),Kh(v,h)&&(z<Z||z===Z&&(v.x>_.x||v.x===_.x&&HI(_,v)))&&(_=v,Z=z)),v=v.next;while(v!==F);return _}(r,t);if(!n)return t;var l=rb(n,r);return Il(l,l.next),Il(n,n.next)}function HI(r,t){return wn(r.prev,r,t.prev)<0&&wn(t.next,r,r.next)<0}function Y_(r,t,n,l,h){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-n)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ZI(r){var t=r,n=r;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==r);return n}function Wc(r,t,n,l,h,m,_,v){return(h-_)*(t-v)>=(r-_)*(m-v)&&(r-_)*(l-v)>=(n-_)*(t-v)&&(n-_)*(m-v)>=(h-_)*(l-v)}function XI(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(n,l){var h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==l.i&&h.next.i!==l.i&&nb(h,h.next,n,l))return!0;h=h.next}while(h!==n);return!1}(r,t)&&(Kh(r,t)&&Kh(t,r)&&function(n,l){var h=n,m=!1,_=(n.x+l.x)/2,v=(n.y+l.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&_<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==n);return m}(r,t)&&(wn(r.prev,r,t.prev)||wn(r,t.prev,t))||Dp(r,t)&&wn(r.prev,r,r.next)>0&&wn(t.prev,t,t.next)>0)}function wn(r,t,n){return(t.y-r.y)*(n.x-t.x)-(t.x-r.x)*(n.y-t.y)}function Dp(r,t){return r.x===t.x&&r.y===t.y}function nb(r,t,n,l){var h=Fp(wn(r,t,n)),m=Fp(wn(r,t,l)),_=Fp(wn(n,l,r)),v=Fp(wn(n,l,t));return h!==m&&_!==v||!(h!==0||!Op(r,n,t))||!(m!==0||!Op(r,l,t))||!(_!==0||!Op(n,r,l))||!(v!==0||!Op(n,t,l))}function Op(r,t,n){return t.x<=Math.max(r.x,n.x)&&t.x>=Math.min(r.x,n.x)&&t.y<=Math.max(r.y,n.y)&&t.y>=Math.min(r.y,n.y)}function Fp(r){return r>0?1:r<0?-1:0}function Kh(r,t){return wn(r.prev,r,r.next)<0?wn(r,t,r.next)>=0&&wn(r,r.prev,t)>=0:wn(r,t,r.prev)<0||wn(r,r.next,t)<0}function rb(r,t){var n=new Q_(r.i,r.x,r.y),l=new Q_(t.i,t.x,t.y),h=r.next,m=t.prev;return r.next=t,t.prev=r,n.next=h,h.prev=n,l.next=n,n.prev=l,m.next=l,l.prev=m,l}function sb(r,t,n,l){var h=new Q_(r,t,n);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function Yh(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Q_(r,t,n){this.i=r,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function J_(r,t,n,l){for(var h=0,m=t,_=n-l;m<n;m+=l)h+=(r[_]-r[m])*(r[m+1]+r[_+1]),_=m;return h}function KI(r,t,n,l,h){ob(r,t,n||0,l||r.length-1,h||YI)}function ob(r,t,n,l,h){for(;l>n;){if(l-n>600){var m=l-n+1,_=t-n+1,v=Math.log(m),T=.5*Math.exp(2*v/3),E=.5*Math.sqrt(v*T*(m-T)/m)*(_-m/2<0?-1:1);ob(r,t,Math.max(n,Math.floor(t-_*T/m+E)),Math.min(l,Math.floor(t+(m-_)*T/m+E)),h)}var M=r[t],P=n,z=l;for(Qh(r,n,t),h(r[l],M)>0&&Qh(r,n,l);P<z;){for(Qh(r,P,z),P++,z--;h(r[P],M)<0;)P++;for(;h(r[z],M)>0;)z--}h(r[n],M)===0?Qh(r,n,z):Qh(r,++z,l),z<=t&&(n=z+1),t<=z&&(l=z-1)}}function Qh(r,t,n){var l=r[t];r[t]=r[n],r[n]=l}function YI(r,t){return r<t?-1:r>t?1:0}function ey(r,t){const n=r.length;if(n<=1)return[r];const l=[];let h,m;for(let _=0;_<n;_++){const v=fn(r[_]);v!==0&&(r[_].area=Math.abs(v),m===void 0&&(m=v<0),m===v<0?(h&&l.push(h),h=[r[_]]):h.push(r[_]))}if(h&&l.push(h),t>1)for(let _=0;_<l.length;_++)l[_].length<=t||(KI(l[_],t,1,l[_].length-1,QI),l[_]=l[_].slice(0,t));return l}function QI(r,t){return t.area-r.area}function ty(r,t,n){const l=n.patternDependencies;let h=!1;for(const m of t){const _=m.paint.get(`${r}-pattern`);_.isConstant()||(h=!0);const v=_.constantOr(null);v&&(h=!0,l[v.to]=!0,l[v.from]=!0)}return h}function iy(r,t,n,l,h){const m=h.patternDependencies;for(const _ of t){const v=_.paint.get(`${r}-pattern`).value;if(v.kind!=="constant"){let T=v.evaluate({zoom:l-1},n,{},h.availableImages),E=v.evaluate({zoom:l},n,{},h.availableImages),M=v.evaluate({zoom:l+1},n,{},h.availableImages);T=T&&T.name?T.name:T,E=E&&E.name?E.name:E,M=M&&M.name?M.name:M,m[T]=!0,m[E]=!0,m[M]=!0,n.patterns[_.id]={min:T,mid:E,max:M}}}return n}Rp.deviation=function(r,t,n,l){var h=t&&t.length,m=Math.abs(J_(r,0,h?t[0]*n:r.length,n));if(h)for(var _=0,v=t.length;_<v;_++)m-=Math.abs(J_(r,t[_]*n,_<v-1?t[_+1]*n:r.length,n));var T=0;for(_=0;_<l.length;_+=3){var E=l[_]*n,M=l[_+1]*n,P=l[_+2]*n;T+=Math.abs((r[E]-r[P])*(r[M+1]-r[E+1])-(r[E]-r[M])*(r[P+1]-r[E+1]))}return m===0&&T===0?0:Math.abs((T-m)/m)},Rp.flatten=function(r){for(var t=r[0][0].length,n={vertices:[],holes:[],dimensions:t},l=0,h=0;h<r.length;h++){for(var m=0;m<r[h].length;m++)for(var _=0;_<t;_++)n.vertices.push(r[h][m][_]);h>0&&n.holes.push(l+=r[h-1].length)}return n},zp.default=UI;class Bp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new vt,this.indexArray=new ai,this.indexArray2=new nr,this.programConfigurations=new El(t.layers,t.zoom),this.segments=new En,this.segments2=new En,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=t.projection}populate(t,n,l,h){this.hasPattern=ty("fill",this.layers,n);const m=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:v,id:T,index:E,sourceLayerIndex:M}of t){const P=this.layers[0]._featureFilter.needGeometry,z=Sl(v,P);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),z,l))continue;const F=m?m.evaluate(z,{},l,n.availableImages):void 0,B={id:T,properties:v.properties,type:v.type,sourceLayerIndex:M,index:E,geometry:P?z.geometry:Oo(v,l,h),patterns:{},sortKey:F};_.push(B)}m&&_.sort((v,T)=>v.sortKey-T.sortKey);for(const v of _){const{geometry:T,index:E,sourceLayerIndex:M}=v;if(this.hasPattern){const P=iy("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(P)}else this.addFeature(v,T,E,l,{},n.availableImages);n.featureIndex.insert(t[E].feature,T,E,M,this.index)}}update(t,n,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l,h)}addFeatures(t,n,l,h,m){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,n,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,NI),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,l,h,m,_=[]){for(const v of ey(n,500)){let T=0;for(const B of v)T+=B.length;const E=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),M=E.vertexLength,P=[],z=[];for(const B of v){if(B.length===0)continue;B!==v[0]&&z.push(P.length/2);const G=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),Z=G.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(Z+B.length-1,Z),P.push(B[0].x),P.push(B[0].y);for(let oe=1;oe<B.length;oe++)this.layoutVertexArray.emplaceBack(B[oe].x,B[oe].y),this.indexArray2.emplaceBack(Z+oe-1,Z+oe),P.push(B[oe].x),P.push(B[oe].y);G.vertexLength+=B.length,G.primitiveLength+=B.length}const F=zp(P,z);for(let B=0;B<F.length;B+=3)this.indexArray.emplaceBack(M+F[B],M+F[B+1],M+F[B+2]);E.vertexLength+=T,E.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,_,h)}}Ct(Bp,"FillBucket",{omit:["layers","patternFeatures"]});const JI=new Xe({"fill-sort-key":new Me(Ve.layout_fill["fill-sort-key"])});var eP={paint:new Xe({"fill-antialias":new ve(Ve.paint_fill["fill-antialias"]),"fill-opacity":new Me(Ve.paint_fill["fill-opacity"]),"fill-color":new Me(Ve.paint_fill["fill-color"]),"fill-outline-color":new Me(Ve.paint_fill["fill-outline-color"]),"fill-translate":new ve(Ve.paint_fill["fill-translate"]),"fill-translate-anchor":new ve(Ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new Oe(Ve.paint_fill["fill-pattern"])}),layout:JI};const tP=it([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),iP=it([{name:"a_centroid_pos",components:2,type:"Uint16"}]),nP=it([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:rP}=tP;var ab=Hc;function Hc(r,t,n,l,h){this.properties={},this.extent=n,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=h,r.readFields(sP,this,t)}function sP(r,t,n){r==1?t.id=n.readVarint():r==2?function(l,h){for(var m=l.readVarint()+l.pos;l.pos<m;){var _=h._keys[l.readVarint()],v=h._values[l.readVarint()];h.properties[_]=v}}(n,t):r==3?t.type=n.readVarint():r==4&&(t._geometry=n.pos)}function oP(r){for(var t,n,l=0,h=0,m=r.length,_=m-1;h<m;_=h++)l+=((n=r[_]).x-(t=r[h]).x)*(t.y+n.y);return l}Hc.types=["Unknown","Point","LineString","Polygon"],Hc.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,n=r.readVarint()+r.pos,l=1,h=0,m=0,_=0,v=[];r.pos<n;){if(h<=0){var T=r.readVarint();l=7&T,h=T>>3}if(h--,l===1||l===2)m+=r.readSVarint(),_+=r.readSVarint(),l===1&&(t&&v.push(t),t=[]),t.push(new k(m,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&v.push(t),v},Hc.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,n=1,l=0,h=0,m=0,_=1/0,v=-1/0,T=1/0,E=-1/0;r.pos<t;){if(l<=0){var M=r.readVarint();n=7&M,l=M>>3}if(l--,n===1||n===2)(h+=r.readSVarint())<_&&(_=h),h>v&&(v=h),(m+=r.readSVarint())<T&&(T=m),m>E&&(E=m);else if(n!==7)throw new Error("unknown command "+n)}return[_,T,v,E]},Hc.prototype.toGeoJSON=function(r,t,n){var l,h,m=this.extent*Math.pow(2,n),_=this.extent*r,v=this.extent*t,T=this.loadGeometry(),E=Hc.types[this.type];function M(F){for(var B=0;B<F.length;B++){var G=F[B];F[B]=[360*(G.x+_)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+v)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(l=0;l<T.length;l++)P[l]=T[l][0];M(T=P);break;case 2:for(l=0;l<T.length;l++)M(T[l]);break;case 3:for(T=function(F){var B=F.length;if(B<=1)return[F];for(var G,Z,oe=[],me=0;me<B;me++){var le=oP(F[me]);le!==0&&(Z===void 0&&(Z=le<0),Z===le<0?(G&&oe.push(G),G=[F[me]]):G.push(F[me]))}return G&&oe.push(G),oe}(T),l=0;l<T.length;l++)for(h=0;h<T[l].length;h++)M(T[l][h])}T.length===1?T=T[0]:E="Multi"+E;var z={type:"Feature",geometry:{type:E,coordinates:T},properties:this.properties};return"id"in this&&(z.id=this.id),z};var lb=cb;function cb(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(aP,this,t),this.length=this._features.length}function aP(r,t,n){r===15?t.version=n.readVarint():r===1?t.name=n.readString():r===5?t.extent=n.readVarint():r===2?t._features.push(n.pos):r===3?t._keys.push(n.readString()):r===4&&t._values.push(function(l){for(var h=null,m=l.readVarint()+l.pos;l.pos<m;){var _=l.readVarint()>>3;h=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return h}(n))}function lP(r,t,n){if(r===3){var l=new lb(n,n.readVarint()+n.pos);l.length&&(t[l.name]=l)}}cb.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new ab(this._pbf,t,this.extent,this._keys,this._values)};var Pl={VectorTile:function(r,t){this.layers=r.readFields(lP,{},t)},VectorTileFeature:ab,VectorTileLayer:lb};function Np(r,t,n,l){const h=[],m=l===0?(_,v,T,E,M,P)=>{_.push(new k(P,T+(P-v)/(E-v)*(M-T)))}:(_,v,T,E,M,P)=>{_.push(new k(v+(P-T)/(M-T)*(E-v),P))};for(const _ of r){const v=[];for(const T of _){if(T.length<=2)continue;const E=[];for(let z=0;z<T.length-1;z++){const F=T[z].x,B=T[z].y,G=T[z+1].x,Z=T[z+1].y,oe=l===0?F:B,me=l===0?G:Z;oe<t?me>t&&m(E,F,B,G,Z,t):oe>n?me<n&&m(E,F,B,G,Z,n):E.push(T[z]),me<t&&oe>=t&&m(E,F,B,G,Z,t),me>n&&oe<=n&&m(E,F,B,G,Z,n)}let M=T[T.length-1];const P=l===0?M.x:M.y;P>=t&&P<=n&&E.push(M),E.length&&(M=E[E.length-1],E[0].x===M.x&&E[0].y===M.y||E.push(E[0]),v.push(E))}v.length&&h.push(v)}return h}const cP=Pl.VectorTileFeature.types,uP=Math.pow(2,13);function Jh(r,t,n,l,h,m,_,v){r.emplaceBack((t<<1)+_,(n<<1)+m,(Math.floor(l*uP)<<1)+h,Math.round(v))}function ed(r,t,n){r.emplaceBack(t.x,t.y,t.z,n[0]*16384,n[1]*16384,n[2]*16384)}class ub{constructor(){this.acc=new k(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new k(t.x,t.y),this.max=new k(t.x,t.y))}append(t,n){this.currentPolyCount.edges++,this.acc._add(t);const l=this.min,h=this.max;t.x<l.x?l.x=t.x:t.x>h.x&&(h.x=t.x),t.y<l.y?l.y=t.y:t.y>h.y&&(h.y=t.y),((t.x===0||t.x===Wt)&&t.x===n.x)!=((t.y===0||t.y===Wt)&&t.y===n.y)&&this.processBorderOverlap(t,n),n.x<0!=t.x<0&&this.addBorderIntersection(0,Ti(n.y,t.y,(0-n.x)/(t.x-n.x))),n.x>Wt!=t.x>Wt&&this.addBorderIntersection(1,Ti(n.y,t.y,(Wt-n.x)/(t.x-n.x))),n.y<0!=t.y<0&&this.addBorderIntersection(2,Ti(n.x,t.x,(0-n.y)/(t.y-n.y))),n.y>Wt!=t.y>Wt&&this.addBorderIntersection(3,Ti(n.x,t.x,(Wt-n.y)/(t.y-n.y)))}addBorderIntersection(t,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[t];n<l[0]&&(l[0]=n),n>l[1]&&(l[1]=n)}processBorderOverlap(t,n){if(t.x===n.x){if(t.y===n.y)return;const l=t.x===0?0:1;this.addBorderIntersection(l,n.y),this.addBorderIntersection(l,t.y)}else{const l=t.y===0?2:3;this.addBorderIntersection(l,n.x),this.addBorderIntersection(l,t.x)}}centroid(){const t=this.polyCount.reduce((n,l)=>n+l.edges,0);return t!==0?this.acc.div(t)._round():new k(0,0)}span(){return new k(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,n)=>t+ +(n[0]!==Number.MAX_VALUE),0)}}class td{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new Ut,this.centroidVertexArray=new x1,this.indexArray=new ai,this.programConfigurations=new El(t.layers,t.zoom),this.segments=new En,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=t.enableTerrain}populate(t,n,l,h){this.features=[],this.hasPattern=ty("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(m){const _=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*_/(_*_+1)/Wt/(1<<m.z)}(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:_,index:v,sourceLayerIndex:T}of t){const E=this.layers[0]._featureFilter.needGeometry,M=Sl(m,E);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),M,l))continue;const P={id:_,sourceLayerIndex:T,index:v,geometry:E?M.geometry:Oo(m,l,h),properties:m.properties,type:m.type,patterns:{}},z=this.layoutVertexArray.length;this.hasPattern?this.features.push(iy("fill-extrusion",this.layers,P,this.zoom,n)):this.addFeature(P,P.geometry,v,l,{},n.availableImages,h),n.featureIndex.insert(m,P.geometry,v,T,this.index,z)}this.sortBorders()}addFeatures(t,n,l,h,m){for(const _ of this.features){const{geometry:v}=_;this.addFeature(_,v,_.index,n,l,h,m)}this.sortBorders()}update(t,n,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rP),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,nP.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,iP.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,l,h,m,_,v){const T=[new k(0,0),new k(Wt,Wt)],E=v.projection,M=E.name==="globe",P=this.enableTerrain&&!M?new ub:null,z=cP[t.type]==="Polygon";M&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new rr);const F=ey(n,500);for(let oe=F.length-1;oe>=0;oe--){const me=F[oe];(me.length===0||(B=me[0]).every(le=>le.x<=0)||B.every(le=>le.x>=Wt)||B.every(le=>le.y<=0)||B.every(le=>le.y>=Wt))&&F.splice(oe,1)}var B;let G;if(M)G=_b(F,T,h);else{G=[];for(const oe of F)G.push({polygon:oe,bounds:T})}const Z=z?this.edgeRadius:0;for(const{polygon:oe,bounds:me}of G){let le=0,fe=0;for(const ye of oe)z&&!ye[0].equals(ye[ye.length-1])&&ye.push(ye[0]),fe+=z?ye.length-1:ye.length;const Se=this.segments.prepareSegment((z?5:4)*fe,this.layoutVertexArray,this.indexArray);if(z){const ye=[],Ue=[];le=Se.vertexLength;for(const Ze of oe){let mt,$e;Ze.length&&Ze!==oe[0]&&Ue.push(ye.length/2),mt=Ze[1].sub(Ze[0])._perp()._unit();for(let Qe=1;Qe<Ze.length;Qe++){const st=Ze[Qe],Je=Ze[Qe===Ze.length-1?1:Qe+1];let{x:dt,y:ot}=st;if(Z){$e=Je.sub(st)._perp()._unit();const Tt=mt.add($e)._unit(),ei=Z*Math.min(4,1/(mt.x*Tt.x+mt.y*Tt.y));dt+=ei*Tt.x,ot+=ei*Tt.y,mt=$e}Jh(this.layoutVertexArray,dt,ot,0,0,1,1,0),Se.vertexLength++,ye.push(st.x,st.y),M&&ed(this.layoutVertexExtArray,E.projectTilePoint(dt,ot,h),E.upVector(h,dt,ot))}}const Be=zp(ye,Ue);for(let Ze=0;Ze<Be.length;Ze+=3)this.indexArray.emplaceBack(le+Be[Ze],le+Be[Ze+2],le+Be[Ze+1]),Se.primitiveLength++}for(const ye of oe){P&&ye.length&&P.startRing(ye[0]);let Ue,Be,Ze,mt=ye.length>4&&pb(ye[ye.length-2],ye[0],ye[1]),$e=Z?hP(ye[ye.length-2],ye[0],ye[1],Z):0;Be=ye[1].sub(ye[0])._perp()._unit();for(let Qe=1,st=0;Qe<ye.length;Qe++){let Je=ye[Qe-1],dt=ye[Qe];const ot=ye[Qe===ye.length-1?1:Qe+1];if(P&&z&&P.currentPolyCount.top++,fb(dt,Je,me)){Z&&(Be=ot.sub(dt)._perp()._unit());continue}P&&P.append(dt,Je);const Tt=dt.sub(Je)._perp(),ei=Tt.x/(Math.abs(Tt.x)+Math.abs(Tt.y)),ni=Tt.y>0?1:0,Bt=Je.dist(dt);if(st+Bt>32768&&(st=0),Z){Ze=ot.sub(dt)._perp()._unit();let At=db(Je,dt,ot,hb(Be,Ze),Z);isNaN(At)&&(At=0);const qi=dt.sub(Je)._unit();Je=Je.add(qi.mult($e))._round(),dt=dt.add(qi.mult(-At))._round(),$e=At,Be=Ze}const yt=Se.vertexLength,mi=ye.length>4&&pb(Je,dt,ot);let Xt=mb(st,mt,!0);if(Jh(this.layoutVertexArray,Je.x,Je.y,ei,ni,0,0,Xt),Jh(this.layoutVertexArray,Je.x,Je.y,ei,ni,0,1,Xt),st+=Bt,Xt=mb(st,mi,!1),mt=mi,Jh(this.layoutVertexArray,dt.x,dt.y,ei,ni,0,0,Xt),Jh(this.layoutVertexArray,dt.x,dt.y,ei,ni,0,1,Xt),Se.vertexLength+=4,this.indexArray.emplaceBack(yt+0,yt+1,yt+2),this.indexArray.emplaceBack(yt+1,yt+3,yt+2),Se.primitiveLength+=2,Z){const At=le+(Qe===1?ye.length-2:Qe-2),qi=Qe===1?le:At+1;if(this.indexArray.emplaceBack(yt+1,At,yt+3),this.indexArray.emplaceBack(At,qi,yt+3),Se.primitiveLength+=2,Ue===void 0&&(Ue=yt),!fb(ot,ye[Qe],me)){const Ui=Qe===ye.length-1?Ue:Se.vertexLength;this.indexArray.emplaceBack(yt+2,yt+3,Ui),this.indexArray.emplaceBack(yt+3,Ui+1,Ui),this.indexArray.emplaceBack(yt+3,qi,Ui+1),Se.primitiveLength+=3}}if(M){const At=this.layoutVertexExtArray,qi=E.projectTilePoint(Je.x,Je.y,h),Ui=E.projectTilePoint(dt.x,dt.y,h),sn=E.upVector(h,Je.x,Je.y),ri=E.upVector(h,dt.x,dt.y);ed(At,qi,sn),ed(At,qi,sn),ed(At,Ui,ri),ed(At,Ui,ri)}}z&&(le+=ye.length-1)}}if(P&&P.polyCount.length>0){if(P.borders){P.vertexArrayOffset=this.centroidVertexArray.length;const oe=P.borders,me=this.featuresOnBorder.push(P)-1;for(let le=0;le<4;le++)oe[le][0]!==Number.MAX_VALUE&&this.borders[le].push(me)}this.encodeCentroid(P.borders?void 0:P.centroid(),P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,_,h)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((n,l)=>this.featuresOnBorder[n].borders[t][0]-this.featuresOnBorder[l].borders[t][0])}encodeCentroid(t,n,l=!0){let h,m;if(t)if(t.y!==0){const v=n.span()._mult(this.tileToMeter);h=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(v.x/10)),m=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else h=Math.ceil(7*(t.x+450)),m=0;else h=0,m=+l;let _=l?this.centroidVertexArray.length:n.vertexArrayOffset;for(const v of n.polyCount){l&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let T=0;T<v.top;T++)this.centroidVertexArray.emplace(_++,h,m);for(let T=0;T<2*v.edges;T++)this.centroidVertexArray.emplace(_++,0,m),this.centroidVertexArray.emplace(_++,h,m)}}}function hb(r,t){const n=r.add(t)._unit();return r.x*n.x+r.y*n.y}function hP(r,t,n,l){const h=t.sub(r)._perp()._unit(),m=n.sub(t)._perp()._unit();return db(r,t,n,hb(h,m),l)}function db(r,t,n,l,h){const m=Math.sqrt(1-l*l);return Math.min(r.dist(t)/3,t.dist(n)/3,h*m/l)}function fb(r,t,n){return r.x<n[0].x&&t.x<n[0].x||r.x>n[1].x&&t.x>n[1].x||r.y<n[0].y&&t.y<n[0].y||r.y>n[1].y&&t.y>n[1].y}function pb(r,t,n){if(r.x<0||r.x>=Wt||t.x<0||t.x>=Wt||n.x<0||n.x>=Wt)return!1;const l=n.sub(t),h=l.perp(),m=r.sub(t);return(l.x*m.x+l.y*m.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(m.x*m.x+m.y*m.y))>-.866&&h.x*m.x+h.y*m.y<0}function mb(r,t,n){const l=t?2|r:-3&r;return n?1|l:-2&l}function gb(){const r=Math.PI/32,t=Math.tan(r),n=k_;return n*Math.sqrt(1+2*t*t)-n}function _b(r,t,n){const l=1<<n.z,h=ys(n.x/l),m=ys((n.x+1)/l),_=Xn(n.y/l),v=Xn((n.y+1)/l);return function(T,E,M,P,z=0,F){const B=[];if(!T.length||!M||!P)return B;const G=(ye,Ue)=>{for(const Be of ye)B.push({polygon:Be,bounds:Ue})},Z=Math.ceil(Math.log2(M)),oe=Math.ceil(Math.log2(P)),me=Z-oe,le=[];for(let ye=0;ye<Math.abs(me);ye++)le.push(me>0?0:1);for(let ye=0;ye<Math.min(Z,oe);ye++)le.push(0),le.push(1);let fe=T;if(fe=Np(fe,E[0].y-z,E[1].y+z,1),fe=Np(fe,E[0].x-z,E[1].x+z,0),!fe.length)return B;const Se=[];for(le.length?Se.push({polygons:fe,bounds:E,depth:0}):G(fe,E);Se.length;){const ye=Se.pop(),Ue=ye.depth,Be=le[Ue],Ze=ye.bounds[0],mt=ye.bounds[1],$e=Be===0?Ze.x:Ze.y,Qe=Be===0?mt.x:mt.y,st=F?F(Be,$e,Qe):.5*($e+Qe),Je=Np(ye.polygons,$e-z,st+z,Be),dt=Np(ye.polygons,st-z,Qe+z,Be);if(Je.length){const ot=[Ze,new k(Be===0?st:mt.x,Be===1?st:mt.y)];le.length>Ue+1?Se.push({polygons:Je,bounds:ot,depth:Ue+1}):G(Je,ot)}if(dt.length){const ot=[new k(Be===0?st:Ze.x,Be===1?st:Ze.y),mt];le.length>Ue+1?Se.push({polygons:dt,bounds:ot,depth:Ue+1}):G(dt,ot)}}return B}(r,t,Math.ceil((m-h)/11.25),Math.ceil((_-v)/11.25),1,(T,E,M)=>{if(T===0)return .5*(E+M);{const P=Xn((n.y+E/Wt)/l);return(Do(.5*(Xn((n.y+M/Wt)/l)+P))*l-n.y)*Wt}})}Ct(td,"FillExtrusionBucket",{omit:["layers","features"]}),Ct(ub,"PartMetadata");const dP=new Xe({"fill-extrusion-edge-radius":new ve(Ve["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var fP={paint:new Xe({"fill-extrusion-opacity":new ve(Ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Me(Ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ve(Ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ve(Ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Oe(Ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Me(Ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Me(Ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ve(Ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ve(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ve(Ve["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:dP};function yb(r,t,n){var l=2*Math.PI*6378137/256/Math.pow(2,n);return[r*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class Up{constructor(t,n,l){this.z=t,this.x=n,this.y=l,this.key=id(0,t,t,n,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n){const l=function(m,_,v){var T=yb(256*m,256*(_=Math.pow(2,v)-_-1),v),E=yb(256*(m+1),256*(_+1),v);return T[0]+","+T[1]+","+E[0]+","+E[1]}(this.x,this.y,this.z),h=function(m,_,v){let T,E="";for(let M=m;M>0;M--)T=1<<M-1,E+=(_&T?1:0)+(v&T?2:0);return E}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vb{constructor(t,n){this.wrap=t,this.canonical=n,this.key=id(t,n.z,n.z,n.x,n.y)}}class pr{constructor(t,n,l,h,m){this.overscaledZ=t,this.wrap=n,this.canonical=new Up(l,+h,+m),this.key=n===0&&t===l?this.canonical.key:id(n,t,l,h,m)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const n=this.canonical.z-t;return t>this.canonical.z?new pr(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pr(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n=!0){if(this.overscaledZ===t&&n)return this.key;if(t>this.canonical.z)return id(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-t;return id(this.wrap*+n,t,t,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new pr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new pr(n,this.wrap,n,l,h),new pr(n,this.wrap,n,l+1,h),new pr(n,this.wrap,n,l,h+1),new pr(n,this.wrap,n,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new pr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new pr(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function id(r,t,n,l,h){const m=1<<Math.min(n,22);let _=m*(h%m)+l%m;return r&&n<22&&(_+=m*m*((r<0?-2*r-1:2*r)%(1<<2*(22-n)))),16*(32*_+n)+(t-n)}function nd(r,t){return r.x*t.x+r.y*t.y}function xb(r,t){if(r.length===1){let n=0;const l=t[n++];let h;for(;!h||l.equals(h);)if(h=t[n++],!h)return 1/0;for(;n<t.length;n++){const m=t[n],_=r[0],v=h.sub(l),T=m.sub(l),E=_.sub(l),M=nd(v,v),P=nd(v,T),z=nd(T,T),F=nd(E,v),B=nd(E,T),G=M*z-P*P,Z=(z*F-P*B)/G,oe=(M*B-P*F)/G,me=l.z*(1-Z-oe)+h.z*Z+m.z*oe;if(isFinite(me))return me}return 1/0}{let n=1/0;for(const l of t)n=Math.min(n,l.z);return n}}function Vp(r){const t=new k(r[0],r[1]);return t.z=r[2],t}function bb(r,t,n,l,h,m,_,v){const T=_*h.getElevationAt(r,t,!0,!0),E=m[0]!==0,M=E?m[1]===0?_*(m[0]/7-450):_*function(P,z,F){const B=Math.floor(z[0]/8),G=Math.floor(z[1]/8),Z=10*(z[0]-8*B),oe=10*(z[1]-8*G),me=P.getElevationAt(B,G,!0,!0),le=P.getMeterToDEM(F),fe=Math.floor(.5*(Z*le-1)),Se=Math.floor(.5*(oe*le-1)),ye=P.tileCoordToPixel(B,G),Ue=2*fe+1,Be=2*Se+1,Ze=function(dt,ot,Tt,ei,ni){return[dt.getElevationAtPixel(ot,Tt,!0),dt.getElevationAtPixel(ot+ni,Tt,!0),dt.getElevationAtPixel(ot,Tt+ni,!0),dt.getElevationAtPixel(ot+ei,Tt+ni,!0)]}(P,ye.x-fe,ye.y-Se,Ue,Be),mt=Math.abs(Ze[0]-Ze[1]),$e=Math.abs(Ze[2]-Ze[3]),Qe=Math.abs(Ze[0]-Ze[2])+Math.abs(Ze[1]-Ze[3]),st=Math.min(.25,.5*le*(mt+$e)/Ue),Je=Math.min(.25,.5*le*Qe/Be);return me+Math.max(st*Z,Je*oe)}(h,m,v):T;return{base:T+(n===0)?-1:n,top:E?Math.max(M+l,T+n+2):T+l}}Ct(Up,"CanonicalTileID"),Ct(pr,"OverscaledTileID",{omit:["projMatrix"]});const pP=it([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:mP}=pP,gP=it([{name:"a_packed",components:4,type:"Float32"}]),{members:_P}=gP,yP=Pl.VectorTileFeature.types,vP=Math.cos(Math.PI/180*37.5);class $p{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Ht,this.layoutVertexArray2=new pi,this.indexArray=new ai,this.programConfigurations=new El(t.layers,t.zoom),this.segments=new En,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,l,h){this.hasPattern=ty("line",this.layers,n);const m=this.layers[0].layout.get("line-sort-key"),_=[];for(const{feature:M,id:P,index:z,sourceLayerIndex:F}of t){const B=this.layers[0]._featureFilter.needGeometry,G=Sl(M,B);if(!this.layers[0]._featureFilter.filter(new Y(this.zoom),G,l))continue;const Z=m?m.evaluate(G,{},l):void 0,oe={id:P,properties:M.properties,type:M.type,sourceLayerIndex:F,index:z,geometry:B?G.geometry:Oo(M,l,h),patterns:{},sortKey:Z};_.push(oe)}m&&_.sort((M,P)=>M.sortKey-P.sortKey);const{lineAtlas:v,featureIndex:T}=n,E=this.addConstantDashes(v);for(const M of _){const{geometry:P,index:z,sourceLayerIndex:F}=M;if(E&&this.addFeatureDashes(M,v),this.hasPattern){const B=iy("line",this.layers,M,this.zoom,n);this.patternFeatures.push(B)}else this.addFeature(M,P,z,l,v.positions,n.availableImages);T.insert(t[z].feature,P,z,F,this.index)}}addConstantDashes(t){let n=!1;for(const l of this.layers){const h=l.paint.get("line-dasharray").value,m=l.layout.get("line-cap").value;if(h.kind!=="constant"||m.kind!=="constant")n=!0;else{const _=m.value,v=h.value;if(!v)continue;t.addDash(v.from,_),t.addDash(v.to,_),v.other&&t.addDash(v.other,_)}}return n}addFeatureDashes(t,n){const l=this.zoom;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,_=h.layout.get("line-cap").value;if(m.kind==="constant"&&_.kind==="constant")continue;let v,T,E,M,P,z;if(m.kind==="constant"){const Z=m.value;if(!Z)continue;v=Z.other||Z.to,T=Z.to,E=Z.from}else v=m.evaluate({zoom:l-1},t),T=m.evaluate({zoom:l},t),E=m.evaluate({zoom:l+1},t);_.kind==="constant"?M=P=z=_.value:(M=_.evaluate({zoom:l-1},t),P=_.evaluate({zoom:l},t),z=_.evaluate({zoom:l+1},t)),n.addDash(v,M),n.addDash(T,P),n.addDash(E,z);const F=n.getKey(v,M),B=n.getKey(T,P),G=n.getKey(E,z);t.patterns[h.id]={min:F,mid:B,max:G}}}update(t,n,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,l,h)}addFeatures(t,n,l,h,m){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,n,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,_P)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,mP),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,l,h,m,_){const v=this.layers[0].layout,T=v.get("line-join").evaluate(t,{}),E=v.get("line-cap").evaluate(t,{}),M=v.get("line-miter-limit"),P=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const z of n)this.addLine(z,t,T,E,M,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,_,h)}addLine(t,n,l,h,m,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<t.length-1;oe++)this.totalDistance+=t[oe].dist(t[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=yP[n.type]==="Polygon";let T=t.length;for(;T>=2&&t[T-1].equals(t[T-2]);)T--;let E=0;for(;E<T-1&&t[E].equals(t[E+1]);)E++;if(T<(v?3:2))return;l==="bevel"&&(m=1.05);const M=this.overscaling<=16?122880/(512*this.overscaling):0,P=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let z,F,B,G,Z;this.e1=this.e2=-1,v&&(z=t[T-2],Z=t[E].sub(z)._unit()._perp());for(let oe=E;oe<T;oe++){if(B=oe===T-1?v?t[E+1]:void 0:t[oe+1],B&&t[oe].equals(B))continue;Z&&(G=Z),z&&(F=z),z=t[oe],Z=B?B.sub(z)._unit()._perp():G,G=G||Z;let me=G.add(Z);me.x===0&&me.y===0||me._unit();const le=G.x*Z.x+G.y*Z.y,fe=me.x*Z.x+me.y*Z.y,Se=fe!==0?1/fe:1/0,ye=2*Math.sqrt(2-2*fe),Ue=fe<vP&&F&&B,Be=G.x*Z.y-G.y*Z.x>0;if(Ue&&oe>E){const $e=z.dist(F);if($e>2*M){const Qe=z.sub(z.sub(F)._mult(M/$e)._round());this.updateDistance(F,Qe),this.addCurrentVertex(Qe,G,0,0,P),F=Qe}}const Ze=F&&B;let mt=Ze?l:v?"butt":h;if(Ze&&mt==="round"&&(Se<_?mt="miter":Se<=2&&(mt="fakeround")),mt==="miter"&&Se>m&&(mt="bevel"),mt==="bevel"&&(Se>2&&(mt="flipbevel"),Se<m&&(mt="miter")),F&&this.updateDistance(F,z),mt==="miter")me._mult(Se),this.addCurrentVertex(z,me,0,0,P);else if(mt==="flipbevel"){if(Se>100)me=Z.mult(-1);else{const $e=Se*G.add(Z).mag()/G.sub(Z).mag();me._perp()._mult($e*(Be?-1:1))}this.addCurrentVertex(z,me,0,0,P),this.addCurrentVertex(z,me.mult(-1),0,0,P)}else if(mt==="bevel"||mt==="fakeround"){const $e=-Math.sqrt(Se*Se-1),Qe=Be?$e:0,st=Be?0:$e;if(F&&this.addCurrentVertex(z,G,Qe,st,P),mt==="fakeround"){const Je=Math.round(180*ye/Math.PI/20);for(let dt=1;dt<Je;dt++){let ot=dt/Je;if(ot!==.5){const ei=ot-.5;ot+=ot*ei*(ot-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*ei*ei+(.848013+le*(.215638*le-1.06021)))}const Tt=Z.sub(G)._mult(ot)._add(G)._unit()._mult(Be?-1:1);this.addHalfVertex(z,Tt.x,Tt.y,!1,Be,0,P)}}B&&this.addCurrentVertex(z,Z,-Qe,-st,P)}else if(mt==="butt")this.addCurrentVertex(z,me,0,0,P);else if(mt==="square"){const $e=F?1:-1;F||this.addCurrentVertex(z,me,$e,$e,P),this.addCurrentVertex(z,me,0,0,P),F&&this.addCurrentVertex(z,me,$e,$e,P)}else mt==="round"&&(F&&(this.addCurrentVertex(z,G,0,0,P),this.addCurrentVertex(z,G,1,1,P,!0)),B&&(this.addCurrentVertex(z,Z,-1,-1,P,!0),this.addCurrentVertex(z,Z,0,0,P)));if(Ue&&oe<T-1){const $e=z.dist(B);if($e>2*M){const Qe=z.add(B.sub(z)._mult(M/$e)._round());this.updateDistance(z,Qe),this.addCurrentVertex(Qe,Z,0,0,P),z=Qe}}}}addCurrentVertex(t,n,l,h,m,_=!1){const v=n.y*h-n.x,T=-n.y-n.x*h;this.addHalfVertex(t,n.x+n.y*l,n.y-n.x*l,_,!1,l,m),this.addHalfVertex(t,v,T,_,!0,-h,m)}addHalfVertex({x:t,y:n},l,h,m,_,v,T){this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(n<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const E=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),T.primitiveLength++),_?this.e2=E:this.e1=E}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}Ct($p,"LineBucket",{omit:["layers","patternFeatures"]});const xP=new Xe({"line-cap":new Me(Ve.layout_line["line-cap"]),"line-join":new Me(Ve.layout_line["line-join"]),"line-miter-limit":new ve(Ve.layout_line["line-miter-limit"]),"line-round-limit":new ve(Ve.layout_line["line-round-limit"]),"line-sort-key":new Me(Ve.layout_line["line-sort-key"])});var wb={paint:new Xe({"line-opacity":new Me(Ve.paint_line["line-opacity"]),"line-color":new Me(Ve.paint_line["line-color"]),"line-translate":new ve(Ve.paint_line["line-translate"]),"line-translate-anchor":new ve(Ve.paint_line["line-translate-anchor"]),"line-width":new Me(Ve.paint_line["line-width"]),"line-gap-width":new Me(Ve.paint_line["line-gap-width"]),"line-offset":new Me(Ve.paint_line["line-offset"]),"line-blur":new Me(Ve.paint_line["line-blur"]),"line-dasharray":new Oe(Ve.paint_line["line-dasharray"]),"line-pattern":new Oe(Ve.paint_line["line-pattern"]),"line-gradient":new ke(Ve.paint_line["line-gradient"]),"line-trim-offset":new ve(Ve.paint_line["line-trim-offset"])}),layout:xP};const Tb=new class extends Me{possiblyEvaluate(r,t){return t=new Y(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(r,t)}evaluate(r,t,n,l){return t=Ce({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(r,t,n,l)}}(wb.paint.properties["line-width"].specification);function Eb(r,t){return t>0?t+2*r:r}Tb.useIntegerZoom=!0;const bP=it([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),wP=it([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),TP=it([{name:"a_projected_pos",components:4,type:"Float32"}],4);it([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const EP=it([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),SP=it([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);it([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Sb=it([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),AP=it([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);it([{name:"triangle",components:3,type:"Uint16"}]),it([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),it([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),it([{type:"Float32",name:"offsetX"}]),it([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Kn=24;const ao=128;function ny(r,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Y(r+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=n;let m=0;for(;m<l.length&&l[m]<=r;)m++;m=Math.max(0,m-1);let _=m;for(;_<l.length&&l[_]<r+1;)_++;_=Math.min(l.length-1,_);const v=l[m],T=l[_];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:T,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:T,minSize:n.evaluate(new Y(v)),maxSize:n.evaluate(new Y(T)),interpolationType:h}}}function jp(r,{uSize:t,uSizeT:n},{lowerSize:l,upperSize:h}){return r.kind==="source"?l/ao:r.kind==="composite"?Ti(l/ao,h/ao,n):t}function Zc(r,t){let n=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:_}=r,v=h?ie(gs.interpolationFactor(h,t,m,_),0,1):0;r.kind==="camera"?l=Ti(r.minSize,r.maxSize,v):n=v}return{uSizeT:n,uSize:l}}var CP=Object.freeze({__proto__:null,getSizeData:ny,evaluateSizeForFeature:jp,evaluateSizeForZoom:Zc,SIZE_PACK_FACTOR:ao});function MP(r,t,n){return r.sections.forEach(l=>{l.text=function(h,m,_){const v=m.layout.get("text-transform").evaluate(_,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),K.applyArabicShaping&&(h=K.applyArabicShaping(h)),h}(l.text,t,n)}),r}const rd={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function IP(r){return r==="\uFE36"||r==="\uFE48"||r==="\uFE38"||r==="\uFE44"||r==="\uFE42"||r==="\uFE3E"||r==="\uFE3C"||r==="\uFE3A"||r==="\uFE18"||r==="\uFE40"||r==="\uFE10"||r==="\uFE13"||r==="\uFE14"||r==="\uFF40"||r==="\uFFE3"||r==="\uFE11"||r==="\uFE12"}function PP(r){return r==="\uFE35"||r==="\uFE47"||r==="\uFE37"||r==="\uFE43"||r==="\uFE41"||r==="\uFE3D"||r==="\uFE3B"||r==="\uFE39"||r==="\uFE17"||r==="\uFE3F"}var Ab=function(r,t,n,l,h){var m,_,v=8*h-l-1,T=(1<<v)-1,E=T>>1,M=-7,P=n?h-1:0,z=n?-1:1,F=r[t+P];for(P+=z,m=F&(1<<-M)-1,F>>=-M,M+=v;M>0;m=256*m+r[t+P],P+=z,M-=8);for(_=m&(1<<-M)-1,m>>=-M,M+=l;M>0;_=256*_+r[t+P],P+=z,M-=8);if(m===0)m=1-E;else{if(m===T)return _?NaN:1/0*(F?-1:1);_+=Math.pow(2,l),m-=E}return(F?-1:1)*_*Math.pow(2,m-l)},Cb=function(r,t,n,l,h,m){var _,v,T,E=8*m-h-1,M=(1<<E)-1,P=M>>1,z=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=l?0:m-1,B=l?1:-1,G=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,_=M):(_=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-_))<1&&(_--,T*=2),(t+=_+P>=1?z/T:z*Math.pow(2,1-P))*T>=2&&(_++,T/=2),_+P>=M?(v=0,_=M):_+P>=1?(v=(t*T-1)*Math.pow(2,h),_+=P):(v=t*Math.pow(2,P-1)*Math.pow(2,h),_=0));h>=8;r[n+F]=255&v,F+=B,v/=256,h-=8);for(_=_<<h|v,E+=h;E>0;r[n+F]=255&_,F+=B,_/=256,E-=8);r[n+F-B]|=128*G},sd=Gi;function Gi(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Gi.Varint=0,Gi.Fixed64=1,Gi.Bytes=2,Gi.Fixed32=5;var ry=4294967296,Mb=1/ry,Ib=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Bo(r){return r.type===Gi.Bytes?r.readVarint()+r.pos:r.pos+1}function Xc(r,t,n){return n?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function Pb(r,t,n){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(l);for(var h=n.pos-1;h>=r;h--)n.buf[h+l]=n.buf[h]}function kP(r,t){for(var n=0;n<r.length;n++)t.writeVarint(r[n])}function LP(r,t){for(var n=0;n<r.length;n++)t.writeSVarint(r[n])}function zP(r,t){for(var n=0;n<r.length;n++)t.writeFloat(r[n])}function RP(r,t){for(var n=0;n<r.length;n++)t.writeDouble(r[n])}function DP(r,t){for(var n=0;n<r.length;n++)t.writeBoolean(r[n])}function OP(r,t){for(var n=0;n<r.length;n++)t.writeFixed32(r[n])}function FP(r,t){for(var n=0;n<r.length;n++)t.writeSFixed32(r[n])}function BP(r,t){for(var n=0;n<r.length;n++)t.writeFixed64(r[n])}function NP(r,t){for(var n=0;n<r.length;n++)t.writeSFixed64(r[n])}function Gp(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function Kc(r,t,n){r[n]=t,r[n+1]=t>>>8,r[n+2]=t>>>16,r[n+3]=t>>>24}function kb(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}function UP(r,t,n){t.glyphs=[],r===1&&n.readMessage(VP,t)}function VP(r,t,n){if(r===3){const{id:l,bitmap:h,width:m,height:_,left:v,top:T,advance:E}=n.readMessage($P,{});t.glyphs.push({id:l,bitmap:new Fo({width:m+6,height:_+6},h),metrics:{width:m,height:_,left:v,top:T,advance:E}})}else r===4?t.ascender=n.readSVarint():r===5&&(t.descender=n.readSVarint())}function $P(r,t,n){r===1?t.id=n.readVarint():r===2?t.bitmap=n.readBytes():r===3?t.width=n.readVarint():r===4?t.height=n.readVarint():r===5?t.left=n.readSVarint():r===6?t.top=n.readSVarint():r===7&&(t.advance=n.readVarint())}function sy(r){let t=0,n=0;for(const _ of r)t+=_.w*_.h,n=Math.max(n,_.w);r.sort((_,v)=>v.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let h=0,m=0;for(const _ of r)for(let v=l.length-1;v>=0;v--){const T=l[v];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,m=Math.max(m,_.y+_.h),h=Math.max(h,_.x+_.w),_.w===T.w&&_.h===T.h){const E=l.pop();v<l.length&&(l[v]=E)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(l.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}Gi.prototype={destroy:function(){this.buf=null},readFields:function(r,t,n){for(n=n||this.length;this.pos<n;){var l=this.readVarint(),h=l>>3,m=this.pos;this.type=7&l,r(h,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=Gp(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=kb(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Gp(this.buf,this.pos)+Gp(this.buf,this.pos+4)*ry;return this.pos+=8,r},readSFixed64:function(){var r=Gp(this.buf,this.pos)+kb(this.buf,this.pos+4)*ry;return this.pos+=8,r},readFloat:function(){var r=Ab(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Ab(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,n,l=this.buf;return t=127&(n=l[this.pos++]),n<128?t:(t|=(127&(n=l[this.pos++]))<<7,n<128?t:(t|=(127&(n=l[this.pos++]))<<14,n<128?t:(t|=(127&(n=l[this.pos++]))<<21,n<128?t:function(h,m,_){var v,T,E=_.buf;if(v=(112&(T=E[_.pos++]))>>4,T<128||(v|=(127&(T=E[_.pos++]))<<3,T<128)||(v|=(127&(T=E[_.pos++]))<<10,T<128)||(v|=(127&(T=E[_.pos++]))<<17,T<128)||(v|=(127&(T=E[_.pos++]))<<24,T<128)||(v|=(1&(T=E[_.pos++]))<<31,T<128))return Xc(h,v,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&Ib?function(n,l,h){return Ib.decode(n.subarray(l,h))}(this.buf,t,r):function(n,l,h){for(var m="",_=l;_<h;){var v,T,E,M=n[_],P=null,z=M>239?4:M>223?3:M>191?2:1;if(_+z>h)break;z===1?M<128&&(P=M):z===2?(192&(v=n[_+1]))==128&&(P=(31&M)<<6|63&v)<=127&&(P=null):z===3?(T=n[_+2],(192&(v=n[_+1]))==128&&(192&T)==128&&((P=(15&M)<<12|(63&v)<<6|63&T)<=2047||P>=55296&&P<=57343)&&(P=null)):z===4&&(T=n[_+2],E=n[_+3],(192&(v=n[_+1]))==128&&(192&T)==128&&(192&E)==128&&((P=(15&M)<<18|(63&v)<<12|(63&T)<<6|63&E)<=65535||P>=1114112)&&(P=null)),P===null?(P=65533,z=1):P>65535&&(P-=65536,m+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),m+=String.fromCharCode(P),_+=z}return m}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==Gi.Bytes)return r.push(this.readVarint(t));var n=Bo(this);for(r=r||[];this.pos<n;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==Gi.Bytes)return r.push(this.readSVarint());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Gi.Bytes)return r.push(this.readBoolean());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Gi.Bytes)return r.push(this.readFloat());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Gi.Bytes)return r.push(this.readDouble());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Gi.Bytes)return r.push(this.readFixed32());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Gi.Bytes)return r.push(this.readSFixed32());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Gi.Bytes)return r.push(this.readFixed64());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Gi.Bytes)return r.push(this.readSFixed64());var t=Bo(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===Gi.Varint)for(;this.buf[this.pos++]>127;);else if(t===Gi.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Gi.Fixed32)this.pos+=4;else{if(t!==Gi.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Kc(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Kc(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Kc(this.buf,-1&r,this.pos),Kc(this.buf,Math.floor(r*Mb),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Kc(this.buf,-1&r,this.pos),Kc(this.buf,Math.floor(r*Mb),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,n){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(m,_,v){v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,v.buf[v.pos]=127&(m>>>=7)}(l,0,n),function(m,_){var v=(7&m)<<4;_.buf[_.pos++]|=v|((m>>>=3)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m)))))}(h,n)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(l,h,m){for(var _,v,T=0;T<h.length;T++){if((_=h.charCodeAt(T))>55295&&_<57344){if(!v){_>56319||T+1===h.length?(l[m++]=239,l[m++]=191,l[m++]=189):v=_;continue}if(_<56320){l[m++]=239,l[m++]=191,l[m++]=189,v=_;continue}_=v-55296<<10|_-56320|65536,v=null}else v&&(l[m++]=239,l[m++]=191,l[m++]=189,v=null);_<128?l[m++]=_:(_<2048?l[m++]=_>>6|192:(_<65536?l[m++]=_>>12|224:(l[m++]=_>>18|240,l[m++]=_>>12&63|128),l[m++]=_>>6&63|128),l[m++]=63&_|128)}return m}(this.buf,r,this.pos);var n=this.pos-t;n>=128&&Pb(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(r){this.realloc(4),Cb(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Cb(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=r[n]},writeRawMessage:function(r,t){this.pos++;var n=this.pos;r(t,this);var l=this.pos-n;l>=128&&Pb(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,t,n){this.writeTag(r,Gi.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,kP,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,LP,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,DP,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,zP,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,RP,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,OP,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,FP,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,BP,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,NP,t)},writeBytesField:function(r,t){this.writeTag(r,Gi.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,Gi.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,Gi.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,Gi.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,Gi.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,Gi.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,Gi.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,Gi.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,Gi.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,Gi.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,Boolean(t))}};class oy{constructor(t,{pixelRatio:n,version:l,stretchX:h,stretchY:m,content:_}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=h,this.stretchY=m,this.content=_,this.version=l}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Lb{constructor(t,n){const l={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,l,m),this.addImages(n,h,m);const{w:_,h:v}=sy(m),T=new Dr({width:_||1,height:v||1});for(const E in t){const M=t[E],P=l[E].paddedRect;Dr.copy(M.data,T,{x:0,y:0},{x:P.x+1,y:P.y+1},M.data)}for(const E in n){const M=n[E],P=h[E].paddedRect,z=P.x+1,F=P.y+1,B=M.data.width,G=M.data.height;Dr.copy(M.data,T,{x:0,y:0},{x:z,y:F},M.data),Dr.copy(M.data,T,{x:0,y:G-1},{x:z,y:F-1},{width:B,height:1}),Dr.copy(M.data,T,{x:0,y:0},{x:z,y:F+G},{width:B,height:1}),Dr.copy(M.data,T,{x:B-1,y:0},{x:z-1,y:F},{width:1,height:G}),Dr.copy(M.data,T,{x:0,y:0},{x:z+B,y:F},{width:1,height:G})}this.image=T,this.iconPositions=l,this.patternPositions=h}addImages(t,n,l){for(const h in t){const m=t[h],_={x:0,y:0,w:m.data.width+2,h:m.data.height+2};l.push(_),n[h]=new oy(_,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(l=>t.hasImage(l)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),n)}patchUpdatedImage(t,n,l){if(!t||!n||t.version===n.version)return;t.version=n.version;const[h,m]=t.tl;l.update(n.data,void 0,{x:h,y:m})}}Ct(oy,"ImagePosition"),Ct(Lb,"ImageAtlas");const Yr={horizontal:1,vertical:2,horizontalOnly:3};class od{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,n){const l=new od;return l.scale=t||1,l.fontStack=n,l}static forImage(t){const n=new od;return n.imageName=t,n}}class Yc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const l=new Yc;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?l.addImageSection(m):l.addTextSection(m,n)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(n,l){let h="";for(let m=0;m<n.length;m++){const _=n.charCodeAt(m+1)||null,v=n.charCodeAt(m-1)||null;h+=!l&&(_&&wl(_)&&!rd[n[m+1]]||v&&wl(v)&&!rd[n[m-1]])||!rd[n[m]]?n[m]:rd[n[m]]}return h}(this.text,t)}trim(){let t=0;for(let l=0;l<this.text.length&&qp[this.text.charCodeAt(l)];l++)t++;let n=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&qp[this.text.charCodeAt(l)];l--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const l=new Yc;return l.text=this.text.substring(t,n),l.sectionIndex=this.sectionIndex.slice(t,n),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}addTextSection(t,n){this.text+=t.text,this.sections.push(od.forText(t.scale,t.fontStack||n));const l=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(l)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void yi("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(od.forImage(n)),this.sectionIndex.push(this.sections.length-1)):yi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ay(r,t,n,l,h,m,_,v,T,E,M,P,z,F,B,G){const Z=Yc.fromFeature(r,h);let oe;P===Yr.vertical&&Z.verticalizePunctuation(z);const{processBidirectionalText:me,processStyledBidirectionalText:le}=K;if(me&&Z.sections.length===1){oe=[];const ye=me(Z.toString(),ly(Z,E,m,t,l,F,B));for(const Ue of ye){const Be=new Yc;Be.text=Ue,Be.sections=Z.sections;for(let Ze=0;Ze<Ue.length;Ze++)Be.sectionIndex.push(0);oe.push(Be)}}else if(le){oe=[];const ye=le(Z.text,Z.sectionIndex,ly(Z,E,m,t,l,F,B));for(const Ue of ye){const Be=new Yc;Be.text=Ue[0],Be.sectionIndex=Ue[1],Be.sections=Z.sections,oe.push(Be)}}else oe=function(ye,Ue){const Be=[],Ze=ye.text;let mt=0;for(const $e of Ue)Be.push(ye.substring(mt,$e)),mt=$e;return mt<Ze.length&&Be.push(ye.substring(mt,Ze.length)),Be}(Z,ly(Z,E,m,t,l,F,B));const fe=[],Se={positionedLines:fe,text:Z.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ye,Ue,Be,Ze,mt,$e,Qe,st,Je,dt,ot,Tt){let ei=0,ni=0,Bt=0;const yt=st==="right"?1:st==="left"?0:.5;let mi=!1;for(const ri of mt){const Si=ri.getSections();for(const Wi of Si){if(Wi.imageName)continue;const Vi=Ue[Wi.fontStack];if(Vi&&(mi=Vi.ascender!==void 0&&Vi.descender!==void 0,!mi))break}if(!mi)break}let Xt=0;for(const ri of mt){ri.trim();const Si=ri.getMaxScale(),Wi=(Si-1)*Kn,Vi={positionedGlyphs:[],lineOffset:0};ye.positionedLines[Xt]=Vi;const Ni=Vi.positionedGlyphs;let Qi=0;if(!ri.length()){ni+=$e,++Xt;continue}let ln=0,Fn=0;for(let xi=0;xi<ri.length();xi++){const mn=ri.getSection(xi),sr=ri.getSectionIndex(xi),Li=ri.getCharCode(xi);let cn=mn.scale,mr=null,on=null,yn=null,Bn=Kn,Pn=0;const Yn=!(Je===Yr.horizontal||!ot&&!Uc(Li)||ot&&(qp[Li]||(At=Li,hp(At)||dp(At)||fp(At)||bl(At)||$h(At))));if(mn.imageName){const gr=Ze[mn.imageName];if(!gr)continue;yn=mn.imageName,ye.iconsInText=ye.iconsInText||!0,on=gr.paddedRect;const Nn=gr.displaySize;cn=cn*Kn/Tt,mr={width:Nn[0],height:Nn[1],left:1,top:-3,advance:Yn?Nn[1]:Nn[0],localGlyph:!1},Pn=mi?-mr.height*cn:Si*Kn-17-Nn[1]*cn,Bn=mr.advance;const Vo=(Yn?Nn[0]:Nn[1])*cn-Kn*Si;Vo>0&&Vo>Qi&&(Qi=Vo)}else{const gr=Be[mn.fontStack];if(!gr)continue;gr[Li]&&(on=gr[Li]);const Nn=Ue[mn.fontStack];if(!Nn)continue;const Vo=Nn.glyphs[Li];if(!Vo)continue;if(mr=Vo.metrics,Bn=Li!==8203?Kn:0,mi){const ru=Nn.ascender!==void 0?Math.abs(Nn.ascender):0,yd=Nn.descender!==void 0?Math.abs(Nn.descender):0,vd=(ru+yd)*cn;ln<vd&&(ln=vd,Fn=(ru-yd)/2*cn),Pn=-ru*cn}else Pn=(Si-cn)*Kn-17}Yn?(ye.verticalizable=!0,Ni.push({glyph:Li,imageName:yn,x:ei,y:ni+Pn,vertical:Yn,scale:cn,localGlyph:mr.localGlyph,fontStack:mn.fontStack,sectionIndex:sr,metrics:mr,rect:on}),ei+=Bn*cn+dt):(Ni.push({glyph:Li,imageName:yn,x:ei,y:ni+Pn,vertical:Yn,scale:cn,localGlyph:mr.localGlyph,fontStack:mn.fontStack,sectionIndex:sr,metrics:mr,rect:on}),ei+=mr.advance*cn+dt)}Ni.length!==0&&(Bt=Math.max(ei-dt,Bt),mi?Fb(Ni,yt,Qi,Fn,$e*Si/2):Fb(Ni,yt,Qi,0,$e/2)),ei=0;const Ar=$e*Si+Qi;Vi.lineOffset=Math.max(Qi,Wi),ni+=Ar,++Xt}var At;const qi=ni,{horizontalAlign:Ui,verticalAlign:sn}=cy(Qe);(function(ri,Si,Wi,Vi,Ni,Qi){const ln=(Si-Wi)*Ni,Fn=-Qi*Vi;for(const Ar of ri)for(const xi of Ar.positionedGlyphs)xi.x+=ln,xi.y+=Fn})(ye.positionedLines,yt,Ui,sn,Bt,qi),ye.top+=-sn*qi,ye.bottom=ye.top+qi,ye.left+=-Ui*Bt,ye.right=ye.left+Bt,ye.hasBaseline=mi}(Se,t,n,l,oe,_,v,T,P,E,z,G),!function(ye){for(const Ue of ye)if(Ue.positionedGlyphs.length!==0)return!1;return!0}(fe)&&Se}const qp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},jP={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function zb(r,t,n,l,h,m){if(t.imageName){const _=l[t.imageName];return _?_.displaySize[0]*t.scale*Kn/m+h:0}{const _=n[t.fontStack],v=_&&_.glyphs[r];return v?v.metrics.advance*t.scale+h:0}}function Rb(r,t,n,l){const h=Math.pow(r-t,2);return l?r<t?h/2:2*h:h+Math.abs(n)*n}function GP(r,t,n){let l=0;return r===10&&(l-=1e4),n&&(l+=150),r!==40&&r!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function Db(r,t,n,l,h,m){let _=null,v=Rb(t,n,h,m);for(const T of l){const E=Rb(t-T.x,n,h,m)+T.badness;E<=v&&(_=T,v=E)}return{index:r,x:t,priorBreak:_,badness:v}}function Ob(r){return r?Ob(r.priorBreak).concat(r.index):[]}function ly(r,t,n,l,h,m,_){if(m!=="point")return[];if(!r)return[];const v=[],T=function(z,F,B,G,Z,oe){let me=0;for(let le=0;le<z.length();le++){const fe=z.getSection(le);me+=zb(z.getCharCode(le),fe,G,Z,F,oe)}return me/Math.max(1,Math.ceil(me/B))}(r,t,n,l,h,_),E=r.text.indexOf("\u200B")>=0;let M=0;for(let z=0;z<r.length();z++){const F=r.getSection(z),B=r.getCharCode(z);if(qp[B]||(M+=zb(B,F,l,h,t,_)),z<r.length()-1){const G=!((P=B)<11904||!(Oh(P)||gp(P)||Vh(P)||xp(P)||Nh(P)||pp(P)||_p(P)||Fc(P)||Uh(P)||xl(P)||Bh(P)||jh(P)||Dh(P)||vl(P)||mp(P)||Fh(P)||Co(P)||bp(P)||yp(P)||Bc(P)));(jP[B]||G||F.imageName)&&v.push(Db(z+1,M,T,v,GP(B,r.getCharCode(z+1),G&&E),!1))}}var P;return Ob(Db(r.length(),M,T,v,0,!0))}function cy(r){let t=.5,n=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Fb(r,t,n,l,h){if(!(t||n||l||h))return;const m=r.length-1,_=r[m],v=(_.x+_.metrics.advance*_.scale)*t;for(let T=0;T<=m;T++)r[T].x-=v,r[T].y+=n+l+h}function qP(r,t,n){const{horizontalAlign:l,verticalAlign:h}=cy(n),m=t[0]-r.displaySize[0]*l,_=t[1]-r.displaySize[1]*h;return{image:r,top:_,bottom:_+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function Bb(r,t,n,l,h,m){const _=r.image;let v;if(_.content){const Z=_.content,oe=_.pixelRatio||1;v=[Z[0]/oe,Z[1]/oe,_.displaySize[0]-Z[2]/oe,_.displaySize[1]-Z[3]/oe]}const T=t.left*m,E=t.right*m;let M,P,z,F;n==="width"||n==="both"?(F=h[0]+T-l[3],P=h[0]+E+l[1]):(F=h[0]+(T+E-_.displaySize[0])/2,P=F+_.displaySize[0]);const B=t.top*m,G=t.bottom*m;return n==="height"||n==="both"?(M=h[1]+B-l[0],z=h[1]+G+l[2]):(M=h[1]+(B+G-_.displaySize[1])/2,z=M+_.displaySize[1]),{image:_,top:M,right:P,bottom:z,left:F,collisionPadding:v}}class No extends k{constructor(t,n,l,h,m){super(t,n),this.angle=h,this.z=l,m!==void 0&&(this.segment=m)}clone(){return new No(this.x,this.y,this.z,this.angle,this.segment)}}function Nb(r,t,n,l,h){if(t.segment===void 0)return!0;let m=t,_=t.segment+1,v=0;for(;v>-n/2;){if(_--,_<0)return!1;v-=r[_].dist(m),m=r[_]}v+=r[_].dist(r[_+1]),_++;const T=[];let E=0;for(;v<n/2;){const M=r[_],P=r[_+1];if(!P)return!1;let z=r[_-1].angleTo(M)-M.angleTo(P);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:v,angleDelta:z}),E+=z;v-T[0].distance>l;)E-=T.shift().angleDelta;if(E>h)return!1;_++,v+=M.dist(P)}return!0}function Ub(r){let t=0;for(let n=0;n<r.length-1;n++)t+=r[n].dist(r[n+1]);return t}function Vb(r,t,n){return r?.6*t*n:0}function $b(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function WP(r,t,n,l,h,m){const _=Vb(n,h,m),v=$b(n,l)*m;let T=0;const E=Ub(r)/2;for(let M=0;M<r.length-1;M++){const P=r[M],z=r[M+1],F=P.dist(z);if(T+F>E){const B=(E-T)/F,G=Ti(P.x,z.x,B),Z=Ti(P.y,z.y,B),oe=new No(G,Z,0,z.angleTo(P),M);return!_||Nb(r,oe,v,_,t)?oe:void 0}T+=F}}function HP(r,t,n,l,h,m,_,v,T){const E=Vb(l,m,_),M=$b(l,h),P=M*_,z=r[0].x===0||r[0].x===T||r[0].y===0||r[0].y===T;return t-P<t/4&&(t=P+t/4),jb(r,z?t/2*v%t:(M/2+2*m)*_*v%t,t,E,n,P,z,!1,T)}function jb(r,t,n,l,h,m,_,v,T){const E=m/2,M=Ub(r);let P=0,z=t-n,F=[];for(let B=0;B<r.length-1;B++){const G=r[B],Z=r[B+1],oe=G.dist(Z),me=Z.angleTo(G);for(;z+n<P+oe;){z+=n;const le=(z-P)/oe,fe=Ti(G.x,Z.x,le),Se=Ti(G.y,Z.y,le);if(fe>=0&&fe<T&&Se>=0&&Se<T&&z-E>=0&&z+E<=M){const ye=new No(fe,Se,0,me,B);ye._round(),l&&!Nb(r,ye,m,l,h)||F.push(ye)}}P+=oe}return v||F.length||_||(F=jb(r,P/2,n,l,h,m,_,!0,T)),F}function Gb(r,t,n,l,h){const m=[];for(let _=0;_<r.length;_++){const v=r[_];let T;for(let E=0;E<v.length-1;E++){let M=v[E],P=v[E+1];M.x<t&&P.x<t||(M.x<t?M=new k(t,M.y+(t-M.x)/(P.x-M.x)*(P.y-M.y))._round():P.x<t&&(P=new k(t,M.y+(t-M.x)/(P.x-M.x)*(P.y-M.y))._round()),M.y<n&&P.y<n||(M.y<n?M=new k(M.x+(n-M.y)/(P.y-M.y)*(P.x-M.x),n)._round():P.y<n&&(P=new k(M.x+(n-M.y)/(P.y-M.y)*(P.x-M.x),n)._round()),M.x>=l&&P.x>=l||(M.x>=l?M=new k(l,M.y+(l-M.x)/(P.x-M.x)*(P.y-M.y))._round():P.x>=l&&(P=new k(l,M.y+(l-M.x)/(P.x-M.x)*(P.y-M.y))._round()),M.y>=h&&P.y>=h||(M.y>=h?M=new k(M.x+(h-M.y)/(P.y-M.y)*(P.x-M.x),h)._round():P.y>=h&&(P=new k(M.x+(h-M.y)/(P.y-M.y)*(P.x-M.x),h)._round()),T&&M.equals(T[T.length-1])||(T=[M],m.push(T)),T.push(P)))))}}return m}Ct(No,"Anchor");const ad=1e20;function qb(r,t,n,l,h,m,_,v,T){for(let E=t;E<t+l;E++)Wb(r,n*m+E,m,h,_,v,T);for(let E=n;E<n+h;E++)Wb(r,E*m+t,1,l,_,v,T)}function Wb(r,t,n,l,h,m,_){m[0]=0,_[0]=-ad,_[1]=ad,h[0]=r[t];for(let v=1,T=0,E=0;v<l;v++){h[v]=r[t+v*n];const M=v*v;do{const P=m[T];E=(h[v]-h[P]+M-P*P)/(v-P)/2}while(E<=_[T]&&--T>-1);T++,m[T]=v,_[T]=E,_[T+1]=ad}for(let v=0,T=0;v<l;v++){for(;_[T+1]<v;)T++;const E=m[T],M=v-E;r[t+v*n]=h[E]+M*M}}const uy={none:0,ideographs:1,all:2};class Qc{constructor(t,n,l){this.requestManager=t,this.localGlyphMode=n,this.localFontFamily=l,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,n){const l=[];for(const h in t)for(const m of t[h])l.push({stack:h,id:m});Ae(l,({stack:h,id:m},_)=>{let v=this.entries[h];v||(v=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=v.glyphs[m];if(T!==void 0)return void _(null,{stack:h,id:m,glyph:T});if(T=this._tinySDF(v,h,m),T)return v.glyphs[m]=T,void _(null,{stack:h,id:m,glyph:T});const E=Math.floor(m/256);if(256*E>65535)return void _(new Error("glyphs > 65535 not supported"));if(v.ranges[E])return void _(null,{stack:h,id:m,glyph:T});let M=v.requests[E];M||(M=v.requests[E]=[],Qc.loadGlyphRange(h,E,this.url,this.requestManager,(P,z)=>{if(z){v.ascender=z.ascender,v.descender=z.descender;for(const F in z.glyphs)this._doesCharSupportLocalGlyph(+F)||(v.glyphs[+F]=z.glyphs[+F]);v.ranges[E]=!0}for(const F of M)F(P,z);delete v.requests[E]})),M.push((P,z)=>{P?_(P):z&&_(null,{stack:h,id:m,glyph:z.glyphs[m]||null})})},(h,m)=>{if(h)n(h);else if(m){const _={};for(const{stack:v,id:T,glyph:E}of m)_[v]===void 0&&(_[v]={}),_[v].glyphs===void 0&&(_[v].glyphs={}),_[v].glyphs[T]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics},_[v].ascender=this.entries[v].ascender,_[v].descender=this.entries[v].descender;n(null,_)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==uy.none&&(this.localGlyphMode===uy.all?!!this.localFontFamily:!!this.localFontFamily&&(xl(t)||vp(t)||Dh(t)||Co(t)||Fc(t)))}_tinySDF(t,n,l){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let m=t.tinySDF;if(!m){let G="400";/bold/i.test(n)?G="900":/medium/i.test(n)?G="500":/light/i.test(n)&&(G="200"),m=t.tinySDF=new Qc.TinySDF({fontFamily:h,fontWeight:G,fontSize:48,buffer:6,radius:16}),m.fontWeight=G}if(this.localGlyphs[m.fontWeight][l])return this.localGlyphs[m.fontWeight][l];const _=String.fromCharCode(l),{data:v,width:T,height:E,glyphWidth:M,glyphHeight:P,glyphLeft:z,glyphTop:F,glyphAdvance:B}=m.draw(_);return this.localGlyphs[m.fontWeight][l]={id:l,bitmap:new Fo({width:T,height:E},v),metrics:{width:M/2,height:P/2,left:z/2,top:F/2-27,advance:B/2,localGlyph:!0}}}}function Hb(r,t,n,l){const h=[],m=r.image,_=m.pixelRatio,v=m.paddedRect.w-2,T=m.paddedRect.h-2,E=r.right-r.left,M=r.bottom-r.top,P=m.stretchX||[[0,v]],z=m.stretchY||[[0,T]],F=($e,Qe)=>$e+Qe[1]-Qe[0],B=P.reduce(F,0),G=z.reduce(F,0),Z=v-B,oe=T-G;let me=0,le=B,fe=0,Se=G,ye=0,Ue=Z,Be=0,Ze=oe;if(m.content&&l){const $e=m.content;me=Wp(P,0,$e[0]),fe=Wp(z,0,$e[1]),le=Wp(P,$e[0],$e[2]),Se=Wp(z,$e[1],$e[3]),ye=$e[0]-me,Be=$e[1]-fe,Ue=$e[2]-$e[0]-le,Ze=$e[3]-$e[1]-Se}const mt=($e,Qe,st,Je)=>{const dt=Hp($e.stretch-me,le,E,r.left),ot=Zp($e.fixed-ye,Ue,$e.stretch,B),Tt=Hp(Qe.stretch-fe,Se,M,r.top),ei=Zp(Qe.fixed-Be,Ze,Qe.stretch,G),ni=Hp(st.stretch-me,le,E,r.left),Bt=Zp(st.fixed-ye,Ue,st.stretch,B),yt=Hp(Je.stretch-fe,Se,M,r.top),mi=Zp(Je.fixed-Be,Ze,Je.stretch,G),Xt=new k(dt,Tt),At=new k(ni,Tt),qi=new k(ni,yt),Ui=new k(dt,yt),sn=new k(ot/_,ei/_),ri=new k(Bt/_,mi/_),Si=t*Math.PI/180;if(Si){const Ni=Math.sin(Si),Qi=Math.cos(Si),ln=[Qi,-Ni,Ni,Qi];Xt._matMult(ln),At._matMult(ln),Ui._matMult(ln),qi._matMult(ln)}const Wi=$e.stretch+$e.fixed,Vi=Qe.stretch+Qe.fixed;return{tl:Xt,tr:At,bl:Ui,br:qi,tex:{x:m.paddedRect.x+1+Wi,y:m.paddedRect.y+1+Vi,w:st.stretch+st.fixed-Wi,h:Je.stretch+Je.fixed-Vi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:sn,pixelOffsetBR:ri,minFontScaleX:Ue/_/E,minFontScaleY:Ze/_/M,isSDF:n}};if(l&&(m.stretchX||m.stretchY)){const $e=Zb(P,Z,B),Qe=Zb(z,oe,G);for(let st=0;st<$e.length-1;st++){const Je=$e[st],dt=$e[st+1];for(let ot=0;ot<Qe.length-1;ot++)h.push(mt(Je,Qe[ot],dt,Qe[ot+1]))}}else h.push(mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:T+1}));return h}function Wp(r,t,n){let l=0;for(const h of r)l+=Math.max(t,Math.min(n,h[1]))-Math.max(t,Math.min(n,h[0]));return l}function Zb(r,t,n){const l=[{fixed:-1,stretch:0}];for(const[h,m]of r){const _=l[l.length-1];l.push({fixed:h-_.stretch,stretch:_.stretch}),l.push({fixed:h-_.stretch,stretch:_.stretch+(m-h)})}return l.push({fixed:t+1,stretch:n}),l}function Hp(r,t,n,l){return r/t*n+l}function Zp(r,t,n,l){return r-t*n/l}function ZP(r,t,n,l){const h=t+r.positionedLines[l].lineOffset;return l===0?n+h/2:n+(h+(t+r.positionedLines[l-1].lineOffset))/2}Qc.loadGlyphRange=function(r,t,n,l,h){const m=256*t,_=m+255,v=l.transformRequest(l.normalizeGlyphsURL(n).replace("{fontstack}",r).replace("{range}",`${m}-${_}`),Te.Glyphs);Re(v,(T,E)=>{if(T)h(T);else if(E){const M={},P=function(z){return new sd(z).readFields(UP,{})}(E);for(const z of P.glyphs)M[z.id]=z;h(null,{glyphs:M,ascender:P.ascender,descender:P.descender})}})},Qc.TinySDF=class{constructor({fontSize:r=24,buffer:t=3,radius:n=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:_="normal"}={}){this.buffer=t,this.cutoff=l,this.radius=n;const v=this.size=r+4*t,T=this._createCanvas(v),E=this.ctx=T.getContext("2d",{willReadFrequently:!0});E.font=`${_} ${m} ${r}px ${h}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(r){const t=document.createElement("canvas");return t.width=t.height=r,t}draw(r){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(r),_=Math.ceil(n),v=Math.min(this.size-this.buffer,Math.ceil(m-h)),T=Math.min(this.size-this.buffer,_+Math.ceil(l)),E=v+2*this.buffer,M=T+2*this.buffer,P=Math.max(E*M,0),z=new Uint8ClampedArray(P),F={data:z,width:E,height:M,glyphWidth:v,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:t};if(v===0||T===0)return F;const{ctx:B,buffer:G,gridInner:Z,gridOuter:oe}=this;B.clearRect(G,G,v,T),B.fillText(r,G,G+_);const me=B.getImageData(G,G,v,T);oe.fill(ad,0,P),Z.fill(0,0,P);for(let le=0;le<T;le++)for(let fe=0;fe<v;fe++){const Se=me.data[4*(le*v+fe)+3]/255;if(Se===0)continue;const ye=(le+G)*E+fe+G;if(Se===1)oe[ye]=0,Z[ye]=ad;else{const Ue=.5-Se;oe[ye]=Ue>0?Ue*Ue:0,Z[ye]=Ue<0?Ue*Ue:0}}qb(oe,0,0,E,M,E,this.f,this.v,this.z),qb(Z,G,G,v,T,E,this.f,this.v,this.z);for(let le=0;le<P;le++){const fe=Math.sqrt(oe[le])-Math.sqrt(Z[le]);z[le]=Math.round(255-255*(fe/this.radius+this.cutoff))}return F}};class XP{constructor(t=[],n=KP){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:l}=this,h=n[t];for(;t>0;){const m=t-1>>1,_=n[m];if(l(h,_)>=0)break;n[t]=_,t=m}n[t]=h}_down(t){const{data:n,compare:l}=this,h=this.length>>1,m=n[t];for(;t<h;){let _=1+(t<<1),v=n[_];const T=_+1;if(T<this.length&&l(n[T],v)<0&&(_=T,v=n[T]),l(v,m)>=0)break;n[t]=v,t=_}n[t]=m}}function KP(r,t){return r<t?-1:r>t?1:0}function YP(r,t=1,n=!1){let l=1/0,h=1/0,m=-1/0,_=-1/0;const v=r[0];for(let F=0;F<v.length;F++){const B=v[F];(!F||B.x<l)&&(l=B.x),(!F||B.y<h)&&(h=B.y),(!F||B.x>m)&&(m=B.x),(!F||B.y>_)&&(_=B.y)}const T=Math.min(m-l,_-h);let E=T/2;const M=new XP([],QP);if(T===0)return new k(l,h);for(let F=l;F<m;F+=T)for(let B=h;B<_;B+=T)M.push(new Jc(F+E,B+E,E,r));let P=function(F){let B=0,G=0,Z=0;const oe=F[0];for(let me=0,le=oe.length,fe=le-1;me<le;fe=me++){const Se=oe[me],ye=oe[fe],Ue=Se.x*ye.y-ye.x*Se.y;G+=(Se.x+ye.x)*Ue,Z+=(Se.y+ye.y)*Ue,B+=3*Ue}return new Jc(G/B,Z/B,0,F)}(r),z=M.length;for(;M.length;){const F=M.pop();(F.d>P.d||!P.d)&&(P=F,n&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,z)),F.max-P.d<=t||(E=F.h/2,M.push(new Jc(F.p.x-E,F.p.y-E,E,r)),M.push(new Jc(F.p.x+E,F.p.y-E,E,r)),M.push(new Jc(F.p.x-E,F.p.y+E,E,r)),M.push(new Jc(F.p.x+E,F.p.y+E,E,r)),z+=4)}return n&&(console.log(`num probes: ${z}`),console.log(`best distance: ${P.d}`)),P.p}function QP(r,t){return t.max-r.max}function Jc(r,t,n,l){this.p=new k(r,t),this.h=n,this.d=function(h,m){let _=!1,v=1/0;for(let T=0;T<m.length;T++){const E=m[T];for(let M=0,P=E.length,z=P-1;M<P;z=M++){const F=E[M],B=E[z];F.y>h.y!=B.y>h.y&&h.x<(B.x-F.x)*(h.y-F.y)/(B.y-F.y)+F.x&&(_=!_),v=Math.min(v,D1(h,F,B))}}return(_?1:-1)*Math.sqrt(v)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}const hy=Number.POSITIVE_INFINITY,JP=Math.sqrt(2);function Xb(r,t){return t[1]!==hy?function(n,l,h){let m=0,_=0;switch(l=Math.abs(l),h=Math.abs(h),n){case"top-right":case"top-left":case"top":_=h-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-h}switch(n){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,_]}(r,t[0],t[1]):function(n,l){let h=0,m=0;l<0&&(l=0);const _=l/JP;switch(n){case"top-right":case"top-left":m=_-7;break;case"bottom-right":case"bottom-left":m=7-_;break;case"bottom":m=7-l;break;case"top":m=l-7}switch(n){case"top-right":case"bottom-right":h=-_;break;case"top-left":case"bottom-left":h=_;break;case"left":h=l;break;case"right":h=-l}return[h,m]}(r,t[0])}function ek(r,t,n,l,h,m,_,v,T,E){r.createArrays(),r.tilePixelRatio=Wt/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const M=r.layers[0].layout,P=r.layers[0]._unevaluatedLayout._values,z={};if(r.textSizeData.kind==="composite"){const{minZoom:G,maxZoom:Z}=r.textSizeData;z.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Y(G),v),P["text-size"].possiblyEvaluate(new Y(Z),v)]}if(r.iconSizeData.kind==="composite"){const{minZoom:G,maxZoom:Z}=r.iconSizeData;z.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Y(G),v),P["icon-size"].possiblyEvaluate(new Y(Z),v)]}z.layoutTextSize=P["text-size"].possiblyEvaluate(new Y(T+1),v),z.layoutIconSize=P["icon-size"].possiblyEvaluate(new Y(T+1),v),z.textMaxSize=P["text-size"].possiblyEvaluate(new Y(18),v);const F=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",B=M.get("text-size");for(const G of r.features){const Z=M.get("text-font").evaluate(G,{},v).join(","),oe=B.evaluate(G,{},v),me=z.layoutTextSize.evaluate(G,{},v),le=(z.layoutIconSize.evaluate(G,{},v),{horizontal:{},vertical:void 0}),fe=G.text;let Se,ye=[0,0];if(fe){const Ze=fe.toString(),mt=M.get("text-letter-spacing").evaluate(G,{},v)*Kn,$e=M.get("text-line-height").evaluate(G,{},v)*Kn,Qe=C_(Ze)?mt:0,st=M.get("text-anchor").evaluate(G,{},v),Je=M.get("text-variable-anchor");if(!Je){const Bt=M.get("text-radial-offset").evaluate(G,{},v);ye=Bt?Xb(st,[Bt*Kn,hy]):M.get("text-offset").evaluate(G,{},v).map(yt=>yt*Kn)}let dt=F?"center":M.get("text-justify").evaluate(G,{},v);const ot=M.get("symbol-placement"),Tt=ot==="point",ei=ot==="point"?M.get("text-max-width").evaluate(G,{},v)*Kn:0,ni=Bt=>{r.allowVerticalPlacement&&Nc(Ze)&&(le.vertical=ay(fe,t,n,h,Z,ei,$e,st,Bt,Qe,ye,Yr.vertical,!0,ot,me,oe))};if(!F&&Je){const Bt=dt==="auto"?Je.map(mi=>dy(mi)):[dt];let yt=!1;for(let mi=0;mi<Bt.length;mi++){const Xt=Bt[mi];if(!le.horizontal[Xt])if(yt)le.horizontal[Xt]=le.horizontal[0];else{const At=ay(fe,t,n,h,Z,ei,$e,"center",Xt,Qe,ye,Yr.horizontal,!1,ot,me,oe);At&&(le.horizontal[Xt]=At,yt=At.positionedLines.length===1)}}ni("left")}else{if(dt==="auto"&&(dt=dy(st)),Tt||M.get("text-writing-mode").indexOf("horizontal")>=0||!Nc(Ze)){const Bt=ay(fe,t,n,h,Z,ei,$e,st,dt,Qe,ye,Yr.horizontal,!1,ot,me,oe);Bt&&(le.horizontal[dt]=Bt)}ni(ot==="point"?"left":dt)}}let Ue=!1;if(G.icon&&G.icon.name){const Ze=l[G.icon.name];Ze&&(Se=qP(h[G.icon.name],M.get("icon-offset").evaluate(G,{},v),M.get("icon-anchor").evaluate(G,{},v)),Ue=Ze.sdf,r.sdfIcons===void 0?r.sdfIcons=Ze.sdf:r.sdfIcons!==Ze.sdf&&yi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ze.pixelRatio!==r.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const Be=Yb(le.horizontal)||le.vertical;r.iconsInText||(r.iconsInText=!!Be&&Be.iconsInText),(Be||Se)&&tk(r,G,le,Se,l,z,me,0,ye,Ue,_,v,E)}m&&r.generateCollisionDebugBuffers(T,r.collisionBoxArray)}function dy(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tk(r,t,n,l,h,m,_,v,T,E,M,P,z){let F=m.textMaxSize.evaluate(t,{},P);F===void 0&&(F=_);const B=r.layers[0].layout,G=B.get("icon-offset").evaluate(t,{},P),Z=Yb(n.horizontal)||n.vertical,oe=z.name==="globe",me=_/24,le=r.tilePixelRatio*F/24,fe=(Qe=r.overscaling,r.zoom>18&&Qe>2&&(Qe>>=1),Math.max(Wt/(512*Qe),1)*B.get("symbol-spacing")),Se=B.get("text-padding")*r.tilePixelRatio,ye=B.get("icon-padding")*r.tilePixelRatio,Ue=J(B.get("text-max-angle")),Be=B.get("text-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",Ze=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",mt=B.get("symbol-placement"),$e=fe/2;var Qe;const st=B.get("icon-text-fit");let Je;l&&st!=="none"&&(r.allowVerticalPlacement&&n.vertical&&(Je=Bb(l,n.vertical,st,B.get("icon-text-fit-padding"),G,me)),Z&&(l=Bb(l,Z,st,B.get("icon-text-fit-padding"),G,me)));const dt=(ot,Tt,ei)=>{if(Tt.x<0||Tt.x>=Wt||Tt.y<0||Tt.y>=Wt)return;let ni=null;if(oe){const{x:Bt,y:yt,z:mi}=z.projectTilePoint(Tt.x,Tt.y,ei);ni={anchor:new No(Bt,yt,mi,0,void 0),up:z.upVector(ei,Tt.x,Tt.y)}}(function(Bt,yt,mi,Xt,At,qi,Ui,sn,ri,Si,Wi,Vi,Ni,Qi,ln,Fn,Ar,xi,mn,sr,Li,cn,mr,on,yn){const Bn=Bt.addToLineVertexArray(yt,Xt);let Pn,Yn,gr,Nn,Vo,ru,yd,vd=0,Rw=0,Dw=0,Ow=0,Iy=-1,Py=-1;const fo={};let Fw=Gh("");const zl=mi?mi.anchor:yt;let ky=0,Ly=0;if(ri._unevaluatedLayout.getValue("text-radial-offset")===void 0?[ky,Ly]=ri.layout.get("text-offset").evaluate(Li,{},yn).map(Or=>Or*Kn):(ky=ri.layout.get("text-radial-offset").evaluate(Li,{},yn)*Kn,Ly=hy),Bt.allowVerticalPlacement&&At.vertical){const Or=At.vertical;if(ln)ru=fy(Or),sn&&(yd=fy(sn));else{const Fr=ri.layout.get("text-rotate").evaluate(Li,{},yn)+90;gr=Xp(Si,zl,yt,Wi,Vi,Ni,Or,Qi,Fr,Fn),sn&&(Nn=Xp(Si,zl,yt,Wi,Vi,Ni,sn,xi,Fr))}}if(qi){const Or=ri.layout.get("icon-rotate").evaluate(Li,{},yn),Fr=ri.layout.get("icon-text-fit")!=="none",xd=Hb(qi,Or,mr,Fr),Ry=sn?Hb(sn,Or,mr,Fr):void 0;Yn=Xp(Si,zl,yt,Wi,Vi,Ni,qi,xi,Or),vd=4*xd.length;const Bw=Bt.iconSizeData;let Rl=null;Bw.kind==="source"?(Rl=[ao*ri.layout.get("icon-size").evaluate(Li,{},yn)],Rl[0]>_a&&yi(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Bw.kind==="composite"&&(Rl=[ao*cn.compositeIconSizes[0].evaluate(Li,{},yn),ao*cn.compositeIconSizes[1].evaluate(Li,{},yn)],(Rl[0]>_a||Rl[1]>_a)&&yi(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Bt.addSymbols(Bt.icon,xd,Rl,sr,mn,Li,!1,mi,yt,Bn.lineStartIndex,Bn.lineLength,-1,on,yn),Iy=Bt.icon.placedSymbolArray.length-1,Ry&&(Rw=4*Ry.length,Bt.addSymbols(Bt.icon,Ry,Rl,sr,mn,Li,Yr.vertical,mi,yt,Bn.lineStartIndex,Bn.lineLength,-1,on,yn),Py=Bt.icon.placedSymbolArray.length-1)}for(const Or in At.horizontal){const Fr=At.horizontal[Or];Pn||(Fw=Gh(Fr.text),ln?Vo=fy(Fr):Pn=Xp(Si,zl,yt,Wi,Vi,Ni,Fr,Qi,ri.layout.get("text-rotate").evaluate(Li,{},yn),Fn));const xd=Fr.positionedLines.length===1;if(Dw+=Kb(Bt,mi,yt,Fr,Ui,ri,ln,Li,Fn,Bn,At.vertical?Yr.horizontal:Yr.horizontalOnly,xd?Object.keys(At.horizontal):[Or],fo,Iy,cn,on,yn),xd)break}At.vertical&&(Ow+=Kb(Bt,mi,yt,At.vertical,Ui,ri,ln,Li,Fn,Bn,Yr.vertical,["vertical"],fo,Py,cn,on,yn));let Ta=-1;const zy=(Or,Fr)=>Or?Math.max(Or,Fr):Fr;Ta=zy(Vo,Ta),Ta=zy(ru,Ta),Ta=zy(yd,Ta);const zk=Ta>-1?1:0;Bt.glyphOffsetArray.length>=va.MAX_GLYPHS&&yi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Li.sortKey!==void 0&&Bt.addToSortKeyRanges(Bt.symbolInstances.length,Li.sortKey),Bt.symbolInstances.emplaceBack(zl.x,zl.y,zl.z,yt.x,yt.y,fo.right>=0?fo.right:-1,fo.center>=0?fo.center:-1,fo.left>=0?fo.left:-1,fo.vertical>=0?fo.vertical:-1,Iy,Py,Fw,Pn!==void 0?Pn:Bt.collisionBoxArray.length,Pn!==void 0?Pn+1:Bt.collisionBoxArray.length,gr!==void 0?gr:Bt.collisionBoxArray.length,gr!==void 0?gr+1:Bt.collisionBoxArray.length,Yn!==void 0?Yn:Bt.collisionBoxArray.length,Yn!==void 0?Yn+1:Bt.collisionBoxArray.length,Nn||Bt.collisionBoxArray.length,Nn?Nn+1:Bt.collisionBoxArray.length,Wi,Dw,Ow,vd,Rw,zk,0,ky,Ly,Ta)})(r,Tt,ni,ot,n,l,h,Je,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,Se,Be,T,0,ye,Ze,G,t,m,E,M,P)};if(mt==="line")for(const ot of Gb(t.geometry,0,0,Wt,Wt)){const Tt=HP(ot,fe,Ue,n.vertical||Z,l,24,le,r.overscaling,Wt);for(const ei of Tt){const ni=Z;ni&&ik(r,ni.text,$e,ei)||dt(ot,ei,P)}}else if(mt==="line-center"){for(const ot of t.geometry)if(ot.length>1){const Tt=WP(ot,Ue,n.vertical||Z,l,24,le);Tt&&dt(ot,Tt,P)}}else if(t.type==="Polygon")for(const ot of ey(t.geometry,0)){const Tt=YP(ot,16);dt(ot[0],new No(Tt.x,Tt.y,0,0,void 0),P)}else if(t.type==="LineString")for(const ot of t.geometry)dt(ot,new No(ot[0].x,ot[0].y,0,0,void 0),P);else if(t.type==="Point")for(const ot of t.geometry)for(const Tt of ot)dt([Tt],new No(Tt.x,Tt.y,0,0,void 0),P)}const _a=32640;function Kb(r,t,n,l,h,m,_,v,T,E,M,P,z,F,B,G,Z){const oe=function(fe,Se,ye,Ue,Be,Ze,mt,$e){const Qe=[];if(Se.positionedLines.length===0)return Qe;const st=Ue.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Je=function(ni){const Bt=ni[0],yt=ni[1],mi=Bt*yt;return mi>0?[Bt,-yt]:mi<0?[-Bt,yt]:Bt===0?[yt,Bt]:[yt,-Bt]}(ye);let dt=Math.abs(Se.top-Se.bottom);for(const ni of Se.positionedLines)dt-=ni.lineOffset;const ot=Se.positionedLines.length,Tt=dt/ot;let ei=Se.top-ye[1];for(let ni=0;ni<ot;++ni){const Bt=Se.positionedLines[ni];ei=ZP(Se,Tt,ei,ni);for(const yt of Bt.positionedGlyphs){if(!yt.rect)continue;const mi=yt.rect||{};let Xt=4,At=!0,qi=1,Ui=0;if(yt.imageName){const on=mt[yt.imageName];if(!on)continue;if(on.sdf){yi("SDF images are not supported in formatted text and will be ignored.");continue}At=!1,qi=on.pixelRatio,Xt=1/qi}const sn=(Be||$e)&&yt.vertical,ri=yt.metrics.advance*yt.scale/2,Si=yt.metrics,Wi=yt.rect;if(Wi===null)continue;$e&&Se.verticalizable&&(Ui=yt.imageName?ri-yt.metrics.width*yt.scale/2:0);const Vi=Be?[yt.x+ri,yt.y]:[0,0];let Ni=[0,0],Qi=[0,0],ln=!1;Be||(sn?(Qi=[yt.x+ri+Je[0],yt.y+Je[1]-Ui],ln=!0):Ni=[yt.x+ri+ye[0],yt.y+ye[1]-Ui]);const Fn=Wi.w*yt.scale/(qi*(yt.localGlyph?2:1)),Ar=Wi.h*yt.scale/(qi*(yt.localGlyph?2:1));let xi,mn,sr,Li;if(sn){const on=yt.y-ei,yn=new k(-ri,ri-on),Bn=-Math.PI/2,Pn=new k(...Qi);xi=new k(-ri+Ni[0],Ni[1]),xi._rotateAround(Bn,yn)._add(Pn),xi.x+=-on+ri,xi.y-=(Si.left-Xt)*yt.scale;const Yn=yt.imageName?Si.advance*yt.scale:Kn*yt.scale,gr=String.fromCharCode(yt.glyph);IP(gr)?xi.x+=(1-Xt)*yt.scale:PP(gr)?xi.x+=Yn-Si.height*yt.scale+(-Xt-1)*yt.scale:xi.x+=yt.imageName||Si.width+2*Xt===Wi.w&&Si.height+2*Xt===Wi.h?(Yn-Ar)/2:(Yn-(Si.height+2*Xt)*yt.scale)/2,mn=new k(xi.x,xi.y-Fn),sr=new k(xi.x+Ar,xi.y),Li=new k(xi.x+Ar,xi.y-Fn)}else{const on=(Si.left-Xt)*yt.scale-ri+Ni[0],yn=(-Si.top-Xt)*yt.scale+Ni[1],Bn=on+Fn,Pn=yn+Ar;xi=new k(on,yn),mn=new k(Bn,yn),sr=new k(on,Pn),Li=new k(Bn,Pn)}if(st){let on;on=Be?new k(0,0):ln?new k(Je[0],Je[1]):new k(ye[0],ye[1]),xi._rotateAround(st,on),mn._rotateAround(st,on),sr._rotateAround(st,on),Li._rotateAround(st,on)}const cn=new k(0,0),mr=new k(0,0);Qe.push({tl:xi,tr:mn,bl:sr,br:Li,tex:mi,writingMode:Se.writingMode,glyphOffset:Vi,sectionIndex:yt.sectionIndex,isSDF:At,pixelOffsetTL:cn,pixelOffsetBR:mr,minFontScaleX:0,minFontScaleY:0})}}return Qe}(0,l,T,m,_,v,h,r.allowVerticalPlacement),me=r.textSizeData;let le=null;me.kind==="source"?(le=[ao*m.layout.get("text-size").evaluate(v,{},Z)],le[0]>_a&&yi(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):me.kind==="composite"&&(le=[ao*B.compositeTextSizes[0].evaluate(v,{},Z),ao*B.compositeTextSizes[1].evaluate(v,{},Z)],(le[0]>_a||le[1]>_a)&&yi(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,oe,le,T,_,v,M,t,n,E.lineStartIndex,E.lineLength,F,G,Z);for(const fe of P)z[fe]=r.text.placedSymbolArray.length-1;return 4*oe.length}function Yb(r){for(const t in r)return r[t];return null}function Xp(r,t,n,l,h,m,_,v,T,E){let M=_.top,P=_.bottom,z=_.left,F=_.right;const B=_.collisionPadding;if(B&&(z-=B[0],M-=B[1],F+=B[2],P+=B[3]),T){const G=new k(z,M),Z=new k(F,M),oe=new k(z,P),me=new k(F,P),le=J(T);let fe=new k(0,0);E&&(fe=new k(E[0],E[1])),G._rotateAround(le,fe),Z._rotateAround(le,fe),oe._rotateAround(le,fe),me._rotateAround(le,fe),z=Math.min(G.x,Z.x,oe.x,me.x),F=Math.max(G.x,Z.x,oe.x,me.x),M=Math.min(G.y,Z.y,oe.y,me.y),P=Math.max(G.y,Z.y,oe.y,me.y)}return r.emplaceBack(t.x,t.y,t.z,n.x,n.y,z,M,F,P,v,l,h,m),r.length-1}function fy(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const t=r.bottom-r.top;return t>0?Math.max(10,t):null}function ik(r,t,n,l){const h=r.compareText;if(t in h){const m=h[t];for(let _=m.length-1;_>=0;_--)if(l.dist(m[_])<n)return!0}else h[t]=[];return h[t].push(l),!1}const nk=it([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Qb}=nk,Jb=it([{name:"a_pos_3",components:3,type:"Int16"}]);var ld=it([{name:"a_pos",type:"Int16",components:2}]);const Uo=Wt/Math.PI/2,py=2*_s(1,0)*Uo*Math.PI,eu=[64,32,16],Fs=-Uo,Bs=Uo,rk=[new Sr([Fs,Fs,Fs],[Bs,Bs,Bs]),new Sr([Fs,Fs,Fs],[0,0,Bs]),new Sr([0,Fs,Fs],[Bs,0,Bs]),new Sr([Fs,0,Fs],[0,Bs,Bs]),new Sr([0,0,Fs],[Bs,Bs,Bs])];function ew(r,t,n,l=!0){const h=Ds([],r._camera.position,r.worldSize),m=[t,n,1,1];Ml(m,m,r.pixelMatrixInverse),W1(m,m,1/m[3]);const _=fr([],Os([],m,h)),v=r.globeMatrix,T=[v[12],v[13],v[14]],E=Os([],T,h),M=Hh(E),P=fr([],E),z=r.worldSize/(2*Math.PI),F=vs(P,_),B=Math.asin(z/M);if(B<Math.acos(F)){if(!l)return null;const mt=[],$e=[];Ds(mt,_,M/F),fr($e,Os($e,mt,E)),fr(_,ga(_,E,Ds(_,$e,Math.tan(B)*M)))}const G=[];new W_(h,_).closestPointOnSphere(T,z,G);const Z=fr([],Lt(v,0)),oe=fr([],Lt(v,1)),me=fr([],Lt(v,2)),le=vs(Z,G),fe=vs(oe,G),Se=vs(me,G),ye=ue(Math.asin(-fe/z));let Ue=ue(Math.atan2(le,Se));Ue=r.center.lng+function(mt,$e){const Qe=($e-mt+180)%360-180;return Qe<-180?Qe+360:Qe}(r.center.lng,Ue);const Be=ro(Ue),Ze=ie(Do(ye),0,1);return new $c(Be,Ze)}class sk{constructor(t,n,l){this.a=Os([],t,l),this.b=Os([],n,l),this.center=l;const h=fr([],this.a),m=fr([],this.b);this.angle=Math.acos(vs(h,m))}}function my(r,t){if(r.angle===0)return null;let n;return n=r.a[t]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[t]/r.a[t]/Math.sin(r.angle)-1/Math.tan(r.angle)),n<0||n>1?null:function(l,h,m,_){const v=Math.sin(m);return l*(Math.sin((1-_)*m)/v)+h*(Math.sin(_*m)/v)}(r.a[t],r.b[t],r.angle,ie(n,0,1))+r.center[t]}function lo(r){if(r.z<=1)return rk[r.z+2*r.y+r.x];const t=gy(Kp(r));return Sr.fromPoints(t)}function tw(r,t){const n=hd(t.zoom);if(n===0)return lo(r);const l=Kp(r),h=gy(l),m=ro(l.getWest())*t.worldSize,_=ro(l.getEast())*t.worldSize,v=Do(l.getNorth())*t.worldSize,T=Do(l.getSouth())*t.worldSize,E=[m,v,0],M=[_,v,0],P=[m,T,0],z=[_,T,0],F=N_([],t.globeMatrix);return An(E,E,F),An(M,M,F),An(P,P,F),An(z,z,F),h[0]=ea(h[0],P,n),h[1]=ea(h[1],z,n),h[2]=ea(h[2],M,n),h[3]=ea(h[3],E,n),Sr.fromPoints(h)}function iw(r,t,n,l,h){for(const m of n)An(m,m,l),Ds(m,m,h),j_(r,r,m),G_(t,t,m)}function ok(r,t,n){const l=t/r.worldSize,h=Number.MAX_VALUE,m=[-h,-h,-h],_=[h,h,h],v=r.globeMatrix;if(n.z<=1)return iw(_,m,lo(n).getCorners(),v,l),new Sr(_,m);const T=Kp(n),E=gy(T);if(iw(_,m,E,v,l),T.contains(r.center)){m[2]=0;const Ue=r.point,Be=[Ue.x*l,Ue.y*l,0];return j_(_,_,Be),G_(m,m,Be),new Sr(_,m)}const M=[v[12]*l,v[13]*l,v[14]*l],P=T.getCenter(),z=ie(r.center.lat,-85.051129,so),F=ie(P.lat,-85.051129,so),B=ro(r.center.lng),G=Do(z);let Z=B-ro(P.lng);const oe=G-Do(F);Z>.5?Z-=1:Z<-.5&&(Z+=1);let me=0;Math.abs(Z)>Math.abs(oe)?me=Z>=0?1:3:(me=oe>=0?0:2,Lp(M,M,[v[4]*l,v[5]*l,v[6]*l],-Math.sin(J(oe>=0?T.getSouth():T.getNorth()))*Uo));const le=E[me],fe=E[(me+1)%4],Se=new sk(le,fe,M),ye=[my(Se,0)||le[0],my(Se,1)||le[1],my(Se,2)||le[2]];return _[2]=Math.min(le[2],fe[2]),j_(_,_,ye),G_(m,m,ye),new Sr(_,m)}function Kp({x:r,y:t,z:n}){const l=1/(1<<n),h=new zi(ys(r*l),Xn((t+1)*l)),m=new zi(ys((r+1)*l),Xn(t*l));return new ma(h,m)}function gy(r){const t=J(r.getNorth()),n=J(r.getSouth()),l=Math.cos(t),h=Math.cos(n),m=Math.sin(t),_=Math.sin(n),v=r.getWest(),T=r.getEast();return[tu(h,_,v),tu(h,_,T),tu(l,m,T),tu(l,m,v)]}function tu(r,t,n,l=Uo){return n=J(n),[r*Math.sin(n)*l,-t*l,r*Math.cos(n)*l]}function Yp(r,t,n){return tu(Math.cos(J(r)),Math.sin(J(r)),t,n)}function cd(r,t,n,l){const h=1<<n.z,m=(r/Wt+n.x)/h;return Yp(Xn((t/Wt+n.y)/h),ys(m),l)}function Qp({min:r,max:t}){return 16383/Math.max(t[0]-r[0],t[1]-r[1],t[2]-r[2])}const nw=new Float64Array(16);function ud(r){const t=Qp(r),n=V1(nw,[t,t,t]);return Wh(n,n,((l=[])[0]=-(h=r.min)[0],l[1]=-h[1],l[2]=-h[2],l));var l,h}function _y(r){const t=(l=r.min,(n=nw)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=l[0],n[13]=l[1],n[14]=l[2],n[15]=1,n);var n,l;const h=1/Qp(r);return Cl(t,t,[h,h,h])}function rw(r,t,n,l,h){const m=function(T){const E=Wt/(2*Math.PI);return T/(2*Math.PI)/E}(n),_=[r,t,-n/(2*Math.PI)],v=oo(new Float64Array(16));return Wh(v,v,_),Cl(v,v,[m,m,m]),U_(v,v,J(-h)),kp(v,v,J(-l)),v}function hd(r){return Ie(5,6,r)}function sw(r,t){const n=Yp(t.lat,t.lng);return m=(l=$_([],function(F){const B=Yp(F._center.lat,F._center.lng);let G=q_([],qc(0,1,0),B);const Z=$1([],-F.angle,B);G=An(G,G,Z),$1(Z,-F._pitch,G);const oe=fr([],B);return Ds(oe,oe,F.cameraToCenterDistance/F.pixelsPerMeter*py),An(oe,oe,Z),ga([],B,oe)}(r),n))[0],_=l[1],v=l[2],T=(h=n)[0],E=h[1],M=h[2],z=(P=Math.sqrt(m*m+_*_+v*v)*Math.sqrt(T*T+E*E+M*M))&&vs(l,h)/P,Math.acos(Math.min(Math.max(z,-1),1));var l,h,m,_,v,T,E,M,P,z}const ow=J(85),ak=Math.cos(ow),lk=Math.sin(ow);function aw(r,t){const n=r.fovAboveCenter,l=r.elevation?r.elevation.getMinElevationBelowMSL()*t:0,h=(r._camera.position[2]*r.worldSize-l)/Math.cos(r._pitch),m=Math.sin(n)*h/Math.sin(Math.max(Math.PI/2-r._pitch-n,.01)),_=Math.sin(r._pitch)*m+h;return Math.min(1.01*_,h*(1/r._horizonShift))}function kl(r,t){if(!t.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:t};const n=Math.pow(2,-r.z),l=r.x*n,h=(r.x+1)*n,m=r.y*n,_=(r.y+1)*n,v=ys(l),T=ys(h),E=Xn(m),M=Xn(_),P=t.project(v,E),z=t.project(T,E),F=t.project(T,M),B=t.project(v,M);let G=Math.min(P.x,z.x,F.x,B.x),Z=Math.min(P.y,z.y,F.y,B.y),oe=Math.max(P.x,z.x,F.x,B.x),me=Math.max(P.y,z.y,F.y,B.y);const le=n/16;function fe(ye,Ue,Be,Ze,mt,$e){const Qe=(Be+mt)/2,st=(Ze+$e)/2,Je=t.project(ys(Qe),Xn(st)),dt=Math.max(0,G-Je.x,Z-Je.y,Je.x-oe,Je.y-me);G=Math.min(G,Je.x),oe=Math.max(oe,Je.x),Z=Math.min(Z,Je.y),me=Math.max(me,Je.y),dt>le&&(fe(ye,Je,Be,Ze,Qe,st),fe(Je,Ue,Qe,st,mt,$e))}fe(P,z,l,m,h,m),fe(z,F,h,m,h,_),fe(F,B,h,_,l,_),fe(B,P,l,_,l,m),G-=le,Z-=le,oe+=le,me+=le;const Se=1/Math.max(oe-G,me-Z);return{scale:Se,x:G*Se,y:Z*Se,x2:oe*Se,y2:me*Se,projection:t}}const ck=oo(new Float32Array(16));class ya{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,n){return{x:0,y:0,z:0}}unproject(t,n){return new zi(0,0)}projectTilePoint(t,n,l){return{x:t,y:n,z:0}}locationPoint(t,n,l=!0){return t._coordinatePoint(t.locationCoordinate(n),l)}pixelsPerMeter(t,n){return _s(1,t)*n}pixelSpaceConversion(t,n,l){return 1}farthestPixelDistance(t){return aw(t,t.pixelsPerMeter)}pointCoordinate(t,n,l,h){const m=t.horizonLineFromTop(!1),_=new k(n,Math.max(m,l));return t.rayIntersectionCoordinate(t.pointRayIntersection(_,h))}pointCoordinate3D(t,n,l){const h=new k(n,l);if(t.elevation)return t.elevation.pointCoordinate(h);{const m=this.pointCoordinate(t,h.x,h.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(t,n){if(t.elevation)return!this.pointCoordinate3D(t,n.x,n.y);const l=t.horizonLineFromTop();return n.y<l}createInversionMatrix(t,n){return ck}createTileMatrix(t,n,l){let h,m,_;const v=l.canonical,T=oo(new Float64Array(16));if(this.isReprojectedInTileSpace){const E=kl(v,this);h=1,m=E.x+l.wrap*E.scale,_=E.y,Cl(T,T,[h/E.scale,h/E.scale,t.pixelsPerMeter/n])}else h=n/t.zoomScale(v.z),m=(v.x+Math.pow(2,v.z)*l.wrap)*h,_=v.y*h;return Wh(T,T,[m,_,0]),Cl(T,T,[h/Wt,h/Wt,1]),T}upVector(t,n,l){return[0,0,1]}upVectorScale(t,n,l){return{metersToTile:1}}}class uk extends ya{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[n,l]=this.parallels=t.parallels||[29.5,45.5],h=Math.sin(J(n));this.n=(h+Math.sin(J(l)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(t,n){const{n:l,c:h,r0:m}=this,_=J(t-this.center[0]),v=J(n),T=Math.sqrt(h-2*l*Math.sin(v))/l;return{x:T*Math.sin(_*l),y:T*Math.cos(_*l)-m,z:0}}unproject(t,n){const{n:l,c:h,r0:m}=this,_=m+n;let v=Math.atan2(t,Math.abs(_))*Math.sign(_);_*l<0&&(v-=Math.PI*Math.sign(t)*Math.sign(_));const T=J(this.center[0])*l;v=ze(v,-Math.PI-T,Math.PI-T);const E=ue(v/l)+this.center[0],M=Math.asin(ie((h-(t*t+_*_)*l*l)/(2*l),-1,1)),P=ie(ue(M),-85.051129,so);return new zi(E,P)}}const dd=1.340264,fd=-.081106,pd=893e-6,md=.003796,Jp=Math.sqrt(3)/2;class hk extends ya{project(t,n){n=n/180*Math.PI,t=t/180*Math.PI;const l=Math.asin(Jp*Math.sin(n)),h=l*l,m=h*h*h;return{x:.5*(t*Math.cos(l)/(Jp*(dd+3*fd*h+m*(7*pd+9*md*h)))/Math.PI+.5),y:1-.5*(l*(dd+fd*h+m*(pd+md*h))/Math.PI+1),z:0}}unproject(t,n){t=(2*t-.5)*Math.PI;let l=n=(2*(1-n)-1)*Math.PI,h=l*l,m=h*h*h;for(let M,P,z,F=0;F<12&&(P=l*(dd+fd*h+m*(pd+md*h))-n,z=dd+3*fd*h+m*(7*pd+9*md*h),M=P/z,l=ie(l-M,-Math.PI/3,Math.PI/3),h=l*l,m=h*h*h,!(Math.abs(M)<1e-12));++F);const _=Jp*t*(dd+3*fd*h+m*(7*pd+9*md*h))/Math.cos(l),v=Math.asin(Math.sin(l)/Jp),T=ie(180*_/Math.PI,-180,180),E=ie(180*v/Math.PI,-85.051129,so);return new zi(T,E)}}class dk extends ya{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,n){return{x:.5+t/360,y:.5-n/360,z:0}}unproject(t,n){const l=360*(t-.5),h=ie(360*(.5-n),-85.051129,so);return new zi(l,h)}}const iu=Math.PI/2;function em(r){return Math.tan((iu+r)/2)}class fk extends ya{constructor(t){super(t),this.center=t.center||[0,30];const[n,l]=this.parallels=t.parallels||[30,30],h=J(n),m=J(l),_=Math.cos(h);this.n=h===m?Math.sin(h):Math.log(_/Math.cos(m))/Math.log(em(m)/em(h)),this.f=_*Math.pow(em(h),this.n)/this.n}project(t,n){n=J(n),t=J(t-this.center[0]);const l=1e-6,{n:h,f:m}=this;m>0?n<-iu+l&&(n=-iu+l):n>iu-l&&(n=iu-l);const _=m/Math.pow(em(n),h),v=_*Math.sin(h*t),T=m-_*Math.cos(h*t);return{x:.5*(v/Math.PI+.5),y:1-.5*(T/Math.PI+.5),z:0}}unproject(t,n){t=(2*t-.5)*Math.PI,n=(2*(1-n)-.5)*Math.PI;const{n:l,f:h}=this,m=h-n,_=Math.sign(m),v=Math.sign(l)*Math.sqrt(t*t+m*m);let T=Math.atan2(t,Math.abs(m))*_;m*l<0&&(T-=Math.PI*Math.sign(t)*_);const E=ie(ue(T/l)+this.center[0],-180,180),M=ie(ue(2*Math.atan(Math.pow(h/v,1/l))-iu),-85.051129,so);return new zi(E,M)}}class lw extends ya{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,n){return{x:ro(t),y:Do(n),z:0}}unproject(t,n){const l=ys(t),h=Xn(n);return new zi(l,h)}}const cw=J(so);class pk extends ya{project(t,n){const l=(n=J(n))*n,h=l*l;return{x:.5*((t=J(t))*(.8707-.131979*l+h*(h*(.003971*l-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+l*(.015085+h*(.028874*l-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(t,n){t=(2*t-.5)*Math.PI;let l=n=(2*(1-n)-1)*Math.PI,h=25,m=0,_=l*l;do{_=l*l;const E=_*_;m=(l*(1.007226+_*(.015085+E*(.028874*_-.044475-.005916*E)))-n)/(1.007226+_*(.045255+E*(.259866*_-.311325-.005916*11*E))),l=ie(l-m,-cw,cw)}while(Math.abs(m)>1e-6&&--h>0);_=l*l;const v=ie(ue(t/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),T=ue(l);return new zi(v,T)}}const uw=J(so);class mk extends ya{project(t,n){n=J(n),t=J(t);const l=Math.cos(n),h=2/Math.PI,m=Math.acos(l*Math.cos(t/2)),_=Math.sin(m)/m,v=.5*(t*h+2*l*Math.sin(t/2)/_)||0,T=.5*(n+Math.sin(n)/_)||0;return{x:.5*(v/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(t,n){let l=t=(2*t-.5)*Math.PI,h=n=(2*(1-n)-1)*Math.PI,m=25;const _=1e-6;let v=0,T=0;do{const E=Math.cos(h),M=Math.sin(h),P=2*M*E,z=M*M,F=E*E,B=Math.cos(l/2),G=Math.sin(l/2),Z=2*B*G,oe=G*G,me=1-F*B*B,le=me?1/me:0,fe=me?Math.acos(E*B)*Math.sqrt(1/me):0,Se=.5*(2*fe*E*G+2*l/Math.PI)-t,ye=.5*(fe*M+h)-n,Ue=.5*le*(F*oe+fe*E*B*z)+1/Math.PI,Be=le*(Z*P/4-fe*M*G),Ze=.125*le*(P*G-fe*M*F*Z),mt=.5*le*(z*B+fe*oe*E)+.5,$e=Be*Ze-mt*Ue;v=(ye*Be-Se*mt)/$e,T=(Se*Ze-ye*Ue)/$e,l=ie(l-v,-Math.PI,Math.PI),h=ie(h-T,-uw,uw)}while((Math.abs(v)>_||Math.abs(T)>_)&&--m>0);return new zi(ue(l),ue(h))}}class hw extends ya{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(J(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,n){const{scale:l,cosPhi:h}=this;return{x:J(t)*h*l+.5,y:-Math.sin(J(n))/h*l+.5,z:0}}unproject(t,n){const{scale:l,cosPhi:h}=this,m=-(n-.5)/l,_=ie(ue((t-.5)/l)/h,-180,180),v=Math.asin(ie(m*h,-1,1)),T=ie(ue(v),-85.051129,so);return new zi(_,T)}}class gk extends lw{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(t,n,l){const h=cd(t,n,l);return An(h,h,ud(lo(l))),{x:h[0],y:h[1],z:h[2]}}locationPoint(t,n){const l=Yp(n.lat,n.lng),h=fr([],l),m=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(n),t._centerAltitude):t._centerAltitude;Lp(l,l,h,_s(1,0)*Wt*m);const _=oo(new Float64Array(16));return Gc(_,t.pixelMatrix,t.globeMatrix),An(l,l,_),new k(l[0],l[1])}pixelsPerMeter(t,n){return _s(1,0)*n}pixelSpaceConversion(t,n,l){const h=Ti(_s(1,45)*n,_s(1,t)*n,l);return this.pixelsPerMeter(t,n)/h}createTileMatrix(t,n,l){const h=_y(lo(l.canonical));return Gc(new Float64Array(16),t.globeMatrix,h)}createInversionMatrix(t,n){const{center:l}=t,h=ud(lo(n));return kp(h,h,J(l.lng)),U_(h,h,J(l.lat)),Cl(h,h,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(t,n,l,h){return ew(t,n,l,!0)||new $c(0,0)}pointCoordinate3D(t,n,l){const h=this.pointCoordinate(t,n,l,0);return[h.x,h.y,h.z]}isPointAboveHorizon(t,n){return!ew(t,n.x,n.y,!1)}farthestPixelDistance(t){const n=function(h,m){const _=h.cameraToCenterDistance,v=h._centerAltitude*m,T=h._camera,E=h._camera.forward(),M=ga([],Ds([],E,-_),[0,0,v]),P=h.worldSize/(2*Math.PI),z=[0,0,-P],F=h.width/h.height,B=Math.tan(h.fovAboveCenter),G=Ds([],T.up(),B),Z=Ds([],T.right(),B*F),oe=fr([],ga([],ga([],E,G),Z)),me=[];let le;if(new W_(M,oe).closestPointOnSphere(z,P,me)){const fe=ga([],me,z),Se=Os([],fe,M);le=Math.cos(h.fovAboveCenter)*Hh(Se)}else{const fe=Os([],M,z),Se=Os([],z,M);fr(Se,Se);const ye=Hh(fe)-P;le=Math.sqrt(ye*(ye+2*P));const Ue=Math.acos(le/(P+ye))-Math.acos(vs(E,Se));le*=Math.cos(Ue)}return 1.01*le}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),l=hd(t.zoom);if(l>0){const h=aw(t,_s(1,t.center.lat)*t.worldSize),m=t.worldSize/(2*Math.PI),_=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Ti(n,h+m*(1-Math.cos(_)),Math.pow(l,10))}return n}upVector(t,n,l){return cd(n,l,t,1)}upVectorScale(t){return{metersToTile:py*Qp(lo(t))}}}function dw(r){const t=r.parallels,n=!!t&&Math.abs(t[0]+t[1])<.01;switch(r.name){case"mercator":return new lw(r);case"equirectangular":return new dk(r);case"naturalEarth":return new pk(r);case"equalEarth":return new hk(r);case"winkelTripel":return new mk(r);case"albers":return n?new hw(r):new uk(r);case"lambertConformalConic":return n?new hw(r):new fk(r);case"globe":return new gk(r)}throw new Error(`Invalid projection name: ${r.name}`)}const _k=Pl.VectorTileFeature.types,yk=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tm(r,t,n,l,h,m,_,v,T,E,M,P,z){const F=v?Math.min(_a,Math.round(v[0])):0,B=v?Math.min(_a,Math.round(v[1])):0;r.emplaceBack(t,n,Math.round(32*l),Math.round(32*h),m,_,(F<<1)+(T?1:0),B,16*E,16*M,256*P,256*z)}function im(r,t,n,l,h,m,_){r.emplaceBack(t,n,l,h,m,_)}function nm(r,t,n,l,h){r.emplaceBack(t,n,l,h),r.emplaceBack(t,n,l,h),r.emplaceBack(t,n,l,h),r.emplaceBack(t,n,l,h)}function vk(r){for(const t of r.sections)if(u(t.text))return!0;return!1}class yy{constructor(t){this.layoutVertexArray=new Ki,this.indexArray=new ai,this.programConfigurations=t,this.segments=new En,this.dynamicLayoutVertexArray=new pi,this.opacityVertexArray=new Bi,this.placedSymbolArray=new d1,this.globeExtVertexArray=new hn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bP.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,TP.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,yk,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,wP.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ct(yy,"SymbolBuffers");class vy{constructor(t,n,l){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new l,this.segments=new En,this.collisionVertexArray=new Yi,this.collisionVertexArrayExt=new rn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,EP.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,SP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ct(vy,"CollisionBuffers");class va{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=oo([]),this.placementViewportMatrix=oo([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ny(this.zoom,n["text-size"]),this.iconSizeData=ny(this.zoom,n["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(_=>Yr[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new yy(new El(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new yy(new El(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new m1,this.lineVertexArray=new g1,this.symbolInstances=new p1}calculateGlyphDependencies(t,n,l,h,m){for(let _=0;_<t.length;_++)if(n[t.charCodeAt(_)]=!0,h&&m){const v=rd[t.charAt(_)];v&&(n[v.charCodeAt(0)]=!0)}}populate(t,n,l,h){const m=this.layers[0],_=m.layout,v=this.projection.name==="globe",T=_.get("text-font"),E=_.get("text-field"),M=_.get("icon-image"),P=(E.value.kind!=="constant"||E.value.value instanceof hr&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),z=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,F=_.get("symbol-sort-key");if(this.features=[],!P&&!z)return;const B=n.iconDependencies,G=n.glyphDependencies,Z=n.availableImages,oe=new Y(this.zoom);for(const{feature:me,id:le,index:fe,sourceLayerIndex:Se}of t){const ye=m._featureFilter.needGeometry,Ue=Sl(me,ye);if(!m._featureFilter.filter(oe,Ue,l))continue;if(ye||(Ue.geometry=Oo(me,l,h)),v&&me.type!==1&&l.z<=5){const $e=Ue.geometry,Qe=.98078528056;for(let st=0;st<$e.length;st++)$e[st]=wI($e[st],Je=>Je,(Je,dt)=>vs(cd(Je.x,Je.y,l,1),cd(dt.x,dt.y,l,1))<Qe)}let Be,Ze;if(P){const $e=m.getValueAndResolveTokens("text-field",Ue,l,Z),Qe=hr.factory($e);vk(Qe)&&(this.hasRTLText=!0),(!this.hasRTLText||W()==="unavailable"||this.hasRTLText&&K.isParsed())&&(Be=MP(Qe,m,Ue))}if(z){const $e=m.getValueAndResolveTokens("icon-image",Ue,l,Z);Ze=$e instanceof dr?$e:dr.fromString($e)}if(!Be&&!Ze)continue;const mt=this.sortFeaturesByKey?F.evaluate(Ue,{},l):void 0;if(this.features.push({id:le,text:Be,icon:Ze,index:fe,sourceLayerIndex:Se,geometry:Ue.geometry,properties:me.properties,type:_k[me.type],sortKey:mt}),Ze&&(B[Ze.name]=!0),Be){const $e=T.evaluate(Ue,{},l).join(","),Qe=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Yr.vertical)>=0;for(const st of Be.sections)if(st.image)B[st.image.name]=!0;else{const Je=Nc(Be.toString()),dt=st.fontStack||$e,ot=G[dt]=G[dt]||{};this.calculateGlyphDependencies(st.text,ot,Qe,this.allowVerticalPlacement,Je)}}}_.get("symbol-placement")==="line"&&(this.features=function(me){const le={},fe={},Se=[];let ye=0;function Ue($e){Se.push(me[$e]),ye++}function Be($e,Qe,st){const Je=fe[$e];return delete fe[$e],fe[Qe]=Je,Se[Je].geometry[0].pop(),Se[Je].geometry[0]=Se[Je].geometry[0].concat(st[0]),Je}function Ze($e,Qe,st){const Je=le[Qe];return delete le[Qe],le[$e]=Je,Se[Je].geometry[0].shift(),Se[Je].geometry[0]=st[0].concat(Se[Je].geometry[0]),Je}function mt($e,Qe,st){const Je=st?Qe[0][Qe[0].length-1]:Qe[0][0];return`${$e}:${Je.x}:${Je.y}`}for(let $e=0;$e<me.length;$e++){const Qe=me[$e],st=Qe.geometry,Je=Qe.text?Qe.text.toString():null;if(!Je){Ue($e);continue}const dt=mt(Je,st),ot=mt(Je,st,!0);if(dt in fe&&ot in le&&fe[dt]!==le[ot]){const Tt=Ze(dt,ot,st),ei=Be(dt,ot,Se[Tt].geometry);delete le[dt],delete fe[ot],fe[mt(Je,Se[ei].geometry,!0)]=ei,Se[Tt].geometry=null}else dt in fe?Be(dt,ot,st):ot in le?Ze(dt,ot,st):(Ue($e),le[dt]=ye-1,fe[ot]=ye-1)}return Se.filter($e=>$e.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((me,le)=>me.sortKey-le.sortKey)}update(t,n,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,l,h),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,l,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=dw(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const l=this.lineVertexArray.length,h=t.segment;if(h!==void 0){let m=t.dist(n[h+1]),_=t.dist(n[h]);const v={};for(let T=h+1;T<n.length;T++)v[T]={x:n[T].x,y:n[T].y,tileUnitDistanceFromAnchor:m},T<n.length-1&&(m+=n[T+1].dist(n[T]));for(let T=h||0;T>=0;T--)v[T]={x:n[T].x,y:n[T].y,tileUnitDistanceFromAnchor:_},T>0&&(_+=n[T-1].dist(n[T]));for(let T=0;T<n.length;T++){const E=v[T];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,n,l,h,m,_,v,T,E,M,P,z,F,B){const G=t.indexArray,Z=t.layoutVertexArray,oe=t.globeExtVertexArray,me=t.segments.prepareSegment(4*n.length,Z,G,this.canOverlap?_.sortKey:void 0),le=this.glyphOffsetArray.length,fe=me.vertexLength,Se=this.allowVerticalPlacement&&v===Yr.vertical?Math.PI/2:0,ye=_.text&&_.text.sections;for(let Be=0;Be<n.length;Be++){const{tl:Ze,tr:mt,bl:$e,br:Qe,tex:st,pixelOffsetTL:Je,pixelOffsetBR:dt,minFontScaleX:ot,minFontScaleY:Tt,glyphOffset:ei,isSDF:ni,sectionIndex:Bt}=n[Be],yt=me.vertexLength,mi=ei[1];if(tm(Z,E.x,E.y,Ze.x,mi+Ze.y,st.x,st.y,l,ni,Je.x,Je.y,ot,Tt),tm(Z,E.x,E.y,mt.x,mi+mt.y,st.x+st.w,st.y,l,ni,dt.x,Je.y,ot,Tt),tm(Z,E.x,E.y,$e.x,mi+$e.y,st.x,st.y+st.h,l,ni,Je.x,dt.y,ot,Tt),tm(Z,E.x,E.y,Qe.x,mi+Qe.y,st.x+st.w,st.y+st.h,l,ni,dt.x,dt.y,ot,Tt),T){const Xt=T.anchor,At=T.up;im(oe,Xt.x,Xt.y,Xt.z,At[0],At[1],At[2]),im(oe,Xt.x,Xt.y,Xt.z,At[0],At[1],At[2]),im(oe,Xt.x,Xt.y,Xt.z,At[0],At[1],At[2]),im(oe,Xt.x,Xt.y,Xt.z,At[0],At[1],At[2]),nm(t.dynamicLayoutVertexArray,Xt.x,Xt.y,Xt.z,Se)}else nm(t.dynamicLayoutVertexArray,E.x,E.y,E.z,Se);G.emplaceBack(yt,yt+1,yt+2),G.emplaceBack(yt+1,yt+2,yt+3),me.vertexLength+=4,me.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ei[0]),Be!==n.length-1&&Bt===n[Be+1].sectionIndex||t.programConfigurations.populatePaintArrays(Z.length,_,_.index,{},F,B,ye&&ye[Bt])}const Ue=T?T.anchor:E;t.placedSymbolArray.emplaceBack(Ue.x,Ue.y,Ue.z,E.x,E.y,le,this.glyphOffsetArray.length-le,fe,M,P,E.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],v,0,!1,0,z,0)}_commitLayoutVertex(t,n,l,h,m,_,v){t.emplaceBack(n,l,h,m,_,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(t,n,l,h,m,_,v){const T=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),E=T.vertexLength,M=v.tileAnchorX,P=v.tileAnchorY;for(let F=0;F<4;F++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(n,-t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(n,t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(n,t.padding,t.padding),l.collisionVertexArrayExt.emplaceBack(n,-t.padding,t.padding),this._commitLayoutVertex(l.layoutVertexArray,h,m,_,M,P,new k(t.x1,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,m,_,M,P,new k(t.x2,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,h,m,_,M,P,new k(t.x2,t.y2)),this._commitLayoutVertex(l.layoutVertexArray,h,m,_,M,P,new k(t.x1,t.y2)),T.vertexLength+=4;const z=l.indexArray;z.emplaceBack(E,E+1),z.emplaceBack(E+1,E+2),z.emplaceBack(E+2,E+3),z.emplaceBack(E+3,E),T.primitiveLength+=4}_addTextDebugCollisionBoxes(t,n,l,h,m,_){for(let v=h;v<m;v++){const T=l.get(v),E=this.getSymbolInstanceTextSize(t,_,n,v);this._addCollisionDebugVertices(T,E,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(t,n,l,h,m,_){for(let v=h;v<m;v++){const T=l.get(v),E=this.getSymbolInstanceIconSize(t,n,v);this._addCollisionDebugVertices(T,E,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}generateCollisionDebugBuffers(t,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vy(Kr,Sb.members,nr),this.iconCollisionBox=new vy(Kr,Sb.members,nr);const l=Zc(this.iconSizeData,t),h=Zc(this.textSizeData,t);for(let m=0;m<this.symbolInstances.length;m++){const _=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(h,t,n,_.textBoxStartIndex,_.textBoxEndIndex,_),this._addTextDebugCollisionBoxes(h,t,n,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._addIconDebugCollisionBoxes(l,t,n,_.iconBoxStartIndex,_.iconBoxEndIndex,_),this._addIconDebugCollisionBoxes(l,t,n,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_)}}getSymbolInstanceTextSize(t,n,l,h){const m=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:h),_=jp(this.textSizeData,t,m)/Kn;return this.tilePixelRatio*_}getSymbolInstanceIconSize(t,n,l){const h=this.icon.placedSymbolArray.get(l),m=jp(this.iconSizeData,t,h);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(t,n,l){t.emplaceBack(n,-l,-l),t.emplaceBack(n,l,-l),t.emplaceBack(n,l,l),t.emplaceBack(n,-l,l)}_updateTextDebugCollisionBoxes(t,n,l,h,m,_){for(let v=h;v<m;v++){const T=l.get(v),E=this.getSymbolInstanceTextSize(t,_,n,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,E,T.padding)}}_updateIconDebugCollisionBoxes(t,n,l,h,m){for(let _=h;_<m;_++){const v=l.get(_),T=this.getSymbolInstanceIconSize(t,n,_);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,v.padding)}}updateCollisionDebugBuffers(t,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Zc(this.iconSizeData,t),h=Zc(this.textSizeData,t);for(let m=0;m<this.symbolInstances.length;m++){const _=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(h,t,n,_.textBoxStartIndex,_.textBoxEndIndex,_),this._updateTextDebugCollisionBoxes(h,t,n,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._updateIconDebugCollisionBoxes(l,t,n,_.iconBoxStartIndex,_.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(l,t,n,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,n,l,h,m,_,v,T,E){const M={};for(let P=n;P<l;P++){const z=t.get(P);M.textBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},M.textFeatureIndex=z.featureIndex;break}for(let P=h;P<m;P++){const z=t.get(P);M.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},M.verticalTextFeatureIndex=z.featureIndex;break}for(let P=_;P<v;P++){const z=t.get(P);M.iconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},M.iconFeatureIndex=z.featureIndex;break}for(let P=T;P<E;P++){const z=t.get(P);M.verticalIconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,padding:z.padding,projectedAnchorX:z.projectedAnchorX,projectedAnchorY:z.projectedAnchorY,projectedAnchorZ:z.projectedAnchorZ,tileAnchorX:z.tileAnchorX,tileAnchorY:z.tileAnchorY},M.verticalIconFeatureIndex=z.featureIndex;break}return M}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const l=t.placedSymbolArray.get(n),h=l.vertexStartIndex+4*l.numGlyphs;for(let m=l.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),l=Math.cos(t),h=[],m=[],_=[];for(let v=0;v<this.symbolInstances.length;++v){_.push(v);const T=this.symbolInstances.get(v);h.push(0|Math.round(n*T.tileAnchorX+l*T.tileAnchorY)),m.push(T.featureIndex)}return _.sort((v,T)=>h[v]-h[T]||m[T]-m[v]),_}addToSortKeyRanges(t,n){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const l=this.symbolInstances.get(n);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((h,m,_)=>{h>=0&&_.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ct(va,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),va.MAX_GLYPHS=65535,va.addDynamicAttributes=nm;const xk=new Xe({"symbol-placement":new ve(Ve.layout_symbol["symbol-placement"]),"symbol-spacing":new ve(Ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ve(Ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Me(Ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ve(Ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ve(Ve.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ve(Ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new ve(Ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ve(Ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new Me(Ve.layout_symbol["icon-size"]),"icon-text-fit":new ve(Ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ve(Ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new Me(Ve.layout_symbol["icon-image"]),"icon-rotate":new Me(Ve.layout_symbol["icon-rotate"]),"icon-padding":new ve(Ve.layout_symbol["icon-padding"]),"icon-keep-upright":new ve(Ve.layout_symbol["icon-keep-upright"]),"icon-offset":new Me(Ve.layout_symbol["icon-offset"]),"icon-anchor":new Me(Ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ve(Ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ve(Ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ve(Ve.layout_symbol["text-rotation-alignment"]),"text-field":new Me(Ve.layout_symbol["text-field"]),"text-font":new Me(Ve.layout_symbol["text-font"]),"text-size":new Me(Ve.layout_symbol["text-size"]),"text-max-width":new Me(Ve.layout_symbol["text-max-width"]),"text-line-height":new Me(Ve.layout_symbol["text-line-height"]),"text-letter-spacing":new Me(Ve.layout_symbol["text-letter-spacing"]),"text-justify":new Me(Ve.layout_symbol["text-justify"]),"text-radial-offset":new Me(Ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ve(Ve.layout_symbol["text-variable-anchor"]),"text-anchor":new Me(Ve.layout_symbol["text-anchor"]),"text-max-angle":new ve(Ve.layout_symbol["text-max-angle"]),"text-writing-mode":new ve(Ve.layout_symbol["text-writing-mode"]),"text-rotate":new Me(Ve.layout_symbol["text-rotate"]),"text-padding":new ve(Ve.layout_symbol["text-padding"]),"text-keep-upright":new ve(Ve.layout_symbol["text-keep-upright"]),"text-transform":new Me(Ve.layout_symbol["text-transform"]),"text-offset":new Me(Ve.layout_symbol["text-offset"]),"text-allow-overlap":new ve(Ve.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ve(Ve.layout_symbol["text-ignore-placement"]),"text-optional":new ve(Ve.layout_symbol["text-optional"])});var xy={paint:new Xe({"icon-opacity":new Me(Ve.paint_symbol["icon-opacity"]),"icon-color":new Me(Ve.paint_symbol["icon-color"]),"icon-halo-color":new Me(Ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new Me(Ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Me(Ve.paint_symbol["icon-halo-blur"]),"icon-translate":new ve(Ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new ve(Ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new Me(Ve.paint_symbol["text-opacity"]),"text-color":new Me(Ve.paint_symbol["text-color"],{runtimeType:Wr,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new Me(Ve.paint_symbol["text-halo-color"]),"text-halo-width":new Me(Ve.paint_symbol["text-halo-width"]),"text-halo-blur":new Me(Ve.paint_symbol["text-halo-blur"]),"text-translate":new ve(Ve.paint_symbol["text-translate"]),"text-translate-anchor":new ve(Ve.paint_symbol["text-translate-anchor"])}),layout:xk};class fw{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ko,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ct(fw,"FormatSectionOverride",{omit:["defaultValue"]});class rm extends Rs{constructor(t){super(t,xy)}recalculate(t,n){super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const m of l)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,n,l,h){const m=this.layout.get(t).evaluate(n,{},l,h),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||Ic(_.value)||!m?m:function(v,T){return T.replace(/{([^{}]+)}/g,(E,M)=>M in v?String(v[M]):"")}(n.properties,m)}createBucket(t){return new va(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of xy.paint.overridableProperties){if(!rm.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),l=new fw(n),h=new Sh(l,n.property.specification);let m=null;m=n.value.kind==="constant"||n.value.kind==="source"?new Ah("source",h):new hl("composite",h,n.value.zoomStops,n.value._interpolationType),this.paint._values[t]=new pe(n.property,m,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,l){return!(!this.layout||n.isDataDriven()||l.isDataDriven())&&rm.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const l=t.get("text-field"),h=xy.paint.properties[n];let m=!1;const _=v=>{for(const T of v)if(h.overrides&&h.overrides.hasOverride(T))return void(m=!0)};if(l.value.kind==="constant"&&l.value.value instanceof hr)_(l.value.value.sections);else if(l.value.kind==="source"){const v=E=>{m||(E instanceof Ja&&_n(E.value)===Xa?_(E.value.sections):E instanceof tl?_(E.sections):E.eachChild(v))},T=l.value;T._styleExpression&&v(T._styleExpression.expression)}return m}getProgramConfiguration(t){return new pa(this,t)}}var bk={paint:new Xe({"background-color":new ve(Ve.paint_background["background-color"]),"background-pattern":new ht(Ve.paint_background["background-pattern"]),"background-opacity":new ve(Ve.paint_background["background-opacity"])})},wk={paint:new Xe({"raster-opacity":new ve(Ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new ve(Ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ve(Ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ve(Ve.paint_raster["raster-brightness-max"]),"raster-saturation":new ve(Ve.paint_raster["raster-saturation"]),"raster-contrast":new ve(Ve.paint_raster["raster-contrast"]),"raster-resampling":new ve(Ve.paint_raster["raster-resampling"]),"raster-fade-duration":new ve(Ve.paint_raster["raster-fade-duration"])})};class Tk extends Rs{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var Ek={paint:new Xe({"sky-type":new ve(Ve.paint_sky["sky-type"]),"sky-atmosphere-sun":new ve(Ve.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ve(Ve.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ve(Ve.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ve(Ve.paint_sky["sky-gradient-radius"]),"sky-gradient":new ke(Ve.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ve(Ve.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ve(Ve.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ve(Ve.paint_sky["sky-opacity"])})};function by(r,t,n){const l=[0,0,1],h=Z1([]);return K1(h,h,n?-J(r)+Math.PI:J(r)),X1(h,h,-J(t)),q1(l,l,h),fr(l,l)}const Sk={circle:class extends Rs{constructor(r){super(r,II)}createBucket(r){return new O_(r)}queryRadius(r){const t=r;return jc("circle-radius",this,t)+jc("circle-stroke-width",this,t)+Ip(this.paint.get("circle-translate"))}queryIntersectsFeature(r,t,n,l,h,m,_,v){const T=N1(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,r.pixelToTileUnitsFactor),E=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n);return Y1(r,l,m,_,v,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,E)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new pa(this,r)}},heatmap:class extends Rs{createBucket(r){return new J1(r)}constructor(r){super(r,OI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=K_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return jc("heatmap-radius",this,r)}queryIntersectsFeature(r,t,n,l,h,m,_,v){const T=this.paint.get("heatmap-radius").evaluate(t,n);return Y1(r,l,m,_,v,!0,!0,new k(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new pa(this,r)}},hillshade:class extends Rs{constructor(r){super(r,FI)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Rs{constructor(r){super(r,eP)}getProgramIds(){const r=this.paint.get("fill-pattern"),t=r&&r.constantOr(1),n=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(r){return new pa(this,r)}recalculate(r,t){super.recalculate(r,t);const n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Bp(r)}queryRadius(){return Ip(this.paint.get("fill-translate"))}queryIntersectsFeature(r,t,n,l,h,m){return!r.queryGeometry.isAboveHorizon&&R1(B1(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,r.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Rs{constructor(r){super(r,fP)}createBucket(r){return new td(r)}queryRadius(){return Ip(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new pa(this,r)}queryIntersectsFeature(r,t,n,l,h,m,_,v,T){const E=N1(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,r.pixelToTileUnitsFactor),M=this.paint.get("fill-extrusion-height").evaluate(t,n),P=this.paint.get("fill-extrusion-base").evaluate(t,n),z=[0,0],F=v&&m.elevation,B=m.elevation?m.elevation.exaggeration():1,G=r.tile.getBucket(this);if(F&&G instanceof td){const me=G.centroidVertexArray,le=T+1;if(le<me.length){const fe=me.get(le);z[0]=fe.a_centroid_pos0,z[1]=fe.a_centroid_pos1}}if(z[0]===0&&z[1]===1)return!1;m.projection.name==="globe"&&(l=_b([l],[new k(0,0),new k(Wt,Wt)],r.tileID.canonical).map(me=>me.polygon).flat());const Z=function(me,le,fe,Se,ye,Ue,Be,Ze,mt,$e,Qe){return me.projection.name==="globe"?function(st,Je,dt,ot,Tt,ei,ni,Bt,yt,mi,Xt){const At=[],qi=[],Ui=st.projection.upVectorScale(Xt,st.center.lat,st.worldSize).metersToTile,sn=[0,0,0,1],ri=[0,0,0,1],Si=(Vi,Ni,Qi,ln)=>{Vi[0]=Ni,Vi[1]=Qi,Vi[2]=ln,Vi[3]=1},Wi=gb();dt>0&&(dt+=Wi),ot+=Wi;for(const Vi of Je){const Ni=[],Qi=[];for(const ln of Vi){const Fn=ln.x+Tt.x,Ar=ln.y+Tt.y,xi=st.projection.projectTilePoint(Fn,Ar,Xt),mn=st.projection.upVector(Xt,ln.x,ln.y);let sr=dt,Li=ot;if(ni){const cn=bb(Fn,Ar,dt,ot,ni,Bt,yt,mi);sr+=cn.base,Li+=cn.top}dt!==0?Si(sn,xi.x+mn[0]*Ui*sr,xi.y+mn[1]*Ui*sr,xi.z+mn[2]*Ui*sr):Si(sn,xi.x,xi.y,xi.z),Si(ri,xi.x+mn[0]*Ui*Li,xi.y+mn[1]*Ui*Li,xi.z+mn[2]*Ui*Li),An(sn,sn,ei),An(ri,ri,ei),Ni.push(Vp(sn)),Qi.push(Vp(ri))}At.push(Ni),qi.push(Qi)}return[At,qi]}(me,le,fe,Se,ye,Ue,Be,Ze,mt,$e,Qe):Be?function(st,Je,dt,ot,Tt,ei,ni,Bt,yt){const mi=[],Xt=[],At=[0,0,0,1];for(const qi of st){const Ui=[],sn=[];for(const ri of qi){const Si=ri.x+ot.x,Wi=ri.y+ot.y,Vi=bb(Si,Wi,Je,dt,ei,ni,Bt,yt);At[0]=Si,At[1]=Wi,At[2]=Vi.base,At[3]=1,Ml(At,At,Tt),At[3]=Math.max(At[3],1e-5);const Ni=Vp([At[0]/At[3],At[1]/At[3],At[2]/At[3]]);At[0]=Si,At[1]=Wi,At[2]=Vi.top,At[3]=1,Ml(At,At,Tt),At[3]=Math.max(At[3],1e-5);const Qi=Vp([At[0]/At[3],At[1]/At[3],At[2]/At[3]]);Ui.push(Ni),sn.push(Qi)}mi.push(Ui),Xt.push(sn)}return[mi,Xt]}(le,fe,Se,ye,Ue,Be,Ze,mt,$e):function(st,Je,dt,ot,Tt){const ei=[],ni=[],Bt=Tt[8]*Je,yt=Tt[9]*Je,mi=Tt[10]*Je,Xt=Tt[11]*Je,At=Tt[8]*dt,qi=Tt[9]*dt,Ui=Tt[10]*dt,sn=Tt[11]*dt;for(const ri of st){const Si=[],Wi=[];for(const Vi of ri){const Ni=Vi.x+ot.x,Qi=Vi.y+ot.y,ln=Tt[0]*Ni+Tt[4]*Qi+Tt[12],Fn=Tt[1]*Ni+Tt[5]*Qi+Tt[13],Ar=Tt[2]*Ni+Tt[6]*Qi+Tt[14],xi=Tt[3]*Ni+Tt[7]*Qi+Tt[15],mn=ln+Bt,sr=Fn+yt,Li=Ar+mi,cn=Math.max(xi+Xt,1e-5),mr=ln+At,on=Fn+qi,yn=Ar+Ui,Bn=Math.max(xi+sn,1e-5),Pn=new k(mn/cn,sr/cn);Pn.z=Li/cn,Si.push(Pn);const Yn=new k(mr/Bn,on/Bn);Yn.z=yn/Bn,Wi.push(Yn)}ei.push(Si),ni.push(Wi)}return[ei,ni]}(le,fe,Se,ye,Ue)}(m,l,P,M,E,_,F?v:null,z,B,m.center.lat,r.tileID.canonical),oe=r.queryGeometry;return function(me,le,fe){let Se=1/0;R1(fe,le)&&(Se=xb(fe,le[0]));for(let ye=0;ye<le.length;ye++){const Ue=le[ye],Be=me[ye];for(let Ze=0;Ze<Ue.length-1;Ze++){const mt=Ue[Ze],$e=[mt,Ue[Ze+1],Be[Ze+1],Be[Ze],mt];z1(fe,$e)&&(Se=Math.min(Se,xb(fe,$e)))}}return Se!==1/0&&Se}(Z[0],Z[1],oe.isPointQuery()?oe.screenBounds:oe.screenGeometry)}},line:class extends Rs{constructor(r){super(r,wb),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof sh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,t){super.recalculate(r,t),this.paint._values["line-floorwidth"]=Tb.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new $p(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new pa(this,r)}queryRadius(r){const t=r,n=Eb(jc("line-width",this,t),jc("line-gap-width",this,t)),l=jc("line-offset",this,t);return n/2+Math.abs(l)+Ip(this.paint.get("line-translate"))}queryIntersectsFeature(r,t,n,l,h,m){if(r.queryGeometry.isAboveHorizon)return!1;const _=B1(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,r.pixelToTileUnitsFactor),v=r.pixelToTileUnitsFactor/2*Eb(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),T=this.paint.get("line-offset").evaluate(t,n);return T&&(l=function(E,M){const P=[],z=new k(0,0);for(let F=0;F<E.length;F++){const B=E[F],G=[];for(let Z=0;Z<B.length;Z++){const oe=B[Z-1],me=B[Z],le=B[Z+1],fe=Z===0?z:me.sub(oe)._unit()._perp(),Se=Z===B.length-1?z:le.sub(me)._unit()._perp(),ye=fe._add(Se)._unit();ye._mult(1/(ye.x*Se.x+ye.y*Se.y)),G.push(ye._mult(M)._add(me))}P.push(G)}return P}(l,T*r.pixelToTileUnitsFactor)),function(E,M,P){for(let z=0;z<M.length;z++){const F=M[z];if(E.length>=3){for(let B=0;B<F.length;B++)if(Al(E,F[B]))return!0}if(SI(E,F,P))return!0}return!1}(_,l,v)}isTileClipped(){return!0}},symbol:rm,background:class extends Rs{constructor(r){super(r,bk)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Rs{constructor(r){super(r,wk)}getProgramIds(){return["raster"]}},sky:class extends Rs{constructor(r){super(r,Ek),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=K_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(r,t){if(this.paint.get("sky-type")==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),h=!l,m=r.style.light,_=m.properties.get("position");return h&&m.properties.get("anchor")==="viewport"&&yi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?by(_.azimuthal,90-_.polar,t):by(l[0],90-l[1],t)}const n=this.paint.get("sky-gradient-center");return by(n[0],90-n[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}}};class gd{constructor(t,n,l,h){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(n,h)}update(t,n,l){const{width:h,height:m}=t,{context:_}=this,{gl:v}=_,{HTMLImageElement:T,HTMLCanvasElement:E,HTMLVideoElement:M,ImageData:P,ImageBitmap:z}=w;if(v.bindTexture(v.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!n||n.premultiply!==!1)),l||this.size&&this.size[0]===h&&this.size[1]===m){const{x:F,y:B}=l||{x:0,y:0};t instanceof T||t instanceof E||t instanceof M||t instanceof P||z&&t instanceof z?v.texSubImage2D(v.TEXTURE_2D,0,F,B,v.RGBA,v.UNSIGNED_BYTE,t):v.texSubImage2D(v.TEXTURE_2D,0,F,B,h,m,v.RGBA,v.UNSIGNED_BYTE,t.data)}else this.size=[h,m],t instanceof T||t instanceof E||t instanceof M||t instanceof P||z&&t instanceof z?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,t):v.texImage2D(v.TEXTURE_2D,0,this.format,h,m,0,this.format,v.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(t,n){const{context:l}=this,{gl:h}=l;h.bindTexture(h.TEXTURE_2D,this.texture),t!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,t),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?t===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:t),this.filter=t),n!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class wy{constructor(t,n){this.width=t,this.height=n,this.nextRow=0,this.image=new Fo({width:t,height:n}),this.positions={},this.uploaded=!1}getDash(t,n){const l=this.getKey(t,n);return this.positions[l]}trim(){const t=this.width,n=this.height=et(this.nextRow);this.image.resize({width:t,height:n})}getKey(t,n){return t.join(",")+n}getDashRanges(t,n,l){const h=[];let m=t.length%2==1?-t[t.length-1]*l:0,_=t[0]*l,v=!0;h.push({left:m,right:_,isDash:v,zeroLength:t[0]===0});let T=t[0];for(let E=1;E<t.length;E++){v=!v;const M=t[E];m=T*l,T+=M,_=T*l,h.push({left:m,right:_,isDash:v,zeroLength:M===0})}return h}addRoundDash(t,n,l){const h=n/2;for(let m=-l;m<=l;m++){const _=this.width*(this.nextRow+l+m);let v=0,T=t[v];for(let E=0;E<this.width;E++){E/T.right>1&&(T=t[++v]);const M=Math.abs(E-T.left),P=Math.abs(E-T.right),z=Math.min(M,P);let F;const B=m/l*(h+1);if(T.isDash){const G=h-Math.abs(B);F=Math.sqrt(z*z+G*G)}else F=h-Math.sqrt(z*z+B*B);this.image.data[_+E]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(t,n){for(let T=t.length-1;T>=0;--T){const E=t[T],M=t[T+1];E.zeroLength?t.splice(T,1):M&&M.isDash===E.isDash&&(M.left=E.left,t.splice(T,1))}const l=t[0],h=t[t.length-1];l.isDash===h.isDash&&(l.left=h.left-this.width,h.right=l.right+this.width);const m=this.width*this.nextRow;let _=0,v=t[_];for(let T=0;T<this.width;T++){T/v.right>1&&(v=t[++_]);const E=Math.abs(T-v.left),M=Math.abs(T-v.right),P=Math.min(E,M);this.image.data[m+T]=Math.max(0,Math.min(255,(v.isDash?P:-P)+n+128))}}addDash(t,n){const l=this.getKey(t,n);if(this.positions[l])return this.positions[l];const h=n==="round",m=h?7:0,_=2*m+1;if(this.nextRow+_>this.height)return yi("LineAtlas out of space"),null;t.length===0&&t.push(1);let v=0;for(let M=0;M<t.length;M++)t[M]<0&&(yi("Negative value is found in line dasharray, replacing values with 0"),t[M]=0),v+=t[M];if(v!==0){const M=this.width/v,P=this.getDashRanges(t,this.width,M);h?this.addRoundDash(P,M,m):this.addRegularDash(P,n==="square"?.5*M:0)}const T=this.nextRow+m;this.nextRow+=_;const E={tl:[T,m],br:[v,0]};return this.positions[l]=E,E}}Ct(wy,"LineAtlas");class Ak{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Ck{constructor(){this.tasks={},this.taskQueue=[],Vt(["process"],this),this.invoker=new Ak(this.process),this.nextId=0}add(t,n){const l=this.nextId++,h=function({type:m,isSymbolTile:_,zoom:v}){return v=v||0,m==="message"?0:m!=="maybePrepare"||_?m!=="parseTile"||_?m==="parseTile"&&_?300-v:m==="maybePrepare"&&_?400-v:500:200-v:100-v}(n);if(h===0){gn();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:t,metadata:n,priority:h,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){gn();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const n=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let t=null,n=1/0;for(let h=0;h<this.taskQueue.length;h++){const m=this.tasks[this.taskQueue[h]];m.priority<n&&(n=m.priority,t=h)}if(t===null)return null;const l=this.taskQueue[t];return this.taskQueue.splice(t,1),l}remove(){this.invoker.remove()}}class pw{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const l=t[n];this._stringToNumber[l]=n,this._numberToString[n]=l}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const Mk=["tile","layer","source","sourceLayer","state"];class mw{constructor(t,n,l,h,m){this.type="Feature",this._vectorTileFeature=t,this._z=n,this._x=l,this._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const n of Mk)this[n]!==void 0&&(t[n]=this[n]);return t}}const xs=32,co=33,xa=new Uint16Array(8184);for(let r=0;r<2046;r++){let t=r+2,n=0,l=0,h=0,m=0,_=0,v=0;for(1&t?h=m=_=xs:n=l=v=xs;(t>>=1)>1;){const E=n+h>>1,M=l+m>>1;1&t?(h=n,m=l,n=_,l=v):(n=h,l=m,h=_,m=v),_=E,v=M}const T=4*r;xa[T+0]=n,xa[T+1]=l,xa[T+2]=h,xa[T+3]=m}const uo=new Uint16Array(2178),ba=new Uint8Array(1089),sm=new Uint16Array(1089);function gw(r){return r===0?-.03125:r===32?.03125:0}var _w=it([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const yw={type:2,extent:Wt,loadGeometry:()=>[[new k(0,0),new k(8193,0),new k(8193,8193),new k(0,8193),new k(0,0)]]};class Ty{constructor(t,n,l,h,m){this.tileID=t,this.uid=De(),this.uses=0,this.tileSize=n,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(t){const n=t+this.timeAdded;n<gt.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=kl(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,n,l){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(h,m){const _={};if(!m)return _;for(const v of h){const T=v.layerIds.map(E=>m.getLayer(E)).filter(Boolean);if(T.length!==0){v.layers=T,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(E=>T.filter(M=>M.id===E)[0]));for(const E of T)_[E.id]=v}}return _}(t.buckets,n.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof va){if(this.hasSymbolBuckets=!0,!l)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof va&&m.hasRTLText){this.hasRTLText=!0,K.isLoading()||K.isLoaded()||W()!=="deferred"||ee();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(h).queryRadius(m))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new no}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(t)}const n=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new gd(t,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new gd(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new gd(t,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,n,l,h,m,_,v,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:v,transform:_,params:m,tileTransform:this.tileTransform},t,n,l):{}}querySourceFeatures(t,n){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),m=n?n.sourceLayer:"",_=h._geojsonTileLayer||h[m];if(!_)return;const v=ml(n&&n.filter),{z:T,x:E,y:M}=this.tileID.canonical,P={z:T,x:E,y:M};for(let z=0;z<_.length;z++){const F=_.feature(z);if(v.needGeometry){const Z=Sl(F,!0);if(!v.filter(new Y(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!v.filter(new Y(this.tileID.overscaledZ),F))continue;const B=l.getId(F,m),G=new mw(F,T,E,M,B);G.tile=P,t.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const n=this.expirationTime;if(t.cacheControl){const l=xn(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(n)if(this.expirationTime<n)h=!0;else{const m=this.expirationTime-n;m?this.expirationTime=l+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!n)return;const l=this.latestFeatureIndex.loadVTLayers(),h=n.style.listImages();for(const m in this.buckets){if(!n.style.hasLayer(m))continue;const _=this.buckets[m],v=_.layers[0].sourceLayer||"_geojsonTileLayer",T=l[v],E=t[v];if(!T||!E||Object.keys(E).length===0)continue;if(_.update(E,T,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),_ instanceof $p||_ instanceof Bp){const P=n.style._getSourceCache(_.layers[0].source);n._terrain&&n._terrain.enabled&&P&&_.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(P.id,this.tileID)}const M=n&&n.style&&n.style.getLayer(m);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<gt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=gt.now()+t}setTexture(t,n){const l=n.context,h=l.gl;this.texture=n.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new gd(l,t,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),l.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax))}setDependencies(t,n){const l={};for(const h of n)l[h]=!0;this.dependencies[t]=l}hasDependency(t,n){for(const l of t){const h=this.dependencies[l];if(h){for(const m of n)if(h[m])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,n){if(!n||n.name==="mercator"||this._tileDebugBuffer)return;const l=Oo(yw,this.tileID.canonical,this.tileTransform)[0],h=new vt,m=new Io;for(let _=0;_<l.length;_++){const{x:v,y:T}=l[_];h.emplaceBack(v,T),m.emplaceBack(_)}m.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(m),this._tileDebugBuffer=t.createVertexBuffer(h,ld.members),this._tileDebugSegments=En.simpleSegment(0,0,h.length,m.length)}_makeTileBoundsBuffers(t,n){if(this._tileBoundsBuffer||!n||n.name==="mercator")return;const l=Oo(yw,this.tileID.canonical,this.tileTransform)[0];let h,m;if(this.isRaster){const _=function(v,T){const E=kl(v,T),M=Math.pow(2,v.z);for(let Z=0;Z<co;Z++)for(let oe=0;oe<co;oe++){const me=ys((v.x+(oe+gw(oe))/xs)/M),le=Xn((v.y+(Z+gw(Z))/xs)/M),fe=T.project(me,le),Se=Z*co+oe;uo[2*Se+0]=Math.round((fe.x*E.scale-E.x)*Wt),uo[2*Se+1]=Math.round((fe.y*E.scale-E.y)*Wt)}ba.fill(0),sm.fill(0);for(let Z=2045;Z>=0;Z--){const oe=4*Z,me=xa[oe+0],le=xa[oe+1],fe=xa[oe+2],Se=xa[oe+3],ye=me+fe>>1,Ue=le+Se>>1,Be=ye+Ue-le,Ze=Ue+me-ye,mt=le*co+me,$e=Se*co+fe,Qe=Ue*co+ye,st=Math.hypot((uo[2*mt+0]+uo[2*$e+0])/2-uo[2*Qe+0],(uo[2*mt+1]+uo[2*$e+1])/2-uo[2*Qe+1])>=16;if(ba[Qe]=ba[Qe]||(st?1:0),Z<1022){const Je=(le+Ze>>1)*co+(me+Be>>1),dt=(Se+Ze>>1)*co+(fe+Be>>1);ba[Qe]=ba[Qe]||ba[Je]||ba[dt]}}const P=new Ut,z=new ai;let F=0;function B(Z,oe){const me=oe*co+Z;return sm[me]===0&&(P.emplaceBack(uo[2*me+0],uo[2*me+1],Z*Wt/xs,oe*Wt/xs),sm[me]=++F),sm[me]-1}function G(Z,oe,me,le,fe,Se){const ye=Z+me>>1,Ue=oe+le>>1;if(Math.abs(Z-fe)+Math.abs(oe-Se)>1&&ba[Ue*co+ye])G(fe,Se,Z,oe,ye,Ue),G(me,le,fe,Se,ye,Ue);else{const Be=B(Z,oe),Ze=B(me,le),mt=B(fe,Se);z.emplaceBack(Be,Ze,mt)}}return G(0,0,xs,xs,xs,0),G(xs,xs,0,0,0,xs),{vertices:P,indices:z}}(this.tileID.canonical,n);h=_.vertices,m=_.indices}else{h=new Ut,m=new ai;for(const{x:v,y:T}of l)h.emplaceBack(v,T,0,0);const _=zp(h.int16,void 0,4);for(let v=0;v<_.length;v+=3)m.emplaceBack(_[v],_[v+1],_[v+2])}this._tileBoundsBuffer=t.createVertexBuffer(h,_w.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(m),this._tileBoundsSegments=En.simpleSegment(0,0,h.length,m.length)}_makeGlobeTileDebugBuffers(t,n){const l=n.projection;if(!l||l.name!=="globe"||n.freezeTileCoverage)return;const h=this.tileID.canonical,m=ud(tw(h,n)),_=hd(n.zoom);let v;_>0&&(v=N_(new Float64Array(16),n.globeMatrix));const T=(h.x+.5)/(1<<h.z)-ro(n.center.lng);let E=0;T>.5?E=-1:T<-.5&&(E=1),this._makeGlobeTileDebugBorderBuffer(t,h,n,m,v,_,E),this._makeGlobeTileDebugTextBuffer(t,h,n,m,v,_,E)}_globePoint(t,n,l,h,m,_,v,T){let E=cd(t,n,l);if(_){const M=1<<l.z,P=[((t/Wt+l.x)/M+T)*h,(n/Wt+l.y)/M*h,0];An(P,P,_),E=ea(E,P,v)}return An(E,E,m)}_makeGlobeTileDebugBorderBuffer(t,n,l,h,m,_,v){const T=new vt,E=new Io,M=new zt,P=(F,B,G,Z,oe)=>{const me=(G-F)/(oe-1),le=(Z-B)/(oe-1),fe=T.length;for(let Se=0;Se<oe;Se++){const ye=F+Se*me,Ue=B+Se*le;T.emplaceBack(ye,Ue);const Be=this._globePoint(ye,Ue,n,l.worldSize,h,m,_,v);M.emplaceBack(Be[0],Be[1],Be[2]),E.emplaceBack(fe+Se)}},z=Wt;P(0,0,z,0,16),P(z,0,z,z,16),P(z,z,0,z,16),P(0,z,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(E),this._tileDebugBuffer=t.createVertexBuffer(T,ld.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(M,Jb.members),this._tileDebugSegments=En.simpleSegment(0,0,T.length,E.length)}_makeGlobeTileDebugTextBuffer(t,n,l,h,m,_,v){const T=new vt,E=new ai,M=new zt,P=25;E.reserve(32),T.reserve(P),M.reserve(P);const z=(F,B)=>P*F+B;for(let F=0;F<P;F++){const B=2048*F;for(let G=0;G<P;G++){const Z=2048*G;T.emplaceBack(Z,B);const oe=this._globePoint(Z,B,n,l.worldSize,h,m,_,v);M.emplaceBack(oe[0],oe[1],oe[2])}}for(let F=0;F<4;F++)for(let B=0;B<4;B++){const G=z(F,B),Z=z(F,B+1),oe=z(F+1,B),me=z(F+1,B+1);E.emplaceBack(G,Z,oe),E.emplaceBack(oe,Z,me)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(E),this._tileDebugTextBuffer=t.createVertexBuffer(T,ld.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(M,Jb.members),this._tileDebugTextSegments=En.simpleSegment(0,0,P,32)}}class Ik{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,n,l){const h=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][h]=this.stateChanges[t][h]||{},Ce(this.stateChanges[t][h],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const m in this.state[t])m!==h&&(this.deletedStates[t][m]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][h]===null){this.deletedStates[t][h]={};for(const m in this.state[t][h])l[m]||(this.deletedStates[t][h][m]=null)}else for(const m in l)this.deletedStates[t]&&this.deletedStates[t][h]&&this.deletedStates[t][h][m]===null&&delete this.deletedStates[t][h][m]}removeFeatureState(t,n,l){if(this.deletedStates[t]===null)return;const h=String(n);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&n!==void 0)this.deletedStates[t][h]!==null&&(this.deletedStates[t][h]=this.deletedStates[t][h]||{},this.deletedStates[t][h][l]=null);else if(n!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][h])for(l in this.deletedStates[t][h]={},this.stateChanges[t][h])this.deletedStates[t][h][l]=null;else this.deletedStates[t][h]=null;else this.deletedStates[t]=null}getState(t,n){const l=String(n),h=Ce({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const m=this.deletedStates[t][n];if(m===null)return{};for(const _ in m)delete h[_]}return h}initializeTileState(t,n){t.setFeatureState(this.state,n)}coalesceChanges(t,n){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const _ in this.stateChanges[h])this.state[h][_]||(this.state[h][_]={}),Ce(this.state[h][_],this.stateChanges[h][_]),m[_]=this.state[h][_];l[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const _ in this.state[h])m[_]={},this.state[h][_]={};else for(const _ in this.deletedStates[h]){if(this.deletedStates[h][_]===null)this.state[h][_]={};else for(const v of Object.keys(this.deletedStates[h][_]))delete this.state[h][_][v];m[_]=this.state[h][_]}l[h]=l[h]||{},Ce(l[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in t)t[h].setFeatureState(l,n)}}class vw{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,n){const l=this.toIdx(t,n);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(t,n){return this.leaves[this.toIdx(t,n)]}toIdx(t,n){return n*this.size+t}}function xw(r,t,n,l){let h=0,m=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(l[_])<1e-15){if(n[_]<r[_]||n[_]>t[_])return null}else{const v=1/l[_];let T=(r[_]-n[_])*v,E=(t[_]-n[_])*v;if(T>E){const M=T;T=E,E=M}if(T>h&&(h=T),E<m&&(m=E),h>m)return null}return h}function bw(r,t,n,l,h,m,_,v,T,E,M){const P=l-r,z=h-t,F=m-n,B=_-r,G=v-t,Z=T-n,oe=M[1]*Z-M[2]*G,me=M[2]*B-M[0]*Z,le=M[0]*G-M[1]*B,fe=P*oe+z*me+F*le;if(Math.abs(fe)<1e-15)return null;const Se=1/fe,ye=E[0]-r,Ue=E[1]-t,Be=E[2]-n,Ze=(ye*oe+Ue*me+Be*le)*Se;if(Ze<0||Ze>1)return null;const mt=Ue*F-Be*z,$e=Be*P-ye*F,Qe=ye*z-Ue*P,st=(M[0]*mt+M[1]*$e+M[2]*Qe)*Se;return st<0||Ze+st>1?null:(B*mt+G*$e+Z*Qe)*Se}function ww(r,t,n){return(r-t)/(n-t)}function Tw(r,t,n,l,h,m,_,v,T){const E=1<<n,M=m-l,P=_-h,z=(r+1)/E*M+l,F=(t+0)/E*P+h,B=(t+1)/E*P+h;v[0]=(r+0)/E*M+l,v[1]=F,T[0]=z,T[1]=B}class Ew{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(m){const _=Math.ceil(Math.log2(m.dim/8)),v=[];let T=Math.ceil(Math.pow(2,_));const E=1/T,M=(F,B,G,Z,oe)=>{const me=Z?1:0,le=(F+1)*G-me,fe=B*G,Se=(B+1)*G-me;oe[0]=F*G,oe[1]=fe,oe[2]=le,oe[3]=Se};let P=new vw(T);const z=[];for(let F=0;F<T*T;F++){M(F%T,Math.floor(F/T),E,!1,z);const B=wa(z[0],z[1],m),G=wa(z[2],z[1],m),Z=wa(z[2],z[3],m),oe=wa(z[0],z[3],m);P.minimums.push(Math.min(B,G,Z,oe)),P.maximums.push(Math.max(B,G,Z,oe)),P.leaves.push(1)}for(v.push(P),T/=2;T>=1;T/=2){const F=v[v.length-1];P=new vw(T);for(let B=0;B<T*T;B++){M(B%T,Math.floor(B/T),2,!0,z);const G=F.getElevation(z[0],z[1]),Z=F.getElevation(z[2],z[1]),oe=F.getElevation(z[2],z[3]),me=F.getElevation(z[0],z[3]),le=F.isLeaf(z[0],z[1]),fe=F.isLeaf(z[2],z[1]),Se=F.isLeaf(z[2],z[3]),ye=F.isLeaf(z[0],z[3]),Ue=Math.min(G.min,Z.min,oe.min,me.min),Be=Math.max(G.max,Z.max,oe.max,me.max),Ze=le&&fe&&Se&&ye;P.maximums.push(Be),P.minimums.push(Ue),P.leaves.push(Be-Ue<=5&&Ze?1:0)}v.push(P)}return v}(this.dem),l=n.length-1,h=n[l];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(n,0,0,l,0)}raycastRoot(t,n,l,h,m,_,v=1){return xw([t,n,-100],[l,h,this.maximums[0]*v],m,_)}raycast(t,n,l,h,m,_,v=1){if(!this.nodeCount)return null;const T=this.raycastRoot(t,n,l,h,m,_,v);if(T==null)return null;const E=[],M=[],P=[],z=[],F=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;F.length>0;){const{idx:B,t:G,nodex:Z,nodey:oe,depth:me}=F.pop();if(this.leaves[B]){Tw(Z,oe,me,t,n,l,h,P,z);const fe=1<<me,Se=(Z+0)/fe,ye=(Z+1)/fe,Ue=(oe+0)/fe,Be=(oe+1)/fe,Ze=wa(Se,Ue,this.dem)*v,mt=wa(ye,Ue,this.dem)*v,$e=wa(ye,Be,this.dem)*v,Qe=wa(Se,Be,this.dem)*v,st=bw(P[0],P[1],Ze,z[0],P[1],mt,z[0],z[1],$e,m,_),Je=bw(z[0],z[1],$e,P[0],z[1],Qe,P[0],P[1],Ze,m,_),dt=Math.min(st!==null?st:Number.MAX_VALUE,Je!==null?Je:Number.MAX_VALUE);if(dt!==Number.MAX_VALUE)return dt;{const ot=Lp([],m,_,G);if(Sw(Ze,mt,Qe,$e,ww(ot[0],P[0],z[0]),ww(ot[1],P[1],z[1]))>=ot[2])return G}continue}let le=0;for(let fe=0;fe<this._siblingOffset.length;fe++){Tw((Z<<1)+this._siblingOffset[fe][0],(oe<<1)+this._siblingOffset[fe][1],me+1,t,n,l,h,P,z),P[2]=-100,z[2]=this.maximums[this.childOffsets[B]+fe]*v;const Se=xw(P,z,m,_);if(Se!=null){const ye=Se;E[fe]=ye;let Ue=!1;for(let Be=0;Be<le&&!Ue;Be++)ye>=E[M[Be]]&&(M.splice(Be,0,fe),Ue=!0);Ue||(M[le]=fe),le++}}for(let fe=0;fe<le;fe++){const Se=M[fe];F.push({idx:this.childOffsets[B]+Se,t:E[Se],nodex:(Z<<1)+this._siblingOffset[Se][0],nodey:(oe<<1)+this._siblingOffset[Se][1],depth:me+1})}}return null}_addNode(t,n,l){return this.minimums.push(t),this.maximums.push(n),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(t,n,l,h,m){if(t[h].isLeaf(n,l)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const _=h-1,v=t[_];let T=0,E=0;for(let M=0;M<this._siblingOffset.length;M++){const P=2*n+this._siblingOffset[M][0],z=2*l+this._siblingOffset[M][1],F=v.getElevation(P,z),B=v.isLeaf(P,z),G=this._addNode(F.min,F.max,B);B&&(T|=1<<M),E||(E=G)}for(let M=0;M<this._siblingOffset.length;M++)T&1<<M||this._construct(t,2*n+this._siblingOffset[M][0],2*l+this._siblingOffset[M][1],_,E+M)}}function Sw(r,t,n,l,h,m){return Ti(Ti(r,n,m),Ti(t,l,m),h)}function wa(r,t,n){const l=n.dim,h=ie(r*l-.5,0,l-1),m=ie(t*l-.5,0,l-1),_=Math.floor(h),v=Math.floor(m),T=Math.min(_+1,l-1),E=Math.min(v+1,l-1);return Sw(n.get(_,v),n.get(T,v),n.get(_,E),n.get(T,E),h-_,m-v)}const Aw={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class om{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,n,l,h=!1,m=!1){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return yi(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const _=this.dim=n.height-2,v=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=l||"mapbox",this.borderReady=h,!h){for(let T=0;T<_;T++)v[this._idx(-1,T)]=v[this._idx(0,T)],v[this._idx(_,T)]=v[this._idx(_-1,T)],v[this._idx(T,-1)]=v[this._idx(T,0)],v[this._idx(T,_)]=v[this._idx(T,_-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(_,-1)]=v[this._idx(_-1,0)],v[this._idx(-1,_)]=v[this._idx(0,_-1)],v[this._idx(_,_)]=v[this._idx(_-1,_-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Ew(this)}get(t,n,l=!1){l&&(t=ie(t,-1,this.dim),n=ie(n,-1,this.dim));const h=4*this._idx(t,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(t){return Aw[t]}get unpackVector(){return Aw[this.encoding]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}_unpackMapbox(t,n,l){return(256*t*256+256*n+l)/10-1e4}_unpackTerrarium(t,n,l){return 256*t+n+l/256-32768}static pack(t,n){const l=[0,0,0,0],h=om.getUnpackVector(n);let m=Math.floor((t+h[3])/h[2]);return l[2]=m%256,m=Math.floor(m/256),l[1]=m%256,m=Math.floor(m/256),l[0]=m,l}getPixels(){return new Dr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,n,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,m=n*this.dim+this.dim,_=l*this.dim,v=l*this.dim+this.dim;switch(n){case-1:h=m-1;break;case 1:m=h+1}switch(l){case-1:_=v-1;break;case 1:v=_+1}const T=-n*this.dim,E=-l*this.dim;for(let M=_;M<v;M++)for(let P=h;P<m;P++){const z=4*this._idx(P,M),F=4*this._idx(P+T,M+E);this.pixels[z+0]=t.pixels[F+0],this.pixels[z+1]=t.pixels[F+1],this.pixels[z+2]=t.pixels[F+2],this.pixels[z+3]=t.pixels[F+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ct(om,"DEMData"),Ct(Ew,"DemMinMaxQuadTree",{omit:["dem"]});class Pk{constructor(t,n){this.max=t,this.onRemove=n,this.reset()}reset(){for(const t in this.data)for(const n of this.data[t])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(t,n,l){const h=t.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:n,timeout:void 0};if(l!==void 0&&(m.timeout=setTimeout(()=>{this.remove(t,m)},l)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const n=this.data[t].shift();return n.timeout&&clearTimeout(n.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),n.value}getByKey(t){const n=this.data[t];return n?n[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,n){if(!this.has(t))return this;const l=t.wrapped().key,h=n===void 0?0:this.data[l].indexOf(n),m=this.data[l][h];return this.data[l].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(m.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(t){const n=[];for(const l in this.data)for(const h of this.data[l])t(h.value)||n.push(h);for(const l of n)this.remove(l.value.tileID,l)}}class nu{constructor(t,n,l){this.func=t,this.mask=n,this.range=l}}nu.ReadOnly=!1,nu.ReadWrite=!0,nu.disabled=new nu(519,nu.ReadOnly,[0,1]);const Ey=7680;class Sy{constructor(t,n,l,h,m,_){this.test=t,this.ref=n,this.mask=l,this.fail=h,this.depthFail=m,this.pass=_}}Sy.disabled=new Sy({func:519,mask:0},0,0,Ey,Ey,Ey);class ho{constructor(t,n,l){this.blendFunction=t,this.blendColor=n,this.mask=l}}ho.Replace=[1,0],ho.disabled=new ho(ho.Replace,Fi.transparent,[!1,!1,!1,!1]),ho.unblended=new ho(ho.Replace,Fi.transparent,[!0,!0,!0,!0]),ho.alphaBlended=new ho([1,771],Fi.transparent,[!0,!0,!0,!0]);const Ay=1029,Cy=2305;class Ns{constructor(t,n,l){this.enable=t,this.mode=n,this.frontFace=l}}Ns.disabled=new Ns(!1,Ay,Cy),Ns.backCCW=new Ns(!0,Ay,Cy),Ns.backCW=new Ns(!0,Ay,2304),Ns.frontCW=new Ns(!0,1028,2304),Ns.frontCCW=new Ns(!0,1028,Cy);class Ll extends kt{constructor(t,n,l){super(),this.id=t,this._onlySymbols=l,n.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new Pk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ik,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const n=this._tiles[t];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,n){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,n)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const n in this._tiles){const l=this._tiles[n];this._source.prepareTile(l)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,l.tileID),l.upload(t),l.prepare(this.map.style.imageManager)}else for(const n in this._tiles){const l=this._tiles[n];l.upload(t),l.prepare(this.map.style.imageManager)}}getIds(){return He(this._tiles).map(t=>t.tileID).sort(Cw).map(t=>t.key)}getRenderableIds(t){const n=[];for(const l in this._tiles)this._isIdRenderable(+l,t)&&n.push(this._tiles[l]);return t?n.sort((l,h)=>{const m=l.tileID,_=h.tileID,v=new k(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),T=new k(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-_.overscaledZ||T.y-v.y||T.x-v.x}).map(l=>l.tileID.key):n.map(l=>l.tileID).sort(Cw).map(l=>l.key)}hasRenderableParent(t){const n=this.findLoadedParent(t,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(t,n){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(n||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,n){const l=this._tiles[t];l&&(l.state!=="loading"&&(l.state=n),this._loadTile(l,this._tileLoaded.bind(this,l,t,n)))}_tileLoaded(t,n,l,h){if(h)if(t.state="errored",h.status!==404)this._source.fire(new Jt(h,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=gt.now(),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new ti("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const n=this.getRenderableIds();for(let h=0;h<n.length;h++){const m=n[h];if(t.neighboringTiles&&t.neighboringTiles[m]){const _=this.getTileByID(m);l(t,_),l(_,t)}}function l(h,m){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let _=m.tileID.canonical.x-h.tileID.canonical.x;const v=m.tileID.canonical.y-h.tileID.canonical.y,T=Math.pow(2,h.tileID.canonical.z),E=m.tileID.key;_===0&&v===0||Math.abs(v)>1||(Math.abs(_)>1&&(Math.abs(_+T)===1?_+=T:Math.abs(_-T)===1&&(_-=T)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,_,v),h.neighboringTiles&&h.neighboringTiles[E]&&(h.neighboringTiles[E].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,n,l,h){for(const m in this._tiles){let _=this._tiles[m];if(h[m]||!_.hasData()||_.tileID.overscaledZ<=n||_.tileID.overscaledZ>l)continue;let v=_.tileID;for(;_&&_.tileID.overscaledZ>n+1;){const E=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[E.key],_&&_.hasData()&&(v=E)}let T=v;for(;T.overscaledZ>n;)if(T=T.scaledTo(T.overscaledZ-1),t[T.key]){h[v.key]=v;break}}}findLoadedParent(t,n){if(t.key in this._loadedParentTiles){const l=this._loadedParentTiles[t.key];return l&&l.tileID.overscaledZ>=n?l:null}for(let l=t.overscaledZ-1;l>=n;l--){const h=t.scaledTo(l),m=this._getLoadedTile(h);if(m)return m}}_getLoadedTile(t){const n=this._tiles[t.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,n){n=n||this._source.tileSize;const l=Math.ceil(t.width/n)+1,h=Math.ceil(t.height/n)+1,m=Math.floor(l*h*5),_=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,m):m,v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(v)}handleWrapJump(t){const n=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,n){const l={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+n),l[m.tileID.key]=m}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(t,n,l){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let h;this.updateCacheSize(t,n),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new pr(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(h=t.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(v=>this._source.hasTile(v)))):h=[];const m=this._updateRetainedTiles(h);if(Mw(this._source.type)&&h.length!==0){const v={},T={},E=Object.keys(m);for(const P of E){const z=m[P],F=this._tiles[P];if(!F||F.fadeEndTime&&F.fadeEndTime<=gt.now())continue;const B=this.findLoadedParent(z,Math.max(z.overscaledZ-Ll.maxOverzooming,this._source.minzoom));B&&(this._addTile(B.tileID),v[B.tileID.key]=B.tileID),T[P]=z}const M=h[h.length-1].overscaledZ;for(const P in this._tiles){const z=this._tiles[P];if(m[P]||!z.hasData())continue;let F=z.tileID;for(;F.overscaledZ>M;){F=F.scaledTo(F.overscaledZ-1);const B=this._tiles[F.key];if(B&&B.hasData()&&T[F.key]){m[P]=z.tileID;break}}}for(const P in v)m[P]||(this._coveredTiles[P]=!0,m[P]=v[P])}for(const v in m)this._tiles[v].clearFadeHold();const _=function(v,T){const E=[];for(const M in v)M in T||E.push(M);return E}(this._tiles,m);for(const v of _){const T=this._tiles[v];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const n={};if(t.length===0)return n;const l={},h=t.reduce((E,M)=>Math.min(E,M.overscaledZ),1/0),m=t[0].overscaledZ,_=Math.max(m-Ll.maxOverzooming,this._source.minzoom),v=Math.max(m+Ll.maxUnderzooming,this._source.minzoom),T={};for(const E of t){const M=this._addTile(E);n[E.key]=E,M.hasData()||h<this._source.maxzoom&&(T[E.key]=E)}this._retainLoadedChildren(T,h,v,n);for(const E of t){let M=this._tiles[E.key];if(M.hasData())continue;if(E.canonical.z>=this._source.maxzoom){const z=E.children(this._source.maxzoom)[0],F=this.getTile(z);if(F&&F.hasData()){n[z.key]=z;continue}}else{const z=E.children(this._source.maxzoom);if(n[z[0].key]&&n[z[1].key]&&n[z[2].key]&&n[z[3].key])continue}let P=M.wasRequested();for(let z=E.overscaledZ-1;z>=_;--z){const F=E.scaledTo(z);if(l[F.key]||(l[F.key]=!0,M=this.getTile(F),!M&&P&&(M=this._addTile(F)),M&&(n[F.key]=F,P=M.wasRequested(),M.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const n=[];let l,h=this._tiles[t].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}n.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(m),l)break;h=m}for(const m of n)this._loadedParentTiles[m]=l}}_addTile(t){let n=this._tiles[t.key];if(n)return this._source.prepareTile&&this._source.prepareTile(n),n;n=this._cache.getAndRemove(t),n&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));const l=Boolean(n);if(!l){const h=this.map?this.map.painter:null;n=new Ty(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._source.prepareTile&&this._source.prepareTile(n)||this._loadTile(n,this._tileLoaded.bind(this,n,t.key,n.state))}return n?(n.uses++,this._tiles[t.key]=n,l||this._source.fire(new ti("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(t,n){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const l=n.getExpiryTimeout();l&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},l))}_removeTile(t){const n=this._tiles[t];n&&(n.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,n,l){const h=[],m=this.transform;if(!m)return h;const _=m.projection.name==="globe",v=ro(m.center.lng);for(const T in this._tiles){const E=this._tiles[T];if(l&&E.clearQueryDebugViz(),E.holdingForFade())continue;let M;if(_){const P=E.tileID.canonical;if(P.z===0){const z=[Math.abs(ie(v,..._d(P,-1))-v),Math.abs(ie(v,..._d(P,1))-v)];M=[0,2*z.indexOf(Math.min(...z))-1]}else{const z=[Math.abs(ie(v,..._d(P,-1))-v),Math.abs(ie(v,..._d(P,0))-v),Math.abs(ie(v,..._d(P,1))-v)];M=[z.indexOf(Math.min(...z))-1]}}else M=[0];for(const P of M){const z=t.containsTile(E,m,n,P);z&&h.push(z)}}return h}getVisibleCoordinates(t){const n=this.getRenderableIds(t).map(l=>this._tiles[l].tileID);for(const l of n)l.projMatrix=this.transform.calculateProjMatrix(l.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(Mw(this._source.type))for(const t in this._tiles){const n=this._tiles[t];if(n.fadeEndTime!==void 0&&n.fadeEndTime>=gt.now())return!0}return!1}setFeatureState(t,n,l){this._state.updateState(t=t||"_geojsonTileLayer",n,l)}removeFeatureState(t,n,l){this._state.removeFeatureState(t=t||"_geojsonTileLayer",n,l)}getFeatureState(t,n){return this._state.getState(t=t||"_geojsonTileLayer",n)}setDependencies(t,n,l){const h=this._tiles[t];h&&h.setDependencies(n,l)}reloadTilesForDependencies(t,n){for(const l in this._tiles)this._tiles[l].hasDependency(t,n)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(t,n))}_preloadTiles(t,n){const l=new Map,h=Array.isArray(t)?t:[t],m=this.map.painter.terrain,_=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const v of h){const T=v.coveringTiles({tileSize:_,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const E of T)l.set(E.key,E);this.usedForTerrain&&v.updateElevation(!1)}Ae(Array.from(l.values()),(v,T)=>{const E=new Ty(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(E,M=>{this._source.type==="raster-dem"&&E.dem&&this._backfillDEM(E),T(M,E)})},n)}}function Cw(r,t){const n=Math.abs(2*r.wrap)-+(r.wrap<0),l=Math.abs(2*t.wrap)-+(t.wrap<0);return r.overscaledZ-t.overscaledZ||l-n||t.canonical.y-r.canonical.y||t.canonical.x-r.canonical.x}function Mw(r){return r==="raster"||r==="image"||r==="video"}function _d(r,t){const n=1<<r.z;return[r.x/n+t,(r.x+1)/n+t]}Ll.maxOverzooming=10,Ll.maxUnderzooming=3;class am{constructor(t,n,l){this._demTile=t,this._dem=this._demTile.dem,this._scale=n,this._offset=l}static create(t,n,l){const h=l||t.findDEMTileFor(n);if(!h||!h.dem)return;const m=h.dem,_=h.tileID,v=1<<n.canonical.z-_.canonical.z;return new am(h,h.tileSize/Wt/v,[(n.canonical.x/v-_.canonical.x)*m.dim,(n.canonical.y/v-_.canonical.y)*m.dim])}tileCoordToPixel(t,n){const l=n*this._scale+this._offset[1],h=Math.floor(t*this._scale+this._offset[0]),m=Math.floor(l);return new k(h,m)}getElevationAt(t,n,l,h){const m=t*this._scale+this._offset[0],_=n*this._scale+this._offset[1],v=Math.floor(m),T=Math.floor(_),E=this._dem;return h=!!h,l?Ti(Ti(E.get(v,T,h),E.get(v,T+1,h),_-T),Ti(E.get(v+1,T,h),E.get(v+1,T+1,h),_-T),m-v):E.get(v,T,h)}getElevationAtPixel(t,n,l){return this._dem.get(t,n,!!l)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*_s(1,t)*this._dem.stride}}class Iw{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ha(Wt,16,0),this.featureIndexArray=new y1,this.promoteId=n}insert(t,n,l,h,m,_=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,m,_);const T=this.grid;for(let E=0;E<n.length;E++){const M=n[E],P=[1/0,1/0,-1/0,-1/0];for(let z=0;z<M.length;z++){const F=M[z];P[0]=Math.min(P[0],F.x),P[1]=Math.min(P[1],F.y),P[2]=Math.max(P[2],F.x),P[3]=Math.max(P[3],F.y)}P[0]<Wt&&P[1]<Wt&&P[2]>=0&&P[3]>=0&&T.insert(v,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Pl.VectorTile(new sd(this.rawTileData)).layers,this.sourceLayerCoder=new pw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,n,l,h){this.loadVTLayers();const m=t.params||{},_=ml(m.filter),v=t.tileResult,T=t.transform,E=v.bufferedTilespaceBounds,M=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(B,G,Z,oe)=>F1(v.bufferedTilespaceGeometry,B,G,Z,oe));M.sort(kk);let P=null;T.elevation&&M.length>0&&(P=am.create(T.elevation,this.tileID));const z={};let F;for(let B=0;B<M.length;B++){const G=M[B];if(G===F)continue;F=G;const Z=this.featureIndexArray.get(G);let oe=null;this.loadMatchingFeature(z,Z,_,m.layers,m.availableImages,n,l,h,(me,le,fe,Se=0)=>(oe||(oe=Oo(me,this.tileID.canonical,t.tileTransform)),le.queryIntersectsFeature(v,me,fe,oe,this.z,t.transform,t.pixelPosMatrix,P,Se)))}return z}loadMatchingFeature(t,n,l,h,m,_,v,T,E){const{featureIndex:M,bucketIndex:P,sourceLayerIndex:z,layoutVertexArrayOffset:F}=n,B=this.bucketLayerIDs[P];if(h&&!function(me,le){for(let fe=0;fe<me.length;fe++)if(le.indexOf(me[fe])>=0)return!0;return!1}(h,B))return;const G=this.sourceLayerCoder.decode(z),Z=this.vtLayers[G].feature(M);if(l.needGeometry){const me=Sl(Z,!0);if(!l.filter(new Y(this.tileID.overscaledZ),me,this.tileID.canonical))return}else if(!l.filter(new Y(this.tileID.overscaledZ),Z))return;const oe=this.getId(Z,G);for(let me=0;me<B.length;me++){const le=B[me];if(h&&h.indexOf(le)<0)continue;const fe=_[le];if(!fe)continue;let Se={};oe!==void 0&&T&&(Se=T.getState(fe.sourceLayer||"_geojsonTileLayer",oe));const ye=Ce({},v[le]);ye.paint=Pw(ye.paint,fe.paint,Z,Se,m),ye.layout=Pw(ye.layout,fe.layout,Z,Se,m);const Ue=!E||E(Z,fe,Se,F);if(!Ue)continue;const Be=new mw(Z,this.z,this.x,this.y,oe);Be.layer=ye;let Ze=t[le];Ze===void 0&&(Ze=t[le]=[]),Ze.push({featureIndex:M,feature:Be,intersectionZ:Ue})}}lookupSymbolFeatures(t,n,l,h,m,_,v,T){const E={};this.loadVTLayers();const M=ml(m);for(const P of t)this.loadMatchingFeature(E,{bucketIndex:l,sourceLayerIndex:h,featureIndex:P,layoutVertexArrayOffset:0},M,_,v,T,n);return E}loadFeature(t){const{featureIndex:n,sourceLayerIndex:l}=t;this.loadVTLayers();const h=this.sourceLayerCoder.decode(l),m=this.vtFeatures[h];if(m[n])return m[n];const _=this.vtLayers[h].feature(n);return m[n]=_,_}hasLayer(t){for(const n of this.bucketLayerIDs)for(const l of n)if(t===l)return!0;return!1}getId(t,n){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof l=="boolean"&&(l=Number(l))),l}}function Pw(r,t,n,l,h){return Yt(r,(m,_)=>{const v=t instanceof we?t.get(_):null;return v&&v.evaluate?v.evaluate(n,l,h):v})}function kk(r,t){return t-r}Ct(Iw,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class kw{constructor(t){const n={},l=[];for(const v in t){const T=t[v],E=n[v]={};for(const M in T.glyphs){const P=T.glyphs[+M];if(!P||P.bitmap.width===0||P.bitmap.height===0)continue;const z=P.metrics.localGlyph?2:1,F={x:0,y:0,w:P.bitmap.width+2*z,h:P.bitmap.height+2*z};l.push(F),E[M]=F}}const{w:h,h:m}=sy(l),_=new Fo({width:h||1,height:m||1});for(const v in t){const T=t[v];for(const E in T.glyphs){const M=T.glyphs[+E];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const P=n[v][E],z=M.metrics.localGlyph?2:1;Fo.copy(M.bitmap,_,{x:0,y:0},{x:P.x+z,y:P.y+z},M.bitmap)}}this.image=_,this.positions=n}}Ct(kw,"GlyphAtlas");class Lk{constructor(t){this.tileID=new pr(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=kl(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,n,l,h,m){this.status="parsing",this.data=t,this.collisionBoxArray=new no;const _=new pw(Object.keys(t.layers).sort()),v=new Iw(this.tileID,this.promoteId);v.bucketLayerIDs=[];const T={},E=new wy(256,256),M={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:E,availableImages:l},P=n.familiesBySource[this.source];for(const Se in P){const ye=t.layers[Se];if(!ye)continue;let Ue=!1,Be=!1;for(const $e of P[Se])$e[0].type==="symbol"?Ue=!0:Be=!0;if(this.isSymbolTile===!0&&!Ue||this.isSymbolTile===!1&&!Be)continue;ye.version===1&&yi(`Vector tile source "${this.source}" layer "${Se}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ze=_.encode(Se),mt=[];for(let $e=0;$e<ye.length;$e++){const Qe=ye.feature($e),st=v.getId(Qe,Se);mt.push({feature:Qe,id:st,index:$e,sourceLayerIndex:Ze})}for(const $e of P[Se]){const Qe=$e[0];this.isSymbolTile!==void 0&&Qe.type==="symbol"!==this.isSymbolTile||Qe.minzoom&&this.zoom<Math.floor(Qe.minzoom)||Qe.maxzoom&&this.zoom>=Qe.maxzoom||Qe.visibility!=="none"&&(My($e,this.zoom,l),(T[Qe.id]=Qe.createBucket({index:v.bucketLayerIDs.length,layers:$e,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ze,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:l})).populate(mt,M,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push($e.map(st=>st.id)))}}let z,F,B,G;E.trim();const Z={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},oe=Yt(M.glyphDependencies,Se=>Object.keys(Se).map(Number));Object.keys(oe).length?h.send("getGlyphs",{uid:this.uid,stacks:oe},(Se,ye)=>{z||(z=Se,F=ye,fe.call(this))},void 0,!1,Z):F={};const me=Object.keys(M.iconDependencies);me.length?h.send("getImages",{icons:me,source:this.source,tileID:this.tileID,type:"icons"},(Se,ye)=>{z||(z=Se,B=ye,fe.call(this))},void 0,!1,Z):B={};const le=Object.keys(M.patternDependencies);function fe(){if(z)return m(z);if(F&&B&&G){const Se=new kw(F),ye=new Lb(B,G);for(const Ue in T){const Be=T[Ue];Be instanceof va?(My(Be.layers,this.zoom,l),ek(Be,F,Se.positions,B,ye.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection)):Be.hasPattern&&(Be instanceof $p||Be instanceof Bp||Be instanceof td)&&(My(Be.layers,this.zoom,l),Be.addFeatures(M,this.tileID.canonical,ye.patternPositions,l,this.tileTransform))}this.status="done",m(null,{buckets:He(T).filter(Ue=>!Ue.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Se.image,lineAtlas:E,imageAtlas:ye,glyphMap:this.returnDependencies?F:null,iconMap:this.returnDependencies?B:null,glyphPositions:this.returnDependencies?Se.positions:null})}}le.length?h.send("getImages",{icons:le,source:this.source,tileID:this.tileID,type:"patterns"},(Se,ye)=>{z||(z=Se,G=ye,fe.call(this))},void 0,!1,Z):G={},fe.call(this)}}function My(r,t,n){const l=new Y(t);for(const h of r)h.recalculate(l,n)}class Lw{constructor(t){this.entries={},this.scheduler=t}request(t,n,l,h){const m=this.entries[t]=this.entries[t]||{callbacks:[]};if(m.result){const[_,v]=m.result;return this.scheduler?this.scheduler.add(()=>{h(_,v)},n):h(_,v),()=>{}}return m.callbacks.push(h),m.cancel||(m.cancel=l((_,v)=>{m.result=[_,v];for(const T of m.callbacks)this.scheduler?this.scheduler.add(()=>{T(_,v)},n):T(_,v);setTimeout(()=>delete this.entries[t],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(_=>_!==h),m.callbacks.length||(m.cancel(),delete this.entries[t]))}}}function zw(r,t,n){const l=JSON.stringify(r.request);return r.data&&(this.deduped.entries[l]={result:[null,r.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},h=>{const m=Re(r.request,(_,v,T,E)=>{_?h(_):v&&h(null,{vectorTile:n?void 0:new Pl.VectorTile(new sd(v)),rawData:v,cacheControl:T,expires:E})});return()=>{m.cancel(),h()}},t)}s.ARRAY_TYPE=Rr,s.AUTH_ERR_MSG=oi,s.Aabb=Sr,s.Actor=class{constructor(r,t,n){this.target=r,this.parent=t,this.mapId=n,this.callbacks={},this.cancelCallbacks={},Vt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=gn()?r:w,this.scheduler=new Ck}send(r,t,n,l,h=!1,m){const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=m,this.callbacks[_]=n);const v=Pt(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:r,hasCallback:!!n,targetMapId:l,mustQueue:h,sourceMapId:this.mapId,data:da(t,v)},v),{cancel:()=>{n&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:l,sourceMapId:this.mapId})}}}receive(r){const t=r.data,n=t.id;if(n&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){const l=this.cancelCallbacks[n];delete this.cancelCallbacks[n],l&&l.cancel()}else if(t.mustQueue||gn()){const l=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,t),l&&l.metadata||{type:"message"})}else this.processTask(n,t)}processTask(r,t){if(t.type==="<response>"){const n=this.callbacks[r];delete this.callbacks[r],n&&(t.error?n(yl(t.error)):n(null,yl(t.data)))}else{const n=Pt(this.globalScope)?void 0:[],l=t.hasCallback?(m,_)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:m?da(m):null,data:da(_,n)},n)}:m=>{},h=yl(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,h,l);else if(this.parent.getWorkerSource){const m=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,m[0],h.source)[m[1]](h,l)}else l(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Up,s.Color=Fi,s.ColorMode=ho,s.CullFaceMode=Ns,s.DEMData=om,s.DataConstantProperty=ve,s.DedupedRequest=Lw,s.DepthMode=nu,s.EXTENT=Wt,s.Elevation=class{isDataAvailableAtPoint(r){const t=this._source();if(!t||r.y<0||r.y>1)return!1;const n=t.getSource().maxzoom,l=1<<n,h=Math.floor(r.x),m=Math.floor((r.x-h)*l),_=Math.floor(r.y*l),v=this.findDEMTileFor(new pr(n,h,n,m,_));return!(!v||!v.dem)}getAtPointOrZero(r,t=0){return this.getAtPoint(r,t)||0}getAtPoint(r,t,n=!0){t==null&&(t=null);const l=this._source();if(!l||r.y<0||r.y>1)return t;const h=l.getSource().maxzoom,m=1<<h,_=Math.floor(r.x),v=r.x-_,T=new pr(h,_,h,Math.floor(v*m),Math.floor(r.y*m)),E=this.findDEMTileFor(T);if(!E||!E.dem)return t;const M=E.dem,P=1<<E.tileID.canonical.z,z=(v*P-E.tileID.canonical.x)*M.dim,F=(r.y*P-E.tileID.canonical.y)*M.dim,B=Math.floor(z),G=Math.floor(F);return(n?this.exaggeration():1)*Ti(Ti(M.get(B,G),M.get(B,G+1),F-G),Ti(M.get(B+1,G),M.get(B+1,G+1),F-G),z-B)}getAtTileOffset(r,t,n){const l=1<<r.canonical.z;return this.getAtPointOrZero(new $c(r.wrap+(r.canonical.x+t/Wt)/l,(r.canonical.y+n/Wt)/l))}getAtTileOffsetFunc(r,t,n,l){return h=>{const m=this.getAtTileOffset(r,h.x,h.y),_=l.upVector(r.canonical,h.x,h.y);return Ds(_,_,m*l.upVectorScale(r.canonical,t,n).metersToTile),_}}getForTilePoints(r,t,n,l){const h=am.create(this,r,l);return!!h&&(t.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],n)}),!0)}getMinMaxForTile(r){const t=this.findDEMTileFor(r);if(!t||!t.dem)return null;const n=t.dem.tree,l=t.tileID,h=1<<r.canonical.z-l.canonical.z;let m=r.canonical.x/h-l.canonical.x,_=r.canonical.y/h-l.canonical.y,v=0;for(let T=0;T<r.canonical.z-l.canonical.z&&!n.leaves[v];T++){m*=2,_*=2;const E=2*Math.floor(_)+Math.floor(m);v=n.childOffsets[v]+E,m%=1,_%=1}return{min:this.exaggeration()*n.minimums[v],max:this.exaggeration()*n.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,t,n){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Jt,s.EvaluationParameters=Y,s.Event=ti,s.Evented=kt,s.FillExtrusionBucket=td,s.Frustum=Z_,s.FrustumCorners=H_,s.GLOBE_METERS_TO_ECEF=py,s.GLOBE_RADIUS=Uo,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_createGrid(r){const t=new vt,n=new ai,l=65;for(let h=0;h<l;h++)for(let m=0;m<l;m++)t.emplaceBack(m,h);this._gridSegments=[];for(let h=0,m=0;h<eu.length;h++){const _=eu[h];for(let T=0;T<_;T++)for(let E=0;E<64;E++){const M=T*l+E;n.emplaceBack(M+1,M,M+l),n.emplaceBack(M+l,M+l+1,M+1)}const v=64*_*2;this._gridSegments.push(En.simpleSegment(0,m,(_+1)*l,v)),m+=v}this._gridBuffer=r.createVertexBuffer(t,ld.members),this._gridIndexBuffer=r.createIndexBuffer(n,!0)}_createPoles(r){const t=new ai;for(let h=0;h<=64;h++)t.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=r.createIndexBuffer(t,!0);const n=new Zn,l=new Zn;this._poleSegments=[];for(let h=0,m=0;h<5;h++){const _=360/(1<<h);n.emplaceBack(0,-Uo,0,.5,0),l.emplaceBack(0,-Uo,0,.5,1);for(let v=0;v<=64;v++){const T=v/64,E=Ti(0,_,T),[M,P,z]=tu(ak,lk,E,Uo);n.emplaceBack(M,P,z,T,0),l.emplaceBack(M,P,z,T,1)}this._poleSegments.push(En.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(n,Qb,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(l,Qb,!1)}getGridBuffers(r){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[r]]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,t){if(!this._wireframeSegments){const n=new nr,l=64,h=l+1;this._wireframeSegments=[];for(let m=0,_=0;m<eu.length;m++){const v=eu[m];for(let E=0;E<v;E++)for(let M=0;M<l;M++){const P=E*h+M;n.emplaceBack(P,P+1),n.emplaceBack(P,P+h),n.emplaceBack(P,P+h+1)}const T=v*l*3;this._wireframeSegments.push(En.simpleSegment(0,_,(v+1)*h,T)),_+=T}this._wireframeIndexBuffer=r.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},s.GlyphManager=Qc,s.ImagePosition=oy,s.LineAtlas=wy,s.LngLat=zi,s.LngLatBounds=ma,s.LocalGlyphMode=uy,s.MAX_MERCATOR_LATITUDE=so,s.MercatorCoordinate=$c,s.ONE_EM=Kn,s.OverscaledTileID=pr,s.Properties=Xe,s.RGBAImage=Dr,s.Ray=W_,s.RequestManager=class{constructor(r,t,n){this._transformRequestFn=r,this._customAccessToken=t,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const r=function(){let t="";for(let n=0;n<10;n++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ci,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,t){return this._transformRequestFn&&this._transformRequestFn(r,t)||{url:r}}normalizeStyleURL(r,t){if(!ui(r))return r;const n=Zi(r);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||t)}normalizeGlyphsURL(r,t){if(!ui(r))return r;const n=Zi(r);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||t)}normalizeSourceURL(r,t,n,l){if(!ui(r))return r;const h=Zi(r);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),n&&h.params.push(`language=${n}`),l&&h.params.push(`worldview=${l}`),this._makeAPIURL(h,this._customAccessToken||t)}normalizeSpriteURL(r,t,n,l){const h=Zi(r);return ui(r)?(h.path=`/styles/v1${h.path}/sprite${t}${n}`,this._makeAPIURL(h,this._customAccessToken||l)):(h.path+=`${t}${n}`,Gn(h))}normalizeTileURL(r,t,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!ui(r))return r;const l=Zi(r);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||n&&l.authority!=="raster"&&n===512?"@2x":""}${xt.supported?".webp":"$1"}`),l.authority==="raster"?l.path=`/${tt.RASTER_URL_PREFIX}${l.path}`:(l.path=l.path.replace(/^.+\/v4\//,"/"),l.path=`/${tt.TILE_URL_VERSION}${l.path}`);const h=this._customAccessToken||function(m){for(const _ of m){const v=_.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(l.params)||tt.ACCESS_TOKEN;return tt.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&l.params.push(`sku=${this._skuToken}`),this._makeAPIURL(l,h)}canonicalizeTileURL(r,t){const n=Zi(r);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return r;let l="mapbox://";n.path.match(/^\/raster\/v1\//)?l+=`raster/${n.path.replace(`/${tt.RASTER_URL_PREFIX}/`,"")}`:l+=`tiles/${n.path.replace(`/${tt.TILE_URL_VERSION}/`,"")}`;let h=n.params;return t&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(l+=`?${h.join("&")}`),l}canonicalizeTileset(r,t){const n=!!t&&ui(t),l=[];for(const h of r.tiles||[])bi(h)?l.push(this.canonicalizeTileURL(h,n)):l.push(h);return l}_makeAPIURL(r,t){const n="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",l=Zi(tt.API_URL);if(r.protocol=l.protocol,r.authority=l.authority,r.protocol==="http"){const h=r.params.indexOf("secure");h>=0&&r.params.splice(h,1)}if(l.path!=="/"&&(r.path=`${l.path}${r.path}`),!tt.REQUIRE_ACCESS_TOKEN)return Gn(r);if(t=t||tt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return r.params=r.params.filter(h=>h.indexOf("access_token")===-1),r.params.push(`access_token=${t||""}`),Gn(r)}},s.ResourceType=Te,s.SegmentVector=En,s.SourceCache=Ll,s.StencilMode=Sy,s.StructArrayLayout1ui2=Io,s.StructArrayLayout2f1f2i16=Ls,s.StructArrayLayout2i4=vt,s.StructArrayLayout2ui4=nr,s.StructArrayLayout3f12=rn,s.StructArrayLayout3ui6=ai,s.StructArrayLayout4i8=Ut,s.StructArrayLayout5f20=Zn,s.Texture=gd,s.Tile=Ty,s.Transitionable=ae,s.Uniform1f=Sp,s.Uniform1i=class extends zo{constructor(r){super(r),this.current=0}set(r,t,n){this.fetchUniformLocation(r,t)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},s.Uniform2f=class extends zo{constructor(r){super(r),this.current=[0,0]}set(r,t,n){this.fetchUniformLocation(r,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},s.Uniform3f=class extends zo{constructor(r){super(r),this.current=[0,0,0]}set(r,t,n){this.fetchUniformLocation(r,t)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},s.Uniform4f=S1,s.UniformColor=A1,s.UniformMatrix2f=class extends zo{constructor(r){super(r),this.current=mI}set(r,t,n){if(this.fetchUniformLocation(r,t)){for(let l=0;l<4;l++)if(n[l]!==this.current[l]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}}},s.UniformMatrix3f=class extends zo{constructor(r){super(r),this.current=pI}set(r,t,n){if(this.fetchUniformLocation(r,t)){for(let l=0;l<9;l++)if(n[l]!==this.current[l]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}}},s.UniformMatrix4f=class extends zo{constructor(r){super(r),this.current=fI}set(r,t,n){if(this.fetchUniformLocation(r,t)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let l=1;l<16;l++)if(n[l]!==this.current[l]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},s.UnwrappedTileID=vb,s.ValidationError=St,s.VectorTileWorkerSource=class extends kt{constructor(r,t,n,l,h){super(),this.actor=r,this.layerIndex=t,this.availableImages=n,this.loadVectorData=h||zw,this.loading={},this.loaded={},this.deduped=new Lw(r.scheduler),this.isSpriteLoaded=l,this.scheduler=r.scheduler}loadTile(r,t){const n=r.uid,l=r&&r.request,h=l&&l.collectResourceTiming,m=this.loading[n]=new Lk(r);m.abort=this.loadVectorData(r,(_,v)=>{const T=!this.loading[n];if(delete this.loading[n],T||_||!v)return m.status="done",T||(this.loaded[n]=m),t(_);const E=v.rawData,M={};v.expires&&(M.expires=v.expires),v.cacheControl&&(M.cacheControl=v.cacheControl),m.vectorTile=v.vectorTile||new Pl.VectorTile(new sd(E));const P=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(z,F)=>{if(z||!F)return t(z);const B={};if(h){const G=Ai(l);G.length>0&&(B.resourceTiming=JSON.parse(JSON.stringify(G)))}t(null,Ce({rawTileData:E.slice(0)},F,M,B))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[n]=m})}reloadTile(r,t){const n=this.loaded,l=r.uid,h=this;if(n&&n[l]){const m=n[l];m.showCollisionBoxes=r.showCollisionBoxes,m.enableTerrain=!!r.enableTerrain,m.projection=r.projection,m.tileTransform=kl(r.tileID.canonical,r.projection);const _=(v,T)=>{const E=m.reloadCallback;E&&(delete m.reloadCallback,m.parse(m.vectorTile,h.layerIndex,this.availableImages,h.actor,E)),t(v,T)};m.status==="parsing"?m.reloadCallback=_:m.status==="done"&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,_):_())}}abortTile(r,t){const n=r.uid,l=this.loading[n];l&&(l.abort&&l.abort(),delete this.loading[n]),t()}removeTile(r,t){const n=this.loaded,l=r.uid;n&&n[l]&&delete n[l],t()}},s.WritingMode=Yr,s.ZoomHistory=up,s.add=ga,s.addDynamicAttributes=nm,s.adjoint=function(r,t){var n=t[0],l=t[1],h=t[2],m=t[3],_=t[4],v=t[5],T=t[6],E=t[7],M=t[8];return r[0]=_*M-v*E,r[1]=h*E-l*M,r[2]=l*v-h*_,r[3]=v*T-m*M,r[4]=n*M-h*T,r[5]=h*m-n*v,r[6]=m*E-_*T,r[7]=l*T-n*E,r[8]=n*_-l*m,r},s.asyncAll=Ae,s.bezier=se,s.bindAll=Vt,s.boundsAttributes=_w,s.bufferConvexPolygon=function(r,t){const n=[];for(let l=0;l<r.length;l++){const h=ze(l-1,-1,r.length-1),m=ze(l+1,-1,r.length-1),_=r[l],v=r[m],T=r[h].sub(_).unit(),E=v.sub(_).unit(),M=E.angleWithSep(T.x,T.y),P=T.add(E).unit().mult(-1*t/Math.sin(M/2));n.push(_.add(P))}return n},s.cacheEntryPossiblyAdded=function(r){ce++,ce>wo&&(r.getActor().send("enforceCacheSizeLimit",Ms),ce=0)},s.calculateGlobeLabelMatrix=function(r,t){const{x:n,y:l}=r.point,h=rw(n,l,r.worldSize/r._pixelsPerMercatorPixel,0,0);return Gc(h,h,_y(lo(t)))},s.calculateGlobeMatrix=function(r){const{x:t,y:n}=r.point,{lng:l,lat:h}=r._center;return rw(t,n,r.worldSize,l,h)},s.calculateGlobeMercatorMatrix=function(r){const t=r.pixelsPerMeter,n=t/_s(1,r.center.lat),l=oo(new Float64Array(16));return Wh(l,l,[r.point.x,r.point.y,0]),Cl(l,l,[n,n,t]),Float32Array.from(l)},s.circumferenceAtLatitude=L_,s.clamp=ie,s.clearTileCache=function(r){const t=re(),n=[];for(const l in qn)t&&n.push(t.delete(l)),delete qn[l];r&&Promise.all(n).catch(r).then(()=>r())},s.clipLine=Gb,s.clone=function(r){var t=new Rr(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},s.clone$1=tn,s.collisionCircleLayout=AP,s.config=tt,s.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},s.create=function(){var r=new Rr(16);return Rr!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},s.create$1=U1,s.createExpression=oa,s.createLayout=it,s.createStyleLayer=function(r){return r.type==="custom"?new Tk(r):new Sk[r.type](r)},s.cross=q_,s.degToRad=J,s.distance=function(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2])},s.div=function(r,t,n){return r[0]=t[0]/n[0],r[1]=t[1]/n[1],r[2]=t[2]/n[2],r},s.dot=vs,s.ease=ge,s.easeCubicInOut=q,s.emitValidationErrors=Rh,s.endsWith=fi,s.enforceCacheSizeLimit=function(r){for(const t in qn)N(t),qn[t].then(n=>{n.keys().then(l=>{for(let h=0;h<l.length-r;h++)n.delete(l[h])})})},s.evaluateSizeForFeature=jp,s.evaluateSizeForZoom=Zc,s.evaluateVariableOffset=Xb,s.evented=U,s.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},s.exactEquals$1=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]},s.exported=gt,s.exported$1=xt,s.extend=Ce,s.extend$1=Sn,s.fillExtrusionHeightLift=gb,s.filterObject=_i,s.fromMat4=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[4],r[4]=t[5],r[5]=t[6],r[6]=t[8],r[7]=t[9],r[8]=t[10],r},s.fromQuat=function(r,t){var n=t[0],l=t[1],h=t[2],m=t[3],_=n+n,v=l+l,T=h+h,E=n*_,M=l*_,P=l*v,z=h*_,F=h*v,B=h*T,G=m*_,Z=m*v,oe=m*T;return r[0]=1-P-B,r[1]=M+oe,r[2]=z-Z,r[3]=0,r[4]=M-oe,r[5]=1-E-B,r[6]=F+G,r[7]=0,r[8]=z+Z,r[9]=F-G,r[10]=1-E-P,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},s.fromRotation=function(r,t){var n=Math.sin(t),l=Math.cos(t);return r[0]=l,r[1]=n,r[2]=0,r[3]=-n,r[4]=l,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},s.fromScaling=V1,s.furthestTileCorner=function(r){const t=Math.round((r+45+360)%360/90)%4;return j[t]},s.getAABBPointSquareDist=function(r,t,n){let l=0;for(let h=0;h<2;++h){const m=n?n[h]:0;r[h]>m&&(l+=(r[h]-m)*(r[h]-m)),t[h]<m&&(l+=(m-t[h])*(m-t[h]))}return l},s.getAnchorAlignment=cy,s.getAnchorJustification=dy,s.getBounds=function(r){let t=1/0,n=1/0,l=-1/0,h=-1/0;for(const m of r)t=Math.min(t,m.x),n=Math.min(n,m.y),l=Math.max(l,m.x),h=Math.max(h,m.y);return{min:new k(t,n),max:new k(l,h)}},s.getColumn=Lt,s.getGridMatrix=function(r,t,n){const l=t.getNorth(),h=t.getSouth(),m=t.getWest(),_=.015625;return[0,(t.getEast()-m)*_,1<<r.z,(h-l)/eu[n],0,r.y,l,m,_]},s.getImage=qe,s.getJSON=function(r,t){return be(Ce(r,{type:"json"}),t)},s.getLatitudinalLod=function(r){const t=80.051129;r=ie(r,-80.051129,t)/t*90;const n=Math.pow(Math.abs(Math.sin(J(r))),3);return Math.round(n*(eu.length-1))},s.getMapSessionAPI=Ha,s.getPerformanceMeasurement=Ai,s.getProjection=dw,s.getRTLTextPluginStatus=W,s.getReferrer=Pe,s.getTilePoint=function(r,{x:t,y:n},l=0){return new k(((t-l)*r.scale-r.x)*Wt,(n*r.scale-r.y)*Wt)},s.getTileVec3=function(r,t,n=0){return qc(((t.x-n)*r.scale-r.x)*Wt,(t.y*r.scale-r.y)*Wt,I1(t.z,t.y))},s.getVideo=function(r,t){const n=w.document.createElement("video");n.muted=!0,n.onloadstart=function(){t(null,n)};for(let l=0;l<r.length;l++){const h=w.document.createElement("source");ct(r[l])||(n.crossOrigin="Anonymous"),h.src=r[l],n.appendChild(h)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(r){const t=[0,0,0],n=oo(new Float64Array(16));return Gc(n,r.pixelMatrix,r.globeMatrix),An(t,t,n),new k(t[0],t[1])},s.globeDenormalizeECEF=_y,s.globeECEFOrigin=function(r,t){const n=[0,0,0];return An(n,n,ud(lo(t.canonical))),An(n,n,r),n},s.globeNormalizeECEF=ud,s.globePixelsToTileUnits=function(r,t){return Wt/(512*Math.pow(2,r))*Qp(lo(t))},s.globePoleMatrixForTile=function(r,t,n){const l=oo(new Float64Array(16)),h=(t/(1<<r)-.5)*Math.PI*2;return kp(l,n.globeMatrix,h),Float32Array.from(l)},s.globeTileBounds=lo,s.globeTiltAtLngLat=sw,s.globeToMercatorTransition=hd,s.globeUseCustomAntiAliasing=function(r,t,n){const l=hd(n.zoom),h=r.style.map._antialias,m=!!t.extStandardDerivatives,_=t.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return l===0&&!h&&!_&&m},s.identity=oo,s.identity$1=Z1,s.invert=N_,s.isFullscreen=function(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement},s.isLngLatBehindGlobe=function(r,t){return sw(r,t)>Math.PI/2*1.01},s.isMapAuthenticated=function(r){return jr.has(r)},s.isMapboxURL=ui,s.isSafariWithAntialiasingBug=function(r){const t=r.navigator?r.navigator.userAgent:null;return!!Pt(r)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Xn,s.len=LI,s.length=Hh,s.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},s.loadVectorTile=zw,s.makeRequest=be,s.mapValue=function(r,t,n,l,h){return ie((r-t)/(n-t)*(h-l)+l,l,h)},s.mercatorScale=P1,s.mercatorXfromLng=ro,s.mercatorYfromLat=Do,s.mercatorZfromAltitude=_s,s.mul=PI,s.mul$1=kI,s.multiply=Gc,s.multiply$1=function(r,t,n){var l=t[0],h=t[1],m=t[2],_=t[3],v=t[4],T=t[5],E=t[6],M=t[7],P=t[8],z=n[0],F=n[1],B=n[2],G=n[3],Z=n[4],oe=n[5],me=n[6],le=n[7],fe=n[8];return r[0]=z*l+F*_+B*E,r[1]=z*h+F*v+B*M,r[2]=z*m+F*T+B*P,r[3]=G*l+Z*_+oe*E,r[4]=G*h+Z*v+oe*M,r[5]=G*m+Z*T+oe*P,r[6]=me*l+le*_+fe*E,r[7]=me*h+le*v+fe*M,r[8]=me*m+le*T+fe*P,r},s.multiply$2=G1,s.nextPowerOfTwo=et,s.normalize=fr,s.normalize$1=function(r,t){var n=t[0],l=t[1],h=t[2],m=t[3],_=n*n+l*l+h*h+m*m;return _>0&&(_=1/Math.sqrt(_)),r[0]=n*_,r[1]=l*_,r[2]=h*_,r[3]=m*_,r},s.number=Ti,s.ortho=function(r,t,n,l,h,m,_){var v=1/(t-n),T=1/(l-h),E=1/(m-_);return r[0]=-2*v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*T,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*E,r[11]=0,r[12]=(t+n)*v,r[13]=(h+l)*T,r[14]=(_+m)*E,r[15]=1,r},s.pbf=sd,s.perspective=function(r,t,n,l,h){var m,_=1/Math.tan(t/2);return r[0]=_/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,h!=null&&h!==1/0?(r[10]=(h+l)*(m=1/(l-h)),r[14]=2*h*l*m):(r[10]=-1,r[14]=-2*l),r},s.pick=function(r,t){const n={};for(let l=0;l<t.length;l++){const h=t[l];h in r&&(n[h]=r[h])}return n},s.plugin=K,s.pointGeometry=k,s.polygonContainsPoint=Al,s.polygonIntersectsBox=F1,s.polygonIntersectsPolygon=z1,s.polygonizeBounds=function(r,t,n=0,l=!0){const h=new k(n,n),m=r.sub(h),_=t.add(h),v=[m,new k(_.x,m.y),_,new k(m.x,_.y)];return l&&v.push(m.clone()),v},s.posAttributes=ld,s.postMapLoadEvent=pn,s.postTurnstileEvent=Mn,s.potpack=sy,s.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},s.radToDeg=ue,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(r){return r({pluginStatus:A,pluginURL:I}),U.on("pluginStateChange",r),r},s.removeAuthState=function(r){jr.delete(r)},s.renderColorRamp=K_,s.resample=k1,s.rotateX=U_,s.rotateX$1=X1,s.rotateY=kp,s.rotateY$1=K1,s.rotateZ=function(r,t,n){var l=Math.sin(n),h=Math.cos(n),m=t[0],_=t[1],v=t[2],T=t[3],E=t[4],M=t[5],P=t[6],z=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=m*h+E*l,r[1]=_*h+M*l,r[2]=v*h+P*l,r[3]=T*h+z*l,r[4]=E*h-m*l,r[5]=M*h-_*l,r[6]=P*h-v*l,r[7]=z*h-T*l,r},s.rotateZ$1=function(r,t,n){n*=.5;var l=t[0],h=t[1],m=t[2],_=t[3],v=Math.sin(n),T=Math.cos(n);return r[0]=l*T+h*v,r[1]=h*T-l*v,r[2]=m*T+_*v,r[3]=_*T-m*v,r},s.scale=Cl,s.scale$1=W1,s.scale$2=Ds,s.scaleAndAdd=Lp,s.setCacheLimits=function(r,t){Ms=r,wo=t},s.setColumn=function(r,t,n){r[4*t+0]=n[0],r[4*t+1]=n[1],r[4*t+2]=n[2],r[4*t+3]=n[3]},s.setRTLTextPlugin=function(r,t,n=!1){if(A===g||A===x||A===b)throw new Error("setRTLTextPlugin cannot be called multiple times.");I=gt.resolveURL(r),A=g,S=t,O(),n||ee()},s.smoothstep=Ie,s.spec=Ve,s.storeAuthState=function(r,t){t?jr.add(r):jr.delete(r)},s.sub=Os,s.subtract=$_,s.symbolSize=CP,s.tileAABB=function(r,t,n,l,h,m,_,v,T){if(T.name==="globe")return ok(r,t,new Up(n,l,h));const E=kl({z:n,x:l,y:h},T);return new Sr([(m+E.x/E.scale)*t,t*(E.y/E.scale),_],[(m+E.x2/E.scale)*t,t*(E.y2/E.scale),v])},s.tileCornersToBounds=Kp,s.tileTransform=kl,s.transformMat3=function(r,t,n){var l=t[0],h=t[1],m=t[2];return r[0]=l*n[0]+h*n[3]+m*n[6],r[1]=l*n[1]+h*n[4]+m*n[7],r[2]=l*n[2]+h*n[5]+m*n[8],r},s.transformMat4=An,s.transformMat4$1=Ml,s.transformQuat=q1,s.transitionTileAABBinECEF=tw,s.translate=Wh,s.transpose=function(r,t){if(r===t){var n=t[1],l=t[2],h=t[5];r[1]=t[3],r[2]=t[6],r[3]=n,r[5]=t[7],r[6]=l,r[7]=h}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r},s.triggerPluginCompletionEvent=D,s.uniqueId=De,s.updateGlobeVertexNormal=function(r,t,n,l,h){const m=5*t+2;r.float32[m+0]=n,r.float32[m+1]=l,r.float32[m+2]=h},s.validateCustomStyleLayer=function(r){const t=[],n=r.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},s.validateFilter=r=>ks(ca(r)),s.validateFog=r=>ks(op(r)),s.validateLayer=r=>ks(kc(r)),s.validateLight=r=>ks(sp(r)),s.validateSource=r=>ks(rp(r)),s.validateStyle=Rc,s.validateTerrain=r=>ks(zc(r)),s.values=He,s.vectorTile=Pl,s.version=he,s.warnOnce=yi,s.window=w,s.wrap=ze}),f(["./shared"],function(s){function w(re){if(typeof re=="number"||typeof re=="boolean"||typeof re=="string"||re==null)return JSON.stringify(re);if(Array.isArray(re)){let $="[";for(const ne of re)$+=`${w(ne)},`;return`${$}]`}let N="{";for(const $ of Object.keys(re).sort())N+=`${$}:${w(re[$])},`;return`${N}}`}function C(re){let N="";for(const $ of s.refProperties)N+=`/${w(re[$])}`;return N}class L{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,$){for(const ce of N)this._layerConfigs[ce.id]=ce,(this._layers[ce.id]=s.createStyleLayer(ce)).compileFilter(),this.keyCache[ce.id]&&delete this.keyCache[ce.id];for(const ce of $)delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce];this.familiesBySource={};const ne=function(ce,Te){const Le={};for(let be=0;be<ce.length;be++){const Re=Te&&Te[ce[be].id]||C(ce[be]);Te&&(Te[ce[be].id]=Re);let rt=Le[Re];rt||(rt=Le[Re]=[]),rt.push(ce[be])}const Pe=[];for(const be in Le)Pe.push(Le[be]);return Pe}(s.values(this._layerConfigs),this.keyCache);for(const ce of ne){const Te=ce.map(wt=>this._layers[wt.id]),Le=Te[0];if(Le.visibility==="none")continue;const Pe=Le.source||"";let be=this.familiesBySource[Pe];be||(be=this.familiesBySource[Pe]={});const Re=Le.sourceLayer||"_geojsonTileLayer";let rt=be[Re];rt||(rt=be[Re]=[]),rt.push(Te)}}}class k{loadTile(N,$){const{uid:ne,encoding:ce,rawImageData:Te,padding:Le,buildQuadTree:Pe}=N,be=s.window.ImageBitmap&&Te instanceof s.window.ImageBitmap?this.getImageData(Te,Le):Te;$(null,new s.DEMData(ne,be,ce,Le<1,Pe))}getImageData(N,$){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(N.width,N.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=N.width,this.offscreenCanvas.height=N.height,this.offscreenCanvasContext.drawImage(N,0,0,N.width,N.height);const ne=this.offscreenCanvasContext.getImageData(-$,-$,N.width+2*$,N.height+2*$);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ne}}var R=function re(N,$){var ne,ce=N&&N.type;if(ce==="FeatureCollection")for(ne=0;ne<N.features.length;ne++)re(N.features[ne],$);else if(ce==="GeometryCollection")for(ne=0;ne<N.geometries.length;ne++)re(N.geometries[ne],$);else if(ce==="Feature")re(N.geometry,$);else if(ce==="Polygon")V(N.coordinates,$);else if(ce==="MultiPolygon")for(ne=0;ne<N.coordinates.length;ne++)V(N.coordinates[ne],$);return N};function V(re,N){if(re.length!==0){H(re[0],N);for(var $=1;$<re.length;$++)H(re[$],!N)}}function H(re,N){for(var $=0,ne=0,ce=0,Te=re.length,Le=Te-1;ce<Te;Le=ce++){var Pe=(re[ce][0]-re[Le][0])*(re[Le][1]+re[ce][1]),be=$+Pe;ne+=Math.abs($)>=Math.abs(Pe)?$-be+Pe:Pe-be+$,$=be}$+ne>=0!=!!N&&re.reverse()}const J=s.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ue{constructor(N){this._feature=N,this.extent=s.EXTENT,this.type=N.type,this.properties=N.tags,"id"in N&&!isNaN(N.id)&&(this.id=parseInt(N.id,10))}loadGeometry(){if(this._feature.type===1){const N=[];for(const $ of this._feature.geometry)N.push([new s.pointGeometry($[0],$[1])]);return N}{const N=[];for(const $ of this._feature.geometry){const ne=[];for(const ce of $)ne.push(new s.pointGeometry(ce[0],ce[1]));N.push(ne)}return N}}toGeoJSON(N,$,ne){return J.call(this,N,$,ne)}}class j{constructor(N){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=N.length,this._features=N}feature(N){return new ue(this._features[N])}}var q=s.vectorTile.VectorTileFeature,se=ge;function ge(re,N){this.options=N||{},this.features=re,this.length=re.length}function ie(re,N){this.id=typeof re.id=="number"?re.id:void 0,this.type=re.type,this.rawGeometry=re.type===1?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=N||4096}ge.prototype.feature=function(re){return new ie(this.features[re],this.options.extent)},ie.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var N=0;N<re.length;N++){for(var $=re[N],ne=[],ce=0;ce<$.length;ce++)ne.push(new s.pointGeometry($[ce][0],$[ce][1]));this.geometry.push(ne)}return this.geometry},ie.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,N=1/0,$=-1/0,ne=1/0,ce=-1/0,Te=0;Te<re.length;Te++)for(var Le=re[Te],Pe=0;Pe<Le.length;Pe++){var be=Le[Pe];N=Math.min(N,be.x),$=Math.max($,be.x),ne=Math.min(ne,be.y),ce=Math.max(ce,be.y)}return[N,ne,$,ce]},ie.prototype.toGeoJSON=q.prototype.toGeoJSON;var Ie=Ae,ze=se;function Ae(re){var N=new s.pbf;return function($,ne){for(var ce in $.layers)ne.writeMessage(3,He,$.layers[ce])}(re,N),N.finish()}function He(re,N){var $;N.writeVarintField(15,re.version||1),N.writeStringField(1,re.name||""),N.writeVarintField(5,re.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for($=0;$<re.length;$++)ne.feature=re.feature($),N.writeMessage(2,Ce,ne);var ce=ne.keys;for($=0;$<ce.length;$++)N.writeStringField(3,ce[$]);var Te=ne.values;for($=0;$<Te.length;$++)N.writeMessage(4,Gt,Te[$])}function Ce(re,N){var $=re.feature;$.id!==void 0&&N.writeVarintField(1,$.id),N.writeMessage(2,Ge,re),N.writeVarintField(3,$.type),N.writeMessage(4,et,$)}function Ge(re,N){var $=re.feature,ne=re.keys,ce=re.values,Te=re.keycache,Le=re.valuecache;for(var Pe in $.properties){var be=$.properties[Pe],Re=Te[Pe];if(be!==null){Re===void 0&&(ne.push(Pe),Te[Pe]=Re=ne.length-1),N.writeVarint(Re);var rt=typeof be;rt!=="string"&&rt!=="boolean"&&rt!=="number"&&(be=JSON.stringify(be));var wt=rt+":"+be,ct=Le[wt];ct===void 0&&(ce.push(be),Le[wt]=ct=ce.length-1),N.writeVarint(ct)}}}function De(re,N){return(N<<3)+(7&re)}function We(re){return re<<1^re>>31}function et(re,N){for(var $=re.loadGeometry(),ne=re.type,ce=0,Te=0,Le=$.length,Pe=0;Pe<Le;Pe++){var be=$[Pe],Re=1;ne===1&&(Re=be.length),N.writeVarint(De(1,Re));for(var rt=ne===3?be.length-1:be.length,wt=0;wt<rt;wt++){wt===1&&ne!==1&&N.writeVarint(De(2,rt-1));var ct=be[wt].x-ce,jt=be[wt].y-Te;N.writeVarint(We(ct)),N.writeVarint(We(jt)),ce+=ct,Te+=jt}ne===3&&N.writeVarint(De(7,1))}}function Gt(re,N){var $=typeof re;$==="string"?N.writeStringField(1,re):$==="boolean"?N.writeBooleanField(7,re):$==="number"&&(re%1!=0?N.writeDoubleField(3,re):re<0?N.writeSVarintField(6,re):N.writeVarintField(5,re))}function Vt(re,N,$,ne,ce,Te){if(ce-ne<=$)return;const Le=ne+ce>>1;fi(re,N,Le,ne,ce,Te%2),Vt(re,N,$,ne,Le-1,Te+1),Vt(re,N,$,Le+1,ce,Te+1)}function fi(re,N,$,ne,ce,Te){for(;ce>ne;){if(ce-ne>600){const Re=ce-ne+1,rt=$-ne+1,wt=Math.log(Re),ct=.5*Math.exp(2*wt/3),jt=.5*Math.sqrt(wt*ct*(Re-ct)/Re)*(rt-Re/2<0?-1:1);fi(re,N,$,Math.max(ne,Math.floor($-rt*ct/Re+jt)),Math.min(ce,Math.floor($+(Re-rt)*ct/Re+jt)),Te)}const Le=N[2*$+Te];let Pe=ne,be=ce;for(Yt(re,N,ne,$),N[2*ce+Te]>Le&&Yt(re,N,ne,ce);Pe<be;){for(Yt(re,N,Pe,be),Pe++,be--;N[2*Pe+Te]<Le;)Pe++;for(;N[2*be+Te]>Le;)be--}N[2*ne+Te]===Le?Yt(re,N,ne,be):(be++,Yt(re,N,be,ce)),be<=$&&(ne=be+1),$<=be&&(ce=be-1)}}function Yt(re,N,$,ne){_i(re,$,ne),_i(N,2*$,2*ne),_i(N,2*$+1,2*ne+1)}function _i(re,N,$){const ne=re[N];re[N]=re[$],re[$]=ne}function tn(re,N,$,ne){const ce=re-$,Te=N-ne;return ce*ce+Te*Te}Ie.fromVectorTileJs=Ae,Ie.fromGeojsonVt=function(re,N){N=N||{};var $={};for(var ne in re)$[ne]=new se(re[ne].features,N),$[ne].name=ne,$[ne].version=N.version,$[ne].extent=N.extent;return Ae({layers:$})},Ie.GeoJSONWrapper=ze;const Mi=re=>re[0],yi=re=>re[1];class Kt{constructor(N,$=Mi,ne=yi,ce=64,Te=Float64Array){this.nodeSize=ce,this.points=N;const Le=N.length<65536?Uint16Array:Uint32Array,Pe=this.ids=new Le(N.length),be=this.coords=new Te(2*N.length);for(let Re=0;Re<N.length;Re++)Pe[Re]=Re,be[2*Re]=$(N[Re]),be[2*Re+1]=ne(N[Re]);Vt(Pe,be,ce,0,Pe.length-1,0)}range(N,$,ne,ce){return function(Te,Le,Pe,be,Re,rt,wt){const ct=[0,Te.length-1,0],jt=[];let lt,_e;for(;ct.length;){const qe=ct.pop(),pt=ct.pop(),qt=ct.pop();if(pt-qt<=wt){for(let kt=qt;kt<=pt;kt++)lt=Le[2*kt],_e=Le[2*kt+1],lt>=Pe&&lt<=Re&&_e>=be&&_e<=rt&&jt.push(Te[kt]);continue}const ti=Math.floor((qt+pt)/2);lt=Le[2*ti],_e=Le[2*ti+1],lt>=Pe&&lt<=Re&&_e>=be&&_e<=rt&&jt.push(Te[ti]);const Jt=(qe+1)%2;(qe===0?Pe<=lt:be<=_e)&&(ct.push(qt),ct.push(ti-1),ct.push(Jt)),(qe===0?Re>=lt:rt>=_e)&&(ct.push(ti+1),ct.push(pt),ct.push(Jt))}return jt}(this.ids,this.coords,N,$,ne,ce,this.nodeSize)}within(N,$,ne){return function(ce,Te,Le,Pe,be,Re){const rt=[0,ce.length-1,0],wt=[],ct=be*be;for(;rt.length;){const jt=rt.pop(),lt=rt.pop(),_e=rt.pop();if(lt-_e<=Re){for(let Jt=_e;Jt<=lt;Jt++)tn(Te[2*Jt],Te[2*Jt+1],Le,Pe)<=ct&&wt.push(ce[Jt]);continue}const qe=Math.floor((_e+lt)/2),pt=Te[2*qe],qt=Te[2*qe+1];tn(pt,qt,Le,Pe)<=ct&&wt.push(ce[qe]);const ti=(jt+1)%2;(jt===0?Le-be<=pt:Pe-be<=qt)&&(rt.push(_e),rt.push(qe-1),rt.push(ti)),(jt===0?Le+be>=pt:Pe+be>=qt)&&(rt.push(qe+1),rt.push(lt),rt.push(ti))}return wt}(this.ids,this.coords,N,$,ne,this.nodeSize)}}const fn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},gn=Math.fround||(xn=new Float32Array(1),re=>(xn[0]=+re,xn[0]));var xn;class Ke{constructor(N){this.options=Ne(Object.create(fn),N),this.trees=new Array(this.options.maxZoom+1)}load(N){const{log:$,minZoom:ne,maxZoom:ce,nodeSize:Te}=this.options;$&&console.time("total time");const Le=`prepare ${N.length} points`;$&&console.time(Le),this.points=N;let Pe=[];for(let be=0;be<N.length;be++)N[be].geometry&&Pe.push(Mt(N[be],be));this.trees[ce+1]=new Kt(Pe,at,Ye,Te,Float32Array),$&&console.timeEnd(Le);for(let be=ce;be>=ne;be--){const Re=+Date.now();Pe=this._cluster(Pe,be),this.trees[be]=new Kt(Pe,at,Ye,Te,Float32Array),$&&console.log("z%d: %d clusters in %dms",be,Pe.length,+Date.now()-Re)}return $&&console.timeEnd("total time"),this}getClusters(N,$){let ne=((N[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,N[1]));let Te=N[2]===180?180:((N[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)ne=-180,Te=180;else if(ne>Te){const rt=this.getClusters([ne,ce,180,Le],$),wt=this.getClusters([-180,ce,Te,Le],$);return rt.concat(wt)}const Pe=this.trees[this._limitZoom($)],be=Pe.range(Ai(ne),he(Le),Ai(Te),he(ce)),Re=[];for(const rt of be){const wt=Pe.points[rt];Re.push(wt.numPoints?Lt(wt):this.points[wt.index])}return Re}getChildren(N){const $=this._getOriginId(N),ne=this._getOriginZoom(N),ce="No cluster with the specified id.",Te=this.trees[ne];if(!Te)throw new Error(ce);const Le=Te.points[$];if(!Le)throw new Error(ce);const Pe=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),be=Te.within(Le.x,Le.y,Pe),Re=[];for(const rt of be){const wt=Te.points[rt];wt.parentId===N&&Re.push(wt.numPoints?Lt(wt):this.points[wt.index])}if(Re.length===0)throw new Error(ce);return Re}getLeaves(N,$,ne){const ce=[];return this._appendLeaves(ce,N,$=$||10,ne=ne||0,0),ce}getTile(N,$,ne){const ce=this.trees[this._limitZoom(N)],Te=Math.pow(2,N),{extent:Le,radius:Pe}=this.options,be=Pe/Le,Re=(ne-be)/Te,rt=(ne+1+be)/Te,wt={features:[]};return this._addTileFeatures(ce.range(($-be)/Te,Re,($+1+be)/Te,rt),ce.points,$,ne,Te,wt),$===0&&this._addTileFeatures(ce.range(1-be/Te,Re,1,rt),ce.points,Te,ne,Te,wt),$===Te-1&&this._addTileFeatures(ce.range(0,Re,be/Te,rt),ce.points,-1,ne,Te,wt),wt.features.length?wt:null}getClusterExpansionZoom(N){let $=this._getOriginZoom(N)-1;for(;$<=this.options.maxZoom;){const ne=this.getChildren(N);if($++,ne.length!==1)break;N=ne[0].properties.cluster_id}return $}_appendLeaves(N,$,ne,ce,Te){const Le=this.getChildren($);for(const Pe of Le){const be=Pe.properties;if(be&&be.cluster?Te+be.point_count<=ce?Te+=be.point_count:Te=this._appendLeaves(N,be.cluster_id,ne,ce,Te):Te<ce?Te++:N.push(Pe),N.length===ne)break}return Te}_addTileFeatures(N,$,ne,ce,Te,Le){for(const Pe of N){const be=$[Pe],Re=be.numPoints;let rt,wt,ct;if(Re)rt=li(be),wt=be.x,ct=be.y;else{const _e=this.points[be.index];rt=_e.properties,wt=Ai(_e.geometry.coordinates[0]),ct=he(_e.geometry.coordinates[1])}const jt={type:1,geometry:[[Math.round(this.options.extent*(wt*Te-ne)),Math.round(this.options.extent*(ct*Te-ce))]],tags:rt};let lt;Re?lt=be.id:this.options.generateId?lt=be.index:this.points[be.index].id&&(lt=this.points[be.index].id),lt!==void 0&&(jt.id=lt),Le.features.push(jt)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(+N,this.options.maxZoom+1))}_cluster(N,$){const ne=[],{radius:ce,extent:Te,reduce:Le,minPoints:Pe}=this.options,be=ce/(Te*Math.pow(2,$));for(let Re=0;Re<N.length;Re++){const rt=N[Re];if(rt.zoom<=$)continue;rt.zoom=$;const wt=this.trees[$+1],ct=wt.within(rt.x,rt.y,be),jt=rt.numPoints||1;let lt=jt;for(const _e of ct){const qe=wt.points[_e];qe.zoom>$&&(lt+=qe.numPoints||1)}if(lt>jt&&lt>=Pe){let _e=rt.x*jt,qe=rt.y*jt,pt=Le&&jt>1?this._map(rt,!0):null;const qt=(Re<<5)+($+1)+this.points.length;for(const ti of ct){const Jt=wt.points[ti];if(Jt.zoom<=$)continue;Jt.zoom=$;const kt=Jt.numPoints||1;_e+=Jt.x*kt,qe+=Jt.y*kt,Jt.parentId=qt,Le&&(pt||(pt=this._map(rt,!0)),Le(pt,this._map(Jt)))}rt.parentId=qt,ne.push(Pt(_e/lt,qe/lt,qt,lt,pt))}else if(ne.push(rt),lt>1)for(const _e of ct){const qe=wt.points[_e];qe.zoom<=$||(qe.zoom=$,ne.push(qe))}}return ne}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,$){if(N.numPoints)return $?Ne({},N.properties):N.properties;const ne=this.points[N.index].properties,ce=this.options.map(ne);return $&&ce===ne?Ne({},ce):ce}}function Pt(re,N,$,ne,ce){return{x:gn(re),y:gn(N),zoom:1/0,id:$,parentId:-1,numPoints:ne,properties:ce}}function Mt(re,N){const[$,ne]=re.geometry.coordinates;return{x:gn(Ai($)),y:gn(he(ne)),zoom:1/0,index:N,parentId:-1}}function Lt(re){return{type:"Feature",id:re.id,properties:li(re),geometry:{type:"Point",coordinates:[(N=re.x,360*(N-.5)),de(re.y)]}};var N}function li(re){const N=re.numPoints,$=N>=1e4?`${Math.round(N/1e3)}k`:N>=1e3?Math.round(N/100)/10+"k":N;return Ne(Ne({},re.properties),{cluster:!0,cluster_id:re.id,point_count:N,point_count_abbreviated:$})}function Ai(re){return re/360+.5}function he(re){const N=Math.sin(re*Math.PI/180),$=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return $<0?0:$>1?1:$}function de(re){const N=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Ne(re,N){for(const $ in N)re[$]=N[$];return re}function at(re){return re.x}function Ye(re){return re.y}function gt(re,N,$,ne){for(var ce,Te=ne,Le=$-N>>1,Pe=$-N,be=re[N],Re=re[N+1],rt=re[$],wt=re[$+1],ct=N+3;ct<$;ct+=3){var jt=It(re[ct],re[ct+1],be,Re,rt,wt);if(jt>Te)ce=ct,Te=jt;else if(jt===Te){var lt=Math.abs(ct-Le);lt<Pe&&(ce=ct,Pe=lt)}}Te>ne&&(ce-N>3&&gt(re,N,ce,ne),re[ce+2]=Te,$-ce>3&&gt(re,ce,$,ne))}function It(re,N,$,ne,ce,Te){var Le=ce-$,Pe=Te-ne;if(Le!==0||Pe!==0){var be=((re-$)*Le+(N-ne)*Pe)/(Le*Le+Pe*Pe);be>1?($=ce,ne=Te):be>0&&($+=Le*be,ne+=Pe*be)}return(Le=re-$)*Le+(Pe=N-ne)*Pe}function tt(re,N,$,ne){var ce={id:re===void 0?null:re,type:N,geometry:$,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Te){var Le=Te.geometry,Pe=Te.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")xt(Te,Le);else if(Pe==="Polygon"||Pe==="MultiLineString")for(var be=0;be<Le.length;be++)xt(Te,Le[be]);else if(Pe==="MultiPolygon")for(be=0;be<Le.length;be++)for(var Re=0;Re<Le[be].length;Re++)xt(Te,Le[be][Re])}(ce),ce}function xt(re,N){for(var $=0;$<N.length;$+=3)re.minX=Math.min(re.minX,N[$]),re.minY=Math.min(re.minY,N[$+1]),re.maxX=Math.max(re.maxX,N[$]),re.maxY=Math.max(re.maxY,N[$+1])}function ut(re,N,$,ne){if(N.geometry){var ce=N.geometry.coordinates,Te=N.geometry.type,Le=Math.pow($.tolerance/((1<<$.maxZoom)*$.extent),2),Pe=[],be=N.id;if($.promoteId?be=N.properties[$.promoteId]:$.generateId&&(be=ne||0),Te==="Point")Ot(ce,Pe);else if(Te==="MultiPoint")for(var Re=0;Re<ce.length;Re++)Ot(ce[Re],Pe);else if(Te==="LineString")Dt(ce,Pe,Le,!1);else if(Te==="MultiLineString"){if($.lineMetrics){for(Re=0;Re<ce.length;Re++)Dt(ce[Re],Pe=[],Le,!1),re.push(tt(be,"LineString",Pe,N.properties));return}$t(ce,Pe,Le,!1)}else if(Te==="Polygon")$t(ce,Pe,Le,!0);else{if(Te!=="MultiPolygon"){if(Te==="GeometryCollection"){for(Re=0;Re<N.geometry.geometries.length;Re++)ut(re,{id:be,geometry:N.geometry.geometries[Re],properties:N.properties},$,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Re=0;Re<ce.length;Re++){var rt=[];$t(ce[Re],rt,Le,!0),Pe.push(rt)}}re.push(tt(be,Te,Pe,N.properties))}}function Ot(re,N){N.push(Zt(re[0])),N.push(ci(re[1])),N.push(0)}function Dt(re,N,$,ne){for(var ce,Te,Le=0,Pe=0;Pe<re.length;Pe++){var be=Zt(re[Pe][0]),Re=ci(re[Pe][1]);N.push(be),N.push(Re),N.push(0),Pe>0&&(Le+=ne?(ce*Re-be*Te)/2:Math.sqrt(Math.pow(be-ce,2)+Math.pow(Re-Te,2))),ce=be,Te=Re}var rt=N.length-3;N[2]=1,gt(N,0,rt,$),N[rt+2]=1,N.size=Math.abs(Le),N.start=0,N.end=N.size}function $t(re,N,$,ne){for(var ce=0;ce<re.length;ce++){var Te=[];Dt(re[ce],Te,$,ne),N.push(Te)}}function Zt(re){return re/360+.5}function ci(re){var N=Math.sin(re*Math.PI/180),$=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return $<0?0:$>1?1:$}function oi(re,N,$,ne,ce,Te,Le,Pe){if(ne/=N,Te>=($/=N)&&Le<ne)return re;if(Le<$||Te>=ne)return null;for(var be=[],Re=0;Re<re.length;Re++){var rt=re[Re],wt=rt.geometry,ct=rt.type,jt=ce===0?rt.minX:rt.minY,lt=ce===0?rt.maxX:rt.maxY;if(jt>=$&&lt<ne)be.push(rt);else if(!(lt<$||jt>=ne)){var _e=[];if(ct==="Point"||ct==="MultiPoint")ui(wt,_e,$,ne,ce);else if(ct==="LineString")bi(wt,_e,$,ne,ce,!1,Pe.lineMetrics);else if(ct==="MultiLineString")Zi(wt,_e,$,ne,ce,!1);else if(ct==="Polygon")Zi(wt,_e,$,ne,ce,!0);else if(ct==="MultiPolygon")for(var qe=0;qe<wt.length;qe++){var pt=[];Zi(wt[qe],pt,$,ne,ce,!0),pt.length&&_e.push(pt)}if(_e.length){if(Pe.lineMetrics&&ct==="LineString"){for(qe=0;qe<_e.length;qe++)be.push(tt(rt.id,ct,_e[qe],rt.tags));continue}ct!=="LineString"&&ct!=="MultiLineString"||(_e.length===1?(ct="LineString",_e=_e[0]):ct="MultiLineString"),ct!=="Point"&&ct!=="MultiPoint"||(ct=_e.length===3?"Point":"MultiPoint"),be.push(tt(rt.id,ct,_e,rt.tags))}}}return be.length?be:null}function ui(re,N,$,ne,ce){for(var Te=0;Te<re.length;Te+=3){var Le=re[Te+ce];Le>=$&&Le<=ne&&(N.push(re[Te]),N.push(re[Te+1]),N.push(re[Te+2]))}}function bi(re,N,$,ne,ce,Te,Le){for(var Pe,be,Re=nn(re),rt=ce===0?ur:fs,wt=re.start,ct=0;ct<re.length-3;ct+=3){var jt=re[ct],lt=re[ct+1],_e=re[ct+2],qe=re[ct+3],pt=re[ct+4],qt=ce===0?jt:lt,ti=ce===0?qe:pt,Jt=!1;Le&&(Pe=Math.sqrt(Math.pow(jt-qe,2)+Math.pow(lt-pt,2))),qt<$?ti>$&&(be=rt(Re,jt,lt,qe,pt,$),Le&&(Re.start=wt+Pe*be)):qt>ne?ti<ne&&(be=rt(Re,jt,lt,qe,pt,ne),Le&&(Re.start=wt+Pe*be)):Gn(Re,jt,lt,_e),ti<$&&qt>=$&&(be=rt(Re,jt,lt,qe,pt,$),Jt=!0),ti>ne&&qt<=ne&&(be=rt(Re,jt,lt,qe,pt,ne),Jt=!0),!Te&&Jt&&(Le&&(Re.end=wt+Pe*be),N.push(Re),Re=nn(re)),Le&&(wt+=Pe)}var kt=re.length-3;jt=re[kt],lt=re[kt+1],_e=re[kt+2],(qt=ce===0?jt:lt)>=$&&qt<=ne&&Gn(Re,jt,lt,_e),kt=Re.length-3,Te&&kt>=3&&(Re[kt]!==Re[0]||Re[kt+1]!==Re[1])&&Gn(Re,Re[0],Re[1],Re[2]),Re.length&&N.push(Re)}function nn(re){var N=[];return N.size=re.size,N.start=re.start,N.end=re.end,N}function Zi(re,N,$,ne,ce,Te){for(var Le=0;Le<re.length;Le++)bi(re[Le],N,$,ne,ce,Te,!1)}function Gn(re,N,$,ne){re.push(N),re.push($),re.push(ne)}function ur(re,N,$,ne,ce,Te){var Le=(Te-N)/(ne-N);return re.push(Te),re.push($+(ce-$)*Le),re.push(1),Le}function fs(re,N,$,ne,ce,Te){var Le=(Te-$)/(ce-$);return re.push(N+(ne-N)*Le),re.push(Te),re.push(1),Le}function Xi(re,N){for(var $=[],ne=0;ne<re.length;ne++){var ce,Te=re[ne],Le=Te.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")ce=Mn(Te.geometry,N);else if(Le==="MultiLineString"||Le==="Polygon"){ce=[];for(var Pe=0;Pe<Te.geometry.length;Pe++)ce.push(Mn(Te.geometry[Pe],N))}else if(Le==="MultiPolygon")for(ce=[],Pe=0;Pe<Te.geometry.length;Pe++){for(var be=[],Re=0;Re<Te.geometry[Pe].length;Re++)be.push(Mn(Te.geometry[Pe][Re],N));ce.push(be)}$.push(tt(Te.id,Le,ce,Te.tags))}return $}function Mn(re,N){var $=[];$.size=re.size,re.start!==void 0&&($.start=re.start,$.end=re.end);for(var ne=0;ne<re.length;ne+=3)$.push(re[ne]+N,re[ne+1],re[ne+2]);return $}function ps(re,N){if(re.transformed)return re;var $,ne,ce,Te=1<<re.z,Le=re.x,Pe=re.y;for($=0;$<re.features.length;$++){var be=re.features[$],Re=be.geometry,rt=be.type;if(be.geometry=[],rt===1)for(ne=0;ne<Re.length;ne+=2)be.geometry.push(pn(Re[ne],Re[ne+1],N,Te,Le,Pe));else for(ne=0;ne<Re.length;ne++){var wt=[];for(ce=0;ce<Re[ne].length;ce+=2)wt.push(pn(Re[ne][ce],Re[ne][ce+1],N,Te,Le,Pe));be.geometry.push(wt)}}return re.transformed=!0,re}function pn(re,N,$,ne,ce,Te){return[Math.round($*(re*ne-ce)),Math.round($*(N*ne-Te))]}function $r(re,N,$,ne,ce){for(var Te=N===ce.maxZoom?0:ce.tolerance/((1<<N)*ce.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:$,y:ne,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Pe=0;Pe<re.length;Pe++){Le.numFeatures++,Ha(Le,re[Pe],Te,ce);var be=re[Pe].minX,Re=re[Pe].minY,rt=re[Pe].maxX,wt=re[Pe].maxY;be<Le.minX&&(Le.minX=be),Re<Le.minY&&(Le.minY=Re),rt>Le.maxX&&(Le.maxX=rt),wt>Le.maxY&&(Le.maxY=wt)}return Le}function Ha(re,N,$,ne){var ce=N.geometry,Te=N.type,Le=[];if(Te==="Point"||Te==="MultiPoint")for(var Pe=0;Pe<ce.length;Pe+=3)Le.push(ce[Pe]),Le.push(ce[Pe+1]),re.numPoints++,re.numSimplified++;else if(Te==="LineString")jr(Le,ce,re,$,!1,!1);else if(Te==="MultiLineString"||Te==="Polygon")for(Pe=0;Pe<ce.length;Pe++)jr(Le,ce[Pe],re,$,Te==="Polygon",Pe===0);else if(Te==="MultiPolygon")for(var be=0;be<ce.length;be++){var Re=ce[be];for(Pe=0;Pe<Re.length;Pe++)jr(Le,Re[Pe],re,$,!0,Pe===0)}if(Le.length){var rt=N.tags||null;if(Te==="LineString"&&ne.lineMetrics){for(var wt in rt={},N.tags)rt[wt]=N.tags[wt];rt.mapbox_clip_start=ce.start/ce.size,rt.mapbox_clip_end=ce.end/ce.size}var ct={geometry:Le,type:Te==="Polygon"||Te==="MultiPolygon"?3:Te==="LineString"||Te==="MultiLineString"?2:1,tags:rt};N.id!==null&&(ct.id=N.id),re.features.push(ct)}}function jr(re,N,$,ne,ce,Te){var Le=ne*ne;if(ne>0&&N.size<(ce?Le:ne))$.numPoints+=N.length/3;else{for(var Pe=[],be=0;be<N.length;be+=3)(ne===0||N[be+2]>Le)&&($.numSimplified++,Pe.push(N[be]),Pe.push(N[be+1])),$.numPoints++;ce&&function(Re,rt){for(var wt=0,ct=0,jt=Re.length,lt=jt-2;ct<jt;lt=ct,ct+=2)wt+=(Re[ct]-Re[lt])*(Re[ct+1]+Re[lt+1]);if(wt>0===rt)for(ct=0,jt=Re.length;ct<jt/2;ct+=2){var _e=Re[ct],qe=Re[ct+1];Re[ct]=Re[jt-2-ct],Re[ct+1]=Re[jt-1-ct],Re[jt-2-ct]=_e,Re[jt-1-ct]=qe}}(Pe,Te),re.push(Pe)}}function wr(re,N){var $=(N=this.options=function(ce,Te){for(var Le in Te)ce[Le]=Te[Le];return ce}(Object.create(this.options),N)).debug;if($&&console.time("preprocess data"),N.maxZoom<0||N.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(N.promoteId&&N.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(ce,Te){var Le=[];if(ce.type==="FeatureCollection")for(var Pe=0;Pe<ce.features.length;Pe++)ut(Le,ce.features[Pe],Te,Pe);else ut(Le,ce.type==="Feature"?ce:{geometry:ce},Te);return Le}(re,N);this.tiles={},this.tileCoords=[],$&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",N.indexMaxZoom,N.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ne=function(ce,Te){var Le=Te.buffer/Te.extent,Pe=ce,be=oi(ce,1,-1-Le,Le,0,-1,2,Te),Re=oi(ce,1,1-Le,2+Le,0,-1,2,Te);return(be||Re)&&(Pe=oi(ce,1,-Le,1+Le,0,-1,2,Te)||[],be&&(Pe=Xi(be,1).concat(Pe)),Re&&(Pe=Pe.concat(Xi(Re,-1)))),Pe}(ne,N)).length&&this.splitTile(ne,0,0,0),$&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ms(re,N,$){return 32*((1<<re)*$+N)+re}function wo(re,N){const $=re.tileID.canonical;if(!this._geoJSONIndex)return N(null,null);const ne=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!ne)return N(null,null);const ce=new j(ne.features);let Te=Ie(ce);Te.byteOffset===0&&Te.byteLength===Te.buffer.byteLength||(Te=new Uint8Array(Te)),N(null,{vectorTile:ce,rawData:Te.buffer})}wr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},wr.prototype.splitTile=function(re,N,$,ne,ce,Te,Le){for(var Pe=[re,N,$,ne],be=this.options,Re=be.debug;Pe.length;){ne=Pe.pop(),$=Pe.pop(),N=Pe.pop(),re=Pe.pop();var rt=1<<N,wt=Ms(N,$,ne),ct=this.tiles[wt];if(!ct&&(Re>1&&console.time("creation"),ct=this.tiles[wt]=$r(re,N,$,ne,be),this.tileCoords.push({z:N,x:$,y:ne}),Re)){Re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",N,$,ne,ct.numFeatures,ct.numPoints,ct.numSimplified),console.timeEnd("creation"));var jt="z"+N;this.stats[jt]=(this.stats[jt]||0)+1,this.total++}if(ct.source=re,ce){if(N===be.maxZoom||N===ce)continue;var lt=1<<ce-N;if($!==Math.floor(Te/lt)||ne!==Math.floor(Le/lt))continue}else if(N===be.indexMaxZoom||ct.numPoints<=be.indexMaxPoints)continue;if(ct.source=null,re.length!==0){Re>1&&console.time("clipping");var _e,qe,pt,qt,ti,Jt,kt=.5*be.buffer/be.extent,Ve=.5-kt,Sn=.5+kt,vi=1+kt;_e=qe=pt=qt=null,ti=oi(re,rt,$-kt,$+Sn,0,ct.minX,ct.maxX,be),Jt=oi(re,rt,$+Ve,$+vi,0,ct.minX,ct.maxX,be),re=null,ti&&(_e=oi(ti,rt,ne-kt,ne+Sn,1,ct.minY,ct.maxY,be),qe=oi(ti,rt,ne+Ve,ne+vi,1,ct.minY,ct.maxY,be),ti=null),Jt&&(pt=oi(Jt,rt,ne-kt,ne+Sn,1,ct.minY,ct.maxY,be),qt=oi(Jt,rt,ne+Ve,ne+vi,1,ct.minY,ct.maxY,be),Jt=null),Re>1&&console.timeEnd("clipping"),Pe.push(_e||[],N+1,2*$,2*ne),Pe.push(qe||[],N+1,2*$,2*ne+1),Pe.push(pt||[],N+1,2*$+1,2*ne),Pe.push(qt||[],N+1,2*$+1,2*ne+1)}}},wr.prototype.getTile=function(re,N,$){var ne=this.options,ce=ne.extent,Te=ne.debug;if(re<0||re>24)return null;var Le=1<<re,Pe=Ms(re,N=(N%Le+Le)%Le,$);if(this.tiles[Pe])return ps(this.tiles[Pe],ce);Te>1&&console.log("drilling down to z%d-%d-%d",re,N,$);for(var be,Re=re,rt=N,wt=$;!be&&Re>0;)Re--,rt=Math.floor(rt/2),wt=Math.floor(wt/2),be=this.tiles[Ms(Re,rt,wt)];return be&&be.source?(Te>1&&console.log("found parent tile z%d-%d-%d",Re,rt,wt),Te>1&&console.time("drilling down"),this.splitTile(be.source,Re,rt,wt,re,N,$),Te>1&&console.timeEnd("drilling down"),this.tiles[Pe]?ps(this.tiles[Pe],ce):null):null};class qn extends s.VectorTileWorkerSource{constructor(N,$,ne,ce,Te){super(N,$,ne,ce,wo),Te&&(this.loadGeoJSON=Te)}loadData(N,$){const ne=N&&N.request,ce=ne&&ne.collectResourceTiming;this.loadGeoJSON(N,(Te,Le)=>{if(Te||!Le)return $(Te);if(typeof Le!="object")return $(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));{R(Le,!0);try{if(N.filter){const be=s.createExpression(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(be.result==="error")throw new Error(be.value.map(rt=>`${rt.key}: ${rt.message}`).join(", "));const Re=Le.features.filter(rt=>be.value.evaluate({zoom:0},rt));Le={type:"FeatureCollection",features:Re}}this._geoJSONIndex=N.cluster?new Ke(function({superclusterOptions:be,clusterProperties:Re}){if(!Re||!be)return be;const rt={},wt={},ct={accumulated:null,zoom:0},jt={properties:null},lt=Object.keys(Re);for(const _e of lt){const[qe,pt]=Re[_e],qt=s.createExpression(pt),ti=s.createExpression(typeof qe=="string"?[qe,["accumulated"],["get",_e]]:qe);rt[_e]=qt.value,wt[_e]=ti.value}return be.map=_e=>{jt.properties=_e;const qe={};for(const pt of lt)qe[pt]=rt[pt].evaluate(ct,jt);return qe},be.reduce=(_e,qe)=>{jt.properties=qe;for(const pt of lt)ct.accumulated=_e[pt],_e[pt]=wt[pt].evaluate(ct,jt)},be}(N)).load(Le.features):function(be,Re){return new wr(be,Re)}(Le,N.geojsonVtOptions)}catch(be){return $(be)}this.loaded={};const Pe={};if(ce){const be=s.getPerformanceMeasurement(ne);be&&(Pe.resourceTiming={},Pe.resourceTiming[N.source]=JSON.parse(JSON.stringify(be)))}$(null,Pe)}})}reloadTile(N,$){const ne=this.loaded;return ne&&ne[N.uid]?super.reloadTile(N,$):this.loadTile(N,$)}loadGeoJSON(N,$){if(N.request)s.getJSON(N.request,$);else{if(typeof N.data!="string")return $(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`));try{return $(null,JSON.parse(N.data))}catch{return $(new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(N,$){try{$(null,this._geoJSONIndex.getClusterExpansionZoom(N.clusterId))}catch(ne){$(ne)}}getClusterChildren(N,$){try{$(null,this._geoJSONIndex.getChildren(N.clusterId))}catch(ne){$(ne)}}getClusterLeaves(N,$){try{$(null,this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset))}catch(ne){$(ne)}}}class ms{constructor(N){this.self=N,this.actor=new s.Actor(N,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:qn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=($,ne)=>{if(this.workerSourceTypes[$])throw new Error(`Worker source with name "${$}" already registered.`);this.workerSourceTypes[$]=ne},this.self.registerRTLTextPlugin=$=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=$.applyArabicShaping,s.plugin.processBidirectionalText=$.processBidirectionalText,s.plugin.processStyledBidirectionalText=$.processStyledBidirectionalText}}clearCaches(N,$,ne){delete this.layerIndexes[N],delete this.availableImages[N],delete this.workerSources[N],delete this.demWorkerSources[N],ne()}checkIfReady(N,$,ne){ne()}setReferrer(N,$){this.referrer=$}spriteLoaded(N,$){this.isSpriteLoaded[N]=$;for(const ne in this.workerSources[N]){const ce=this.workerSources[N][ne];for(const Te in ce)ce[Te]instanceof s.VectorTileWorkerSource&&(ce[Te].isSpriteLoaded=$,ce[Te].fire(new s.Event("isSpriteLoaded")))}}setImages(N,$,ne){this.availableImages[N]=$;for(const ce in this.workerSources[N]){const Te=this.workerSources[N][ce];for(const Le in Te)Te[Le].availableImages=$}ne()}enableTerrain(N,$,ne){this.terrain=$,ne()}setProjection(N,$){this.projections[N]=s.getProjection($)}setLayers(N,$,ne){this.getLayerIndex(N).replace($),ne()}updateLayers(N,$,ne){this.getLayerIndex(N).update($.layers,$.removedIds),ne()}loadTile(N,$,ne){const ce=this.enableTerrain?s.extend({enableTerrain:this.terrain},$):$;ce.projection=this.projections[N]||this.defaultProjection,this.getWorkerSource(N,$.type,$.source).loadTile(ce,ne)}loadDEMTile(N,$,ne){const ce=this.enableTerrain?s.extend({buildQuadTree:this.terrain},$):$;this.getDEMWorkerSource(N,$.source).loadTile(ce,ne)}reloadTile(N,$,ne){const ce=this.enableTerrain?s.extend({enableTerrain:this.terrain},$):$;ce.projection=this.projections[N]||this.defaultProjection,this.getWorkerSource(N,$.type,$.source).reloadTile(ce,ne)}abortTile(N,$,ne){this.getWorkerSource(N,$.type,$.source).abortTile($,ne)}removeTile(N,$,ne){this.getWorkerSource(N,$.type,$.source).removeTile($,ne)}removeSource(N,$,ne){if(!this.workerSources[N]||!this.workerSources[N][$.type]||!this.workerSources[N][$.type][$.source])return;const ce=this.workerSources[N][$.type][$.source];delete this.workerSources[N][$.type][$.source],ce.removeSource!==void 0?ce.removeSource($,ne):ne()}loadWorkerSource(N,$,ne){try{this.self.importScripts($.url),ne()}catch(ce){ne(ce.toString())}}syncRTLPluginState(N,$,ne){try{s.plugin.setState($);const ce=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&ce!=null){this.self.importScripts(ce);const Te=s.plugin.isParsed();ne(Te?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ce}`),Te)}}catch(ce){ne(ce.toString())}}getAvailableImages(N){let $=this.availableImages[N];return $||($=[]),$}getLayerIndex(N){let $=this.layerIndexes[N];return $||($=this.layerIndexes[N]=new L),$}getWorkerSource(N,$,ne){return this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][$]||(this.workerSources[N][$]={}),this.workerSources[N][$][ne]||(this.workerSources[N][$][ne]=new this.workerSourceTypes[$]({send:(ce,Te,Le,Pe,be,Re)=>{this.actor.send(ce,Te,Le,N,be,Re)},scheduler:this.actor.scheduler},this.getLayerIndex(N),this.getAvailableImages(N),this.isSpriteLoaded[N])),this.workerSources[N][$][ne]}getDEMWorkerSource(N,$){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][$]||(this.demWorkerSources[N][$]=new k),this.demWorkerSources[N][$]}enforceCacheSizeLimit(N,$){s.enforceCacheSizeLimit($)}getWorkerPerformanceMetrics(N,$,ne){ne(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ms(self)),ms}),f(["./shared"],function(s){function w(p,o){if(Array.isArray(p)){if(!Array.isArray(o)||p.length!==o.length)return!1;for(let u=0;u<p.length;u++)if(!w(p[u],o[u]))return!1;return!0}if(typeof p=="object"&&p!==null&&o!==null){if(typeof o!="object"||Object.keys(p).length!==Object.keys(o).length)return!1;for(const u in p)if(!w(p[u],o[u]))return!1;return!0}return p===o}var C=L;function L(p){return!function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,x,b=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(b);try{x=new Worker(S),g=!0}catch{g=!1}return x&&x.terminate(),URL.revokeObjectURL(S),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var x=g.getContext("2d");if(!x)return!1;var b=x.getImageData(0,0,1,1);return b&&b.width===g.width}()?(k[u=o&&o.failIfMajorPerformanceCaveat]===void 0&&(k[u]=function(g){var x,b=function(S){var A=document.createElement("canvas"),I=Object.create(L.webGLContextAttributes);return I.failIfMajorPerformanceCaveat=S,A.getContext("webgl",I)||A.getContext("experimental-webgl",I)}(g);if(!b)return!1;try{x=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!x||b.isContextLost())&&(b.shaderSource(x,"void main() {}"),b.compileShader(x),b.getShaderParameter(x,b.COMPILE_STATUS)===!0)}(u)),k[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(p)}var k={};function R(p,o,u){const g=s.window.document.createElement(p);return o!==void 0&&(g.className=o),u&&u.appendChild(g),g}function V(p,o,u){const g=s.window.document.createElementNS("http://www.w3.org/2000/svg",p);for(const x of Object.keys(o))g.setAttributeNS(null,x,o[x]);return u&&u.appendChild(g),g}L.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const H=s.window.document&&s.window.document.documentElement.style,J=H&&H.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ue;function j(){H&&J&&(ue=H[J],H[J]="none")}function q(){H&&J&&(H[J]=ue)}function se(p){p.preventDefault(),p.stopPropagation(),s.window.removeEventListener("click",se,!0)}function ge(){s.window.addEventListener("click",se,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",se,!0)},0)}function ie(p,o){const u=p.getBoundingClientRect();return Ae(p,u,o)}function Ie(p,o){const u=p.getBoundingClientRect(),g=[];for(let x=0;x<o.length;x++)g.push(Ae(p,u,o[x]));return g}function ze(p){return s.window.InstallTrigger!==void 0&&p.button===2&&p.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:p.button}function Ae(p,o,u){const g=p.offsetWidth===o.width?1:p.offsetWidth/o.width;return new s.pointGeometry((u.clientX-o.left)*g,(u.clientY-o.top)*g)}function He(p,o){var u=o[0],g=o[1],x=o[2],b=o[3],S=u*b-x*g;return S?(p[0]=b*(S=1/S),p[1]=-g*S,p[2]=-x*S,p[3]=u*S,p):null}function Ce(p){const{userImage:o}=p;return!!(o&&o.render&&o.render())&&(p.data.replace(new Uint8Array(o.data.buffer)),!0)}class Ge extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,callback:g}of this.requestors)this._notify(u,g);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,u){this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let g=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,u){if(!o)return!0;let g=0;for(const x of o){if(x[0]<g||x[1]<x[0]||u<x[1])return!1;g=x[1]}return!0}_validateContent(o,u){return!(o&&(o.length!==4||o[0]<0||u.data.width<o[0]||o[1]<0||u.data.height<o[1]||o[2]<0||u.data.width<o[2]||o[3]<0||u.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,u){u.version=this.images[o].version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,u){let g=!0;if(!this.isLoaded())for(const x of o)this.images[x]||(g=!1);this.isLoaded()||g?this._notify(o,u):this.requestors.push({ids:o,callback:u})}_notify(o,u){const g={};for(const x of o){this.images[x]||this.fire(new s.Event("styleimagemissing",{id:x}));const b=this.images[x];b?g[x]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:s.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,g)}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],g=this.getImage(o);if(!g)return null;if(u&&u.position.version===g.version)return u.position;if(u)u.position.version=g.version;else{const x={w:g.data.width+2,h:g.data.height+2,x:0,y:0},b=new s.ImagePosition(x,g);this.patterns[o]={bin:x,position:b}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const b in this.patterns)o.push(this.patterns[b].bin);const{w:u,h:g}=s.potpack(o),x=this.atlasImage;x.resize({width:u||1,height:g||1});for(const b in this.patterns){const{bin:S}=this.patterns[b],A=S.x+1,I=S.y+1,D=this.images[b].data,O=D.width,U=D.height;s.RGBAImage.copy(D,x,{x:0,y:0},{x:A,y:I},{width:O,height:U}),s.RGBAImage.copy(D,x,{x:0,y:U-1},{x:A,y:I-1},{width:O,height:1}),s.RGBAImage.copy(D,x,{x:0,y:0},{x:A,y:I+U},{width:O,height:1}),s.RGBAImage.copy(D,x,{x:O-1,y:0},{x:A-1,y:I},{width:1,height:U}),s.RGBAImage.copy(D,x,{x:0,y:0},{x:A+O,y:I},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const g=this.images[u];Ce(g)&&this.updateImage(u,g)}}}const De=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(p,o){return function([u,g,x]){const b=s.degToRad(g+90),S=s.degToRad(x);return{x:u*Math.cos(b)*Math.sin(S),y:u*Math.sin(b)*Math.sin(S),z:u*Math.cos(S),azimuthal:g,polar:x}}(p.expression.evaluate(o))}interpolate(p,o,u){return{x:s.number(p.x,o.x,u),y:s.number(p.y,o.y,u),z:s.number(p.z,o.z,u),azimuthal:s.number(p.azimuthal,o.azimuthal,u),polar:s.number(p.polar,o.polar,u)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),We="-transition";class et extends s.Evented{constructor(o){super(),this._transitionable=new s.Transitionable(De),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(s.validateLight,o,u))for(const g in o){const x=o[g];s.endsWith(g,We)?this._transitionable.setTransition(g.slice(0,-We.length),x):this._transitionable.setValue(g,x)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const Gt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),Vt="-transition";class fi extends s.Evented{constructor(o,u){super(),this._transitionable=new s.Transitionable(Gt),this.set(o),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(o){for(const u in o){const g=o[u];s.endsWith(u,Vt)?this._transitionable.setTransition(u.slice(0,-Vt.length),g):this._transitionable.setValue(u,g)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}}function Yt(p,o,u,g){const x=s.smoothstep(45,65,u),[b,S]=_i(p,g),A=s.length(o);let I=1-Math.min(1,Math.exp((A-b)/(S-b)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*x*p.alpha}function _i(p,o){const u=.5/Math.tan(.5*o);return[p.range[0]+u,p.range[1]+u]}const tn=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),Mi="-transition";class yi extends s.Evented{constructor(o,u){super(),this._transitionable=new s.Transitionable(tn),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){const o=this._transform,u=o.projection.name==="globe",g=s.globeToMercatorTransition(o.zoom),x=this.properties.get("range"),b=[.5,3];return{range:u?[s.number(b[0],x[0],g),s.number(b[1],x[1],g)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,u={}){if(!this._validate(s.validateFog,o,u)){for(const g of Object.keys(s.spec.fog))o&&o[g]===void 0&&(o[g]=s.spec.fog[g].default);for(const g in o){const x=o[g];s.endsWith(g,Mi)?this._transitionable.setTransition(g.slice(0,-Mi.length),x):this._transitionable.setValue(g,x)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,o))*u.a}getOpacityAtLatLng(o,u){return this._transform.projection.supportsFog?function(g,x,b){const S=s.MercatorCoordinate.fromLngLat(x),A=b.elevation?b.elevation.getAtPointOrZero(S):0,I=[S.x,S.y,A];return s.transformMat4(I,I,b.mercatorFogMatrix),Yt(g,I,b.pitch,b._fov)}(this.state,o,u):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?_i(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,g){return(!g||g.validate!==!1)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Kt{constructor(o,u){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const g=this.workerPool.acquire(this.id);for(let x=0;x<g.length;x++){const b=new Kt.Actor(g[x],u,this.id);b.name=`Worker ${x}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,u,g){s.asyncAll(this.actors,(x,b)=>{x.send(o,u,b)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function fn(p,o,u){return o*(s.EXTENT/(p.tileSize*Math.pow(2,u-p.tileID.overscaledZ)))}Kt.Actor=s.Actor;class gn{constructor(o,u,g,x){this.screenBounds=o,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(o,u){let g,x;if(o instanceof s.pointGeometry||typeof o[0]=="number"){const b=s.pointGeometry.convert(o);g=[s.pointGeometry.convert(o)],x=u.isPointAboveHorizon(b)}else{const b=s.pointGeometry.convert(o[0]),S=s.pointGeometry.convert(o[1]);g=[b,S],x=s.polygonizeBounds(b,S).every(A=>u.isPointAboveHorizon(A))}return new gn(g,u.getCameraPoint(),x,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],x=s.polygonizeBounds(u,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<g.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?x[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(x[3]=this.cameraPoint)),s.bufferConvexPolygon(x,o)}bufferedCameraGeometryGlobe(o){const u=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],x=s.polygonizeBounds(u,g,o),b=this.cameraPoint.clone();switch(3*((b.y>u.y)+(b.y>g.y))+((b.x>u.x)+(b.x>g.x))){case 0:x[0]=b,x[4]=b.clone();break;case 1:x.splice(1,0,b);break;case 2:x[1]=b;break;case 3:x.splice(4,0,b);break;case 5:x.splice(2,0,b);break;case 6:x[3]=b;break;case 7:x.splice(3,0,b);break;case 8:x[2]=b}return x}containsTile(o,u,g,x=0){const b=o.queryPadding/u._pixelsPerMercatorPixel+1,S=g?this._bufferedCameraMercator(b,u):this._bufferedScreenMercator(b,u);let A=o.tileID.wrap+(S.unwrapped?x:0);const I=S.polygon.map(Q=>s.getTilePoint(o.tileTransform,Q,A));if(!s.polygonIntersectsBox(I,0,0,s.EXTENT,s.EXTENT))return;A=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const D=this.screenGeometryMercator.polygon.map(Q=>s.getTileVec3(o.tileTransform,Q,A)),O=D.map(Q=>new s.pointGeometry(Q[0],Q[1])),U=u.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),W=s.getTileVec3(o.tileTransform,U,A),ee=D.map(Q=>{const X=s.sub(Q,Q,W);return s.normalize(X,X),new s.Ray(W,X)}),K=fn(o,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:ee,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(Y=s.getBounds(I),Y.min.x=s.clamp(Y.min.x,0,s.EXTENT),Y.min.y=s.clamp(Y.min.y,0,s.EXTENT),Y.max.x=s.clamp(Y.max.x,0,s.EXTENT),Y.max.y=s.clamp(Y.max.y,0,s.EXTENT),Y),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:K};var Y}_bufferedScreenMercator(o,u){const g=Pt(o);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),u):{polygon:this.bufferedScreenGeometry(o).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[g]=x,x}}_bufferedCameraMercator(o,u){const g=Pt(o);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),u):{polygon:this.bufferedCameraGeometry(o).map(b=>u.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[g]=x,x}}_projectAndResample(o,u){const g=function(b,S){const A=s.multiply([],S.pixelMatrix,S.globeMatrix),I=[0,-s.GLOBE_RADIUS,0,1],D=[0,s.GLOBE_RADIUS,0,1],O=[0,0,0,1];s.transformMat4$1(I,I,A),s.transformMat4$1(D,D,A),s.transformMat4$1(O,O,A);const U=new s.pointGeometry(I[0]/I[3],I[1]/I[3]),W=new s.pointGeometry(D[0]/D[3],D[1]/D[3]),ee=s.polygonContainsPoint(b,U)&&I[3]<O[3],K=s.polygonContainsPoint(b,W)&&D[3]<O[3];if(!ee&&!K)return null;const Y=function(we,ve,Me){for(let Oe=1;Oe<we.length;Oe++){const ht=Ke(ve.pointCoordinate3D(we[Oe-1]).x),ke=Ke(ve.pointCoordinate3D(we[Oe]).x);if(Me<0){if(ht<ke)return{idx:Oe,t:-ht/(ke-1-ht)}}else if(ke<ht)return{idx:Oe,t:(1-ht)/(ke+1-ht)}}return null}(b,S,ee?-1:1);if(!Y)return null;const{idx:Q,t:X}=Y;let ae=Q>1?xn(b.slice(0,Q),S):[],te=Q<b.length?xn(b.slice(Q),S):[];ae=ae.map(we=>new s.pointGeometry(Ke(we.x),we.y)),te=te.map(we=>new s.pointGeometry(Ke(we.x),we.y));const Ee=[...ae];Ee.length===0&&Ee.push(te[te.length-1]);const xe=s.number(Ee[Ee.length-1].y,(te.length===0?ae[0]:te[0]).y,X);let pe;return pe=ee?[new s.pointGeometry(0,xe),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,xe)]:[new s.pointGeometry(1,xe),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,xe)],Ee.push(...pe),te.length===0?Ee.push(ae[0]):Ee.push(...te),{polygon:Ee.map(we=>new s.MercatorCoordinate(we.x,we.y)),unwrapped:!1}}(o,u);if(g)return g;const x=function(b,S){let A=!1,I=-1/0,D=0;for(let U=0;U<b.length-1;U++)b[U].x>I&&(I=b[U].x,D=U);for(let U=0;U<b.length-1;U++){const W=(D+U)%(b.length-1),ee=b[W],K=b[W+1];Math.abs(ee.x-K.x)>.5&&(ee.x<K.x?(ee.x+=1,W===0&&(b[b.length-1].x+=1)):(K.x+=1,W+1===b.length-1&&(b[0].x+=1)),A=!0)}const O=s.mercatorXfromLng(S.center.lng);return A&&O<Math.abs(O-1)&&b.forEach(U=>{U.x-=1}),{polygon:b,unwrapped:A}}(xn(o,u).map(b=>new s.pointGeometry(Ke(b.x),b.y)),u);return{polygon:x.polygon.map(b=>new s.MercatorCoordinate(b.x,b.y)),unwrapped:x.unwrapped}}}function xn(p,o){return s.resample(p,u=>{const g=o.pointCoordinate3D(u);u.x=g.x,u.y=g.y},1/256)}function Ke(p){return p<0?1+p%1:p%1}function Pt(p){return 100*p|0}function Mt(p,o,u,g,x){const b=function(S,A){if(S)return x(S);if(A){const I=s.pick(s.extend(A,p),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);A.vector_layers&&(I.vectorLayers=A.vector_layers,I.vectorLayerIds=I.vectorLayers.map(D=>D.id)),A.language_options&&(I.languageOptions=A.language_options),A.language&&A.language[A.id]&&(I.language=A.language[A.id]),A.worldview_options&&(I.worldviewOptions=A.worldview_options),A.worldview?I.worldview=A.worldview[A.id]:A.worldview_default&&(I.worldview=A.worldview_default),I.tiles=o.canonicalizeTileset(I,p.url),x(null,I)}};return p.url?s.getJSON(o.transformRequest(o.normalizeSourceURL(p.url,null,u,g),s.ResourceType.Source),b):s.exported.frame(()=>b(null,p))}class Lt{constructor(o,u,g){this.bounds=s.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),g=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*u),x=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*u),S=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*u);return o.x>=g&&o.x<b&&o.y>=x&&o.y<S}}class li{constructor(o,u,g){this.context=o;const x=o.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(g),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ai={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class he{constructor(o,u,g,x){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.context=o;const b=o.gl;this.buffer=b.createBuffer(),o.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let g=0;g<this.attributes.length;g++){const x=u.attributes[this.attributes[g].name];x!==void 0&&o.enableVertexAttribArray(x)}}setVertexAttribPointers(o,u,g){for(let x=0;x<this.attributes.length;x++){const b=this.attributes[x],S=u.attributes[b.name];S!==void 0&&o.vertexAttribPointer(S,b.components,o[Ai[b.type]],!1,this.itemSize,b.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class de{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ne extends de{getDefault(){return s.Color.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class at extends de{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Ye extends de{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class gt extends de{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class It extends de{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class tt extends de{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class xt extends de{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class ut extends de{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Ot extends de{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class Dt extends de{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class $t extends de{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class Zt extends de{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class ci extends de{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class oi extends de{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class ui extends de{getDefault(){return s.Color.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class bi extends de{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class nn extends de{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class Zi extends de{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Gn extends de{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class ur extends de{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class fs extends de{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Xi extends de{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Mn extends de{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class ps extends de{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class pn extends de{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class $r extends de{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Ha extends de{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class jr extends de{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class wr extends de{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Ms extends de{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class wo extends de{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class qn extends de{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class ms extends qn{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class re extends qn{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class N extends re{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ${constructor(o,u,g,x){this.context=o,this.width=u,this.height=g;const b=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new ms(o,b),x&&(this.depthAttachment=new re(o,b))}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const g=this.depthAttachment.get();g&&o.deleteRenderbuffer(g)}o.deleteFramebuffer(this.framebuffer)}}class ne{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ne(this),this.clearDepth=new at(this),this.clearStencil=new Ye(this),this.colorMask=new gt(this),this.depthMask=new It(this),this.stencilMask=new tt(this),this.stencilFunc=new xt(this),this.stencilOp=new ut(this),this.stencilTest=new Ot(this),this.depthRange=new Dt(this),this.depthTest=new $t(this),this.depthFunc=new Zt(this),this.blend=new ci(this),this.blendFunc=new oi(this),this.blendColor=new ui(this),this.blendEquation=new bi(this),this.cullFace=new nn(this),this.cullFaceSide=new Zi(this),this.frontFace=new Gn(this),this.program=new ur(this),this.activeTexture=new fs(this),this.viewport=new Xi(this),this.bindFramebuffer=new Mn(this),this.bindRenderbuffer=new ps(this),this.bindTexture=new pn(this),this.bindVertexBuffer=new $r(this),this.bindElementBuffer=new Ha(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new jr(this),this.pixelStoreUnpack=new wr(this),this.pixelStoreUnpackPremultiplyAlpha=new Ms(this),this.pixelStoreUnpackFlipY=new wo(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new li(this,o,u)}createVertexBuffer(o,u,g){return new he(this,o,u,g)}createRenderbuffer(o,u,g){const x=this.gl,b=x.createRenderbuffer();return this.bindRenderbuffer.set(b),x.renderbufferStorage(x.RENDERBUFFER,o,u,g),this.bindRenderbuffer.set(null),b}createFramebuffer(o,u,g){return new $(this,o,u,g)}clear({color:o,depth:u,stencil:g}){const x=this.gl;let b=0;o&&(b|=x.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(b|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(b|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),x.clear(b)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){w(o.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ce extends s.Evented{constructor(o,u,g,x){super(),this.id=o,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},u),s.extend(this,s.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Mt(this._options,this.map._requestManager,null,null,(o,u)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new s.ErrorEvent(o)):u&&(s.extend(this,u),u.bounds&&(this.tileBounds=new Lt(u.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(u.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,u){const g=s.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);o.request=s.getImage(this.map._requestManager.transformRequest(x,s.ResourceType.Tile),(b,S,A,I)=>(delete o.request,o.aborted?(o.state="unloaded",u(null)):b?(o.state="errored",u(b)):S?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:A,expires:I}),o.setTexture(S,this.map.painter),o.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void u(null)):u(null)))}static loadTileData(o,u,g){o.setTexture(u,g)}static unloadTileData(o,u){o.texture&&u.saveTileTexture(o.texture)}abortTile(o,u){o.request&&(o.request.cancel(),delete o.request),u()}unloadTile(o,u){o.texture&&this.map.painter.saveTileTexture(o.texture),u()}hasTransition(){return!1}}let Te;function Le(p,o,u,g,x,b,S,A){const I=[p,u,x,o,g,b,1,1,1],D=[S,A,1],O=s.adjoint([],I),[U,W,ee]=s.transformMat3(D,D,s.transpose(O,O));return s.multiply$1(I,[U,0,0,0,W,0,0,0,ee],I)}class Pe extends s.Evented{constructor(o,u,g,x){super(),this.id=o,this.dispatcher=g,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=u}load(o,u){this._loaded=u||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(g,x)=>{if(this._loaded=!0,g)this.fire(new s.ErrorEvent(g));else if(x){const{HTMLImageElement:b}=s.window;this.image=x instanceof b?s.exported.getImageData(x):x,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const u=o.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(g){let x=1/0,b=1/0,S=-1/0,A=-1/0;for(const U of g)x=Math.min(x,U.x),b=Math.min(b,U.y),S=Math.max(S,U.x),A=Math.max(A,U.y);const I=Math.max(S-x,A-b),D=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),O=Math.pow(2,D);return new s.CanonicalTileID(D,Math.floor((x+S)/2*O),Math.floor((b+A)/2*O))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const I in this.tiles){const D=this.tiles[I];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}if(this._boundsArray)return;const u=s.tileTransform(this.tileID,this.map.transform.projection),[g,x,b,S]=this.coordinates.map(I=>{const D=u.projection.project(I[0],I[1]);return s.getTilePoint(u,D)._round()});this.perspectiveTransform=function(I,D,O,U,W,ee,K,Y,Q,X){const ae=Le(0,0,I,0,0,D,I,D),te=Le(O,U,W,ee,K,Y,Q,X);return s.multiply$1(te,s.adjoint(ae,ae),te),[te[6]/te[8]*I/s.EXTENT,te[7]/te[8]*D/s.EXTENT]}(this.width,this.height,g.x,g.y,x.x,x.y,S.x,S.y,b.x,b.y);const A=this._boundsArray=new s.StructArrayLayout4i8;A.emplaceBack(g.x,g.y,0,0),A.emplaceBack(x.x,x.y,s.EXTENT,0),A.emplaceBack(S.x,S.y,0,s.EXTENT),A.emplaceBack(b.x,b.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(A,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,u=o.gl;this.texture?this.texture.update(this.image):(this.texture=new s.Texture(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._prepareData(o)}loadTile(o,u){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},u(null)):(o.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const be={vector:class extends s.Evented{constructor(p,o,u,g){if(super(),this.id=p,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(o,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(g),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(p){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const o=this.language||this.map._language,u=this.worldview||this.map._worldview;this._tileJSONRequest=Mt(this._options,this.map._requestManager,o,u,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,g?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code. Found: ${o}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new s.ErrorEvent(g))):x&&(s.extend(this,x),x.bounds&&(this.tileBounds=new Lt(x.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(x.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),p&&p(g)})}loaded(){return this._loaded}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}onAdd(p){this.map=p,this.load()}setSourceProperty(p){this._tileJSONRequest&&this._tileJSONRequest.cancel(),p(),this.load(()=>{const o=this.map.style._getSourceCaches(this.id);for(const u of o)u.clearTiles()})}setTiles(p){return this.setSourceProperty(()=>{this._options.tiles=p}),this}setUrl(p){return this.setSourceProperty(()=>{this.url=p,this._options.url=p}),this}_setLanguage(p){return p===this.language||this.setSourceProperty(()=>{this.language=p}),this}_setWorldview(p){return p===this.worldview?this:this.worldviewOptions&&p&&!this.worldviewOptions[p]?(console.warn(`Vector tile source "${this.id}" does not support worldview "${p}".`),this):(this.setSourceProperty(()=>{this.worldview=p}),this)}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}loadTile(p,o){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(u,s.ResourceType.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:p.isSymbolTile};if(g.request.collectResourceTiming=this._collectResourceTiming,p.actor&&p.state!=="expired")p.state==="loading"?p.reloadCallback=o:p.request=p.actor.send("reloadTile",g,x.bind(this));else if(p.actor=this._tileWorkers[u]=this._tileWorkers[u]||this.dispatcher.getActor(),this.dispatcher.ready)p.request=p.actor.send("loadTile",g,x.bind(this),void 0,!0);else{const b=s.loadVectorTile.call({deduped:this._deduped},g,(S,A)=>{S||!A?x.call(this,S):(g.data={cacheControl:A.cacheControl,expires:A.expires,rawData:A.rawData.slice(0)},p.actor&&p.actor.send("loadTile",g,x.bind(this),void 0,!0))},!0);p.request={cancel:b}}function x(b,S){return delete p.request,p.aborted?o(null):b&&b.status!==404?o(b):(S&&S.resourceTiming&&(p.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&p.setExpiryData(S),p.loadVectorData(S,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),o(null),void(p.reloadCallback&&(this.loadTile(p,p.reloadCallback),p.reloadCallback=null)))}}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.actor&&p.actor.send("abortTile",{uid:p.uid,type:this.type,source:this.id})}unloadTile(p){p.unloadVectorData(),p.actor&&p.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:ce,"raster-dem":class extends ce{constructor(p,o,u,g){super(p,o,u,g),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(p,o){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(x,b){x&&(p.state="errored",o(x)),b&&(p.dem=b,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",o(null))}p.request=s.getImage(this.map._requestManager.transformRequest(u,s.ResourceType.Tile),function(x,b,S,A){if(delete p.request,p.aborted)p.state="unloaded",o(null);else if(x)p.state="errored",o(x);else if(b){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:S,expires:A});const I=s.window.ImageBitmap&&b instanceof s.window.ImageBitmap&&(Te==null&&(Te=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),Te),D=1-(b.width-s.prevPowerOfTwo(b.width))/2;D<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const O=I?b:s.exported.getImageData(b,D),U={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:D};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",U,g.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(p){const o=p.canonical,u=Math.pow(2,o.z),g=(o.x-1+u)%u,x=o.x===0?p.wrap-1:p.wrap,b=(o.x+1+u)%u,S=o.x+1===u?p.wrap+1:p.wrap,A={};return A[new s.OverscaledTileID(p.overscaledZ,x,o.z,g,o.y).key]={backfilled:!1},A[new s.OverscaledTileID(p.overscaledZ,S,o.z,b,o.y).key]={backfilled:!1},o.y>0&&(A[new s.OverscaledTileID(p.overscaledZ,x,o.z,g,o.y-1).key]={backfilled:!1},A[new s.OverscaledTileID(p.overscaledZ,p.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},A[new s.OverscaledTileID(p.overscaledZ,S,o.z,b,o.y-1).key]={backfilled:!1}),o.y+1<u&&(A[new s.OverscaledTileID(p.overscaledZ,x,o.z,g,o.y+1).key]={backfilled:!1},A[new s.OverscaledTileID(p.overscaledZ,p.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},A[new s.OverscaledTileID(p.overscaledZ,S,o.z,b,o.y+1).key]={backfilled:!1}),A}unloadTile(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded"}},geojson:class extends s.Evented{constructor(p,o,u,g){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(g),this._data=o.data,this._options=s.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const x=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*x,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*x,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*x,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}getClusterExpansionZoom(p,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},o),this}getClusterChildren(p,o){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},o),this}getClusterLeaves(p,o,u,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:o,offset:u},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const p=s.extend({},this.workerOptions),o=this._data;typeof o=="string"?(p.request=this.map._requestManager.transformRequest(s.exported.resolveURL(o),s.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,p,(u,g)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new s.ErrorEvent(u));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(x.resourceTiming=g.resourceTiming[this.id]),this.fire(new s.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(p,o){const u=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(u,{type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(g,x)=>(delete p.request,p.unloadVectorData(),p.aborted?o(null):g?o(g):(p.loadVectorData(x,this.map.painter,u==="reloadTile"),o(null))),void 0,u==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Pe{constructor(p,o,u,g){super(p,o,u,g),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const o of p.urls)this.urls.push(this.map._requestManager.transformRequest(o,s.ResourceType.Source).url);s.getVideo(this.urls,(o,u)=>{this._loaded=!0,o?this.fire(new s.ErrorEvent(o)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const o=this.video.seekable;p<o.start(0)||p>o.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,o=p.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(p,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Pe,canvas:class extends Pe{constructor(p,o,u,g){super(p,o,u,g),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(b=>typeof b!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends s.Evented{constructor(p,o,u,g){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=o,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Lt(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this._map=p,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:o,y:u,z:g}=p.canonical;return this._implementation.hasTile({x:o,y:u,z:g})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,o){const{x:u,y:g,z:x}=p.tileID.canonical,b=new s.window.AbortController,S=this._implementation.loadTile({x:u,y:g,z:x},{signal:b.signal});if(!S)return this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",o(null);S.cancel=()=>b.abort(),p.request=S.then(function(A){return delete p.request,p.aborted?(p.state="unloaded",o(null)):A?function(I){return I instanceof s.window.ImageData||I instanceof s.window.ImageBitmap||I instanceof s.window.HTMLCanvasElement}(A)?(this.loadTileData(p,A),p.state="loaded",void o(null)):(p.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",o(null))}.bind(this)).catch(A=>{A.code!==20&&(p.state="errored",o(A))})}loadTileData(p,o){ce.loadTileData(p,o,this._map.painter)}unloadTileData(p){ce.unloadTileData(p,this._map.painter)}prepareTile(p){if(!this._implementation.prepareTile)return null;const{x:o,y:u,z:g}=p.tileID.canonical,x=this._implementation.prepareTile({x:o,y:u,z:g});return x?(this.loadTileData(p,x),p.state="loaded",x):null}unloadTile(p,o){if(this.unloadTileData(p),this._implementation.unloadTile){const{x:u,y:g,z:x}=p.tileID.canonical;this._implementation.unloadTile({x:u,y:g,z:x})}o()}abortTile(p,o){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Re=function(p,o,u,g){const x=new be[o.type](p,o,u,g);if(x.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${x.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],x),x};function rt(p,o){const u=s.identity([]);return s.scale(u,u,[.5*p.width,.5*-p.height,1]),s.translate(u,u,[1,-1,0]),s.multiply(u,u,p.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(u)}function wt(p,o,u,g,x,b,S,A=!1){const I=p.tilesIn(g,S,A);I.sort(jt);const D=[];for(const U of I)D.push({wrappedTileID:U.tile.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(o,u,p._state,U,x,b,rt(p.transform,U.tile.tileID),A)});const O=function(U){const W={},ee={};for(const K of U){const Y=K.queryResults,Q=K.wrappedTileID,X=ee[Q]=ee[Q]||{};for(const ae in Y){const te=Y[ae],Ee=X[ae]=X[ae]||{},xe=W[ae]=W[ae]||[];for(const pe of te)Ee[pe.featureIndex]||(Ee[pe.featureIndex]=!0,xe.push(pe))}}return W}(D);for(const U in O)O[U].forEach(W=>{const ee=W.feature,K=ee.layer;K&&K.type!=="background"&&K.type!=="sky"&&(ee.source=K.source,K["source-layer"]&&(ee.sourceLayer=K["source-layer"]),ee.state=ee.id!==void 0?p.getFeatureState(K["source-layer"],ee.id):{})});return O}function ct(p,o){const u=p.getRenderableIds().map(b=>p.getTileByID(b)),g=[],x={};for(let b=0;b<u.length;b++){const S=u[b],A=S.tileID.canonical.key;x[A]||(x[A]=!0,S.querySourceFeatures(g,o))}return g}function jt(p,o){const u=p.tileID,g=o.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function lt(){return wl.workerClass!=null?new wl.workerClass:new s.window.Worker(wl.workerUrl)}const _e="mapboxgl_preloaded_worker_pool";class qe{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<qe.workerCount;)this.workers.push(new lt);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_e]}numActive(){return Object.keys(this.active).length}}let pt;function qt(){return pt||(pt=new qe),pt}function ti(p,o){const u={};for(const g in p)g!=="ref"&&(u[g]=p[g]);return s.refProperties.forEach(g=>{g in o&&(u[g]=o[g])}),u}function Jt(p){p=p.slice();const o=Object.create(null);for(let u=0;u<p.length;u++)o[p[u].id]=p[u];for(let u=0;u<p.length;u++)"ref"in p[u]&&(p[u]=ti(p[u],o[p[u].ref]));return p}qe.workerCount=2;const kt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ve(p,o,u){u.push({command:kt.addSource,args:[p,o[p]]})}function Sn(p,o,u){o.push({command:kt.removeSource,args:[p]}),u[p]=!0}function vi(p,o,u,g){Sn(p,u,g),Ve(p,o,u)}function Gr(p,o,u){let g;for(g in p[u])if(p[u].hasOwnProperty(g)&&g!=="data"&&!w(p[u][g],o[u][g]))return!1;for(g in o[u])if(o[u].hasOwnProperty(g)&&g!=="data"&&!w(p[u][g],o[u][g]))return!1;return!0}function To(p,o,u,g,x,b){let S;for(S in o=o||{},p=p||{})p.hasOwnProperty(S)&&(w(p[S],o[S])||u.push({command:b,args:[g,S,o[S],x]}));for(S in o)o.hasOwnProperty(S)&&!p.hasOwnProperty(S)&&(w(p[S],o[S])||u.push({command:b,args:[g,S,o[S],x]}))}function qr(p){return p.id}function lc(p,o){return p[o.id]=o,p}class c_{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=s.clamp(o,0,1);let u=1,g=this._distances[u];const x=o*this.paddedLength+this.padding;for(;g<x&&u<this._distances.length;)g=this._distances[++u];const b=u-1,S=this._distances[b],A=g-S,I=A>0?(x-S)/A:0;return this.points[b].mult(1-I).add(this.points[u].mult(I))}}class Ko{constructor(o,u,g){const x=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(u/g);for(let S=0;S<this.xCellCount*this.yCellCount;S++)x.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,g,x,b){this._forEachCell(u,g,x,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(b)}insertCircle(o,u,g,x){this._forEachCell(u-x,g-x,u+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(g),this.circles.push(x)}_insertBoxCell(o,u,g,x,b,S){this.boxCells[b].push(S)}_insertCircleCell(o,u,g,x,b,S){this.circleCells[b].push(S)}_query(o,u,g,x,b,S){if(g<0||o>this.width||x<0||u>this.height)return!b&&[];const A=[];if(o<=0&&u<=0&&this.width<=g&&this.height<=x){if(b)return!0;for(let I=0;I<this.boxKeys.length;I++)A.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const D=this.circles[3*I],O=this.circles[3*I+1],U=this.circles[3*I+2];A.push({key:this.circleKeys[I],x1:D-U,y1:O-U,x2:D+U,y2:O+U})}return S?A.filter(S):A}return this._forEachCell(o,u,g,x,this._queryCell,A,{hitTest:b,seenUids:{box:{},circle:{}}},S),b?A.length>0:A}_queryCircle(o,u,g,x,b){const S=o-g,A=o+g,I=u-g,D=u+g;if(A<0||S>this.width||D<0||I>this.height)return!x&&[];const O=[];return this._forEachCell(S,I,A,D,this._queryCellCircle,O,{hitTest:x,circle:{x:o,y:u,radius:g},seenUids:{box:{},circle:{}}},b),x?O.length>0:O}query(o,u,g,x,b){return this._query(o,u,g,x,!1,b)}hitTest(o,u,g,x,b){return this._query(o,u,g,x,!0,b)}hitTestCircle(o,u,g,x){return this._queryCircle(o,u,g,!0,x)}_queryCell(o,u,g,x,b,S,A,I){const D=A.seenUids,O=this.boxCells[b];if(O!==null){const W=this.bboxes;for(const ee of O)if(!D.box[ee]){D.box[ee]=!0;const K=4*ee;if(o<=W[K+2]&&u<=W[K+3]&&g>=W[K+0]&&x>=W[K+1]&&(!I||I(this.boxKeys[ee]))){if(A.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[ee],x1:W[K],y1:W[K+1],x2:W[K+2],y2:W[K+3]})}}}const U=this.circleCells[b];if(U!==null){const W=this.circles;for(const ee of U)if(!D.circle[ee]){D.circle[ee]=!0;const K=3*ee;if(this._circleAndRectCollide(W[K],W[K+1],W[K+2],o,u,g,x)&&(!I||I(this.circleKeys[ee]))){if(A.hitTest)return S.push(!0),!0;{const Y=W[K],Q=W[K+1],X=W[K+2];S.push({key:this.circleKeys[ee],x1:Y-X,y1:Q-X,x2:Y+X,y2:Q+X})}}}}}_queryCellCircle(o,u,g,x,b,S,A,I){const D=A.circle,O=A.seenUids,U=this.boxCells[b];if(U!==null){const ee=this.bboxes;for(const K of U)if(!O.box[K]){O.box[K]=!0;const Y=4*K;if(this._circleAndRectCollide(D.x,D.y,D.radius,ee[Y+0],ee[Y+1],ee[Y+2],ee[Y+3])&&(!I||I(this.boxKeys[K])))return S.push(!0),!0}}const W=this.circleCells[b];if(W!==null){const ee=this.circles;for(const K of W)if(!O.circle[K]){O.circle[K]=!0;const Y=3*K;if(this._circlesCollide(ee[Y],ee[Y+1],ee[Y+2],D.x,D.y,D.radius)&&(!I||I(this.circleKeys[K])))return S.push(!0),!0}}}_forEachCell(o,u,g,x,b,S,A,I){const D=this._convertToXCellCoord(o),O=this._convertToYCellCoord(u),U=this._convertToXCellCoord(g),W=this._convertToYCellCoord(x);for(let ee=D;ee<=U;ee++)for(let K=O;K<=W;K++)if(b.call(this,o,u,g,x,this.xCellCount*K+ee,S,A,I))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,g,x,b,S){const A=x-o,I=b-u,D=g+S;return D*D>A*A+I*I}_circleAndRectCollide(o,u,g,x,b,S,A){const I=(S-x)/2,D=Math.abs(o-(x+I));if(D>I+g)return!1;const O=(A-b)/2,U=Math.abs(u-(b+O));if(U>O+g)return!1;if(D<=I||U<=O)return!0;const W=D-I,ee=U-O;return W*W+ee*ee<=g*g}}const Et=Math.tan(85*Math.PI/180);function hi(p,o,u,g,x,b,S){const A=s.create();if(u)if(b.name==="globe"){const I=s.calculateGlobeLabelMatrix(x,o);s.multiply(A,A,I)}else{const I=He([],S);A[0]=I[0],A[1]=I[1],A[4]=I[2],A[5]=I[3],g||s.rotateZ(A,A,x.angle)}else s.multiply(A,x.labelPlaneMatrix,p);return A}function di(p,o,u,g,x,b,S){const A=hi(p,o,u,g,x,b,S);return b.name==="globe"&&u||(A[2]=A[6]=A[10]=A[14]=0),A}function Wr(p,o,u,g,x,b,S){if(u){if(b.name==="globe"){const A=hi(p,o,u,g,x,b,S);return s.invert(A,A),s.multiply(A,p,A),A}{const A=s.clone(p),I=s.identity([]);return I[0]=S[0],I[1]=S[1],I[4]=S[2],I[5]=S[3],s.multiply(A,A,I),g||s.rotateZ(A,A,-x.angle),A}}return x.glCoordMatrix}function Hr(p,o,u=0){const g=[p.x,p.y,u,1];u?s.transformMat4$1(g,g,o):ir(g,g,o);const x=g[3];return{point:[g[0]/x,g[1]/x,g[2]/x],signedDistanceFromCamera:x}}function ii(p,o){const u=[p[0],p[1],p[2],1];s.transformMat4$1(u,u,o);const g=u[3];return{point:[u[0]/g,u[1]/g,u[2]/g],signedDistanceFromCamera:g}}function Za(p,o){return Math.min(.5+p/o*.5,1.5)}function Xa(p,o){const u=p[0]/p[3],g=p[1]/p[3];return u>=-o[0]&&u<=o[0]&&g>=-o[1]&&g<=o[1]}function Ka(p,o,u,g,x,b,S,A,I,D){const O=u.transform,U=g?p.textSizeData:p.iconSizeData,W=s.evaluateSizeForZoom(U,u.transform.zoom),ee=O.projection.name==="globe",K=[256/u.width*2+1,256/u.height*2+1],Y=g?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;Y.clear();let Q=null;ee&&(Q=g?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const X=p.lineVertexArray,ae=g?p.text.placedSymbolArray:p.icon.placedSymbolArray,te=u.transform.width/u.transform.height;let Ee=!1;for(let xe=0;xe<ae.length;xe++){const pe=ae.get(xe);if(pe.writingMode!==s.WritingMode.vertical||Ee||xe!==0&&ae.get(xe-1).writingMode===s.WritingMode.horizontal||(Ee=!0),(pe.hidden||pe.writingMode===s.WritingMode.vertical)&&!Ee){Ys(pe.numGlyphs,Y);continue}Ee=!1;const we=new s.pointGeometry(pe.tileAnchorX,pe.tileAnchorY),ve=I?I(we):[0,0,0],Me=O.projection.projectTilePoint(we.x,we.y,D.canonical),Oe=[Me.x+ve[0],Me.y+ve[1],Me.z+ve[2]],ht=[...Oe,1];if(s.transformMat4$1(ht,ht,o),!Xa(ht,K)){Ys(pe.numGlyphs,Y);continue}const ke=Za(u.transform.cameraToCenterDistance,ht[3]),Xe=s.evaluateSizeForFeature(U,W,pe),nt=S?Xe/ke:Xe*ke,_t=Hr(new s.pointGeometry(Oe[0],Oe[1]),x,Oe[2]);if(_t.signedDistanceFromCamera<=0){Ys(pe.numGlyphs,Y);continue}let je={};const ft=S?null:I,it=Rf(pe,nt,!1,A,o,x,b,p.glyphOffsetArray,X,Y,Q,_t.point,we,je,te,ft,O.projection,D,S);Ee=it.useVertical,ft&&it.needsFlipping&&(je={}),(it.notEnoughRoom||Ee||it.needsFlipping&&Rf(pe,nt,!0,A,o,x,b,p.glyphOffsetArray,X,Y,Q,_t.point,we,je,te,ft,O.projection,D,S).notEnoughRoom)&&Ys(pe.numGlyphs,Y)}g?(p.text.dynamicLayoutVertexBuffer.updateData(Y),Q&&p.text.globeExtVertexBuffer.updateData(Q)):(p.icon.dynamicLayoutVertexBuffer.updateData(Y),Q&&p.icon.globeExtVertexBuffer.updateData(Q))}function Tr(p,o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y){const Q=A.glyphStartIndex+A.numGlyphs,X=A.lineStartIndex,ae=A.lineStartIndex+A.lineLength,te=o.getoffsetX(A.glyphStartIndex),Ee=o.getoffsetX(Q-1),xe=Ks(p*te,u,g,x,b,S,A.segment,X,ae,I,D,O,U,W,!0,ee,K,Y);if(!xe)return null;const pe=Ks(p*Ee,u,g,x,b,S,A.segment,X,ae,I,D,O,U,W,!0,ee,K,Y);return pe?{first:xe,last:pe}:null}function an(p,o,u,g){return p.writingMode===s.WritingMode.horizontal&&Math.abs(u.y-o.y)>Math.abs(u.x-o.x)*g?{useVertical:!0}:p.writingMode===s.WritingMode.vertical?o.y<u.y?{needsFlipping:!0}:null:p.flipState!==0&&function(x,b,S){const A=(b.x-x.x)*S;return A===0||Math.abs((b.y-x.y)/A)>Et}(o,u,g)?p.flipState===1?{needsFlipping:!0}:null:o.x>u.x?{needsFlipping:!0}:null}function Rf(p,o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y,Q,X,ae){const te=o/24,Ee=p.lineOffsetX*te,xe=p.lineOffsetY*te;let pe;if(p.numGlyphs>1){const we=p.glyphStartIndex+p.numGlyphs,ve=p.lineStartIndex,Me=p.lineStartIndex+p.lineLength,Oe=Tr(te,A,Ee,xe,u,U,W,p,I,b,ee,Y,!1,Q,X,ae);if(!Oe)return{notEnoughRoom:!0};const ht=ii(Oe.first.point,S).point,ke=ii(Oe.last.point,S).point,Xe=new s.pointGeometry(ht[0],ht[1]),nt=new s.pointGeometry(ke[0],ke[1]);if(g&&!u){const _t=an(p,Xe,nt,K);if(p.flipState=_t&&_t.needsFlipping?1:2,_t)return _t}pe=[Oe.first];for(let _t=p.glyphStartIndex+1;_t<we-1;_t++)pe.push(Ks(te*A.getoffsetX(_t),Ee,xe,u,U,W,p.segment,ve,Me,I,b,ee,Y,!1,!1,Q,X,ae));pe.push(Oe.last)}else{if(g&&!u){const ve=Hr(W,x).point,Me=p.lineStartIndex+p.segment+1,Oe=new s.pointGeometry(I.getx(Me),I.gety(Me)),ht=Hr(Oe,x),ke=ht.signedDistanceFromCamera>0?ht.point:cc(W,Oe,ve,1,x,void 0,Q,X.canonical),Xe=an(p,new s.pointGeometry(ve[0],ve[1]),new s.pointGeometry(ke[0],ke[1]),K);if(p.flipState=Xe&&Xe.needsFlipping?1:2,Xe)return Xe}const we=Ks(te*A.getoffsetX(p.glyphStartIndex),Ee,xe,u,U,W,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,I,b,ee,Y,!1,!1,Q,X,ae);if(!we)return{notEnoughRoom:!0};pe=[we]}if(O)for(const we of pe)s.updateGlobeVertexNormal(O,D.length+0,we.up[0],we.up[1],we.up[2]),s.updateGlobeVertexNormal(O,D.length+1,we.up[0],we.up[1],we.up[2]),s.updateGlobeVertexNormal(O,D.length+2,we.up[0],we.up[1],we.up[2]),s.updateGlobeVertexNormal(O,D.length+3,we.up[0],we.up[1],we.up[2]),s.addDynamicAttributes(D,we.point[0],we.point[1],we.point[2],we.angle);else for(const we of pe)s.addDynamicAttributes(D,we.point[0],we.point[1],we.point[2],we.angle);return{}}function Yo(p,o,u,g,x){const b=g.projectTilePoint(p.x,p.y,o);if(!x)return Hr(b,u,b.z);const S=x(p);return Hr(new s.pointGeometry(b.x+S[0],b.y+S[1]),u,b.z+S[2])}function cc(p,o,u,g,x,b,S,A){const I=Yo(p.add(p.sub(o)._unit()),A,x,S,b).point,D=s.sub([],u,I);return s.scaleAndAdd([],u,D,g/s.length(D))}function Ks(p,o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y,Q,X){const ae=g?p-o:p+o;let te=ae>0?1:-1,Ee=0;g&&(te*=-1,Ee=Math.PI),te<0&&(Ee+=Math.PI);let xe=te>0?A+S:A+S+1,pe=x,we=x,ve=0,Me=0;const Oe=Math.abs(ae),ht=[],ke=[];let Xe=b;const nt=()=>{const Rt=xe-te;return ve===0?b:new s.pointGeometry(D.getx(Rt),D.gety(Rt))},_t=()=>cc(nt(),Xe,we,Oe-ve+1,O,W,Y,Q.canonical);for(;ve+Me<=Oe;){if(xe+=te,xe<A||xe>=I)return null;if(we=pe,ht.push(pe),ee&&ke.push(Xe||nt()),pe=U[xe],pe===void 0){Xe=new s.pointGeometry(D.getx(xe),D.gety(xe));const Rt=Yo(Xe,Q.canonical,O,Y,W);pe=Rt.signedDistanceFromCamera>0?U[xe]=Rt.point:_t()}else Xe=null;ve+=Me,Me=s.distance(we,pe)}Xe=Xe||new s.pointGeometry(D.getx(xe),D.gety(xe));const je=nt();K&&W&&(U[xe]=pe=U[xe]===void 0?pe:_t(),Me=s.distance(we,pe));const ft=(Oe-ve)/Me,it=Xe.sub(je).mult(ft)._add(je),bt=s.sub([],pe,we),vt=s.scaleAndAdd([],we,bt,ft);let zt=[0,0,1],Ut=bt[0],Ht=bt[1];if(X&&(zt=Y.upVector(Q.canonical,it.x,it.y),zt[0]!==0||zt[1]!==0||zt[2]!==1)){const Rt=[1,0,0],Qt=[0,1,0];Rt[0]=zt[2],Rt[1]=0,Rt[2]=-zt[0],s.cross(Qt,zt,Rt),s.normalize(Rt,Rt),s.normalize(Qt,Qt),Ut=s.dot(bt,Rt),Ht=s.dot(bt,Qt)}if(u){const Rt=s.cross([],zt,bt);s.normalize(Rt,Rt),s.scaleAndAdd(vt,vt,Rt,u*te)}const pi=Ee+Math.atan2(Ht,Ut);return ht.push(vt),ee&&ke.push(it),{point:vt,angle:pi,path:ht,tilePath:ke,up:zt}}const Hu=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ys(p,o){for(let u=0;u<p;u++){const g=o.length;o.resize(g+4),o.float32.set(Hu,4*g)}}function ir(p,o,u){const g=o[0],x=o[1];return p[0]=u[0]*g+u[4]*x+u[12],p[1]=u[1]*g+u[5]*x+u[13],p[3]=u[3]*g+u[7]*x+u[15],p}const Fi=100;class Zu{constructor(o,u,g=new Ko(o.width+200,o.height+200,25),x=new Ko(o.width+200,o.height+200,25)){this.transform=o,this.grid=g,this.ignoredGrid=x,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Fi,this.screenBottomBoundary=o.height+Fi,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=u}placeCollisionBox(o,u,g,x,b,S,A,I){let D=g.projectedAnchorX,O=g.projectedAnchorY,U=g.projectedAnchorZ;const W=g.elevation,ee=g.tileID;if(W&&ee){const xe=o.getProjection().upVector(ee.canonical,g.tileAnchorX,g.tileAnchorY),pe=o.getProjection().upVectorScale(ee.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;D+=xe[0]*W*pe,O+=xe[1]*W*pe,U+=xe[2]*W*pe}const K=this.projectAndGetPerspectiveRatio(A,[D,O,U],g.tileID,o.projection.name==="globe"||!!W||this.transform.pitch>0,o.getProjection()),Y=S*K.perspectiveRatio,Q=(g.x1*u+x.x-g.padding)*Y+K.point.x,X=(g.y1*u+x.y-g.padding)*Y+K.point.y,ae=(g.x2*u+x.x+g.padding)*Y+K.point.x,te=(g.y2*u+x.y+g.padding)*Y+K.point.y,Ee=K.perspectiveRatio<=.55||K.occluded;return!this.isInsideGrid(Q,X,ae,te)||!b&&this.grid.hitTest(Q,X,ae,te,I)||Ee?{box:[],offscreen:!1,occluded:K.occluded}:{box:[Q,X,ae,te],offscreen:this.isOffscreen(Q,X,ae,te),occluded:!1}}placeCollisionCircles(o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y){const Q=[],X=this.transform.elevation,ae=X?X.getAtTileOffsetFunc(Y,this.transform.center.lat,this.transform.worldSize,o.getProjection()):je=>[0,0,0],te=new s.pointGeometry(g.tileAnchorX,g.tileAnchorY),Ee=o.getProjection().projectTilePoint(g.tileAnchorX,g.tileAnchorY,Y.canonical),xe=ae(te),pe=[Ee.x+xe[0],Ee.y+xe[1],Ee.z+xe[2]],we=o.projection.name==="globe",ve=this.projectAndGetPerspectiveRatio(A,[pe[0],pe[1],pe[2]],Y,we||!!X||this.transform.pitch>0,o.getProjection()),{perspectiveRatio:Me}=ve,Oe=(U?S/Me:S*Me)/s.ONE_EM,ht=Hr(new s.pointGeometry(pe[0],pe[1]),I,pe[2]).point,ke=ve.signedDistanceFromCamera>0?Tr(Oe,b,g.lineOffsetX*Oe,g.lineOffsetY*Oe,!1,ht,te,g,x,I,{},X&&!U?ae:null,U&&!!X,o.getProjection(),Y,U):null;let Xe=!1,nt=!1,_t=!0;if(ke&&!ve.occluded){const je=.5*ee*Me+K,ft=new s.pointGeometry(-100,-100),it=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),bt=new c_,vt=ke.first,zt=ke.last;let Ut=[];for(let Rt=vt.path.length-1;Rt>=1;Rt--)Ut.push(vt.path[Rt]);for(let Rt=1;Rt<zt.path.length;Rt++)Ut.push(zt.path[Rt]);const Ht=2.5*je;if(D){const Rt=Ut.map(X&&!we?(Qt,Ei)=>{const Ki=ae(Ei<vt.path.length-1?vt.tilePath[vt.path.length-1-Ei]:zt.tilePath[Ei-vt.path.length+2]);return Qt[2]=Ki[2],ii(Qt,D)}:Qt=>ii(Qt,D));Ut=Rt.some(Qt=>Qt.signedDistanceFromCamera<=0)?[]:Rt.map(Qt=>Qt.point)}let pi=[];if(Ut.length>0){const Rt=Ut.map(Bi=>new s.pointGeometry(Bi[0],Bi[1]));let Qt=1/0,Ei=-1/0,Ki=1/0,hn=-1/0;for(let Bi=0;Bi<Rt.length;Bi++)Qt=Math.min(Qt,Rt[Bi].x),Ki=Math.min(Ki,Rt[Bi].y),Ei=Math.max(Ei,Rt[Bi].x),hn=Math.max(hn,Rt[Bi].y);pi=Qt>=ft.x&&Ei<=it.x&&Ki>=ft.y&&hn<=it.y?[Rt]:Ei<ft.x||Qt>it.x||hn<ft.y||Ki>it.y?[]:s.clipLine([Rt],ft.x,ft.y,it.x,it.y)}for(const Rt of pi){bt.reset(Rt,.25*je);let Qt=0;Qt=bt.length<=.5*je?1:Math.ceil(bt.paddedLength/Ht)+1;for(let Ei=0;Ei<Qt;Ei++){const Ki=Ei/Math.max(Qt-1,1),hn=bt.lerp(Ki),Bi=hn.x+Fi,On=hn.y+Fi;Q.push(Bi,On,je,0);const Kr=Bi-je,Ls=On-je,Yi=Bi+je,rn=On+je;if(_t=_t&&this.isOffscreen(Kr,Ls,Yi,rn),nt=nt||this.isInsideGrid(Kr,Ls,Yi,rn),!u&&this.grid.hitTestCircle(Bi,On,je,W)&&(Xe=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Xe,occluded:!1}}}}return{circles:!O&&Xe||!nt?[]:Q,offscreen:_t,collisionDetected:Xe,occluded:ve.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let g=1/0,x=1/0,b=-1/0,S=-1/0;for(const O of o){const U=new s.pointGeometry(O.x+Fi,O.y+Fi);g=Math.min(g,U.x),x=Math.min(x,U.y),b=Math.max(b,U.x),S=Math.max(S,U.y),u.push(U)}const A=this.grid.query(g,x,b,S).concat(this.ignoredGrid.query(g,x,b,S)),I={},D={};for(const O of A){const U=O.key;if(I[U.bucketInstanceId]===void 0&&(I[U.bucketInstanceId]={}),I[U.bucketInstanceId][U.featureIndex])continue;const W=[new s.pointGeometry(O.x1,O.y1),new s.pointGeometry(O.x2,O.y1),new s.pointGeometry(O.x2,O.y2),new s.pointGeometry(O.x1,O.y2)];s.polygonIntersectsPolygon(u,W)&&(I[U.bucketInstanceId][U.featureIndex]=!0,D[U.bucketInstanceId]===void 0&&(D[U.bucketInstanceId]=[]),D[U.bucketInstanceId].push(U.featureIndex))}return D}insertCollisionBox(o,u,g,x,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:x,collisionGroupID:b},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,g,x,b){const S=u?this.ignoredGrid:this.grid,A={bucketInstanceId:g,featureIndex:x,collisionGroupID:b};for(let I=0;I<o.length;I+=4)S.insertCircle(A,o[I],o[I+1],o[I+2])}projectAndGetPerspectiveRatio(o,u,g,x,b){const S=[u[0],u[1],u[2],1];let A=!1;if(u[2]||this.transform.pitch>0){s.transformMat4$1(S,S,o);const I=b.name==="globe";this.fogState&&g&&!I&&(A=function(D,O,U,W,ee,K){const Y=K.calculateFogTileMatrix(ee),Q=[O,U,W];return s.transformMat4(Q,Q,Y),Yt(D,Q,K.pitch,K._fov)}(this.fogState,u[0],u[1],u[2],g.toUnwrapped(),this.transform)>.9)}else ir(S,S,o);return{point:new s.pointGeometry((S[0]/S[3]+1)/2*this.transform.width+Fi,(-S[1]/S[3]+1)/2*this.transform.height+Fi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(b)/S[3]*.5,1.5),signedDistanceFromCamera:S[3],occluded:x&&S[2]>S[3]||A}}isOffscreen(o,u,g,x){return g<Fi||o>=this.screenRightBoundary||x<Fi||u>this.screenBottomBoundary}isInsideGrid(o,u,g,x){return g>=0&&o<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=s.identity([]);return s.translate(o,o,[-100,-100,0]),o}}function Ya(p,o,u){const g=o.createTileMatrix(p,p.worldSize,u.toUnwrapped());return s.multiply(new Float32Array(16),p.projMatrix,g)}function hr(p,o,u){if(o.projection.name===u.projection.name)return p.projMatrix;const g=u.clone();return g.setProjection(o.projection),Ya(g,o.getProjection(),p)}function dr(p,o,u){return o.name===u.projection.name?p.projMatrix:Ya(u,o,p)}class Xu{constructor(o,u,g,x){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Qs{constructor(o,u,g,x,b,S=!1){this.text=new Xu(o?o.text:null,u,g,b),this.icon=new Xu(o?o.icon:null,u,x,b),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _n{constructor(o,u,g,x=!1){this.text=o,this.icon=u,this.skipFade=g,this.clipped=x}}class Qa{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Ku{constructor(o,u,g,x,b){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=b}}class Ja{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[o]}}function In(p,o,u,g,x){const{horizontalAlign:b,verticalAlign:S}=s.getAnchorAlignment(p),A=-(b-.5)*o,I=-(S-.5)*u,D=s.evaluateVariableOffset(p,g);return new s.pointGeometry(A+D[0]*x,I+D[1]*x)}function el(p,o,u,g,x){const b=new s.pointGeometry(p,o);return u&&b._rotate(g?x:-x),b}class Yu{constructor(o,u,g,x,b){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Zu(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Ja(g),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,u,g,x){const b=g.getBucket(u),S=g.latestFeatureIndex;if(!b||!S||u.id!==b.layerIds[0])return;const A=b.layers[0].layout,I=g.collisionBoxArray,D=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),O=g.tileSize/s.EXTENT,U=g.tileID.toUnwrapped();this.transform.setProjection(b.projection);const W=(ee=g.tileID,K=b.getProjection(),Y=this.transform,K.name===this.projection?Y.calculateProjMatrix(ee.toUnwrapped()):Ya(Y,K,ee));var ee,K,Y;const Q=A.get("text-pitch-alignment")==="map",X=A.get("text-rotation-alignment")==="map";u.compileFilter();const ae=u.dynamicFilter(),te=u.dynamicFilterNeedsFeature(),Ee=this.transform.calculatePixelsToTileUnitsMatrix(g),xe=di(W,g.tileID.canonical,Q,X,this.transform,b.getProjection(),Ee);let pe=null;if(Q){const Me=Wr(W,g.tileID.canonical,Q,X,this.transform,b.getProjection(),Ee);pe=s.multiply([],this.transform.labelPlaneMatrix,Me)}let we=null;ae&&g.latestFeatureIndex&&(we={unwrappedTileID:U,dynamicFilter:ae,dynamicFilterNeedsFeature:te,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Ku(b.bucketInstanceId,S,b.sourceLayerIndex,b.index,g.tileID);const ve={bucket:b,layout:A,posMatrix:W,textLabelPlaneMatrix:xe,labelToScreenMatrix:pe,clippingData:we,scale:D,textPixelRatio:O,holdingForFade:g.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(x)for(const Me of b.sortKeyRanges){const{sortKey:Oe,symbolInstanceStart:ht,symbolInstanceEnd:ke}=Me;o.push({sortKey:Oe,symbolInstanceStart:ht,symbolInstanceEnd:ke,parameters:ve})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:ve})}attemptAnchorPlacement(o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y,Q,X,ae){const te=[W.textOffset0,W.textOffset1],Ee=In(o,g,x,te,b),xe=this.collisionIndex.placeCollisionBox(K,b,u,el(Ee.x,Ee.y,S,A,this.transform.angle),U,I,D,O.predicate);if((!Q||this.collisionIndex.placeCollisionBox(K,K.getSymbolInstanceIconSize(ae,this.transform.zoom,ee),Q,el(Ee.x,Ee.y,S,A,this.transform.angle),U,I,D,O.predicate).box.length!==0)&&xe.box.length>0){let pe;return this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(pe=this.prevPlacement.variableOffsets[W.crossTileID].anchor),this.variableOffsets[W.crossTileID]={textOffset:te,width:g,height:x,anchor:o,textScale:b,prevAnchor:pe},this.markUsedJustification(K,o,W,Y),K.allowVerticalPlacement&&(this.markUsedOrientation(K,Y,W),this.placedOrientations[W.crossTileID]=Y),{shift:Ee,placedGlyphBoxes:xe}}}placeLayerBucketPart(o,u,g,x){const{bucket:b,layout:S,posMatrix:A,textLabelPlaneMatrix:I,labelToScreenMatrix:D,clippingData:O,textPixelRatio:U,holdingForFade:W,collisionBoxArray:ee,partiallyEvaluatedTextSize:K,partiallyEvaluatedIconSize:Y,collisionGroup:Q}=o.parameters,X=S.get("text-optional"),ae=S.get("icon-optional"),te=S.get("text-allow-overlap"),Ee=S.get("icon-allow-overlap"),xe=S.get("text-rotation-alignment")==="map",pe=S.get("text-pitch-alignment")==="map",we=S.get("icon-text-fit")!=="none",ve=S.get("symbol-z-order")==="viewport-y";this.transform.setProjection(b.projection);let Me=te&&(Ee||!b.hasIconData()||ae),Oe=Ee&&(te||!b.hasTextData()||X);!b.collisionArrays&&ee&&b.deserializeCollisionBoxes(ee),g&&x&&b.updateCollisionDebugBuffers(this.transform.zoom,ee);const ht=(ke,Xe,nt)=>{if(O){const Yi={zoom:this.transform.zoom,pitch:this.transform.pitch};let rn=null;if(O.dynamicFilterNeedsFeature){const ai=this.retainedQueryData[b.bucketInstanceId];rn=O.featureIndex.loadFeature({featureIndex:ke.featureIndex,bucketIndex:ai.bucketIndex,sourceLayerIndex:ai.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(Yi,rn,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new s.pointGeometry(ke.tileAnchorX,ke.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[ke.crossTileID]=new _n(!1,!1,!1,!0),void(u[ke.crossTileID]=!0)}if(u[ke.crossTileID])return;if(W)return void(this.placements[ke.crossTileID]=new _n(!1,!1,!1));let _t=!1,je=!1,ft=!0,it=!1,bt=!1,vt=null,zt={box:null,offscreen:null,occluded:null},Ut={box:null,offscreen:null,occluded:null},Ht=null,pi=null,Rt=null,Qt=0,Ei=0,Ki=0;nt.textFeatureIndex?Qt=nt.textFeatureIndex:ke.useRuntimeCollisionCircles&&(Qt=ke.featureIndex),nt.verticalTextFeatureIndex&&(Ei=nt.verticalTextFeatureIndex);const hn=Yi=>{Yi.tileID=this.retainedQueryData[b.bucketInstanceId].tileID,(this.transform.elevation||Yi.elevation)&&(Yi.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[b.bucketInstanceId].tileID,Yi.tileAnchorX,Yi.tileAnchorY):0)},Bi=nt.textBox;if(Bi){hn(Bi);const Yi=ai=>{let bn=s.WritingMode.horizontal;if(b.allowVerticalPlacement&&!ai&&this.prevPlacement){const Hn=this.prevPlacement.placedOrientations[ke.crossTileID];Hn&&(this.placedOrientations[ke.crossTileID]=Hn,bn=Hn,this.markUsedOrientation(b,bn,ke))}return bn},rn=(ai,bn)=>{if(b.allowVerticalPlacement&&ke.numVerticalGlyphVertices>0&&nt.verticalTextBox){for(const Hn of b.writingModes)if(Hn===s.WritingMode.vertical?(zt=bn(),Ut=zt):zt=ai(),zt&&zt.box&&zt.box.length)break}else zt=ai()};if(S.get("text-variable-anchor")){let ai=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ke.crossTileID]){const ji=this.prevPlacement.variableOffsets[ke.crossTileID];ai.indexOf(ji.anchor)>0&&(ai=ai.filter(Zn=>Zn!==ji.anchor),ai.unshift(ji.anchor))}const bn=(ji,Zn,Mo)=>{const nr=b.getSymbolInstanceTextSize(K,ke,this.transform.zoom,Xe),Io=(ji.x2-ji.x1)*nr+2*ji.padding,Po=(ji.y2-ji.y1)*nr+2*ji.padding,ko=we&&!Ee?Zn:null;ko&&hn(ko);let rr={box:[],offscreen:!1,occluded:!1};const Lo=te?2*ai.length:ai.length;for(let no=0;no<Lo;++no){const Tl=this.attemptAnchorPlacement(ai[no%ai.length],ji,Io,Po,nr,xe,pe,U,A,Q,no>=ai.length,ke,Xe,b,Mo,ko,K,Y);if(Tl&&(rr=Tl.placedGlyphBoxes,rr&&rr.box&&rr.box.length)){_t=!0,vt=Tl.shift;break}}return rr};rn(()=>bn(Bi,nt.iconBox,s.WritingMode.horizontal),()=>{const ji=nt.verticalTextBox;return ji&&hn(ji),b.allowVerticalPlacement&&!(zt&&zt.box&&zt.box.length)&&ke.numVerticalGlyphVertices>0&&ji?bn(ji,nt.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),zt&&(_t=zt.box,ft=zt.offscreen,it=zt.occluded);const Hn=Yi(zt&&zt.box);if(!_t&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[ke.crossTileID];ji&&(this.variableOffsets[ke.crossTileID]=ji,this.markUsedJustification(b,ji.anchor,ke,Hn))}}else{const ai=(bn,Hn)=>{const ji=b.getSymbolInstanceTextSize(K,ke,this.transform.zoom,Xe),Zn=this.collisionIndex.placeCollisionBox(b,ji,bn,new s.pointGeometry(0,0),te,U,A,Q.predicate);return Zn&&Zn.box&&Zn.box.length&&(this.markUsedOrientation(b,Hn,ke),this.placedOrientations[ke.crossTileID]=Hn),Zn};rn(()=>ai(Bi,s.WritingMode.horizontal),()=>{const bn=nt.verticalTextBox;return b.allowVerticalPlacement&&ke.numVerticalGlyphVertices>0&&bn?(hn(bn),ai(bn,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Yi(zt&&zt.box&&zt.box.length)}}if(Ht=zt,_t=Ht&&Ht.box&&Ht.box.length>0,ft=Ht&&Ht.offscreen,it=Ht&&Ht.occluded,ke.useRuntimeCollisionCircles){const Yi=b.text.placedSymbolArray.get(ke.centerJustifiedTextSymbolIndex>=0?ke.centerJustifiedTextSymbolIndex:ke.verticalPlacedTextSymbolIndex),rn=s.evaluateSizeForFeature(b.textSizeData,K,Yi),ai=S.get("text-padding");pi=this.collisionIndex.placeCollisionCircles(b,te,Yi,b.lineVertexArray,b.glyphOffsetArray,rn,A,I,D,g,pe,Q.predicate,ke.collisionCircleDiameter*rn/s.ONE_EM,ai,this.retainedQueryData[b.bucketInstanceId].tileID),_t=te||pi.circles.length>0&&!pi.collisionDetected,ft=ft&&pi.offscreen,it=pi.occluded}if(nt.iconFeatureIndex&&(Ki=nt.iconFeatureIndex),nt.iconBox){const Yi=rn=>{hn(rn);const ai=we&&vt?el(vt.x,vt.y,xe,pe,this.transform.angle):new s.pointGeometry(0,0),bn=b.getSymbolInstanceIconSize(Y,this.transform.zoom,Xe);return this.collisionIndex.placeCollisionBox(b,bn,rn,ai,Ee,U,A,Q.predicate)};Ut&&Ut.box&&Ut.box.length&&nt.verticalIconBox?(Rt=Yi(nt.verticalIconBox),je=Rt.box.length>0):(Rt=Yi(nt.iconBox),je=Rt.box.length>0),ft=ft&&Rt.offscreen,bt=Rt.occluded}const On=X||ke.numHorizontalGlyphVertices===0&&ke.numVerticalGlyphVertices===0,Kr=ae||ke.numIconVertices===0;if(On||Kr?Kr?On||(je=je&&_t):_t=je&&_t:je=_t=je&&_t,_t&&Ht&&Ht.box&&this.collisionIndex.insertCollisionBox(Ht.box,S.get("text-ignore-placement"),b.bucketInstanceId,Ut&&Ut.box&&Ei?Ei:Qt,Q.ID),je&&Rt&&this.collisionIndex.insertCollisionBox(Rt.box,S.get("icon-ignore-placement"),b.bucketInstanceId,Ki,Q.ID),pi&&(_t&&this.collisionIndex.insertCollisionCircles(pi.circles,S.get("text-ignore-placement"),b.bucketInstanceId,Qt,Q.ID),g)){const Yi=b.bucketInstanceId;let rn=this.collisionCircleArrays[Yi];rn===void 0&&(rn=this.collisionCircleArrays[Yi]=new Qa);for(let ai=0;ai<pi.circles.length;ai+=4)rn.circles.push(pi.circles[ai+0]),rn.circles.push(pi.circles[ai+1]),rn.circles.push(pi.circles[ai+2]),rn.circles.push(pi.collisionDetected?1:0)}const Ls=b.projection.name!=="globe";Me=Me&&(Ls||!it),Oe=Oe&&(Ls||!bt),this.placements[ke.crossTileID]=new _n(_t||Me,je||Oe,ft||b.justReloaded),u[ke.crossTileID]=!0};if(ve){const ke=b.getSortedSymbolIndexes(this.transform.angle);for(let Xe=ke.length-1;Xe>=0;--Xe){const nt=ke[Xe];ht(b.symbolInstances.get(nt),nt,b.collisionArrays[nt])}}else for(let ke=o.symbolInstanceStart;ke<o.symbolInstanceEnd;ke++)ht(b.symbolInstances.get(ke),ke,b.collisionArrays[ke]);if(g&&b.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[b.bucketInstanceId];s.invert(ke.invProjMatrix,A),ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(o,u,g,x){let b;b=x===s.WritingMode.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(u)];const S=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const A of S)A>=0&&(o.text.placedSymbolArray.get(A).crossTileID=b>=0&&A!==b?0:g.crossTileID)}markUsedOrientation(o,u,g){const x=u===s.WritingMode.horizontal||u===s.WritingMode.horizontalOnly?u:0,b=u===s.WritingMode.vertical?u:0,S=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const A of S)o.text.placedSymbolArray.get(A).placedOrientation=x;g.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(o):1,b=u?u.opacities:{},S=u?u.variableOffsets:{},A=u?u.placedOrientations:{};for(const I in this.placements){const D=this.placements[I],O=b[I];O?(this.opacities[I]=new Qs(O,x,D.text,D.icon,null,D.clipped),g=g||D.text!==O.text.placed||D.icon!==O.icon.placed):(this.opacities[I]=new Qs(null,x,D.text,D.icon,D.skipFade,D.clipped),g=g||D.text||D.icon)}for(const I in b){const D=b[I];if(!this.opacities[I]){const O=new Qs(D,x,!1,!1);O.isHidden()||(this.opacities[I]=O,g=g||D.text.placed||D.icon.placed)}}for(const I in S)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=S[I]);for(const I in A)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=A[I]);g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const g={};for(const x of u){const b=x.getBucket(o);b&&x.latestFeatureIndex&&o.id===b.layerIds[0]&&this.updateBucketOpacities(b,g,x.collisionBoxArray)}}updateBucketOpacities(o,u,g){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const x=o.layers[0].layout,b=!!o.layers[0].dynamicFilter(),S=new Qs(null,0,!1,!1,!0),A=x.get("text-allow-overlap"),I=x.get("icon-allow-overlap"),D=x.get("text-variable-anchor"),O=x.get("text-rotation-alignment")==="map",U=x.get("text-pitch-alignment")==="map",W=x.get("icon-text-fit")!=="none",ee=new Qs(null,0,A&&(I||!o.hasIconData()||x.get("icon-optional")),I&&(A||!o.hasTextData()||x.get("text-optional")),!0);!o.collisionArrays&&g&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(g);const K=(Q,X,ae)=>{for(let te=0;te<X/4;te++)Q.opacityVertexArray.emplaceBack(ae)};let Y=0;for(let Q=0;Q<o.symbolInstances.length;Q++){const X=o.symbolInstances.get(Q),{numHorizontalGlyphVertices:ae,numVerticalGlyphVertices:te,crossTileID:Ee}=X;let xe=this.opacities[Ee];u[Ee]?xe=S:xe||(xe=ee,this.opacities[Ee]=xe),u[Ee]=!0;const pe=ae>0||te>0,we=X.numIconVertices>0,ve=this.placedOrientations[X.crossTileID],Me=ve===s.WritingMode.vertical,Oe=ve===s.WritingMode.horizontal||ve===s.WritingMode.horizontalOnly;if(!pe&&!we||xe.isHidden()||Y++,pe){const ht=Eo(xe.text);K(o.text,ae,Me?Zr:ht),K(o.text,te,Oe?Zr:ht);const ke=xe.text.isHidden();[X.rightJustifiedTextSymbolIndex,X.centerJustifiedTextSymbolIndex,X.leftJustifiedTextSymbolIndex].forEach(_t=>{_t>=0&&(o.text.placedSymbolArray.get(_t).hidden=ke||Me?1:0)}),X.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(X.verticalPlacedTextSymbolIndex).hidden=ke||Oe?1:0);const Xe=this.variableOffsets[X.crossTileID];Xe&&this.markUsedJustification(o,Xe.anchor,X,ve);const nt=this.placedOrientations[X.crossTileID];nt&&(this.markUsedJustification(o,"left",X,nt),this.markUsedOrientation(o,nt,X))}if(we){const ht=Eo(xe.icon);X.placedIconSymbolIndex>=0&&(K(o.icon,X.numIconVertices,Me?Zr:ht),o.icon.placedSymbolArray.get(X.placedIconSymbolIndex).hidden=xe.icon.isHidden()),X.verticalPlacedIconSymbolIndex>=0&&(K(o.icon,X.numVerticalIconVertices,Oe?Zr:ht),o.icon.placedSymbolArray.get(X.verticalPlacedIconSymbolIndex).hidden=xe.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const ht=o.collisionArrays[Q];if(ht){let ke=new s.pointGeometry(0,0),Xe=!0;if(ht.textBox||ht.verticalTextBox){if(D){const _t=this.variableOffsets[Ee];_t?(ke=In(_t.anchor,_t.width,_t.height,_t.textOffset,_t.textScale),O&&ke._rotate(U?this.transform.angle:-this.transform.angle)):Xe=!1}b&&(Xe=!xe.clipped),ht.textBox&&kr(o.textCollisionBox.collisionVertexArray,xe.text.placed,!Xe||Me,ke.x,ke.y),ht.verticalTextBox&&kr(o.textCollisionBox.collisionVertexArray,xe.text.placed,!Xe||Oe,ke.x,ke.y)}const nt=Xe&&Boolean(!Oe&&ht.verticalIconBox);ht.iconBox&&kr(o.iconCollisionBox.collisionVertexArray,xe.icon.placed,nt,W?ke.x:0,W?ke.y:0),ht.verticalIconBox&&kr(o.iconCollisionBox.collisionVertexArray,xe.icon.placed,!nt,W?ke.x:0,W?ke.y:0)}}}if(o.fullyClipped=Y===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const Q=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Q.invProjMatrix,o.placementViewportMatrix=Q.viewportMatrix,o.collisionCircleArray=Q.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function kr(p,o,u,g,x){p.emplaceBack(o?1:0,u?1:0,g||0,x||0),p.emplaceBack(o?1:0,u?1:0,g||0,x||0),p.emplaceBack(o?1:0,u?1:0,g||0,x||0),p.emplaceBack(o?1:0,u?1:0,g||0,x||0)}const tl=Math.pow(2,25),uc=Math.pow(2,24),u_=Math.pow(2,17),Qu=Math.pow(2,16),Qo=Math.pow(2,9),h_=Math.pow(2,8),Df=Math.pow(2,1);function Eo(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const o=p.placed?1:0,u=Math.floor(127*p.opacity);return u*tl+o*uc+u*u_+o*Qu+u*Qo+o*h_+u*Df+o}const Zr=0;class hc{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,u,g,x,b){const S=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(S,x,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((A,I)=>A.sortKey-I.sortKey));this._currentPartIndex<S.length;){const A=S[this._currentPartIndex];if(u.placeLayerBucketPart(A,this._seenCrossTileIDs,g,A.symbolInstanceStart===0),this._currentPartIndex++,b())return!0}return!1}}class Js{constructor(o,u,g,x,b,S,A,I){this.placement=new Yu(o,b,S,A,I),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(o,u,g){const x=s.exported.now(),b=()=>{const S=s.exported.now()-x;return!this._forceFullPlacement&&S>2};for(;this._currentPlacementIndex>=0;){const S=u[o[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=A)&&(!S.maxzoom||S.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new hc(S)),this._inProgressLayer.continuePlacement(g[S.source],this.placement,this._showCollisionBoxes,S,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Ju=512/s.EXTENT/2;class dc{constructor(o,u,g){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=g;for(let x=0;x<u.length;x++){const b=u.get(x),S=b.key;this.indexedSymbolInstances[S]||(this.indexedSymbolInstances[S]=[]),this.indexedSymbolInstances[S].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,o)})}}getScaledCoordinates(o,u){const g=Ju/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*s.EXTENT+o.tileAnchorX)*g),y:Math.floor((u.canonical.y*s.EXTENT+o.tileAnchorY)*g)}}findMatches(o,u,g){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let b=0;b<o.length;b++){const S=o.get(b);if(S.crossTileID)continue;const A=this.indexedSymbolInstances[S.key];if(!A)continue;const I=this.getScaledCoordinates(S,u);for(const D of A)if(Math.abs(D.coord.x-I.x)<=x&&Math.abs(D.coord.y-I.y)<=x&&!g[D.crossTileID]){g[D.crossTileID]=!0,S.crossTileID=D.crossTileID;break}}}}class d_{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class f_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(u!==0)for(const g in this.indexes){const x=this.indexes[g],b={};for(const S in x){const A=x[S];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+u),b[A.tileID.key]=A}this.indexes[g]=b}this.lng=o}addBucket(o,u,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const x=this.usedCrossTileIDs[o.overscaledZ];for(const b in this.indexes){const S=this.indexes[b];if(Number(b)>o.overscaledZ)for(const A in S){const I=S[A];I.tileID.isChildOf(o)&&I.findMatches(u.symbolInstances,o,x)}else{const A=S[o.scaledTo(Number(b)).key];A&&A.findMatches(u.symbolInstances,o,x)}}for(let b=0;b<u.symbolInstances.length;b++){const S=u.symbolInstances.get(b);S.crossTileID||(S.crossTileID=g.generate(),x[S.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new dc(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const g in u.indexedSymbolInstances)for(const x of u.indexedSymbolInstances[g])delete this.usedCrossTileIDs[o][x.crossTileID]}removeStaleBuckets(o){let u=!1;for(const g in this.indexes){const x=this.indexes[g];for(const b in x)o[x[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[b]),delete x[b],u=!0)}return u}}class fc{constructor(){this.layerIndexes={},this.crossTileIDs=new d_,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,g,x){let b=this.layerIndexes[o.id];b===void 0&&(b=this.layerIndexes[o.id]=new f_);let S=!1;const A={};x.name!=="globe"&&b.handleWrapJump(g);for(const I of u){const D=I.getBucket(o);D&&o.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(I.tileID,D,this.crossTileIDs)&&(S=!0),A[D.bucketInstanceId]=!0)}return b.removeStaleBuckets(A)&&(S=!0),S}pruneUnusedLayers(o){const u={};o.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}const pc=(p,o)=>s.emitValidationErrors(p,o&&o.filter(u=>u.identifier!=="source.canvas")),Of=s.pick(kt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),p_=s.pick(kt,["setCenter","setZoom","setBearing","setPitch"]),Ff={version:8,layers:[],sources:{}},m_={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Lr extends s.Evented{constructor(o,u={}){super(),this.map=o,this.dispatcher=new Kt(qt(),this),this.imageManager=new Ge,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(o._requestManager,u.localFontFamily?s.LocalGlyphMode.all:u.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.lineAtlas=new s.LineAtlas(256,512),this.crossTileSymbolIndex=new fc,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const g=this;this._rtlTextPluginCallback=Lr.registerForPluginStateChange(x=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(b,S)=>{if(s.triggerPluginCompletionEvent(b),S&&S.every(A=>A))for(const A in g._sourceCaches){const I=g._sourceCaches[A],D=I.getSource().type;D!=="vector"&&D!=="geojson"||I.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const b=this.getSource(x.sourceId);if(b&&b.vectorLayerIds)for(const S in this._layers){const A=this._layers[S];A.source===b.id&&this._validateLayer(A)}})}loadURL(o,u={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const g=typeof u.validate=="boolean"?u.validate:!s.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,u.accessToken);const x=this.map._requestManager.transformRequest(o,s.ResourceType.Style);this._request=s.getJSON(x,(b,S)=>{this._request=null,b?this.fire(new s.ErrorEvent(b)):S&&this._load(S,g)})}loadJSON(o,u={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(o,u.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Ff,!1)}_updateLayerCount(o,u){const g=u?1:-1;o.is3D()&&(this._num3DLayers+=g),o.type==="circle"&&(this._numCircleLayers+=g),o.type==="symbol"&&(this._numSymbolLayers+=g)}_load(o,u){if(u&&pc(this,s.validateStyle(o)))return;this._loaded=!0,this.stylesheet=s.clone$1(o),this._updateMapProjection();for(const x in o.sources)this.addSource(x,o.sources[x],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const g=Jt(this.stylesheet.layers);this._order=g.map(x=>x.id),this._layers={},this._serializedLayers={};for(let x of g)x=s.createStyleLayer(x),x.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=x,this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new et(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=function(u,g,x){let b,S,A;const I=s.exported.devicePixelRatio>1?"@2x":"";let D=s.getJSON(g.transformRequest(g.normalizeSpriteURL(u,I,".json"),s.ResourceType.SpriteJSON),(W,ee)=>{D=null,A||(A=W,b=ee,U())}),O=s.getImage(g.transformRequest(g.normalizeSpriteURL(u,I,".png"),s.ResourceType.SpriteImage),(W,ee)=>{O=null,A||(A=W,S=ee,U())});function U(){if(A)x(A);else if(b&&S){const W=s.exported.getImageData(S),ee={};for(const K in b){const{width:Y,height:Q,x:X,y:ae,sdf:te,pixelRatio:Ee,stretchX:xe,stretchY:pe,content:we}=b[K],ve=new s.RGBAImage({width:Y,height:Q});s.RGBAImage.copy(W,ve,{x:X,y:ae},{x:0,y:0},{width:Y,height:Q}),ee[K]={data:ve,pixelRatio:Ee,sdf:te,stretchX:xe,stretchY:pe,content:we}}x(null,ee)}}return{cancel(){D&&(D.cancel(),D=null),O&&(O.cancel(),O=null)}}}(o,this.map._requestManager,(u,g)=>{if(this._spriteRequest=null,u)this.fire(new s.ErrorEvent(u));else if(g)for(const x in g)this.imageManager.addImage(x,g[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(o){const u=this.getSource(o.source);if(!u)return;const g=o.sourceLayer;g&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(g)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${u.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const u=[];for(const g of o){const x=this._layers[g];x.type!=="custom"&&u.push(x.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&m_[o.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const u=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(x.length||b.length)&&this._updateWorkerLayers(x,b);for(const S in this._updatedSources){const A=this._updatedSources[S];A==="reload"?this._reloadSource(S):A==="clear"&&this._clearSource(S)}this._updateTilesForChangedImages();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const g={};for(const x in this._sourceCaches){const b=this._sourceCaches[x];g[x]=b.used,b.used=!1}for(const x of this._order){const b=this._layers[x];if(b.recalculate(o,this._availableImages),!b.isHidden(o.zoom)){const A=this._getLayerSourceCache(b);A&&(A.used=!0)}const S=this.map.painter;if(S){const A=b.getProgramIds();if(!A)continue;const I=b.getProgramConfiguration(o.zoom);for(const D of A)S.useProgram(D,I)}}for(const x in g){const b=this._sourceCaches[x];g[x]!==b.used&&b.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),pc(this,s.validateStyle(o)))return!1;(o=s.clone$1(o)).layers=Jt(o.layers);const u=function(x,b){if(!x)return[{command:kt.setStyle,args:[b]}];let S=[];try{if(!w(x.version,b.version))return[{command:kt.setStyle,args:[b]}];w(x.center,b.center)||S.push({command:kt.setCenter,args:[b.center]}),w(x.zoom,b.zoom)||S.push({command:kt.setZoom,args:[b.zoom]}),w(x.bearing,b.bearing)||S.push({command:kt.setBearing,args:[b.bearing]}),w(x.pitch,b.pitch)||S.push({command:kt.setPitch,args:[b.pitch]}),w(x.sprite,b.sprite)||S.push({command:kt.setSprite,args:[b.sprite]}),w(x.glyphs,b.glyphs)||S.push({command:kt.setGlyphs,args:[b.glyphs]}),w(x.transition,b.transition)||S.push({command:kt.setTransition,args:[b.transition]}),w(x.light,b.light)||S.push({command:kt.setLight,args:[b.light]}),w(x.fog,b.fog)||S.push({command:kt.setFog,args:[b.fog]}),w(x.projection,b.projection)||S.push({command:kt.setProjection,args:[b.projection]});const A={},I=[];(function(U,W,ee,K){let Y;for(Y in W=W||{},U=U||{})U.hasOwnProperty(Y)&&(W.hasOwnProperty(Y)||Sn(Y,ee,K));for(Y in W)W.hasOwnProperty(Y)&&(U.hasOwnProperty(Y)?w(U[Y],W[Y])||(U[Y].type==="geojson"&&W[Y].type==="geojson"&&Gr(U,W,Y)?ee.push({command:kt.setGeoJSONSourceData,args:[Y,W[Y].data]}):vi(Y,W,ee,K)):Ve(Y,W,ee))})(x.sources,b.sources,I,A);const D=[];x.layers&&x.layers.forEach(U=>{U.source&&A[U.source]?S.push({command:kt.removeLayer,args:[U.id]}):D.push(U)});let O=x.terrain;O&&A[O.source]&&(S.push({command:kt.setTerrain,args:[void 0]}),O=void 0),S=S.concat(I),w(O,b.terrain)||S.push({command:kt.setTerrain,args:[b.terrain]}),function(U,W,ee){W=W||[];const K=(U=U||[]).map(qr),Y=W.map(qr),Q=U.reduce(lc,{}),X=W.reduce(lc,{}),ae=K.slice(),te=Object.create(null);let Ee,xe,pe,we,ve,Me,Oe;for(Ee=0,xe=0;Ee<K.length;Ee++)pe=K[Ee],X.hasOwnProperty(pe)?xe++:(ee.push({command:kt.removeLayer,args:[pe]}),ae.splice(ae.indexOf(pe,xe),1));for(Ee=0,xe=0;Ee<Y.length;Ee++)pe=Y[Y.length-1-Ee],ae[ae.length-1-Ee]!==pe&&(Q.hasOwnProperty(pe)?(ee.push({command:kt.removeLayer,args:[pe]}),ae.splice(ae.lastIndexOf(pe,ae.length-xe),1)):xe++,Me=ae[ae.length-Ee],ee.push({command:kt.addLayer,args:[X[pe],Me]}),ae.splice(ae.length-Ee,0,pe),te[pe]=!0);for(Ee=0;Ee<Y.length;Ee++)if(pe=Y[Ee],we=Q[pe],ve=X[pe],!te[pe]&&!w(we,ve))if(w(we.source,ve.source)&&w(we["source-layer"],ve["source-layer"])&&w(we.type,ve.type)){for(Oe in To(we.layout,ve.layout,ee,pe,null,kt.setLayoutProperty),To(we.paint,ve.paint,ee,pe,null,kt.setPaintProperty),w(we.filter,ve.filter)||ee.push({command:kt.setFilter,args:[pe,ve.filter]}),w(we.minzoom,ve.minzoom)&&w(we.maxzoom,ve.maxzoom)||ee.push({command:kt.setLayerZoomRange,args:[pe,ve.minzoom,ve.maxzoom]}),we)we.hasOwnProperty(Oe)&&Oe!=="layout"&&Oe!=="paint"&&Oe!=="filter"&&Oe!=="metadata"&&Oe!=="minzoom"&&Oe!=="maxzoom"&&(Oe.indexOf("paint.")===0?To(we[Oe],ve[Oe],ee,pe,Oe.slice(6),kt.setPaintProperty):w(we[Oe],ve[Oe])||ee.push({command:kt.setLayerProperty,args:[pe,Oe,ve[Oe]]}));for(Oe in ve)ve.hasOwnProperty(Oe)&&!we.hasOwnProperty(Oe)&&Oe!=="layout"&&Oe!=="paint"&&Oe!=="filter"&&Oe!=="metadata"&&Oe!=="minzoom"&&Oe!=="maxzoom"&&(Oe.indexOf("paint.")===0?To(we[Oe],ve[Oe],ee,pe,Oe.slice(6),kt.setPaintProperty):w(we[Oe],ve[Oe])||ee.push({command:kt.setLayerProperty,args:[pe,Oe,ve[Oe]]}))}else ee.push({command:kt.removeLayer,args:[pe]}),Me=ae[ae.lastIndexOf(pe)+1],ee.push({command:kt.addLayer,args:[ve,Me]})}(D,b.layers,S)}catch(A){console.warn("Unable to compute style diff:",A),S=[{command:kt.setStyle,args:[b]}]}return S}(this.serialize(),o).filter(x=>!(x.command in p_));if(u.length===0)return!1;const g=u.filter(x=>!(x.command in Of));if(g.length>0)throw new Error(`Unimplemented: ${g.map(x=>x.command).join(", ")}.`);return u.forEach(x=>{x.command!=="setTransition"&&x.command!=="setProjection"&&this[x.command].apply(this,x.args)}),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,u){return this.getImage(o)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,u),this._afterImageUpdated(o),this)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,u,g={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.validateSource,`sources.${o}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=Re(o,u,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:x.serialize(),sourceId:o}));const b=S=>{const A=(S?"symbol:":"other:")+o,I=this._sourceCaches[A]=new s.SourceCache(A,x,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[o]=I,I.style=this,I.onAdd(this.map)};b(!1),u.type!=="vector"&&u.type!=="geojson"||b(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const u=this.getSource(o);if(!u)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(o);for(const x of g)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,u){this._checkLoaded(),this.getSource(o).setData(u),this._changed=!0}getSource(o){const u=this._getSourceCache(o);return u&&u.getSource()}addLayer(o,u,g={}){this._checkLoaded();const x=o.id;if(this.getLayer(x))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let b;if(o.type==="custom"){if(pc(this,s.validateCustomStyleLayer(o)))return;b=s.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(x,o.source),o=s.clone$1(o),o=s.extend(o,{source:x})),this._validate(s.validateLayer,`layers.${x}`,o,{arrayIndex:-1},g))return;b=s.createStyleLayer(o),this._validateLayer(b),b.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const S=u?this._order.indexOf(u):this._order.length;if(u&&S===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(S,0,x),this._layerOrderChanged=!0,this._layers[x]=b;const A=this._getLayerSourceCache(b);if(this._removedLayers[x]&&b.source&&A&&b.type!=="custom"){const I=this._removedLayers[x];delete this._removedLayers[x],I.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",A.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const g=this._order.indexOf(o);this._order.splice(g,1);const x=u?this._order.indexOf(u):this._order.length;u&&x===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(x,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const g=this._order.indexOf(o);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const u in this._layers)if(this._layers[u].type===o)return!0;return!1}setLayerZoomRange(o,u,g){this._checkLoaded();const x=this.getLayer(o);x?x.minzoom===u&&x.maxzoom===g||(u!=null&&(x.minzoom=u),g!=null&&(x.maxzoom=g),this._updateLayer(x)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,u,g={}){this._checkLoaded();const x=this.getLayer(o);if(x){if(!w(x.filter,u))return u==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(s.validateFilter,`layers.${x.id}.filter`,u,{layerType:x.type},g)||(x.filter=s.clone$1(u),this._updateLayer(x)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const u=this.getLayer(o);return u&&s.clone$1(u.filter)}setLayoutProperty(o,u,g,x={}){this._checkLoaded();const b=this.getLayer(o);b?w(b.getLayoutProperty(u),g)||(b.setLayoutProperty(u,g,x),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,u){const g=this.getLayer(o);if(g)return g.getLayoutProperty(u);this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,u,g,x={}){this._checkLoaded();const b=this.getLayer(o);b?w(b.getPaintProperty(u),g)||(b.setPaintProperty(u,g,x)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,u){const g=this.getLayer(o);return g&&g.getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const g=o.source,x=o.sourceLayer,b=this.getSource(g);if(!b)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const S=b.type;if(S==="geojson"&&x)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!x)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const A=this._getSourceCaches(g);for(const I of A)I.setFeatureState(x,o.id,u)}removeFeatureState(o,u){this._checkLoaded();const g=o.source,x=this.getSource(g);if(!x)return void this.fire(new s.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const b=x.type,S=b==="vector"?o.sourceLayer:void 0;if(b==="vector"&&!S)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const A=this._getSourceCaches(g);for(const I of A)I.removeFeatureState(S,o.id,u)}getFeatureState(o){this._checkLoaded();const u=o.source,g=o.sourceLayer,x=this.getSource(u);if(x){if(x.type!=="vector"||g)return o.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(g,o.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const u in this._sourceCaches){const g=this._sourceCaches[u].getSource();o[g.id]||(o[g.id]=g.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},u=>u!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0;const u=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&u&&u.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",u.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const u=S=>this._layers[S].type==="fill-extrusion",g={},x=[];for(let S=this._order.length-1;S>=0;S--){const A=this._order[S];if(u(A)){g[A]=S;for(const I of o){const D=I[A];if(D)for(const O of D)x.push(O)}}}x.sort((S,A)=>A.intersectionZ-S.intersectionZ);const b=[];for(let S=this._order.length-1;S>=0;S--){const A=this._order[S];if(u(A))for(let I=x.length-1;I>=0;I--){const D=x[I].feature;if(g[D.layer.id]<S)break;b.push(D),x.pop()}else for(const I of o){const D=I[A];if(D)for(const O of D)b.push(O.feature)}}return b}queryRenderedFeatures(o,u,g){u&&u.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",u.filter,null,u);const x={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const I of u.layers){const D=this._layers[I];if(!D)return this.fire(new s.ErrorEvent(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];x[D.source]=!0}}const b=[];u.availableImages=this._availableImages;const S=u&&u.layers?u.layers.some(I=>{const D=this.getLayer(I);return D&&D.is3D()}):this.has3DLayers(),A=gn.createFromScreenPoints(o,g);for(const I in this._sourceCaches){const D=this._sourceCaches[I].getSource().id;u.layers&&!x[D]||b.push(wt(this._sourceCaches[I],this._layers,this._serializedLayers,A,u,g,S,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(I,D,O,U,W,ee,K){const Y={},Q=ee.queryRenderedSymbols(U),X=[];for(const ae of Object.keys(Q).map(Number))X.push(K[ae]);X.sort(jt);for(const ae of X){const te=ae.featureIndex.lookupSymbolFeatures(Q[ae.bucketInstanceId],D,ae.bucketIndex,ae.sourceLayerIndex,W.filter,W.layers,W.availableImages,I);for(const Ee in te){const xe=Y[Ee]=Y[Ee]||[],pe=te[Ee];pe.sort((we,ve)=>{const Me=ae.featureSortOrder;if(Me){const Oe=Me.indexOf(we.featureIndex);return Me.indexOf(ve.featureIndex)-Oe}return ve.featureIndex-we.featureIndex});for(const we of pe)xe.push(we)}}for(const ae in Y)Y[ae].forEach(te=>{const Ee=te.feature,xe=O(I[ae]).getFeatureState(Ee.layer["source-layer"],Ee.id);Ee.source=Ee.layer.source,Ee.layer["source-layer"]&&(Ee.sourceLayer=Ee.layer["source-layer"]),Ee.state=xe});return Y}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),A.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(o,u){u&&u.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",u.filter,null,u);const g=this._getSourceCaches(o);let x=[];for(const b of g)x=x.concat(ct(b,u));return x}addSourceType(o,u,g){return Lr.getSourceType(o)?g(new Error(`A source type called "${o}" already exists.`)):(Lr.setSourceType(o,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:u.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const g=this.light.getLight();let x=!1;for(const S in o)if(!w(o[S],g[S])){x=!0;break}if(!x)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,u),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,u=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(u===1){if(typeof o.source=="object"){const g="terrain-dem-src";this.addSource(g,o.source),o=s.clone$1(o),o=s.extend(o,{source:g})}if(this._validate(s.validateTerrain,"terrain",o))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode)this._createTerrain(o,u);else{const g=this.terrain,x=g.get();for(const b of Object.keys(s.spec.terrain))!o.hasOwnProperty(b)&&s.spec.terrain[b].default&&(o[b]=s.spec.terrain[b].default);for(const b in o)if(!w(o[b],x[b])){g.set(o),this.stylesheet.terrain=o;const S=this._setTransitionParameters({duration:0});g.updateTransitions(S);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const u=this.fog=new yi(o,this.map.transform);this.stylesheet.fog=o;const g=this._setTransitionParameters({duration:0});u.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,g=u.get();Object.keys(o).length===0&&u.set(o);for(const x in o)if(!w(o[x],g[x])){u.set(o),this.stylesheet.fog=o;const b=this._setTransitionParameters({duration:0});u.updateTransitions(b);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:s.exported.now(),transition:s.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(g=>this.isLayerDraped(this._layers[g])),u=this._order.filter(g=>!this.isLayerDraped(this._layers[g]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...u)}_createTerrain(o,u){const g=this.terrain=new fi(o,u);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});g.updateTransitions(x)}_force3DLayerUpdate(){for(const o in this._layers){const u=this._layers[o];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const u=this._layers[o];u.type==="symbol"&&this._updateLayer(u)}}_validate(o,u,g,x,b={}){return(!b||b.validate!==!1)&&pc(this,o.call(s.validateStyle,s.extend({key:u,style:this.serialize(),value:g,styleSpec:s.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const u=this._getSourceCaches(o);for(const g of u)g.clearTiles()}_reloadSource(o){const u=this._getSourceCaches(o);for(const g of u)g.resume(),g.reload()}_updateSources(o){for(const u in this._sourceCaches)this._sourceCaches[u].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const u=this._sourceCaches[o];u.resume(),u.reload()}}_updatePlacement(o,u,g,x,b=!1){let S=!1,A=!1;const I={};for(const D of this._order){const O=this._layers[D];if(O.type!=="symbol")continue;if(!I[O.source]){const W=this._getLayerSourceCache(O);if(!W)continue;I[O.source]=W.getRenderableIds(!0).map(ee=>W.getTileByID(ee)).sort((ee,K)=>K.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(K.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(O,I[O.source],o.center.lng,o.projection);S=S||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),o.zoom))&&(this.pauseablePlacement=new Js(o,this._order,b,u,g,x,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),A=!0),S&&this.pauseablePlacement.placement.setStale()),A||S)for(const D of this._order){const O=this._layers[D];O.type==="symbol"&&this.placement.updateLayerOpacities(O,I[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u,g){this.imageManager.getImages(u.icons,g),this._updateTilesForChangedImages();const x=b=>{b&&b.setDependencies(u.tileID.key,u.type,u.icons)};x(this._otherSourceCaches[u.source]),x(this._symbolSourceCaches[u.source])}getGlyphs(o,u,g){this.glyphManager.getGlyphs(u.stacks,g)}getResource(o,u,g){return s.makeRequest(u,g)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const u=[];return this._otherSourceCaches[o]&&u.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&u.push(this._symbolSourceCaches[o]),u}_isSourceCacheLoaded(o){const u=this._getSourceCaches(o);return u.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):u.every(g=>g.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Lr.getSourceType=function(p){return be[p]},Lr.setSourceType=function(p,o){be[p]=o},Lr.registerForPluginStateChange=s.registerForPluginStateChange;var eh=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,th="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ih=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,nh=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Jo=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let mc={},So={};const eo=[];Ao(eh,eo),Ao(ih,eo),Ao(nh,eo),Ao(Jo,eo),mc=Ii("",ih),So=Ii(Jo,nh);const il=Ii(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),gc=eh,_c=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var yc={background:Ii(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ii(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ii(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ii("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ii(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ii(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ii("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ii("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ii("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ii(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Ii(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ii(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ii(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ii(`uniform lowp vec3 u_lightpos;varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
void main() {vec4 color=v_color;
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color_normal(color.xyz,normalize(v_normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying highp vec3 v_normal;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;vec3 pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_normal=normal;v_depth=gl_Position.w;
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Ii(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Ii(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ii(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ii(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
highp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);
#else
vec4 out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Ii(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Ii(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Ii(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Ii(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);vec4 offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
vec4 offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Ii(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(tile_anchor,0)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Ii(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Ii(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ii(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,th),skyboxGradient:Ii(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,th),skyboxCapture:Ii(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ii(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);vec4 color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
vec4 color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;
#ifdef GLOBE_POLES
vec3 up_vector=normalize(globe_pos)*u_tile_up_scale;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ii(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);
#ifdef PROJECTION_GLOBE_VIEW
float globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));float horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
float horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ao(p,o){const u=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of u)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=g.split(" ");for(const b of x)o.includes(b)||o.push(b)}}function Ii(p,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},b=[...eo];return Ao(p,b),Ao(o,b),{fragmentSource:p=p.replace(u,(S,A,I,D,O)=>(x[O]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${O}
varying ${I} ${D} ${O};
#else
uniform ${I} ${D} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${I} ${D} ${O} = u_${O};
#endif
`)),vertexSource:o=o.replace(u,(S,A,I,D,O)=>{const U=D==="float"?"vec2":"vec4",W=O.match(/color/)?"color":U;return x[O]?A==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${I} ${U} a_${O};
varying ${I} ${D} ${O};
#else
uniform ${I} ${D} u_${O};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${I} ${D} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${W}(a_${O}, u_${O}_t);
#else
    ${I} ${D} ${O} = u_${O};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${I} ${U} a_${O};
#else
uniform ${I} ${D} u_${O};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${I} ${D} ${O} = a_${O};
#else
    ${I} ${D} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${I} ${D} ${O} = unpack_mix_${W}(a_${O}, u_${O}_t);
#else
    ${I} ${D} ${O} = u_${O};
#endif
`}),staticAttributes:g,usedDefines:b}}class vc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,u,g,x,b,S,A){this.context=o;let I=this.boundPaintVertexBuffers.length!==x.length;for(let O=0;!I&&O<x.length;O++)this.boundPaintVertexBuffers[O]!==x[O]&&(I=!0);let D=this.boundDynamicVertexBuffers.length!==A.length;for(let O=0;!D&&O<A.length;O++)this.boundDynamicVertexBuffers[O]!==A[O]&&(D=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||I||D||this.boundIndexBuffer!==b||this.boundVertexOffset!==S)this.freshBind(u,g,x,b,S,A);else{o.bindVertexArrayOES.set(this.vao);for(const O of A)O&&O.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(o,u,g,x,b,S){let A;const I=o.numAttributes,D=this.context,O=D.gl;if(D.extVertexArrayObject)this.vao&&this.destroy(),this.vao=D.extVertexArrayObject.createVertexArrayOES(),D.bindVertexArrayOES.set(this.vao),A=0,this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=S;else{A=D.currentNumAttributes||0;for(let U=I;U<A;U++)O.disableVertexAttribArray(U)}u.enableAttributes(O,o),u.bind(),u.setVertexAttribPointers(O,o,b);for(const U of g)U.enableAttributes(O,o),U.bind(),U.setVertexAttribPointers(O,o,b);for(const U of S)U&&(U.enableAttributes(O,o),U.bind(),U.setVertexAttribPointers(O,o,b));x&&x.bind(),D.currentNumAttributes=I}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function rh(p,o){const u=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new s.MercatorCoordinate(0,g/u).toLngLat().lat,new s.MercatorCoordinate(0,(g+1)/u).toLngLat().lat]}function sh(p,o,u,g,x,b,S){const A=p.context,I=A.gl,D=u.fbo;if(!D)return;p.prepareDrawTile();const O=p.useProgram("hillshade");A.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,D.colorAttachment.get());const U=((Y,Q,X,ae)=>{const te=X.paint.get("hillshade-shadow-color"),Ee=X.paint.get("hillshade-highlight-color"),xe=X.paint.get("hillshade-accent-color");let pe=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);X.paint.get("hillshade-illumination-anchor")==="viewport"&&(pe-=Y.transform.angle);const we=!Y.options.moving;return{u_matrix:ae||Y.transform.calculateProjMatrix(Q.tileID.toUnwrapped(),we),u_image:0,u_latrange:rh(0,Q.tileID),u_light:[X.paint.get("hillshade-exaggeration"),pe],u_shadow:te,u_highlight:Ee,u_accent:xe}})(p,u,g,p.terrain?o.projMatrix:null);p.prepareDrawProgram(A,O,o.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:ee,tileBoundsSegments:K}=p.getTileBoundsBuffers(u);O.draw(A,I.TRIANGLES,x,b,S,s.CullFaceMode.disabled,U,g.id,W,ee,K)}function Ti(p,o,u){if(!o.needsDEMTextureUpload)return;const g=p.context,x=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||p.getTileTexture(u.stride);const b=u.getPixels();o.demTexture?o.demTexture.update(b,{premultiply:!1}):o.demTexture=new s.Texture(g,b,x.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function ea(p,o,u,g,x,b){const S=p.context,A=S.gl;if(!o.dem)return;const I=o.dem;if(S.activeTexture.set(A.TEXTURE1),Ti(p,o,I),!o.demTexture)return;o.demTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE);const D=I.dim;S.activeTexture.set(A.TEXTURE0);let O=o.fbo;if(!O){const K=new s.Texture(S,{width:D,height:D,data:null},A.RGBA);K.bind(A.LINEAR,A.CLAMP_TO_EDGE),O=o.fbo=S.createFramebuffer(D,D,!0),O.colorAttachment.set(K.texture)}S.bindFramebuffer.set(O.framebuffer),S.viewport.set([0,0,D,D]);const{tileBoundsBuffer:U,tileBoundsIndexBuffer:W,tileBoundsSegments:ee}=p.getMercatorTileBoundsBuffers();p.useProgram("hillshadePrepare").draw(S,A.TRIANGLES,g,x,b,s.CullFaceMode.disabled,((K,Y)=>{const Q=Y.stride,X=s.create();return s.ortho(X,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(X,X,[0,-s.EXTENT,0]),{u_matrix:X,u_image:1,u_dimension:[Q,Q],u_zoom:K.overscaledZ,u_unpack:Y.unpackVector}})(o.tileID,I),u.id,U,W,ee),o.needsHillshadePrepare=!1}const nl=p=>({u_matrix:new s.UniformMatrix4f(p),u_image0:new s.Uniform1i(p),u_skirt_height:new s.Uniform1f(p)}),oh=(p,o)=>({u_matrix:p,u_image0:0,u_skirt_height:o}),ah=(p,o,u,g,x,b,S,A,I,D,O,U,W,ee)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:u,u_zoom_transition:x,u_merc_center:b,u_image0:0,u_frustum_tl:S,u_frustum_tr:A,u_frustum_br:I,u_frustum_bl:D,u_globe_pos:O,u_globe_radius:U,u_viewport:W,u_grid_matrix:ee?Float32Array.from(ee):new Float32Array(9)});function lh(p,o){return p!=null&&o!=null&&!(!p.hasData()||!o.hasData())&&p.demTexture!=null&&o.demTexture!=null&&p.tileID.key!==o.tileID.key}const to=new class{constructor(){this.operations={}}newMorphing(p,o,u,g,x){if(p in this.operations){const b=this.operations[p];b.to.tileID.key!==u.tileID.key&&(b.queued=u)}else this.operations[p]={startTime:g,phase:0,duration:x,from:o,to:u,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const o=this.operations[p];return{from:o.from,to:o.to,phase:o.phase}}update(p){for(const o in this.operations){const u=this.operations[o];for(u.phase=(p-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,p)){delete this.operations[o];break}}}_nextOp(p,o){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=o,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},rl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function g_(p,o){const u=1<<p.z;return!o&&(p.x===0||p.x===u-1)||p.y===0||p.y===u-1}const ch=p=>({u_matrix:p});function xc(p,o,u,g,x){if(x>0){const b=s.exported.now(),S=(b-p.timeAdded)/x,A=o?(b-o.timeAdded)/x:-1,I=u.getSource(),D=g.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),O=!o||Math.abs(o.tileID.overscaledZ-D)>Math.abs(p.tileID.overscaledZ-D),U=O&&p.refreshedUponExpiration?1:s.clamp(O?S:1-A,0,1);return p.refreshedUponExpiration&&S>=1&&(p.refreshedUponExpiration=!1),o?{opacity:1,mix:1-U}:{opacity:U,mix:0}}return{opacity:1,mix:0}}class uh extends s.SourceCache{constructor(o){const u={type:"raster-dem",maxzoom:o.transform.maxZoom},g=new Kt(qt(),null),x=Re("mock-dem",u,g,o.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,u){o.state="loaded",u(null)}}class hh extends s.SourceCache{constructor(o){const u=Re("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new Kt(qt(),null),o.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,u,g){if(o.freezeTileCoverage)return;this.transform=o;const x=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,S)=>{if(b[S.key]="",!this._tiles[S.key]){const A=new s.Tile(S,this._source.tileSize*S.overscaleFactor(),o.tileZoom);A.state="loaded",this._tiles[S.key]=A}return b},{});for(const b in this._tiles)b in x||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(o){const u=this.proxyCachedFBO[o];if(u!==void 0){const g=Object.values(u);this.renderCachePool.push(...g),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class bc extends s.OverscaledTileID{constructor(o,u,g){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=u,this.projMatrix=g}}class Bf extends s.Elevation{constructor(o,u){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,x,b]=function(I){const D=new s.StructArrayLayout4i8,O=new s.StructArrayLayout3ui6,U=131;D.reserve(17161),O.reserve(33800);const W=s.EXTENT/128,ee=s.EXTENT+W/2,K=ee+W;for(let Q=-W;Q<K;Q+=W)for(let X=-W;X<K;X+=W){const ae=X<0||X>ee||Q<0||Q>ee?24575:0,te=s.clamp(Math.round(X),0,s.EXTENT),Ee=s.clamp(Math.round(Q),0,s.EXTENT);D.emplaceBack(te+ae,Ee,te,Ee)}const Y=(Q,X)=>{const ae=X*U+Q;O.emplaceBack(ae+1,ae,ae+U),O.emplaceBack(ae+U,ae+U+1,ae+1)};for(let Q=1;Q<129;Q++)for(let X=1;X<129;X++)Y(X,Q);return[0,129].forEach(Q=>{for(let X=0;X<130;X++)Y(X,Q),Y(Q,X)}),[D,O,32768]}(),S=o.context;this.gridBuffer=S.createVertexBuffer(g,s.boundsAttributes.members),this.gridIndexBuffer=S.createIndexBuffer(x),this.gridSegments=s.SegmentVector.simpleSegment(0,0,g.length,x.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,g.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new hh(u.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,0,s.EXTENT,0,s.EXTENT,0,1);const A=S.gl;this._overlapStencilMode=new s.StencilMode({func:A.GEQUAL,mask:255},0,255,A.KEEP,A.KEEP,A.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new uh(u.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency()}update(o,u,g){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const x=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const b=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const S=this.getScaledDemTileSize();this.sourceCache.update(u,S,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),u.updateElevation(!g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=u.getIds().map(I=>{const D=u.getTileByID(I).tileID;return D.projMatrix=g.calculateProjMatrix(D.toUnwrapped()),D});(function(I,D){const O=D.transform.pointCoordinate(D.transform.getCameraPoint()),U=new s.pointGeometry(O.x,O.y);I.sort((W,ee)=>{if(ee.overscaledZ-W.overscaledZ)return ee.overscaledZ-W.overscaledZ;const K=new s.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),Y=new s.pointGeometry(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),Q=U.mult(1<<W.canonical.z);return Q.x-=.5,Q.y-=.5,Q.distSqr(K)-Q.distSqr(Y)})})(x,this.painter),this._previousZoom=g.zoom;const b=this.proxyToSource||{};this.proxyToSource={},x.forEach(I=>{this.proxyToSource[I.key]={}}),this.terrainTileForTile={};const S=this._style._sourceCaches;for(const I in S){const D=S[I];if(!D.used||(D!==this.sourceCache&&this.resetTileLookupCache(D.id),this._setupProxiedCoordsForOrtho(D,o[I],b),D.usedForTerrain))continue;const O=o[I];D.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[u.id]=x.map(I=>new bc(I,I.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const A={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const D=this.terrainTileForTile[I.key];if(!D)continue;const O=D.tileID.key;O in A||(this._visibleDemTiles.push(D),A[O]=O)}}_assignTerrainTiles(o){this._initializing||o.forEach(u=>{if(this.terrainTileForTile[u.key])return;const g=this._findTileCoveringTileID(u,this.sourceCache);g&&(this.terrainTileForTile[u.key]=g)})}_prepareDEMTextures(){const o=this.painter.context,u=o.gl;for(const g in this.terrainTileForTile){const x=this.terrainTileForTile[g],b=x.dem;!b||x.demTexture&&!x.needsDEMTextureUpload||(o.activeTexture.set(u.TEXTURE1),Ti(this.painter,x,b))}}_prepareDemTileUniforms(o,u,g,x){if(!u||u.demTexture==null)return!1;const b=o.tileID.canonical,S=Math.pow(2,u.tileID.canonical.z-b.z),A=x||"";return g[`u_dem_tl${A}`]=[b.x*S%1,b.y*S%1],g[`u_dem_scale${A}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,u=o.gl;if(!this._emptyDepthBufferTexture){const g=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(o,g,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const u=this._visibleDemTiles.reduce((g,x)=>{if(!x.dem)return g;const b=x.dem.tree.minimums[0];return b>0&&o++,g+b},0);return o?u/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,u=o.gl;o.activeTexture.set(u.TEXTURE2);const g=this._getLoadedAreaMinimum(),x=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(x,{premultiply:!1}):b=this._emptyDEMTexture=new s.Texture(o,x,u.RGBA,{premultiply:!1}),b}setupElevationDraw(o,u,g){const x=this.painter.context,b=x.gl,S=(A=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(A),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var A;S.u_dem_size=this.sourceCache.getSource().tileSize,S.u_exaggeration=this.exaggeration();const I=this.painter.transform,D=I.projection,O=o.tileID.canonical;S.u_tile_tl_up=D.upVector(O,0,0),S.u_tile_tr_up=D.upVector(O,s.EXTENT,0),S.u_tile_br_up=D.upVector(O,s.EXTENT,s.EXTENT),S.u_tile_bl_up=D.upVector(O,0,s.EXTENT),S.u_tile_up_scale=g&&g.useDenormalizedUpVectorScale?s.GLOBE_METERS_TO_ECEF:D.upVectorScale(O,I.center.lat,I.worldSize).metersToTile;let U=null,W=null,ee=1;if(g&&g.morphing&&this._useVertexMorphing){const K=g.morphing.srcDemTile,Y=g.morphing.dstDemTile;ee=g.morphing.phase,K&&Y&&(this._prepareDemTileUniforms(o,K,S,"_prev")&&(W=K),this._prepareDemTileUniforms(o,Y,S)&&(U=Y))}if(W&&U?(x.activeTexture.set(b.TEXTURE2),U.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),x.activeTexture.set(b.TEXTURE4),W.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),S.u_dem_lerp=ee):(U=this.terrainTileForTile[o.tileID.key],x.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(o,U,S)?U.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),x.activeTexture.set(b.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(S.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),S.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&U){const K=(1<<U.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=K}g&&g.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),u.setTerrainUniformValues(x,S)}renderToBackBuffer(o){const u=this.painter,g=this.painter.context;o.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,b,S,A,I){if(x.transform.projection.name==="globe")(function(D,O,U,W,ee){const K=D.context,Y=K.gl;let Q,X;const ae=D.options.showTerrainWireframe?2:0,te=D.transform,Ee=s.globeUseCustomAntiAliasing(D,K,te),xe=(_t,je)=>{if(X===_t)return;const ft=[rl[_t],"PROJECTION_GLOBE_VIEW"];Ee&&ft.push("CUSTOM_ANTIALIASING"),je&&ft.push(rl[ae]),Q=D.useProgram("globeRaster",null,ft),X=_t},pe=D.colorModeForRenderPass(),we=new s.DepthMode(Y.LEQUAL,s.DepthMode.ReadWrite,D.depthRangeFor3D);to.update(ee);const ve=s.calculateGlobeMercatorMatrix(te),Me=[s.mercatorXfromLng(te.center.lng),s.mercatorYfromLat(te.center.lat)],Oe=ae?[!1,!0]:[!1],ht=D.globeSharedBuffers,ke=[te.width*s.exported.devicePixelRatio,te.height*s.exported.devicePixelRatio],Xe=Float32Array.from(te.globeMatrix),nt={useDenormalizedUpVectorScale:!0};if(Oe.forEach(_t=>{X=-1;const je=_t?Y.LINES:Y.TRIANGLES;for(const ft of W){const it=U.getTile(ft),bt=s.StencilMode.disabled,vt=O.prevTerrainTileForTile[ft.key],zt=O.terrainTileForTile[ft.key];lh(vt,zt)&&to.newMorphing(ft.key,vt,zt,ee,250),K.activeTexture.set(Y.TEXTURE0),it.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const Ut=to.getMorphValuesForProxy(ft.key),Ht=Ut?1:0;Ut&&s.extend$1(nt,{morphing:{srcDemTile:Ut.from,dstDemTile:Ut.to,phase:s.easeCubicInOut(Ut.phase)}});const pi=s.tileCornersToBounds(ft.canonical),Rt=s.getLatitudinalLod(pi.getCenter().lat),Qt=s.getGridMatrix(ft.canonical,pi,Rt),Ei=s.globeNormalizeECEF(s.globeTileBounds(ft.canonical)),Ki=ah(te.projMatrix,Xe,ve,Ei,s.globeToMercatorTransition(te.zoom),Me,te.frustumCorners.TL,te.frustumCorners.TR,te.frustumCorners.BR,te.frustumCorners.BL,te.globeCenterInViewSpace,te.globeRadius,ke,Qt);if(xe(Ht,_t),O.setupElevationDraw(it,Q,nt),D.prepareDrawProgram(K,Q,ft.toUnwrapped()),ht){const[hn,Bi,On]=_t?ht.getWirefameBuffers(D.context,Rt):ht.getGridBuffers(Rt);Q.draw(K,je,we,bt,pe,s.CullFaceMode.backCCW,Ki,"globe_raster",hn,Bi,On)}}}),ht){const _t=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ee&&_t.push("CUSTOM_ANTIALIASING"),Q=D.useProgram("globeRaster",null,_t);for(const je of W){const{x:ft,y:it,z:bt}=je.canonical,vt=it===0,zt=it===(1<<bt)-1,[Ut,Ht,pi,Rt]=ht.getPoleBuffers(bt);if(Rt&&(vt||zt)){const Qt=U.getTile(je);K.activeTexture.set(Y.TEXTURE0),Qt.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);let Ei=s.globePoleMatrixForTile(bt,ft,te);const Ki=s.globeNormalizeECEF(s.globeTileBounds(je.canonical)),hn=(Bi,On)=>Bi.draw(K,Y.TRIANGLES,we,s.StencilMode.disabled,pe,s.CullFaceMode.disabled,ah(te.projMatrix,Ei,Ei,Ki,0,Me,te.frustumCorners.TL,te.frustumCorners.TR,te.frustumCorners.BR,te.frustumCorners.BL,te.globeCenterInViewSpace,te.globeRadius,ke),"globe_pole_raster",On,pi,Rt);O.setupElevationDraw(Qt,Q,nt),D.prepareDrawProgram(K,Q,je.toUnwrapped()),vt&&hn(Q,Ut),zt&&(Ei=s.scale(s.create(),Ei,[1,-1,1]),hn(Q,Ht))}}}})(x,b,S,A,I);else{const D=x.context,O=D.gl;let U,W;const ee=x.options.showTerrainWireframe?2:0,K=(te,Ee)=>{if(W===te)return;const xe=[rl[te]];Ee&&xe.push(rl[ee]),U=x.useProgram("terrainRaster",null,xe),W=te},Y=x.colorModeForRenderPass(),Q=new s.DepthMode(O.LEQUAL,s.DepthMode.ReadWrite,x.depthRangeFor3D);to.update(I);const X=x.transform,ae=6*Math.pow(1.5,22-X.zoom)*b.exaggeration();(ee?[!1,!0]:[!1]).forEach(te=>{W=-1;const Ee=te?O.LINES:O.TRIANGLES,[xe,pe]=te?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const we of A){const ve=S.getTile(we),Me=s.StencilMode.disabled,Oe=b.prevTerrainTileForTile[we.key],ht=b.terrainTileForTile[we.key];lh(Oe,ht)&&to.newMorphing(we.key,Oe,ht,I,250),D.activeTexture.set(O.TEXTURE0),ve.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const ke=to.getMorphValuesForProxy(we.key),Xe=ke?1:0;let nt;ke&&(nt={morphing:{srcDemTile:ke.from,dstDemTile:ke.to,phase:s.easeCubicInOut(ke.phase)}});const _t=oh(we.projMatrix,g_(we.canonical,X.renderWorldCopies)?ae/10:ae);K(Xe,te),b.setupElevationDraw(ve,U,nt),x.prepareDrawProgram(D,U,we.toUnwrapped()),U.draw(D,Ee,Q,Me,Y,s.CullFaceMode.backCCW,_t,"terrain_raster",b.gridBuffer,xe,pe)}})}}(u,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const u=this.painter,g=this.painter.context,x=this.proxySourceCache,b=this.proxiedCoords[x.id],S=this._drapedRenderBatches.shift(),A=[],I=u.style.order;let D=0;for(const O of b){const U=x.getTileByID(O.proxyTileKey),W=x.proxyCachedFBO[O.key]?x.proxyCachedFBO[O.key][o]:void 0,ee=W!==void 0?x.renderCache[W]:this.pool[D++],K=W!==void 0;if(U.texture=ee.tex,K&&!ee.dirty){A.push(U.tileID);continue}let Y;g.bindFramebuffer.set(ee.fb.framebuffer),this.renderedToTile=!1,ee.dirty&&(g.clear({color:s.Color.transparent,stencil:0}),ee.dirty=!1);for(let Q=S.start;Q<=S.end;++Q){const X=u.style._layers[I[Q]];if(X.isHidden(u.transform.zoom))continue;const ae=u.style._getLayerSourceCache(X),te=ae?this.proxyToSource[O.key][ae.id]:[O];if(!te)continue;const Ee=te;g.viewport.set([0,0,ee.fb.width,ee.fb.height]),Y!==(ae?ae.id:null)&&(this._setupStencil(ee,te,X,ae),Y=ae?ae.id:null),u.renderLayer(u,ae,X,Ee)}this.renderedToTile?(ee.dirty=!0,A.push(U.tileID)):K||--D,D===5&&(D=0,this.renderToBackBuffer(A))}return this.renderToBackBuffer(A),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,u.width,u.height]),S.end+1}postRender(){}renderCacheEfficiency(o){const u=o.order.length;if(u===0)return{efficiency:100};let g,x=0,b=0,S=!1;for(let A=0;A<u;++A){const I=o._layers[o.order[A]];this._style.isLayerDraped(I)?(S&&++x,++b):S||(S=!0,g=I.id)}return b===0?{efficiency:100}:{efficiency:100*(1-x/b),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{o=Math.min(o,u.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,u,g){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const S=b.tileID,A=1<<S.overscaledZ,{x:I,y:D}=S.canonical,O=I/A,U=(I+1)/A,W=D/A,ee=(D+1)/A;return{minx:O,miny:W,maxx:U,maxy:ee,t:b.dem.tree.raycastRoot(O,W,U,ee,o,u,g),tile:b}});x.sort((b,S)=>(b.t!==null?b.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const b of x){if(b.t==null)return null;const S=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,o,u,g);if(S!=null)return S}return null}_createFBO(){const o=this.painter.context,u=o.gl,g=this.drapeBufferSize;o.activeTexture.set(u.TEXTURE0);const x=new s.Texture(o,{width:g[0],height:g[1],data:null},u.RGBA);x.bind(u.LINEAR,u.CLAMP_TO_EDGE);const b=o.createFramebuffer(g[0],g[1],!1);return b.colorAttachment.set(x.texture),b.depthAttachment=new N(o,b.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:b,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const u=this._style._layers[o],g=u.isHidden(this.painter.transform.zoom),x=u.getCrossfadeParameters(),b=!!x&&x.t!==1,S=u.hasTransition();return u.type!=="custom"&&!g&&(b||S)})}_clearRasterFadeFromRenderCache(){let o=!1;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u]._source instanceof ce){o=!0;break}if(o)for(let u=0;u<this._style.order.length;++u){const g=this._style._layers[this._style.order[u]],x=g.isHidden(this.painter.transform.zoom),b=this._style._getLayerSourceCache(g);if(g.type!=="raster"||x||!b)continue;const S=g.paint.get("raster-fade-duration");for(const A of this.proxyCoords){const I=this.proxyToSource[A.key][b.id];if(I)for(const D of I){const O=xc(b.getTile(D),b.findLoadedParent(D,0),b,this.painter.transform,S);(O.opacity!==1||O.mix!==0)&&this._clearRenderCacheForTile(b.id,D)}}}}_setupDrapedRenderBatches(){const o=this._style.order,u=o.length;if(u===0)return;const g=[];let x,b=0,S=this._style._layers[o[b]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++b<u;)S=this._style._layers[o[b]];for(;b<u;++b){const A=this._style._layers[o[b]];A.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(A)?x===void 0&&(x=b):x!==void 0&&(g.push({start:x,end:b-1}),x=void 0))}x!==void 0&&g.push({start:x,end:b-1}),this._drapedRenderBatches=g}_setupRenderCache(o){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const S=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let A=0;A<S.length;++A){const I=Object.values(S[A]);u.renderCachePool.push(...I)}}return}this._clearRasterFadeFromRenderCache();const g=this.proxyCoords,x=this._tilesDirty;for(let S=g.length-1;S>=0;S--){const A=g[S];if(u.getTileByID(A.key),u.proxyCachedFBO[A.key]!==void 0){const I=o[A.key],D=this.proxyToSource[A.key];let O=0;for(const U in D){const W=D[U],ee=I[U];if(!ee||ee.length!==W.length||W.some((K,Y)=>K!==ee[Y]||x[U]&&x[U].hasOwnProperty(K.key))){O=-1;break}++O}for(const U in u.proxyCachedFBO[A.key])u.renderCache[u.proxyCachedFBO[A.key][U]].dirty=O<0||O!==Object.values(I).length}}const b=[...this._drapedRenderBatches];b.sort((S,A)=>A.end-A.start-(S.end-S.start));for(const S of b)for(const A of g){if(u.proxyCachedFBO[A.key])continue;let I=u.renderCachePool.pop();I===void 0&&u.renderCache.length<50&&(I=u.renderCache.length,u.renderCache.push(this._createFBO())),I!==void 0&&(u.proxyCachedFBO[A.key]={},u.proxyCachedFBO[A.key][S.start]=I,u.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(o,u,g,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,S=b.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let A;if(g.isTileClipped())A=u.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);A=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+A>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=A,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(o,u){const g=this.painter,x=this.painter.context,b=x.gl;g._tileClippingMaskIDs={},x.setColorMode(s.ColorMode.disabled),x.setDepthMode(s.DepthMode.disabled);const S=g.useProgram("clippingMask");for(const A of o){const I=g._tileClippingMaskIDs[A.key]=--u;S.draw(x,b.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:b.ALWAYS,mask:0},I,255,b.KEEP,b.KEEP,b.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,ch(A.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(o){const u=this.painter.transform;if(o.x<0||o.x>u.width||o.y<0||o.y>u.height)return null;const g=[o.x,o.y,1,1];s.transformMat4$1(g,g,u.pixelMatrixInverse),s.scale$1(g,g,1/g[3]),g[0]/=u.worldSize,g[1]/=u.worldSize;const x=u._camera.position,b=s.mercatorZfromAltitude(1,u.center.lat),S=[x[0],x[1],x[2]/b,0],A=s.subtract([],g.slice(0,3),S);s.normalize(A,A);const I=this.raycast(S,A,this._exaggeration);return I!==null&&I?(s.scaleAndAdd(S,S,A,I),S[3]=S[2],S[2]*=b,S):null}drawDepth(){const o=this.painter,u=o.context,g=this.proxySourceCache,x=Math.ceil(o.width),b=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const S=u.gl,A=u.createFramebuffer(x,b,!0);u.activeTexture.set(S.TEXTURE0);const I=new s.Texture(u,{width:x,height:b,data:null},S.RGBA);I.bind(S.NEAREST,S.CLAMP_TO_EDGE),A.colorAttachment.set(I.texture);const D=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,x,b);A.depthAttachment.set(D),this._depthFBO=A,this._depthTexture=I}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,x,b]),function(S,A,I,D){if(S.transform.projection.name==="globe")return;const O=S.context,U=O.gl;O.clear({depth:1});const W=S.useProgram("terrainDepth"),ee=new s.DepthMode(U.LESS,s.DepthMode.ReadWrite,S.depthRangeFor3D);for(const K of D){const Y=I.getTile(K),Q=oh(K.projMatrix,0);A.setupElevationDraw(Y,W),W.draw(O,U.TRIANGLES,ee,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,Q,"terrain_depth",A.gridBuffer,A.gridIndexBuffer,A.gridNoSkirtSegments)}}(o,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,u,g){if(o.getSource()instanceof Pe)return this._setupProxiedCoordsForImageSource(o,u,g);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const x=this.proxiedCoords[o.id]=[],b=this.proxyCoords;for(let A=0;A<b.length;A++){const I=b[A],D=this._findTileCoveringTileID(I,o);if(D){const O=this._createProxiedId(I,D,g[I.key]&&g[I.key][o.id]);x.push(O),this.proxyToSource[I.key][o.id]=[O]}}let S=!1;for(let A=0;A<u.length;A++){const I=o.getTile(u[A]);if(!I||!I.hasData())continue;const D=this._findTileCoveringTileID(I.tileID,this.proxySourceCache);if(D&&D.tileID.canonical.z!==I.tileID.canonical.z){const O=this.proxyToSource[D.tileID.key][o.id],U=this._createProxiedId(D.tileID,I,g[D.tileID.key]&&g[D.tileID.key][o.id]);O?O.splice(O.length-1,0,U):this.proxyToSource[D.tileID.key][o.id]=[U],x.push(U),S=!0}}this._sourceTilesOverlap[o.id]=S}_setupProxiedCoordsForImageSource(o,u,g){if(!o.getSource().loaded())return;const x=this.proxiedCoords[o.id]=[],b=this.proxyCoords,S=o.getSource(),A=new s.pointGeometry(S.tileID.x,S.tileID.y)._div(1<<S.tileID.z),I=S.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((O,U)=>(O.min.x=Math.min(O.min.x,U.x-A.x),O.min.y=Math.min(O.min.y,U.y-A.y),O.max.x=Math.max(O.max.x,U.x-A.x),O.max.y=Math.max(O.max.y,U.y-A.y),O),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),D=(O,U)=>{const W=O.wrap+O.canonical.x/(1<<O.canonical.z),ee=O.canonical.y/(1<<O.canonical.z),K=s.EXTENT/(1<<O.canonical.z),Y=U.wrap+U.canonical.x/(1<<U.canonical.z),Q=U.canonical.y/(1<<U.canonical.z);return W+K<Y+I.min.x||W>Y+I.max.x||ee+K<Q+I.min.y||ee>Q+I.max.y};for(let O=0;O<b.length;O++){const U=b[O];for(let W=0;W<u.length;W++){const ee=o.getTile(u[W]);if(!ee||!ee.hasData()||D(U,ee.tileID))continue;const K=this._createProxiedId(U,ee,g[U.key]&&g[U.key][o.id]),Y=this.proxyToSource[U.key][o.id];Y?Y.push(K):this.proxyToSource[U.key][o.id]=[K],x.push(K)}}}_createProxiedId(o,u,g){let x=this.orthoMatrix;if(g){const b=g.find(S=>S.key===u.tileID.key);if(b)return b}if(u.tileID.key!==o.key){const b=o.canonical.z-u.tileID.canonical.z;let S,A,I;x=s.create();const D=u.tileID.wrap-o.wrap<<o.overscaledZ;b>0?(S=s.EXTENT>>b,A=S*((u.tileID.canonical.x<<b)-o.canonical.x+D),I=S*((u.tileID.canonical.y<<b)-o.canonical.y)):(S=s.EXTENT<<-b,A=s.EXTENT*(u.tileID.canonical.x-(o.canonical.x+D<<-b)),I=s.EXTENT*(u.tileID.canonical.y-(o.canonical.y<<-b))),s.ortho(x,0,S,0,S,0,1),s.translate(x,x,[A,I,0])}return new bc(u.tileID,o.key,x)}_findTileCoveringTileID(o,u){let g=u.getTile(o);if(g&&g.hasData())return g;const x=this._findCoveringTileCache[u.id],b=x[o.key];if(g=b?u.getTileByID(b):null,g&&g.hasData()||b===null)return g;let S=g?g.tileID:o,A=S.overscaledZ;const I=u.getSource().minzoom,D=[];if(!b){const U=u.getSource().maxzoom;if(o.canonical.z>=U){const W=o.canonical.z-U;u.getSource().reparseOverscaled?(A=Math.max(o.canonical.z+2,u.transform.tileZoom),S=new s.OverscaledTileID(A,o.wrap,U,o.canonical.x>>W,o.canonical.y>>W)):W!==0&&(A=U,S=new s.OverscaledTileID(A,o.wrap,U,o.canonical.x>>W,o.canonical.y>>W))}S.key!==o.key&&(D.push(S.key),g=u.getTile(S))}const O=U=>{D.forEach(W=>{x[W]=U}),D.length=0};for(A-=1;A>=I&&(!g||!g.hasData());A--){g&&O(g.tileID.key);const U=S.calculateScaledKey(A);if(g=u.getTileByID(U),g&&g.hasData())break;const W=x[U];if(W===null)break;W===void 0?D.push(U):g=u.getTileByID(W)}return O(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,u){let g=this._tilesDirty[o];g||(g=this._tilesDirty[o]={}),g[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(u){let g=0;const x=new s.StructArrayLayout2ui4,b=131;for(let S=1;S<129;S++){for(let A=1;A<129;A++)g=S*b+A,x.emplaceBack(g,g+1),x.emplaceBack(g,g+b),x.emplaceBack(g+1,g+b),S===128&&x.emplaceBack(g+b,g+b+1);x.emplaceBack(g+1,g+1+b)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class dh{static cacheKey(o,u,g,x){let b=`${u}${x?x.cacheKey:""}`;for(const S of g)o.usedDefines.includes(S)&&(b+=`/${S}`);return b}constructor(o,u,g,x,b,S){const A=o.gl;this.program=A.createProgram();const I=function(Q){const X=[];for(let ae=0;ae<Q.length;ae++){if(Q[ae]===null)continue;const te=Q[ae].split(" ");X.push(te.pop())}return X}(g.staticAttributes),D=x?x.getBinderAttributes():[],O=I.concat(D);let U=x?x.defines():[];U=U.concat(S.map(Q=>`#define ${Q}`));const W=U.concat(o.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(_c):_c,_c,gc,il.fragmentSource,So.fragmentSource,g.fragmentSource).join(`
`),ee=U.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,gc,il.vertexSource,So.vertexSource,mc.vertexSource,g.vertexSource).join(`
`),K=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(K,W),A.compileShader(K),A.attachShader(this.program,K);const Y=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(Y,ee),A.compileShader(Y),A.attachShader(this.program,Y),this.attributes={},this.numAttributes=O.length;for(let Q=0;Q<this.numAttributes;Q++)O[Q]&&(A.bindAttribLocation(this.program,Q,O[Q]),this.attributes[O[Q]]=Q);A.linkProgram(this.program),A.deleteShader(Y),A.deleteShader(K),this.fixedUniforms=b(o),this.binderUniforms=x?x.getUniforms(o):[],S.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=(Q=>({u_dem:new s.Uniform1i(Q),u_dem_prev:new s.Uniform1i(Q),u_dem_unpack:new s.Uniform4f(Q),u_dem_tl:new s.Uniform2f(Q),u_dem_scale:new s.Uniform1f(Q),u_dem_tl_prev:new s.Uniform2f(Q),u_dem_scale_prev:new s.Uniform1f(Q),u_dem_size:new s.Uniform1f(Q),u_dem_lerp:new s.Uniform1f(Q),u_exaggeration:new s.Uniform1f(Q),u_depth:new s.Uniform1i(Q),u_depth_size_inv:new s.Uniform2f(Q),u_meter_to_dem:new s.Uniform1f(Q),u_label_plane_matrix_inv:new s.UniformMatrix4f(Q),u_tile_tl_up:new s.Uniform3f(Q),u_tile_tr_up:new s.Uniform3f(Q),u_tile_br_up:new s.Uniform3f(Q),u_tile_bl_up:new s.Uniform3f(Q),u_tile_up_scale:new s.Uniform1f(Q)}))(o)),S.indexOf("FOG")!==-1&&(this.fogUniforms=(Q=>({u_fog_matrix:new s.UniformMatrix4f(Q),u_fog_range:new s.Uniform2f(Q),u_fog_color:new s.Uniform4f(Q),u_fog_horizon_blend:new s.Uniform1f(Q),u_fog_temporal_offset:new s.Uniform1f(Q),u_frustum_tl:new s.Uniform3f(Q),u_frustum_tr:new s.Uniform3f(Q),u_frustum_br:new s.Uniform3f(Q),u_frustum_bl:new s.Uniform3f(Q),u_globe_pos:new s.Uniform3f(Q),u_globe_radius:new s.Uniform1f(Q),u_globe_transition:new s.Uniform1f(Q),u_is_globe:new s.Uniform1i(Q),u_viewport:new s.Uniform2f(Q)}))(o))}}setTerrainUniformValues(o,u){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}setFogUniformValues(o,u){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const x in u)g[x].set(this.program,x,u[x])}}draw(o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y){const Q=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(g),o.setStencilMode(x),o.setColorMode(b),o.setCullFace(S);for(const ae of Object.keys(this.fixedUniforms))this.fixedUniforms[ae].set(this.program,ae,A[ae]);K&&K.setUniforms(this.program,o,this.binderUniforms,W,{zoom:ee});const X={[Q.LINES]:2,[Q.TRIANGLES]:3,[Q.LINE_STRIP]:1}[u];for(const ae of U.get()){const te=ae.vaos||(ae.vaos={});(te[I]||(te[I]=new vc)).bind(o,this,D,K?K.getPaintVertexBuffers():[],O,ae.vertexOffset,Y||[]),Q.drawElements(u,ae.primitiveLength*X,Q.UNSIGNED_SHORT,ae.primitiveOffset*X*2)}}}function Nf(p,o,u){const g=1/fn(u,1,o.transform.tileZoom),x=Math.pow(2,u.tileID.overscaledZ),b=u.tileSize*Math.pow(2,o.transform.tileZoom)/x,S=b*(u.tileID.canonical.x+u.tileID.wrap*x),A=b*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[g,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[S>>16,A>>16],u_pixel_coord_lower:[65535&S,65535&A]}}const sl=s.create(),ta=(p,o,u,g,x,b,S,A,I,D,O)=>{const U=o.style.light,W=U.properties.get("position"),ee=[W.x,W.y,W.z],K=s.create$1();U.properties.get("anchor")==="viewport"&&(s.fromRotation(K,-o.transform.angle),s.transformMat3(ee,ee,K));const Y=U.properties.get("color"),Q=o.transform,X={u_matrix:p,u_lightpos:ee,u_lightintensity:U.properties.get("intensity"),u_lightcolor:[Y.r,Y.g,Y.b],u_vertical_gradient:+u,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:sl,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:b};return Q.projection.name==="globe"&&(X.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],X.u_zoom_transition=I,X.u_inv_rot_matrix=O,X.u_merc_center=D,X.u_up_dir=Q.projection.upVector(new s.CanonicalTileID(0,0,0),D[0]*s.EXTENT,D[1]*s.EXTENT),X.u_height_lift=A),X},Uf=(p,o,u,g,x,b,S,A,I,D,O,U,W)=>{const ee=ta(p,o,u,g,x,b,S,D,O,U,W),K={u_height_factor:-Math.pow(2,S.overscaledZ)/I.tileSize/8};return s.extend(ee,Nf(A,o,I),K)},ol=p=>({u_matrix:p}),wc=(p,o,u,g)=>s.extend(ol(p),Nf(u,o,g)),gs=(p,o)=>({u_matrix:p,u_world:o}),fh=(p,o,u,g,x)=>s.extend(wc(p,o,u,g),{u_world:x}),Vf=s.create(),ph=(p,o,u,g,x,b)=>{const S=p.transform,A=S.projection.name==="globe";let I;if(b.paint.get("circle-pitch-alignment")==="map")if(A){const O=s.globePixelsToTileUnits(S.zoom,o.canonical)*S._pixelsPerMercatorPixel;I=Float32Array.from([O,0,0,O])}else I=S.calculatePixelsToTileUnitsMatrix(u);else I=new Float32Array([S.pixelsToGLUnits[0],0,0,S.pixelsToGLUnits[1]]);const D={u_camera_to_center_distance:S.cameraToCenterDistance,u_matrix:p.translatePosMatrix(o.projMatrix,u,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:I,u_inv_rot_matrix:Vf,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(A){D.u_inv_rot_matrix=g,D.u_merc_center=x,D.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],D.u_zoom_transition=s.globeToMercatorTransition(S.zoom);const O=x[0]*s.EXTENT,U=x[1]*s.EXTENT;D.u_up_dir=S.projection.upVector(new s.CanonicalTileID(0,0,0),O,U)}return D},$f=p=>{const o=[];return p.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),p.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},mh=(p,o,u,g)=>{const x=s.EXTENT/u.tileSize;return{u_matrix:p,u_camera_to_center_distance:o.getCameraToCenterDistance(g),u_extrude_scale:[o.pixelsToGLUnits[0]/x,o.pixelsToGLUnits[1]/x]}},jf=(p,o,u=1)=>({u_matrix:p,u_color:o,u_overlay:0,u_overlay_scale:u}),gh=s.create(),__=(p,o,u,g,x,b,S)=>{const A=p.transform,I=A.projection.name==="globe",D=I?s.globePixelsToTileUnits(A.zoom,o.canonical)*A._pixelsPerMercatorPixel:fn(u,1,b),O={u_matrix:o.projMatrix,u_extrude_scale:D,u_intensity:S,u_inv_rot_matrix:gh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){O.u_inv_rot_matrix=g,O.u_merc_center=x,O.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],O.u_zoom_transition=s.globeToMercatorTransition(A.zoom);const U=x[0]*s.EXTENT,W=x[1]*s.EXTENT;O.u_up_dir=A.projection.upVector(new s.CanonicalTileID(0,0,0),U,W)}return O},Tc=(p,o,u,g,x,b,S,A)=>{const I=p.transform,D=I.calculatePixelsToTileUnitsMatrix(o),O={u_matrix:Gf(p,o,u,x),u_pixels_to_tile_units:D,u_device_pixel_ratio:S,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:b,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:A};if(Sc(u)){const U=Ec(o,p.transform);O.u_texsize=o.lineAtlasTexture.size,O.u_scale=[U,g.fromScale,g.toScale],O.u_mix=g.t}return O},y_=(p,o,u,g,x,b)=>{const S=p.transform,A=Ec(o,S);return{u_matrix:Gf(p,o,u,x),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:S.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:b,u_image:0,u_scale:[A,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ec(p,o){return 1/fn(p,1,o.tileZoom)}function Gf(p,o,u,g){return p.translatePosMatrix(g||o.tileID.projMatrix,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function Sc(p){const o=p.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const v_=(p,o,u,g,x,b)=>{return{u_matrix:p,u_tl_parent:o,u_scale_parent:u,u_fade_t:g.mix,u_opacity:g.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(A=x.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(S=x.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Ac(x.paint.get("raster-hue-rotate")),u_perspective_transform:b};var S,A};function Ac(p){p*=Math.PI/180;const o=Math.sin(p),u=Math.cos(p);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const qf=s.create(),_h=(p,o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y)=>{const Q=x.transform,X={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_rotate_symbol:+u,u_aspect_ratio:Q.width/Q.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:S,u_coord_matrix:A,u_is_text:+I,u_pitch_with_map:+g,u_texsize:D,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:qf,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:qf,u_up_vector:[0,-1,0]};return Y.name==="globe"&&(X.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],X.u_zoom_transition=U,X.u_inv_rot_matrix=ee,X.u_merc_center=W,X.u_camera_forward=Q._camera.forward(),X.u_ecef_origin=s.globeECEFOrigin(Q.globeMatrix,O.toUnwrapped()),X.u_tile_matrix=Float32Array.from(Q.globeMatrix),X.u_up_vector=K),X},yh=(p,o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y,Q)=>s.extend(_h(p,o,u,g,x,b,S,A,I,D,U,W,ee,K,Y,Q),{u_gamma_scale:g?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+O}),ia=(p,o,u,g,x,b,S,A,I,D,O,U,W,ee,K,Y)=>s.extend(yh(p,o,u,g,x,b,S,A,!0,I,!0,O,U,W,ee,K,Y),{u_texsize_icon:D,u_texture_icon:1}),x_=(p,o,u)=>({u_matrix:p,u_opacity:o,u_color:u}),b_=(p,o,u,g,x,b)=>s.extend(function(S,A,I,D){const O=I.imageManager.getPattern(S.from.toString()),U=I.imageManager.getPattern(S.to.toString()),{width:W,height:ee}=I.imageManager.getPixelSize(),K=Math.pow(2,D.tileID.overscaledZ),Y=D.tileSize*Math.pow(2,I.transform.tileZoom)/K,Q=Y*(D.tileID.canonical.x+D.tileID.wrap*K),X=Y*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[W,ee],u_mix:A.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:A.fromScale,u_scale_b:A.toScale,u_tile_units_to_pixels:1/fn(D,1,I.transform.tileZoom),u_pixel_coord_upper:[Q>>16,X>>16],u_pixel_coord_lower:[65535&Q,65535&X]}}(g,b,u,x),{u_matrix:p,u_opacity:o}),w_={fillExtrusion:p=>({u_matrix:new s.UniformMatrix4f(p),u_lightpos:new s.Uniform3f(p),u_lightintensity:new s.Uniform1f(p),u_lightcolor:new s.Uniform3f(p),u_vertical_gradient:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_edge_radius:new s.Uniform1f(p),u_ao:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_up_dir:new s.Uniform3f(p),u_height_lift:new s.Uniform1f(p)}),fillExtrusionPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_lightpos:new s.Uniform3f(p),u_lightintensity:new s.Uniform1f(p),u_lightcolor:new s.Uniform3f(p),u_vertical_gradient:new s.Uniform1f(p),u_height_factor:new s.Uniform1f(p),u_edge_radius:new s.Uniform1f(p),u_ao:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_up_dir:new s.Uniform3f(p),u_height_lift:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_scale:new s.Uniform3f(p),u_fade:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p)}),fill:p=>({u_matrix:new s.UniformMatrix4f(p)}),fillPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_scale:new s.Uniform3f(p),u_fade:new s.Uniform1f(p)}),fillOutline:p=>({u_matrix:new s.UniformMatrix4f(p),u_world:new s.Uniform2f(p)}),fillOutlinePattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_world:new s.Uniform2f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_scale:new s.Uniform3f(p),u_fade:new s.Uniform1f(p)}),circle:p=>({u_camera_to_center_distance:new s.Uniform1f(p),u_extrude_scale:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_up_dir:new s.Uniform3f(p)}),collisionBox:p=>({u_matrix:new s.UniformMatrix4f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_extrude_scale:new s.Uniform2f(p)}),collisionCircle:p=>({u_matrix:new s.UniformMatrix4f(p),u_inv_matrix:new s.UniformMatrix4f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_viewport_size:new s.Uniform2f(p)}),debug:p=>({u_color:new s.UniformColor(p),u_matrix:new s.UniformMatrix4f(p),u_overlay:new s.Uniform1i(p),u_overlay_scale:new s.Uniform1f(p)}),clippingMask:p=>({u_matrix:new s.UniformMatrix4f(p)}),heatmap:p=>({u_extrude_scale:new s.Uniform1f(p),u_intensity:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_up_dir:new s.Uniform3f(p)}),heatmapTexture:p=>({u_image:new s.Uniform1i(p),u_color_ramp:new s.Uniform1i(p),u_opacity:new s.Uniform1f(p)}),hillshade:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_latrange:new s.Uniform2f(p),u_light:new s.Uniform2f(p),u_shadow:new s.UniformColor(p),u_highlight:new s.UniformColor(p),u_accent:new s.UniformColor(p)}),hillshadePrepare:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_dimension:new s.Uniform2f(p),u_zoom:new s.Uniform1f(p),u_unpack:new s.Uniform4f(p)}),line:p=>({u_matrix:new s.UniformMatrix4f(p),u_pixels_to_tile_units:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_units_to_pixels:new s.Uniform2f(p),u_dash_image:new s.Uniform1i(p),u_gradient_image:new s.Uniform1i(p),u_image_height:new s.Uniform1f(p),u_texsize:new s.Uniform2f(p),u_scale:new s.Uniform3f(p),u_mix:new s.Uniform1f(p),u_alpha_discard_threshold:new s.Uniform1f(p),u_trim_offset:new s.Uniform2f(p)}),linePattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_texsize:new s.Uniform2f(p),u_pixels_to_tile_units:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_units_to_pixels:new s.Uniform2f(p),u_scale:new s.Uniform3f(p),u_fade:new s.Uniform1f(p),u_alpha_discard_threshold:new s.Uniform1f(p)}),raster:p=>({u_matrix:new s.UniformMatrix4f(p),u_tl_parent:new s.Uniform2f(p),u_scale_parent:new s.Uniform1f(p),u_fade_t:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_image0:new s.Uniform1i(p),u_image1:new s.Uniform1i(p),u_brightness_low:new s.Uniform1f(p),u_brightness_high:new s.Uniform1f(p),u_saturation_factor:new s.Uniform1f(p),u_contrast_factor:new s.Uniform1f(p),u_spin_weights:new s.Uniform3f(p),u_perspective_transform:new s.Uniform2f(p)}),symbolIcon:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_camera_forward:new s.Uniform3f(p),u_tile_matrix:new s.UniformMatrix4f(p),u_up_vector:new s.Uniform3f(p),u_ecef_origin:new s.Uniform3f(p),u_texture:new s.Uniform1i(p)}),symbolSDF:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_texture:new s.Uniform1i(p),u_gamma_scale:new s.Uniform1f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_camera_forward:new s.Uniform3f(p),u_tile_matrix:new s.UniformMatrix4f(p),u_up_vector:new s.Uniform3f(p),u_ecef_origin:new s.Uniform3f(p),u_is_halo:new s.Uniform1i(p)}),symbolTextAndIcon:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_texsize_icon:new s.Uniform2f(p),u_texture:new s.Uniform1i(p),u_texture_icon:new s.Uniform1i(p),u_gamma_scale:new s.Uniform1f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_is_halo:new s.Uniform1i(p)}),background:p=>({u_matrix:new s.UniformMatrix4f(p),u_opacity:new s.Uniform1f(p),u_color:new s.UniformColor(p)}),backgroundPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_opacity:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_pattern_tl_a:new s.Uniform2f(p),u_pattern_br_a:new s.Uniform2f(p),u_pattern_tl_b:new s.Uniform2f(p),u_pattern_br_b:new s.Uniform2f(p),u_texsize:new s.Uniform2f(p),u_mix:new s.Uniform1f(p),u_pattern_size_a:new s.Uniform2f(p),u_pattern_size_b:new s.Uniform2f(p),u_scale_a:new s.Uniform1f(p),u_scale_b:new s.Uniform1f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p)}),terrainRaster:nl,terrainDepth:nl,skybox:p=>({u_matrix:new s.UniformMatrix4f(p),u_sun_direction:new s.Uniform3f(p),u_cubemap:new s.Uniform1i(p),u_opacity:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p)}),skyboxGradient:p=>({u_matrix:new s.UniformMatrix4f(p),u_color_ramp:new s.Uniform1i(p),u_center_direction:new s.Uniform3f(p),u_radius:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p)}),skyboxCapture:p=>({u_matrix_3f:new s.UniformMatrix3f(p),u_sun_direction:new s.Uniform3f(p),u_sun_intensity:new s.Uniform1f(p),u_color_tint_r:new s.Uniform4f(p),u_color_tint_m:new s.Uniform4f(p),u_luminance:new s.Uniform1f(p)}),globeRaster:p=>({u_proj_matrix:new s.UniformMatrix4f(p),u_globe_matrix:new s.UniformMatrix4f(p),u_normalize_matrix:new s.UniformMatrix4f(p),u_merc_matrix:new s.UniformMatrix4f(p),u_zoom_transition:new s.Uniform1f(p),u_merc_center:new s.Uniform2f(p),u_image0:new s.Uniform1i(p),u_grid_matrix:new s.UniformMatrix3f(p),u_frustum_tl:new s.Uniform3f(p),u_frustum_tr:new s.Uniform3f(p),u_frustum_br:new s.Uniform3f(p),u_frustum_bl:new s.Uniform3f(p),u_globe_pos:new s.Uniform3f(p),u_globe_radius:new s.Uniform1f(p),u_viewport:new s.Uniform2f(p)}),globeAtmosphere:p=>({u_frustum_tl:new s.Uniform3f(p),u_frustum_tr:new s.Uniform3f(p),u_frustum_br:new s.Uniform3f(p),u_frustum_bl:new s.Uniform3f(p),u_horizon:new s.Uniform1f(p),u_transition:new s.Uniform1f(p),u_fadeout_range:new s.Uniform1f(p),u_color:new s.Uniform4f(p),u_high_color:new s.Uniform4f(p),u_space_color:new s.Uniform4f(p),u_star_intensity:new s.Uniform1f(p),u_star_density:new s.Uniform1f(p),u_star_size:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p),u_horizon_angle:new s.Uniform1f(p),u_rotation_matrix:new s.UniformMatrix4f(p)})};let Cc;function Wf(p,o,u,g,x,b,S){const A=p.context,I=A.gl,D=p.transform,O=p.useProgram("collisionBox"),U=[];let W=0,ee=0;for(let Ee=0;Ee<g.length;Ee++){const xe=g[Ee],pe=o.getTile(xe),we=pe.getBucket(u);if(!we)continue;const ve=hr(xe,we,D);let Me=ve;x[0]===0&&x[1]===0||(Me=p.translatePosMatrix(ve,pe,x,b));const Oe=S?we.textCollisionBox:we.iconCollisionBox,ht=we.collisionCircleArray;if(ht.length>0){const ke=s.create(),Xe=Me;s.mul(ke,we.placementInvProjMatrix,D.glCoordMatrix),s.mul(ke,ke,we.placementViewportMatrix),U.push({circleArray:ht,circleOffset:ee,transform:Xe,invTransform:ke,projection:we.getProjection()}),W+=ht.length/4,ee=W}Oe&&(p.terrain&&p.terrain.setupElevationDraw(pe,O),O.draw(A,I.LINES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,mh(Me,D,pe,we.getProjection()),u.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,null,D.zoom,null,[Oe.collisionVertexBuffer,Oe.collisionVertexBufferExt]))}if(!S||!U.length)return;const K=p.useProgram("collisionCircle"),Y=new s.StructArrayLayout2f1f2i16;Y.resize(4*W),Y._trim();let Q=0;for(const Ee of U)for(let xe=0;xe<Ee.circleArray.length/4;xe++){const pe=4*xe,we=Ee.circleArray[pe+0],ve=Ee.circleArray[pe+1],Me=Ee.circleArray[pe+2],Oe=Ee.circleArray[pe+3];Y.emplace(Q++,we,ve,Me,Oe,0),Y.emplace(Q++,we,ve,Me,Oe,1),Y.emplace(Q++,we,ve,Me,Oe,2),Y.emplace(Q++,we,ve,Me,Oe,3)}(!Cc||Cc.length<2*W)&&(Cc=function(Ee){const xe=2*Ee,pe=new s.StructArrayLayout3ui6;pe.resize(xe),pe._trim();for(let we=0;we<xe;we++){const ve=6*we;pe.uint16[ve+0]=4*we+0,pe.uint16[ve+1]=4*we+1,pe.uint16[ve+2]=4*we+2,pe.uint16[ve+3]=4*we+2,pe.uint16[ve+4]=4*we+3,pe.uint16[ve+5]=4*we+0}return pe}(W));const X=A.createIndexBuffer(Cc,!0),ae=A.createVertexBuffer(Y,s.collisionCircleLayout.members,!0);for(const Ee of U){const xe={u_matrix:Ee.transform,u_inv_matrix:Ee.invTransform,u_camera_to_center_distance:(te=D).getCameraToCenterDistance(Ee.projection),u_viewport_size:[te.width,te.height]};K.draw(A,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,xe,u.id,ae,X,s.SegmentVector.simpleSegment(0,2*Ee.circleOffset,Ee.circleArray.length,Ee.circleArray.length/2),null,D.zoom)}var te;ae.destroy(),X.destroy()}const Hf=s.create();function vh(p,o,u,g,x,b){const{horizontalAlign:S,verticalAlign:A}=s.getAnchorAlignment(p),I=-(S-.5)*o,D=-(A-.5)*u,O=s.evaluateVariableOffset(p,g);return new s.pointGeometry((I/x+O[0])*b,(D/x+O[1])*b)}function xh(p,o,u,g,x,b,S,A,I,D,O){const U=p.text.placedSymbolArray,W=p.text.dynamicLayoutVertexArray,ee=p.icon.dynamicLayoutVertexArray,K={},Y=dr(A,p.getProjection(),b),Q=b.elevation,X=p.getProjection().upVectorScale(A.canonical,b.center.lat,b.worldSize);W.clear();for(let ae=0;ae<U.length;ae++){const te=U.get(ae),Ee=p.allowVerticalPlacement&&!te.placedOrientation,xe=te.hidden||!te.crossTileID||Ee?null:g[te.crossTileID];if(xe){const pe=new s.pointGeometry(te.tileAnchorX,te.tileAnchorY),we=p.getProjection().upVector(A.canonical,pe.x,pe.y),ve=Q?Q.getAtTileOffset(A,pe.x,pe.y):0,Me=ii([te.projectedAnchorX+ve*we[0]*X.metersToTile,te.projectedAnchorY+ve*we[1]*X.metersToTile,te.projectedAnchorZ+ve*we[2]*X.metersToTile],u?Y:S),Oe=Za(b.getCameraToCenterDistance(p.getProjection()),Me.signedDistanceFromCamera);let ht=x.evaluateSizeForFeature(p.textSizeData,D,te)*Oe/s.ONE_EM;u&&(ht*=p.tilePixelRatio/I);const{width:ke,height:Xe,anchor:nt,textOffset:_t,textScale:je}=xe,ft=vh(nt,ke,Xe,_t,je,ht);let it;if(u){const vt=pe.add(ft),{x:zt,y:Ut,z:Ht}=p.getProjection().projectTilePoint(vt.x,vt.y,A.canonical);it=ii([zt+ve*we[0]*X.metersToTile,Ut+ve*we[1]*X.metersToTile,Ht+ve*we[2]*X.metersToTile],S).point}else{const vt=o?ft.rotate(-b.angle):ft;it=[Me.point[0]+vt.x,Me.point[1]+vt.y,0]}const bt=p.allowVerticalPlacement&&te.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let vt=0;vt<te.numGlyphs;vt++)s.addDynamicAttributes(W,it[0],it[1],it[2],bt);O&&te.associatedIconIndex>=0&&(K[te.associatedIconIndex]={shiftedAnchor:it,angle:bt})}else Ys(te.numGlyphs,W)}if(O){ee.clear();const ae=p.icon.placedSymbolArray;for(let te=0;te<ae.length;te++){const Ee=ae.get(te);if(Ee.hidden)Ys(Ee.numGlyphs,ee);else{const xe=K[te];if(xe)for(let pe=0;pe<Ee.numGlyphs;pe++)s.addDynamicAttributes(ee,xe.shiftedAnchor[0],xe.shiftedAnchor[1],xe.shiftedAnchor[2],xe.angle);else Ys(Ee.numGlyphs,ee)}}p.icon.dynamicLayoutVertexBuffer.updateData(ee)}p.text.dynamicLayoutVertexBuffer.updateData(W)}function Zf(p,o,u){return u.iconsInText&&o?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function bh(p,o,u,g,x,b,S,A,I,D,O,U){const W=p.context,ee=W.gl,K=p.transform,Y=A==="map",Q=I==="map",X=Y&&u.layout.get("symbol-placement")!=="point",ae=Y&&!Q&&!X,te=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ee=!1;const xe=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),pe=[s.mercatorXfromLng(K.center.lng),s.mercatorYfromLat(K.center.lat)],we=u.layout.get("text-variable-anchor"),ve=K.projection.name==="globe",Me=[],Oe=[0,-1,0];let ht=Oe;!ve&&!K.mercatorFromTransition||Y||(ht=function(ke){const Xe=ke._camera.getWorldToCamera(ke.worldSize,1),nt=s.multiply([],Xe,ke.globeMatrix);s.invert(nt,nt);const _t=[0,0,0],je=[0,1,0,0];return s.transformMat4$1(je,je,nt),_t[0]=je[0],_t[1]=je[1],_t[2]=je[2],s.normalize(_t,_t),_t}(K));for(const ke of g){const Xe=o.getTile(ke),nt=Xe.getBucket(u);if(!nt||nt.projection.name==="mercator"&&ve)continue;const _t=x?nt.text:nt.icon;if(!_t||nt.fullyClipped||!_t.segments.get().length)continue;const je=_t.programConfigurations.get(u.id),ft=x||nt.sdfIcons,it=x?nt.textSizeData:nt.iconSizeData,bt=Q||K.pitch!==0,vt=s.evaluateSizeForZoom(it,K.zoom);let zt,Ut,Ht,pi,Rt=[0,0],Qt=null;if(x){if(Ut=Xe.glyphAtlasTexture,Ht=ee.LINEAR,zt=Xe.glyphAtlasTexture.size,nt.iconsInText){Rt=Xe.imageAtlasTexture.size,Qt=Xe.imageAtlasTexture;const rr=it.kind==="composite"||it.kind==="camera";pi=bt||p.options.rotating||p.options.zooming||rr?ee.LINEAR:ee.NEAREST}}else{const rr=u.layout.get("icon-size").constantOr(0)!==1||nt.iconsNeedLinear;Ut=Xe.imageAtlasTexture,Ht=ft||p.options.rotating||p.options.zooming||rr||bt?ee.LINEAR:ee.NEAREST,zt=Xe.imageAtlasTexture.size}const Ei=nt.projection.name==="globe",Ki=Ei?ht:Oe,hn=Ei?s.globeToMercatorTransition(K.zoom):0,Bi=dr(ke,nt.getProjection(),K),On=K.calculatePixelsToTileUnitsMatrix(Xe),Kr=hi(Bi,Xe.tileID.canonical,Q,Y,K,nt.getProjection(),On),Ls=p.terrain&&Q&&X?s.invert(s.create(),Kr):Hf,Yi=Wr(Bi,Xe.tileID.canonical,Q,Y,K,nt.getProjection(),On),rn=we&&nt.hasTextData(),ai=u.layout.get("icon-text-fit")!=="none"&&rn&&nt.hasIconData();if(X){const rr=K.elevation,Lo=rr?rr.getAtTileOffsetFunc(ke,K.center.lat,K.worldSize,nt.getProjection()):Tl=>[0,0,0],no=di(Bi,Xe.tileID.canonical,Q,Y,K,nt.getProjection(),On);Ka(nt,Bi,p,x,no,Yi,Q,D,Lo,ke)}const bn=X||x&&we||ai,Hn=p.translatePosMatrix(Bi,Xe,b,S),ji=bn?Hf:Kr,Zn=p.translatePosMatrix(Yi,Xe,b,S,!0),Mo=nt.getProjection().createInversionMatrix(K,ke.canonical),nr=[];p.terrain&&Q&&nr.push("PITCH_WITH_MAP_TERRAIN"),Ei&&nr.push("PROJECTION_GLOBE_VIEW"),bn&&nr.push("PROJECTED_POS_ON_VIEWPORT");const Io=ft&&u.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Po;Po=ft?nt.iconsInText?ia(it.kind,vt,ae,Q,p,Hn,ji,Zn,zt,Rt,ke,hn,pe,Mo,Ki,nt.getProjection()):yh(it.kind,vt,ae,Q,p,Hn,ji,Zn,x,zt,!0,ke,hn,pe,Mo,Ki,nt.getProjection()):_h(it.kind,vt,ae,Q,p,Hn,ji,Zn,x,zt,ke,hn,pe,Mo,Ki,nt.getProjection());const ko={program:p.useProgram(Zf(ft,x,nt),je,nr),buffers:_t,uniformValues:Po,atlasTexture:Ut,atlasTextureIcon:Qt,atlasInterpolation:Ht,atlasInterpolationIcon:pi,isSDF:ft,hasHalo:Io,tile:Xe,labelPlaneMatrixInv:Ls};if(te&&nt.canOverlap){Ee=!0;const rr=_t.segments.get();for(const Lo of rr)Me.push({segments:new s.SegmentVector([Lo]),sortKey:Lo.sortKey,state:ko})}else Me.push({segments:_t.segments,sortKey:0,state:ko})}Ee&&Me.sort((ke,Xe)=>ke.sortKey-Xe.sortKey);for(const ke of Me){const Xe=ke.state;if(p.terrain&&p.terrain.setupElevationDraw(Xe.tile,Xe.program,{useDepthForOcclusion:!ve,labelPlaneMatrixInv:Xe.labelPlaneMatrixInv}),W.activeTexture.set(ee.TEXTURE0),Xe.atlasTexture.bind(Xe.atlasInterpolation,ee.CLAMP_TO_EDGE),Xe.atlasTextureIcon&&(W.activeTexture.set(ee.TEXTURE1),Xe.atlasTextureIcon&&Xe.atlasTextureIcon.bind(Xe.atlasInterpolationIcon,ee.CLAMP_TO_EDGE)),Xe.isSDF){const nt=Xe.uniformValues;Xe.hasHalo&&(nt.u_is_halo=1,wh(Xe.buffers,ke.segments,u,p,Xe.program,xe,O,U,nt)),nt.u_is_halo=0}wh(Xe.buffers,ke.segments,u,p,Xe.program,xe,O,U,Xe.uniformValues)}}function wh(p,o,u,g,x,b,S,A,I){const D=g.context,O=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.globeExtVertexBuffer];x.draw(D,D.gl.TRIANGLES,b,S,A,s.CullFaceMode.disabled,I,u.id,p.layoutVertexBuffer,p.indexBuffer,o,u.paint,g.transform.zoom,p.programConfigurations.get(u.id),O)}function Mc(p,o,u,g,x,b,S){const A=p.context.gl,I=u.paint.get("fill-pattern"),D=I&&I.constantOr(1),O=u.getCrossfadeParameters();let U,W,ee,K,Y;S?(W=D&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=A.LINES):(W=D?"fillPattern":"fill",U=A.TRIANGLES);for(const Q of g){const X=o.getTile(Q);if(D&&!X.patternsLoaded())continue;const ae=X.getBucket(u);if(!ae)continue;p.prepareDrawTile();const te=ae.programConfigurations.get(u.id),Ee=p.useProgram(W,te);D&&(p.context.activeTexture.set(A.TEXTURE0),X.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),te.updatePaintBuffers(O));const xe=I.constantOr(null);if(xe&&X.imageAtlas){const we=X.imageAtlas,ve=we.patternPositions[xe.to.toString()],Me=we.patternPositions[xe.from.toString()];ve&&Me&&te.setConstantPatternPositions(ve,Me)}const pe=p.translatePosMatrix(Q.projMatrix,X,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(S){K=ae.indexBuffer2,Y=ae.segments2;const we=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[A.drawingBufferWidth,A.drawingBufferHeight];ee=W==="fillOutlinePattern"&&D?fh(pe,p,O,X,we):gs(pe,we)}else K=ae.indexBuffer,Y=ae.segments,ee=D?wc(pe,p,O,X):ol(pe);p.prepareDrawProgram(p.context,Ee,Q.toUnwrapped()),Ee.draw(p.context,U,x,p.stencilModeForClipping(Q),b,s.CullFaceMode.disabled,ee,u.id,ae.layoutVertexBuffer,K,Y,u.paint,p.transform.zoom,te)}}function Is(p,o,u,g,x,b,S){const A=p.context,I=A.gl,D=p.transform,O=u.paint.get("fill-extrusion-pattern"),U=O.constantOr(1),W=u.getCrossfadeParameters(),ee=u.paint.get("fill-extrusion-opacity"),K=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),u.paint.get("fill-extrusion-ambient-occlusion-radius")],Y=u.layout.get("fill-extrusion-edge-radius"),Q=D.projection.name==="globe"?s.fillExtrusionHeightLift():0,X=D.projection.name==="globe",ae=X?s.globeToMercatorTransition(D.zoom):0,te=[s.mercatorXfromLng(D.center.lng),s.mercatorYfromLat(D.center.lat)],Ee=[];X&&(Ee.push("PROJECTION_GLOBE_VIEW"),p.style.terrainSetForDrapingOnly()&&Ee.push("TERRAIN")),K[0]>0&&Ee.push("FAUX_AO");for(const xe of g){const pe=o.getTile(xe),we=pe.getBucket(u);if(!we||we.projection.name!==D.projection.name)continue;const ve=we.programConfigurations.get(u.id),Me=p.useProgram(U?"fillExtrusionPattern":"fillExtrusion",ve,Ee);if(p.terrain){const je=p.terrain;if(p.style.terrainSetForDrapingOnly())je.setupElevationDraw(pe,Me,{useMeterToDem:!0});else{if(!we.enableTerrain)continue;if(je.setupElevationDraw(pe,Me,{useMeterToDem:!0}),al(A,o,xe,we,u,je),!we.centroidVertexBuffer){const ft=Me.attributes.a_centroid_pos;ft!==void 0&&I.vertexAttrib2f(ft,0,0)}}}U&&(p.context.activeTexture.set(I.TEXTURE0),pe.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ve.updatePaintBuffers(W));const Oe=O.constantOr(null);if(Oe&&pe.imageAtlas){const je=pe.imageAtlas,ft=je.patternPositions[Oe.to.toString()],it=je.patternPositions[Oe.from.toString()];ft&&it&&ve.setConstantPatternPositions(ft,it)}const ht=p.translatePosMatrix(xe.projMatrix,pe,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),ke=D.projection.createInversionMatrix(D,xe.canonical),Xe=u.paint.get("fill-extrusion-vertical-gradient"),nt=U?Uf(ht,p,Xe,ee,K,Y,xe,W,pe,Q,ae,te,ke):ta(ht,p,Xe,ee,K,Y,xe,Q,ae,te,ke);p.prepareDrawProgram(A,Me,xe.toUnwrapped());const _t=[];p.terrain&&_t.push(we.centroidVertexBuffer),X&&_t.push(we.layoutVertexExtBuffer),Me.draw(A,A.gl.TRIANGLES,x,b,S,s.CullFaceMode.backCCW,nt,u.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,u.paint,p.transform.zoom,ve,_t)}}function al(p,o,u,g,x,b){const S=[X=>{let ae=X.canonical.x-1,te=X.wrap;return ae<0&&(ae=(1<<X.canonical.z)-1,te--),new s.OverscaledTileID(X.overscaledZ,te,X.canonical.z,ae,X.canonical.y)},X=>{let ae=X.canonical.x+1,te=X.wrap;return ae===1<<X.canonical.z&&(ae=0,te++),new s.OverscaledTileID(X.overscaledZ,te,X.canonical.z,ae,X.canonical.y)},X=>new s.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,(X.canonical.y===0?1<<X.canonical.z:X.canonical.y)-1),X=>new s.OverscaledTileID(X.overscaledZ,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y===(1<<X.canonical.z)-1?0:X.canonical.y+1)],A=X=>{const ae=o.getSource().minzoom,te=xe=>{const pe=o.getTileByID(xe);if(pe&&pe.hasData())return pe.getBucket(x)},Ee=[0,-1,1];for(const xe of Ee){if(X.overscaledZ+xe<ae)continue;const pe=te(X.calculateScaledKey(X.overscaledZ+xe));if(pe)return pe}},I=[0,0,0],D=(X,ae)=>(I[0]=Math.min(X.min.y,ae.min.y),I[1]=Math.max(X.max.y,ae.max.y),I[2]=s.EXTENT-ae.min.x>X.max.x?ae.min.x-s.EXTENT:X.max.x,I),O=(X,ae)=>(I[0]=Math.min(X.min.x,ae.min.x),I[1]=Math.max(X.max.x,ae.max.x),I[2]=s.EXTENT-ae.min.y>X.max.y?ae.min.y-s.EXTENT:X.max.y,I),U=[(X,ae)=>D(X,ae),(X,ae)=>D(ae,X),(X,ae)=>O(X,ae),(X,ae)=>O(ae,X)],W=new s.pointGeometry(0,0);let ee,K,Y;const Q=(X,ae,te,Ee,xe)=>{const pe=[[Ee?te:X,Ee?X:te,0],[Ee?te:ae,Ee?ae:te,0]],we=xe<0?s.EXTENT+xe:xe,ve=[Ee?we:(X+ae)/2,Ee?(X+ae)/2:we,0];return te===0&&xe<0||te!==0&&xe>0?b.getForTilePoints(Y,[ve],!0,K):pe.push(ve),b.getForTilePoints(u,pe,!0,ee),Math.max(pe[0][2],pe[1][2],ve[2])/b.exaggeration()};for(let X=0;X<4;X++){const ae=(X<2?1:5)-X,te=g.borders[X];if(te.length===0)continue;const Ee=Y=S[X](u),xe=A(Ee);if(!(xe&&xe instanceof s.FillExtrusionBucket&&xe.enableTerrain)||g.borderDoneWithNeighborZ[X]===xe.canonical.z&&xe.borderDoneWithNeighborZ[ae]===g.canonical.z||(K=b.findDEMTileFor(Ee),!K||!K.dem))continue;if(!ee){const Me=b.findDEMTileFor(u);if(!Me||!Me.dem)return;ee=Me}const pe=xe.borders[ae];let we=0;const ve=xe.borderDoneWithNeighborZ[ae]!==g.canonical.z;if(g.canonical.z===xe.canonical.z){for(let Me=0;Me<te.length;Me++){const Oe=g.featuresOnBorder[te[Me]],ht=Oe.borders[X];let ke;for(;we<pe.length&&(ke=xe.featuresOnBorder[pe[we]],!(ke.borders[ae][1]>ht[0]+3));)ve&&xe.encodeCentroid(void 0,ke,!1),we++;if(ke&&we<pe.length){const Xe=we;let nt=0;for(;!(ke.borders[ae][0]>ht[1]-3)&&(nt++,++we!==pe.length);)ke=xe.featuresOnBorder[pe[we]];if(ke=xe.featuresOnBorder[pe[Xe]],Oe.intersectsCount()>1||ke.intersectsCount()>1||nt!==1){nt!==1&&(we=Xe),g.encodeCentroid(void 0,Oe,!1),ve&&xe.encodeCentroid(void 0,ke,!1);continue}const _t=U[X](Oe,ke),je=X%2?s.EXTENT-1:0;W.x=Q(_t[0],Math.min(s.EXTENT-1,_t[1]),je,X<2,_t[2]),W.y=0,g.encodeCentroid(W,Oe,!1),ve&&xe.encodeCentroid(W,ke,!1)}else g.encodeCentroid(void 0,Oe,!1)}g.borderDoneWithNeighborZ[X]=xe.canonical.z,g.needsCentroidUpdate=!0,ve&&(xe.borderDoneWithNeighborZ[ae]=g.canonical.z,xe.needsCentroidUpdate=!0)}else{for(const Me of te)g.encodeCentroid(void 0,g.featuresOnBorder[Me],!1);if(ve){for(const Me of pe)xe.encodeCentroid(void 0,xe.featuresOnBorder[Me],!1);xe.borderDoneWithNeighborZ[ae]=g.canonical.z,xe.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[X]=xe.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(p)}const Xf=new s.Color(1,0,0,1),na=new s.Color(0,1,0,1),ra=new s.Color(0,0,1,1),Kf=new s.Color(1,0,1,1),Th=new s.Color(0,1,1,1);function ki(p,o,u){const g=p.context,x=p.transform,b=g.gl,S=x.projection.name==="globe",A=S?["PROJECTION_GLOBE_VIEW"]:null;let I=u.projMatrix;if(S&&s.globeToMercatorTransition(x.zoom)>0){const Oe=s.transitionTileAABBinECEF(u.canonical,x),ht=s.globeDenormalizeECEF(Oe);I=s.multiply(new Float32Array(16),x.globeMatrix,ht),s.multiply(I,x.projMatrix,I)}const D=p.useProgram("debug",null,A),O=o.getTileByID(u.key);p.terrain&&p.terrain.setupElevationDraw(O,D);const U=s.DepthMode.disabled,W=s.StencilMode.disabled,ee=p.colorModeForRenderPass(),K="$debug";g.activeTexture.set(b.TEXTURE0),p.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),S?O._makeGlobeTileDebugBuffers(p.context,x):O._makeDebugTileBoundsBuffers(p.context,x.projection);const Y=O._tileDebugBuffer||p.debugBuffer,Q=O._tileDebugIndexBuffer||p.debugIndexBuffer,X=O._tileDebugSegments||p.debugSegments;D.draw(g,b.LINE_STRIP,U,W,ee,s.CullFaceMode.disabled,jf(I,s.Color.red),K,Y,Q,X,null,null,null,[O._globeTileDebugBorderBuffer]);const ae=O.latestRawTileData,te=Math.floor((ae&&ae.byteLength||0)/1024),Ee=o.getTile(u).tileSize,xe=512/Math.min(Ee,512)*(u.overscaledZ/x.zoom)*.5;let pe=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(pe+=` => ${u.overscaledZ}`),pe+=` ${te}kb`,function(Oe,ht){Oe.initDebugOverlayCanvas();const ke=Oe.debugOverlayCanvas,Xe=Oe.context.gl,nt=Oe.debugOverlayCanvas.getContext("2d");nt.clearRect(0,0,ke.width,ke.height),nt.shadowColor="white",nt.shadowBlur=2,nt.lineWidth=1.5,nt.strokeStyle="white",nt.textBaseline="top",nt.font="bold 36px Open Sans, sans-serif",nt.fillText(ht,5,5),nt.strokeText(ht,5,5),Oe.debugOverlayTexture.update(ke),Oe.debugOverlayTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE)}(p,pe);const we=O._tileDebugTextBuffer||p.debugBuffer,ve=O._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,Me=O._tileDebugTextSegments||p.debugSegments;D.draw(g,b.TRIANGLES,U,W,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,jf(I,s.Color.transparent,xe),K,we,ve,Me,null,null,null,[O._globeTileDebugTextBuffer])}function ll(p,o,u,g){cl(p,0,o+u/2,p.transform.width,u,g)}function Yf(p,o,u,g){cl(p,o-u/2,0,u,p.transform.height,g)}function cl(p,o,u,g,x,b){const S=p.context,A=S.gl;A.enable(A.SCISSOR_TEST),A.scissor(o*s.exported.devicePixelRatio,u*s.exported.devicePixelRatio,g*s.exported.devicePixelRatio,x*s.exported.devicePixelRatio),S.clear({color:b}),A.disable(A.SCISSOR_TEST)}const ul=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:T_}=ul;function io(p,o,u,g){p.emplaceBack(o,u,g)}class Eh{constructor(o){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,io(this.vertexArray,-1,-1,1),io(this.vertexArray,1,-1,1),io(this.vertexArray,-1,1,1),io(this.vertexArray,1,1,1),io(this.vertexArray,-1,-1,-1),io(this.vertexArray,1,-1,-1),io(this.vertexArray,-1,1,-1),io(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,T_),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function sa(p,o,u,g,x,b){const S=p.gl,A=o.paint.get("sky-atmosphere-color"),I=o.paint.get("sky-atmosphere-halo-color"),D=o.paint.get("sky-atmosphere-sun-intensity"),O=((U,W,ee,K,Y)=>({u_matrix_3f:U,u_sun_direction:W,u_sun_intensity:ee,u_color_tint_r:[K.r,K.g,K.b,K.a],u_color_tint_m:[Y.r,Y.g,Y.b,Y.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),g),x,D,A,I);S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+b,o.skyboxTexture,0),u.draw(p,S.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,O,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const Sh=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Ic{constructor(o){const u=new s.StructArrayLayout5f20;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const g=new s.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(u,Sh.members),this.indexBuffer=o.createIndexBuffer(g),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const oa={symbol:function(p,o,u,g,x){if(p.renderPass!=="translucent")return;const b=s.StencilMode.disabled,S=p.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(A,I,D,O,U,W,ee){const K=I.transform,Y=U==="map",Q=W==="map";for(const X of A){const ae=O.getTile(X),te=ae.getBucket(D);if(!te||!te.text||!te.text.segments.get().length)continue;const Ee=s.evaluateSizeForZoom(te.textSizeData,K.zoom),xe=dr(X,te.getProjection(),K),pe=K.calculatePixelsToTileUnitsMatrix(ae),we=hi(xe,ae.tileID.canonical,Q,Y,K,te.getProjection(),pe),ve=D.layout.get("icon-text-fit")!=="none"&&te.hasIconData();if(Ee){const Me=Math.pow(2,K.zoom-ae.tileID.overscaledZ);xh(te,Y,Q,ee,s.symbolSize,K,we,X,Me,Ee,ve)}}}(g,p,u,o,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),x),u.paint.get("icon-opacity").constantOr(1)!==0&&bh(p,o,u,g,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),b,S),u.paint.get("text-opacity").constantOr(1)!==0&&bh(p,o,u,g,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),b,S),o.map.showCollisionBoxes&&(Wf(p,o,u,g,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Wf(p,o,u,g,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(p,o,u,g){if(p.renderPass!=="translucent")return;const x=u.paint.get("circle-opacity"),b=u.paint.get("circle-stroke-width"),S=u.paint.get("circle-stroke-opacity"),A=u.layout.get("circle-sort-key").constantOr(1)!==void 0;if(x.constantOr(1)===0&&(b.constantOr(1)===0||S.constantOr(1)===0))return;const I=p.context,D=I.gl,O=p.transform,U=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),W=s.StencilMode.disabled,ee=p.colorModeForRenderPass(),K=O.projection.name==="globe",Y=[s.mercatorXfromLng(O.center.lng),s.mercatorYfromLat(O.center.lat)],Q=[];for(let ae=0;ae<g.length;ae++){const te=g[ae],Ee=o.getTile(te),xe=Ee.getBucket(u);if(!xe||xe.projection.name!==O.projection.name)continue;const pe=xe.programConfigurations.get(u.id),we=$f(u);K&&we.push("PROJECTION_GLOBE_VIEW");const ve=p.useProgram("circle",pe,we),Me=xe.layoutVertexBuffer,Oe=xe.globeExtVertexBuffer,ht=xe.indexBuffer,ke=O.projection.createInversionMatrix(O,te.canonical),Xe={programConfiguration:pe,program:ve,layoutVertexBuffer:Me,globeExtVertexBuffer:Oe,indexBuffer:ht,uniformValues:ph(p,te,Ee,ke,Y,u),tile:Ee};if(A){const nt=xe.segments.get();for(const _t of nt)Q.push({segments:new s.SegmentVector([_t]),sortKey:_t.sortKey,state:Xe})}else Q.push({segments:xe.segments,sortKey:0,state:Xe})}A&&Q.sort((ae,te)=>ae.sortKey-te.sortKey);const X={useDepthForOcclusion:!K};for(const ae of Q){const{programConfiguration:te,program:Ee,layoutVertexBuffer:xe,globeExtVertexBuffer:pe,indexBuffer:we,uniformValues:ve,tile:Me}=ae.state,Oe=ae.segments;p.terrain&&p.terrain.setupElevationDraw(Me,Ee,X),p.prepareDrawProgram(I,Ee,Me.tileID.toUnwrapped()),Ee.draw(I,D.TRIANGLES,U,W,ee,s.CullFaceMode.disabled,ve,u.id,xe,we,Oe,u.paint,O.zoom,te,[pe])}},heatmap:function(p,o,u,g){if(u.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const x=p.context,b=x.gl,S=s.StencilMode.disabled,A=new s.ColorMode([b.ONE,b.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(ee,K,Y,Q){const X=ee.gl,ae=K.width*Q,te=K.height*Q;ee.activeTexture.set(X.TEXTURE1),ee.viewport.set([0,0,ae,te]);let Ee=Y.heatmapFbo;if(!Ee||Ee&&(Ee.width!==ae||Ee.height!==te)){Ee&&Ee.destroy();const xe=X.createTexture();X.bindTexture(X.TEXTURE_2D,xe),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR),Ee=Y.heatmapFbo=ee.createFramebuffer(ae,te,!1),function(pe,we,ve,Me,Oe,ht){const ke=pe.gl;ke.texImage2D(ke.TEXTURE_2D,0,ke.RGBA,Oe,ht,0,ke.RGBA,pe.extRenderToTextureHalfFloat?pe.extTextureHalfFloat.HALF_FLOAT_OES:ke.UNSIGNED_BYTE,null),Me.colorAttachment.set(ve)}(ee,0,xe,Ee,ae,te)}else X.bindTexture(X.TEXTURE_2D,Ee.colorAttachment.get()),ee.bindFramebuffer.set(Ee.framebuffer)})(x,p,u,p.transform.projection.name==="globe"?.5:.25),x.clear({color:s.Color.transparent});const I=p.transform,D=I.projection.name==="globe",O=D?["PROJECTION_GLOBE_VIEW"]:null,U=D?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,W=[s.mercatorXfromLng(I.center.lng),s.mercatorYfromLat(I.center.lat)];for(let ee=0;ee<g.length;ee++){const K=g[ee];if(o.hasRenderableParent(K))continue;const Y=o.getTile(K),Q=Y.getBucket(u);if(!Q||Q.projection.name!==I.projection.name)continue;const X=Q.programConfigurations.get(u.id),ae=p.useProgram("heatmap",X,O),{zoom:te}=p.transform;p.terrain&&p.terrain.setupElevationDraw(Y,ae),p.prepareDrawProgram(x,ae,K.toUnwrapped());const Ee=I.projection.createInversionMatrix(I,K.canonical);ae.draw(x,b.TRIANGLES,s.DepthMode.disabled,S,A,U,__(p,K,Y,Ee,W,te,u.paint.get("heatmap-intensity")),u.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,u.paint,p.transform.zoom,X,D?[Q.globeExtVertexBuffer]:null)}x.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),function(x,b){const S=x.context,A=S.gl,I=b.heatmapFbo;if(!I)return;S.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,I.colorAttachment.get()),S.activeTexture.set(A.TEXTURE1);let D=b.colorRampTexture;D||(D=b.colorRampTexture=new s.Texture(S,b.colorRamp,A.RGBA)),D.bind(A.LINEAR,A.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(S,A.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,x.colorModeForRenderPass(),s.CullFaceMode.disabled,((O,U,W,ee)=>({u_image:0,u_color_ramp:1,u_opacity:U.paint.get("heatmap-opacity")}))(0,b),b.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,b.paint,x.transform.zoom)}(p,u))},line:function(p,o,u,g){if(p.renderPass!=="translucent")return;const x=u.paint.get("line-opacity"),b=u.paint.get("line-width");if(x.constantOr(1)===0||b.constantOr(1)===0)return;const S=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),A=p.colorModeForRenderPass(),I=p.terrain&&p.terrain.renderingToTexture?1:s.exported.devicePixelRatio,D=u.paint.get("line-dasharray"),O=D.constantOr(1),U=u.layout.get("line-cap"),W=u.paint.get("line-pattern"),ee=W.constantOr(1),K=u.paint.get("line-gradient"),Y=u.getCrossfadeParameters(),Q=ee?"linePattern":"line",X=p.context,ae=X.gl,te=(xe=>{const pe=[];Sc(xe)&&pe.push("RENDER_LINE_DASH"),xe.paint.get("line-gradient")&&pe.push("RENDER_LINE_GRADIENT");const we=xe.paint.get("line-trim-offset");we[0]===0&&we[1]===0||pe.push("RENDER_LINE_TRIM_OFFSET");const ve=xe.paint.get("line-pattern").constantOr(1),Me=xe.paint.get("line-opacity").constantOr(1)!==1;return!ve&&Me&&pe.push("RENDER_LINE_ALPHA_DISCARD"),pe})(u);let Ee=te.includes("RENDER_LINE_ALPHA_DISCARD");p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(Ee=!1);for(const xe of g){const pe=o.getTile(xe);if(ee&&!pe.patternsLoaded())continue;const we=pe.getBucket(u);if(!we)continue;p.prepareDrawTile();const ve=we.programConfigurations.get(u.id),Me=p.useProgram(Q,ve,te),Oe=W.constantOr(null);if(Oe&&pe.imageAtlas){const it=pe.imageAtlas,bt=it.patternPositions[Oe.to.toString()],vt=it.patternPositions[Oe.from.toString()];bt&&vt&&ve.setConstantPatternPositions(bt,vt)}const ht=D.constantOr(null),ke=U.constantOr(null);if(!ee&&ht&&ke&&pe.lineAtlas){const it=pe.lineAtlas,bt=it.getDash(ht.to,ke),vt=it.getDash(ht.from,ke);bt&&vt&&ve.setConstantPatternPositions(bt,vt)}let[Xe,nt]=u.paint.get("line-trim-offset");(ke==="round"||ke==="square")&&Xe!==nt&&(Xe===0&&(Xe-=1),nt===1&&(nt+=1));const _t=p.terrain?xe.projMatrix:null,je=ee?y_(p,pe,u,Y,_t,I):Tc(p,pe,u,Y,_t,we.lineClipsArray.length,I,[Xe,nt]);if(K){const it=we.gradients[u.id];let bt=it.texture;if(u.gradientVersion!==it.version){let vt=256;if(u.stepInterpolant){const zt=o.getSource().maxzoom,Ut=xe.canonical.z===zt?Math.ceil(1<<p.transform.maxZoom-xe.canonical.z):1;vt=s.clamp(s.nextPowerOfTwo(we.maxLineLength/s.EXTENT*1024*Ut),256,X.maxTextureSize)}it.gradient=s.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:vt,image:it.gradient||void 0,clips:we.lineClipsArray}),it.texture?it.texture.update(it.gradient):it.texture=new s.Texture(X,it.gradient,ae.RGBA),it.version=u.gradientVersion,bt=it.texture}X.activeTexture.set(ae.TEXTURE1),bt.bind(u.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}O&&(X.activeTexture.set(ae.TEXTURE0),pe.lineAtlasTexture.bind(ae.LINEAR,ae.REPEAT),ve.updatePaintBuffers(Y)),ee&&(X.activeTexture.set(ae.TEXTURE0),pe.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),ve.updatePaintBuffers(Y)),p.prepareDrawProgram(X,Me,xe.toUnwrapped());const ft=it=>{Me.draw(X,ae.TRIANGLES,S,it,A,s.CullFaceMode.disabled,je,u.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,u.paint,p.transform.zoom,ve,[we.layoutVertexBuffer2])};if(Ee){const it=p.stencilModeForClipping(xe).ref;it===0&&p.terrain&&X.clear({stencil:0});const bt={func:ae.EQUAL,mask:255};je.u_alpha_discard_threshold=.8,ft(new s.StencilMode(bt,it,255,ae.KEEP,ae.KEEP,ae.INVERT)),je.u_alpha_discard_threshold=0,ft(new s.StencilMode(bt,it,255,ae.KEEP,ae.KEEP,ae.KEEP))}else ft(p.stencilModeForClipping(xe))}Ee&&(p.resetStencilClippingMasks(),p.terrain&&X.clear({stencil:0}))},fill:function(p,o,u,g){const x=u.paint.get("fill-color"),b=u.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const S=p.colorModeForRenderPass(),A=u.paint.get("fill-pattern"),I=p.opaquePassEnabledForLayer()&&!A.constantOr(1)&&x.constantOr(s.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(p.renderPass===I){const D=p.depthModeForSublayer(1,p.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Mc(p,o,u,g,D,S,!1)}if(p.renderPass==="translucent"&&u.paint.get("fill-antialias")){const D=p.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Mc(p,o,u,g,D,S,!0)}},"fill-extrusion":function(p,o,u,g){const x=u.paint.get("fill-extrusion-opacity");if(x!==0&&p.renderPass==="translucent"){const b=new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D);if(x!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))Is(p,o,u,g,b,s.StencilMode.disabled,s.ColorMode.disabled),Is(p,o,u,g,b,p.stencilModeFor3D(),p.colorModeForRenderPass()),p.resetStencilClippingMasks();else{const S=p.colorModeForRenderPass();Is(p,o,u,g,b,s.StencilMode.disabled,S)}}},hillshade:function(p,o,u,g){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent")return;const x=p.context,b=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),S=p.colorModeForRenderPass(),A=p.terrain&&p.terrain.renderingToTexture,[I,D]=p.renderPass!=="translucent"||A?[{},g]:p.stencilConfigForOverlap(g);for(const O of D){const U=o.getTile(O);if(U.needsHillshadePrepare&&p.renderPass==="offscreen")ea(p,U,u,b,s.StencilMode.disabled,S);else if(p.renderPass==="translucent"){const W=A&&p.terrain?p.terrain.stencilModeForRTTOverlap(O):I[O.overscaledZ];sh(p,O,U,u,b,W,S)}}x.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,o,u,g,x,b){if(p.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!g.length)return;const S=p.context,A=S.gl,I=o.getSource(),D=p.useProgram("raster"),O=p.colorModeForRenderPass(),U=p.terrain&&p.terrain.renderingToTexture,[W,ee]=I instanceof Pe||U?[{},g]:p.stencilConfigForOverlap(g),K=ee[ee.length-1].overscaledZ,Y=!p.options.moving;for(const Q of ee){const X=U?s.DepthMode.disabled:p.depthModeForSublayer(Q.overscaledZ-K,u.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,A.LESS),ae=Q.toUnwrapped(),te=o.getTile(Q);if(U&&(!te||!te.hasData()))continue;const Ee=U?Q.projMatrix:p.transform.calculateProjMatrix(ae,Y),xe=p.terrain&&U?p.terrain.stencilModeForRTTOverlap(Q):W[Q.overscaledZ],pe=b?0:u.paint.get("raster-fade-duration");te.registerFadeDuration(pe);const we=o.findLoadedParent(Q,0),ve=xc(te,we,o,p.transform,pe);let Me,Oe;p.terrain&&p.terrain.prepareDrawTile();const ht=u.paint.get("raster-resampling")==="nearest"?A.NEAREST:A.LINEAR;S.activeTexture.set(A.TEXTURE0),te.texture.bind(ht,A.CLAMP_TO_EDGE),S.activeTexture.set(A.TEXTURE1),we?(we.texture.bind(ht,A.CLAMP_TO_EDGE),Me=Math.pow(2,we.tileID.overscaledZ-te.tileID.overscaledZ),Oe=[te.tileID.canonical.x*Me%1,te.tileID.canonical.y*Me%1]):te.texture.bind(ht,A.CLAMP_TO_EDGE);const ke=v_(Ee,Oe||[0,0],Me||1,ve,u,I instanceof Pe?I.perspectiveTransform:[0,0]);if(p.prepareDrawProgram(S,D,ae),I instanceof Pe)I.boundsBuffer&&I.boundsSegments&&D.draw(S,A.TRIANGLES,X,s.StencilMode.disabled,O,s.CullFaceMode.disabled,ke,u.id,I.boundsBuffer,p.quadTriangleIndexBuffer,I.boundsSegments);else{const{tileBoundsBuffer:Xe,tileBoundsIndexBuffer:nt,tileBoundsSegments:_t}=p.getTileBoundsBuffers(te);D.draw(S,A.TRIANGLES,X,xe,O,s.CullFaceMode.disabled,ke,u.id,Xe,nt,_t)}}p.resetStencilClippingMasks()},background:function(p,o,u,g){const x=u.paint.get("background-color"),b=u.paint.get("background-opacity");if(b===0)return;const S=p.context,A=S.gl,I=p.transform,D=I.tileSize,O=u.paint.get("background-pattern");if(p.isPatternMissing(O))return;const U=!O&&x.a===1&&b===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==U)return;const W=s.StencilMode.disabled,ee=p.depthModeForSublayer(0,U==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),K=p.colorModeForRenderPass(),Y=p.useProgram(O?"backgroundPattern":"background");let Q,X=g;X||(Q=p.getBackgroundTiles(),X=Object.values(Q).map(te=>te.tileID)),O&&(S.activeTexture.set(A.TEXTURE0),p.imageManager.bind(p.context));const ae=u.getCrossfadeParameters();for(const te of X){const Ee=te.toUnwrapped(),xe=g?te.projMatrix:p.transform.calculateProjMatrix(Ee);p.prepareDrawTile();const pe=o?o.getTile(te):Q?Q[te.key]:new s.Tile(te,D,I.zoom,p),we=O?b_(xe,b,p,O,{tileID:te,tileSize:D},ae):x_(xe,b,x);p.prepareDrawProgram(S,Y,Ee);const{tileBoundsBuffer:ve,tileBoundsIndexBuffer:Me,tileBoundsSegments:Oe}=p.getTileBoundsBuffers(pe);Y.draw(S,A.TRIANGLES,ee,W,K,s.CullFaceMode.disabled,we,u.id,ve,Me,Oe)}},sky:function(p,o,u){const g=p.transform,x=g.projection.name==="mercator"||g.projection.name==="globe"?1:s.smoothstep(7,8,g.zoom),b=u.paint.get("sky-opacity")*x;if(b===0)return;const S=p.context,A=u.paint.get("sky-type"),I=new s.DepthMode(S.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),D=p.frameCounter/1e3%1;A==="atmosphere"?p.renderPass==="offscreen"?u.needsSkyboxCapture(p)&&(function(O,U,W,ee){const K=O.context,Y=K.gl;let Q=U.skyboxFbo;if(!Q){Q=U.skyboxFbo=K.createFramebuffer(32,32,!1),U.skyboxGeometry=new Eh(K),U.skyboxTexture=K.gl.createTexture(),Y.bindTexture(Y.TEXTURE_CUBE_MAP,U.skyboxTexture),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MAG_FILTER,Y.LINEAR);for(let Ee=0;Ee<6;++Ee)Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0,Y.RGBA,32,32,0,Y.RGBA,Y.UNSIGNED_BYTE,null)}K.bindFramebuffer.set(Q.framebuffer),K.viewport.set([0,0,32,32]);const X=U.getCenter(O,!0),ae=O.useProgram("skyboxCapture"),te=new Float64Array(16);s.identity(te),s.rotateY(te,te,.5*-Math.PI),sa(K,U,ae,te,X,0),s.identity(te),s.rotateY(te,te,.5*Math.PI),sa(K,U,ae,te,X,1),s.identity(te),s.rotateX(te,te,.5*-Math.PI),sa(K,U,ae,te,X,2),s.identity(te),s.rotateX(te,te,.5*Math.PI),sa(K,U,ae,te,X,3),s.identity(te),sa(K,U,ae,te,X,4),s.identity(te),s.rotateY(te,te,Math.PI),sa(K,U,ae,te,X,5),K.viewport.set([0,0,O.width,O.height])}(p,u),u.markSkyboxValid(p)):p.renderPass==="sky"&&function(O,U,W,ee,K){const Y=O.context,Q=Y.gl,X=O.transform,ae=O.useProgram("skybox");Y.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_CUBE_MAP,U.skyboxTexture);const te=((Ee,xe,pe,we,ve)=>({u_matrix:Ee,u_sun_direction:xe,u_cubemap:0,u_opacity:we,u_temporal_offset:ve}))(X.skyboxMatrix,U.getCenter(O,!1),0,ee,K);O.prepareDrawProgram(Y,ae),ae.draw(Y,Q.TRIANGLES,W,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,te,"skybox",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(p,u,I,b,D):A==="gradient"&&p.renderPass==="sky"&&function(O,U,W,ee,K){const Y=O.context,Q=Y.gl,X=O.transform,ae=O.useProgram("skyboxGradient");U.skyboxGeometry||(U.skyboxGeometry=new Eh(Y)),Y.activeTexture.set(Q.TEXTURE0);let te=U.colorRampTexture;te||(te=U.colorRampTexture=new s.Texture(Y,U.colorRamp,Q.RGBA)),te.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Ee=((xe,pe,we,ve,Me)=>({u_matrix:xe,u_color_ramp:0,u_center_direction:pe,u_radius:s.degToRad(we),u_opacity:ve,u_temporal_offset:Me}))(X.skyboxMatrix,U.getCenter(O,!1),U.paint.get("sky-gradient-radius"),ee,K);O.prepareDrawProgram(Y,ae),ae.draw(Y,Q.TRIANGLES,W,s.StencilMode.disabled,O.colorModeForRenderPass(),s.CullFaceMode.backCW,Ee,"skyboxGradient",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(p,u,I,b,D)},debug:function(p,o,u){for(let g=0;g<u.length;g++)ki(p,o,u[g])},custom:function(p,o,u){const g=p.context,x=u.implementation;if(p.transform.projection.unsupportedLayers&&p.transform.projection.unsupportedLayers.includes("custom"))s.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(p.renderPass==="offscreen"){const b=x.prerender;b&&(p.setCustomLayerDefaults(),g.setColorMode(p.colorModeForRenderPass()),b.call(x,g.gl,p.transform.customLayerMatrix()),g.setDirty(),p.setBaseState())}else if(p.renderPass==="translucent"){p.setCustomLayerDefaults(),g.setColorMode(p.colorModeForRenderPass()),g.setStencilMode(s.StencilMode.disabled);const b=x.renderingMode==="3d"?new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,s.DepthMode.ReadOnly);g.setDepthMode(b),x.render(g.gl,p.transform.customLayerMatrix()),g.setDirty(),p.setBaseState(),g.bindFramebuffer.set(null)}}};class Ah{constructor(o,u){this.context=new ne(o),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fc,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,u){const g=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Bf(this,o));const x=this._terrain;this.transform.elevation=g?x:null,x.update(o,this.transform,u)}_updateFog(o){const u=o.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,x]=u.getFovAdjustedRange(this.transform._fov);if(g>x)return void(this.transform.fogCullDistSq=null);const b=g+.78*(x-g);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,u){if(this.width=o*s.exported.devicePixelRatio,this.height=u*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const o=this.context,u=new s.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(s.EXTENT,0),u.emplaceBack(0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(u,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const g=new s.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(s.EXTENT,0),g.emplaceBack(0,s.EXTENT),g.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=o.createVertexBuffer(g,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const x=new s.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(x,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(s.EXTENT,0,s.EXTENT,0),b.emplaceBack(0,s.EXTENT,0,s.EXTENT),b.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(b,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const S=new s.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(S);const A=new s.StructArrayLayout1ui2;for(const D of[0,1,3,2,0])A.emplaceBack(D);this.debugIndexBuffer=o.createIndexBuffer(A),this.emptyTexture=new s.Texture(o,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=s.create();const I=this.context.gl;this.stencilClearMode=new s.StencilMode({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new Ic(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,u.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,ch(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,u,g){if(!u||this.currentStencilSource===u.id||!o.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let A=!1;for(const I of g)if(this._tileClippingMaskIDs[I.key]===void 0){A=!0;break}if(!A)return}this.currentStencilSource=u.id;const x=this.context,b=x.gl;this.nextStencilID+g.length>256&&this.clearStencil(),x.setColorMode(s.ColorMode.disabled),x.setDepthMode(s.DepthMode.disabled);const S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const A of g){const I=u.getTile(A),D=this._tileClippingMaskIDs[A.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:U,tileBoundsSegments:W}=this.getTileBoundsBuffers(I);S.draw(x,b.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:b.ALWAYS,mask:0},D,255,b.KEEP,b.KEEP,b.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,ch(A.projMatrix),"$clipping",O,U,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new s.StencilMode({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const u=this.context.gl;return new s.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(o){const u=this.context.gl,g=o.sort((S,A)=>A.overscaledZ-S.overscaledZ),x=g[g.length-1].overscaledZ,b=g[0].overscaledZ-x+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const S={};for(let A=0;A<b;A++)S[A+x]=new s.StencilMode({func:u.GEQUAL,mask:255},A+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[S,g]}return[{[x]:s.StencilMode.disabled},g]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([o.CONSTANT_COLOR,o.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(o,u,g){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new s.DepthMode(g||this.context.gl.LEQUAL,u,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){this.style=o,this.options=u,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const g=this.style.order,x=this.style._sourceCaches;for(const I in x){const D=x[I];D.used&&D.prepare(this.context)}const b={},S={},A={};for(const I in x){const D=x[I];b[I]=D.getVisibleCoordinates(),S[I]=b[I].slice().reverse(),A[I]=D.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let I=0;I<g.length;I++)if(this.style._layers[g[I]].is3D()){this.opaquePassCutoff=I;break}if(this.terrain&&(this.terrain.updateTileBinding(A),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const I of g){const D=this.style._layers[I],O=o._getLayerSourceCache(D);if(!D.hasOffscreenPass()||D.isHidden(this.transform.zoom))continue;const U=O?S[O.id]:void 0;(D.type==="custom"||D.isSky()||U&&U.length)&&this.renderLayer(this,O,D,U)}if(this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:u.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const I=this.style._layers[g[this.currentLayer]],D=o._getLayerSourceCache(I);if(I.isSky())continue;const O=D?S[D.id]:void 0;this._renderTileClippingMasks(I,D,O),this.renderLayer(this,D,I,O)}if(this.style.fog&&this.transform.projection.supportsFog&&function(I,D){const O=I.context,U=O.gl,W=I.transform,ee=new s.DepthMode(U.LEQUAL,s.DepthMode.ReadOnly,[0,1]),K=I.useProgram("globeAtmosphere",null,W.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Y=s.globeToMercatorTransition(W.zoom),Q=D.properties.get("color").toArray01(),X=D.properties.get("high-color").toArray01(),ae=D.properties.get("space-color").toArray01PremultipliedAlpha(),te=s.identity$1([]);s.rotateY$1(te,te,-s.degToRad(W._center.lng)),s.rotateX$1(te,te,s.degToRad(W._center.lat)),s.rotateZ$1(te,te,W.angle),s.rotateX$1(te,te,-W._pitch);const Ee=s.fromQuat(new Float32Array(16),te),xe=s.mapValue(D.properties.get("star-intensity"),0,1,0,.25),pe=5e-4,we=s.mapValue(D.properties.get("horizon-blend"),0,1,pe,.25),ve=s.globeUseCustomAntiAliasing(I,O,W)&&we===pe?W.worldSize/(2*Math.PI*1.025)-1:W.globeRadius,Me=I.frameCounter/1e3%1,Oe=s.length(W.globeCenterInViewSpace),ht=Math.sqrt(Math.pow(Oe,2)-Math.pow(ve,2)),ke=Math.acos(ht/Oe),Xe=((_t,je,ft,it,bt,vt,zt,Ut,Ht,pi,Rt,Qt,Ei,Ki)=>({u_frustum_tl:_t,u_frustum_tr:je,u_frustum_br:ft,u_frustum_bl:it,u_horizon:bt,u_transition:vt,u_fadeout_range:zt,u_color:Ut,u_high_color:Ht,u_space_color:pi,u_star_intensity:Rt,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Qt,u_horizon_angle:Ei,u_rotation_matrix:Ki}))(W.frustumCorners.TL,W.frustumCorners.TR,W.frustumCorners.BR,W.frustumCorners.BL,W.frustumCorners.horizon,Y,we,Q,X,ae,xe,Me,ke,Ee);I.prepareDrawProgram(O,K);const nt=I.atmosphereBuffer;nt&&K.draw(O,U.TRIANGLES,ee,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,Xe,"skybox",nt.vertexBuffer,nt.indexBuffer,nt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const I=this.style._layers[g[this.currentLayer]],D=o._getLayerSourceCache(I);I.isSky()&&this.renderLayer(this,D,I,D?S[D.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const I=this.style._layers[g[this.currentLayer]],D=o._getLayerSourceCache(I);if(I.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(I)){if(I.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const O=D?(I.type==="symbol"?A:S)[D.id]:void 0;this._renderTileClippingMasks(I,D,D?b[D.id]:void 0),this.renderLayer(this,D,I,O),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let I=null;s.values(this.style._layers).forEach(D=>{const O=o._getLayerSourceCache(D);O&&!D.isHidden(this.transform.zoom)&&(!I||I.getSource().maxzoom<O.getSource().maxzoom)&&(I=O)}),I&&this.options.showTileBoundaries&&oa.debug(this,I,I.getVisibleCoordinates())}this.options.showPadding&&function(I){const D=I.transform.padding;ll(I,I.transform.height-(D.top||0),3,Xf),ll(I,D.bottom||0,3,na),Yf(I,D.left||0,3,ra),Yf(I,I.transform.width-(D.right||0),3,Kf);const O=I.transform.centerPoint;(function(U,W,ee,K){cl(U,W-1,ee-10,2,20,K),cl(U,W-10,ee-1,20,2,K)})(I,O.x,I.transform.height-O.y,Th)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(o,u,g,x){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||x&&x.length)&&(this.id=g.id,this.gpuTimingStart(g),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(g.type)||oa[g.type](o,u,g,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let g=this.gpuTimers[o.id];g||(g=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),g.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,u=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(u),o.beginQueryEXT(o.TIME_ELAPSED_EXT,u)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const u={};for(const g in o){const x=o[g],b=this.context.extTimerQuery,S=b.getQueryObjectEXT(x.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(x.query),u[g]=S}return u}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.extTimerQuery;let g=0;for(const x of o)g+=u.getQueryObjectEXT(x,u.QUERY_RESULT_EXT)/1e6,u.deleteQueryEXT(x);return g}translatePosMatrix(o,u,g,x,b){if(!g[0]&&!g[1])return o;const S=b?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(S){const D=Math.sin(S),O=Math.cos(S);g=[g[0]*O-g[1]*D,g[0]*D+g[1]*O]}const A=[b?g[0]:fn(u,g[0],this.transform.zoom),b?g[1]:fn(u,g[1],this.transform.zoom),0],I=new Float32Array(16);return s.translate(I,o,A),I}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const u=this.imageManager.getPattern(o.from.toString()),g=this.imageManager.getPattern(o.to.toString());return!u||!g}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,u=this.style&&this.style.fog,g=[];return this.terrain&&!this.terrain.renderingToTexture&&g.push("TERRAIN"),u&&!o&&u.getOpacity(this.transform.pitch)!==0&&g.push("FOG"),o&&g.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&g.push("OVERDRAW_INSPECTOR"),g}useProgram(o,u,g){this.cache=this.cache||{};const x=g||[],b=this.currentGlobalDefines().concat(x),S=dh.cacheKey(yc[o],o,b,u);return this.cache[S]||(this.cache[S]=new dh(this.context,o,yc[o],u,w_[o],b)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,u,g){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const b=x.getOpacity(this.transform.pitch),S=((A,I,D,O,U,W,ee,K,Y,Q,X)=>{const ae=A.transform,te=I.properties.get("color").toArray01();te[3]=O;const Ee=A.frameCounter/1e3%1;return{u_fog_matrix:D?ae.calculateFogTileMatrix(D):A.identityMat,u_fog_range:I.getFovAdjustedRange(ae._fov),u_fog_color:te,u_fog_horizon_blend:I.properties.get("horizon-blend"),u_fog_temporal_offset:Ee,u_frustum_tl:U,u_frustum_tr:W,u_frustum_br:ee,u_frustum_bl:K,u_globe_pos:Y,u_globe_radius:Q,u_viewport:X,u_globe_transition:s.globeToMercatorTransition(ae.zoom),u_is_globe:+(ae.projection.name==="globe")}})(this,x,g,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);u.setFogUniformValues(o,S)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const o=this.context.gl,u=o.createTexture();return o.bindTexture(o.TEXTURE_2D,u),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,u=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const x of g)u[x.key]=o[x.key]||new s.Tile(x,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class hl{constructor(o=0,u=0,g=0,x=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=g,this.right=x}interpolate(o,u,g){return u.top!=null&&o.top!=null&&(this.top=s.number(o.top,u.top,g)),u.bottom!=null&&o.bottom!=null&&(this.bottom=s.number(o.bottom,u.bottom,g)),u.left!=null&&o.left!=null&&(this.left=s.number(o.left,u.left,g)),u.right!=null&&o.right!=null&&(this.right=s.number(o.right,u.right,g)),this}getCenter(o,u){const g=s.clamp((this.left+o-this.right)/2,0,o),x=s.clamp((this.top+u-this.bottom)/2,0,u);return new s.pointGeometry(g,x)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new hl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ch(p,o){const u=s.getColumn(p,3);s.fromQuat(p,o),s.setColumn(p,3,u)}function aa(p,o){const u=s.identity$1([]);return s.rotateZ$1(u,u,-o),s.rotateX$1(u,u,-p),u}function la(p,o){const u=[p[0],p[1],0],g=[o[0],o[1],0];if(s.length(u)>=1e-15){const S=s.normalize([],u);s.scale$2(g,S,s.dot(g,S)),o[0]=g[0],o[1]=g[1]}const x=s.cross([],o,p);if(s.len(x)<1e-15)return null;const b=Math.atan2(-x[1],x[0]);return aa(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),b)}class St{constructor(o,u){this.position=o,this.orientation=u}get position(){return this._position}set position(o){if(o){const u=o instanceof s.MercatorCoordinate?o:new s.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(u.x=s.wrap(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(o,u){if(this.orientation=null,!this.position)return;const g=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(o)):0,x=this.position,b=s.MercatorCoordinate.fromLngLat(o,g),S=[b.x-x.x,b.y-x.y,b.z-x.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=la(S,u)}setPitchBearing(o,u){this.orientation=aa(s.degToRad(o),s.degToRad(-u))}}class Er{constructor(o,u){this._transform=s.identity([]),this.orientation=u,this.position=o}get mercatorPosition(){const o=this.position;return new s.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=s.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var u;o&&s.setColumn(this._transform,3,[(u=o)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||s.identity$1([]),o&&Ch(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,u){this._orientation=aa(o,u),Ch(this._transform,this._orientation)}forward(){const o=s.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=s.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=s.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,u){const g=new Float64Array(16);return s.invert(g,this.getWorldToCamera(o,u)),g}getWorldToCameraPosition(o,u,g){const x=this.position;s.scale$2(x,x,-o);const b=new Float64Array(16);return s.fromScaling(b,[g,g,g]),s.translate(b,b,x),b[10]*=u,b}getWorldToCamera(o,u){const g=new Float64Array(16),x=new Float64Array(4),b=this.position;return s.conjugate(x,this._orientation),s.scale$2(b,b,-o),s.fromQuat(g,x),s.translate(g,g,b),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=u,g[9]*=u,g[10]*=u,g[11]*=u,g}getCameraToClipPerspective(o,u,g,x){const b=new Float64Array(16);return s.perspective(b,o,u,g,x),b}getDistanceToElevation(o){const u=o===0?0:s.mercatorZfromAltitude(o,this.position[1]),g=this.forward();return(u-this.position[2])/g[2]}clone(){return new Er([...this.position],[...this.orientation])}}function Mh(p,o){const u=dl(p.projection,p.zoom,p.width,p.height),g=function(b,S,A,I,D){const O=new s.LngLat(A.lng-180*Xr,A.lat),U=new s.LngLat(A.lng+180*Xr,A.lat),W=b.project(O.lng,O.lat),ee=b.project(U.lng,U.lat),K=-Math.atan2(ee.y-W.y,ee.x-W.x),Y=s.MercatorCoordinate.fromLngLat(A);Y.y=s.clamp(Y.y,-.999975,.999975);const Q=Y.toLngLat(),X=b.project(Q.lng,Q.lat),ae=s.MercatorCoordinate.fromLngLat(Q);ae.x+=Xr;const te=ae.toLngLat(),Ee=b.project(te.lng,te.lat),xe=fl(Ee.x-X.x,Ee.y-X.y,K),pe=s.MercatorCoordinate.fromLngLat(Q);pe.y+=Xr;const we=pe.toLngLat(),ve=b.project(we.lng,we.lat),Me=fl(ve.x-X.x,ve.y-X.y,K),Oe=Math.abs(xe.x)/Math.abs(Me.y),ht=s.identity([]);s.rotateZ(ht,ht,-K*(1-(D?0:I)));const ke=s.identity([]);return s.scale(ke,ke,[1,1-(1-Oe)*I,1]),ke[4]=-Me.x/Me.y*I,s.rotateZ(ke,ke,K),s.multiply(ke,ht,ke),ke}(p.projection,0,p.center,u,o),x=Ih(p);return s.scale(g,g,[x,x,1]),g}function Ih(p){const o=p.projection,u=dl(p.projection,p.zoom,p.width,p.height),g=Ph(o,p.center),x=Ph(o,s.LngLat.convert(o.center));return Math.pow(2,g*u+(1-u)*x)}function dl(p,o,u,g,x=1/0){const b=p.range;if(!b)return 0;const S=Math.min(x,Math.max(u,g)),A=Math.log(S/1024)/Math.LN2;return s.smoothstep(b[0]+A,b[1]+A,o)}const Xr=1/4e4;function Ph(p,o){const u=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=new s.LngLat(o.lng-180*Xr,u),x=new s.LngLat(o.lng+180*Xr,u),b=p.project(g.lng,u),S=p.project(x.lng,u),A=s.MercatorCoordinate.fromLngLat(g),I=s.MercatorCoordinate.fromLngLat(x),D=S.x-b.x,O=S.y-b.y,U=I.x-A.x,W=I.y-A.y,ee=Math.sqrt((U*U+W*W)/(D*D+O*O));return Math.log(ee)/Math.LN2}function fl(p,o,u){const g=Math.cos(u),x=Math.sin(u);return{x:p*g-o*x,y:p*x+o*g}}class pl{constructor(o,u,g,x,b,S,A){this.tileSize=512,this._renderWorldCopies=b===void 0||b,this._minZoom=o||0,this._maxZoom=u||22,this._minPitch=g==null?0:g,this._maxPitch=x==null?60:x,this.setProjection(S),this.setMaxBounds(A),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new hl,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Er,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new pl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o){const u=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||u)&&this._updateCameraOnTerrain(),(o||u)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const g=!w(u,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const u=o!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const u=-o*Math.PI/180;var g;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(g=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(x,b,S){var A=b[0],I=b[1],D=b[2],O=b[3],U=Math.sin(S),W=Math.cos(S);x[0]=A*W+D*U,x[1]=I*W+O*U,x[2]=A*-U+D*W,x[3]=I*-U+O*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const u=s.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const u=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let x=0,b=0;for(let S=0;S<u.length;S++){const A=new s.pointGeometry(u[S][0]*this.width,g+u[S][1]*(this.height-g)),I=o.pointCoordinate(A);if(!I)continue;const D=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);x+=I[3]*D,b+=D}return b===0?NaN:x/b}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*u,x=this._mercatorZfromZoom(o),b=this._mercatorZfromZoom(this._maxZoom),S=Math.max(x-g,b);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let g;g=o.z<this._camera.position[2]?[u.x,u.y,u.z]:[o.x,o.y,o.z];const x=s.length(s.sub([],this._camera.position,g));return s.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let u=!1;if(o.orientation&&!s.exactEquals(o.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(o.orientation)),o.position){const g=[o.position.x,o.position.y,o.position.z];s.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,u=new St;return u.position=new s.MercatorCoordinate(o[0],o[1],o[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(o){if(!s.length$1(o))return!1;s.normalize$1(o,o);const u=s.transformQuat([],[0,0,-1],o),g=s.transformQuat([],[0,-1,0],o);if(g[2]<0)return!1;const x=la(u,g);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(o){const u=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;o[2]=s.clamp(o[2],x/g,x/u),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,g){this._unmodified=!1,this._edgeInsets.interpolate(o,u,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const u=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(o){const u=[new s.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const g=this.pointCoordinate(new s.pointGeometry(0,0)),x=this.pointCoordinate(new s.pointGeometry(this.width,0)),b=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),S=this.pointCoordinate(new s.pointGeometry(0,this.height)),A=Math.floor(Math.min(g.x,x.x,b.x,S.x)),I=Math.floor(Math.max(g.x,x.x,b.x,S.x)),D=1;for(let O=A-D;O<=I+D;O++)O!==0&&u.push(new s.UnwrappedTileID(O,o))}return u}coveringTiles(o){let u=this.coveringZoomLevel(o);const g=u,x=this.elevation&&!o.isTerrainDEM,b=this.projection.name==="mercator";if(o.minzoom!==void 0&&u<o.minzoom)return[];o.maxzoom!==void 0&&u>o.maxzoom&&(u=o.maxzoom);const S=this.locationCoordinate(this.center),A=this.center.lat,I=1<<u,D=[I*S.x,I*S.y,0],O=this.projection.name==="globe",U=!O,W=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,U),ee=O?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=I*s.mercatorZfromAltitude(1,this.center.lat),Y=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),Q=[I*ee.x,I*ee.y,Y*(U?1:K)],X=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),ae=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,te=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ee=o.isTerrainDEM?-te:this._elevation?this._elevation.getMinElevationBelowMSL():0,xe=this.projection.isReprojectedInTileSpace?Ih(this):1,pe=je=>{const it=new s.MercatorCoordinate(je.x+25e-6,je.y,je.z),bt=new s.MercatorCoordinate(je.x,je.y+25e-6,je.z),vt=je.toLngLat(),zt=it.toLngLat(),Ut=bt.toLngLat(),Ht=this.locationCoordinate(vt),pi=this.locationCoordinate(zt),Rt=this.locationCoordinate(Ut),Qt=Math.hypot(pi.x-Ht.x,pi.y-Ht.y),Ei=Math.hypot(Rt.x-Ht.x,Rt.y-Ht.y);return Math.sqrt(Qt*Ei)*xe/25e-6},we=je=>{const ft=te,it=Ee;return{aabb:s.tileAABB(this,I,0,0,0,je,it,ft,this.projection),zoom:0,x:0,y:0,minZ:it,maxZ:ft,wrap:je,fullyVisible:!1}},ve=[];let Me=[];const Oe=u,ht=o.reparseOverscaled?g:u,ke=je=>je*je,Xe=ke((Y-this._centerAltitude)*K),nt=je=>{if(!this._elevation||!je.tileID||!b)return;const ft=this._elevation.getMinMaxForTile(je.tileID),it=je.aabb;ft?(it.min[2]=ft.min,it.max[2]=ft.max,it.center[2]=(it.min[2]+it.max[2])/2):(je.shouldSplit=_t(je),je.shouldSplit||(it.min[2]=it.max[2]=it.center[2]=this._centerAltitude))},_t=je=>{if(je.zoom<ae)return!0;if(je.zoom===Oe)return!1;if(je.shouldSplit!=null)return je.shouldSplit;const ft=je.aabb.distanceX(Q),it=je.aabb.distanceY(Q);let bt=Xe,vt=1;if(O){bt=ke(je.aabb.distanceZ(Q));const Ut=Math.pow(2,je.zoom),Ht=s.latFromMercatorY((je.y+1)/Ut),pi=s.latFromMercatorY(je.y/Ut),Rt=Math.min(Math.max(A,Ht),pi),Qt=s.circumferenceAtLatitude(Rt)/s.circumferenceAtLatitude(A);if(vt=Rt===A?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Qt/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&je.zoom===Oe-1&&Qt>=.9)return!0}else if(x&&(bt=ke(je.aabb.distanceZ(Q)*K)),this.projection.isReprojectedInTileSpace&&g<=5){const Ut=Math.pow(2,je.zoom),Ht=pe(new s.MercatorCoordinate((je.x+.5)/Ut,(je.y+.5)/Ut));vt=Ht>.85?1:Ht}const zt=ft*ft+it*it+bt;return zt<ke((1<<Oe-je.zoom)*X*vt*((Ut,Ht)=>{if(Ht*ke(.707)<Ut)return 1;const pi=Math.sqrt(Ht/Ut);return pi/(1.4144271570014144+(Math.pow(1.1,pi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(bt,Xe),zt))};if(this.renderWorldCopies)for(let je=1;je<=3;je++)ve.push(we(-je)),ve.push(we(je));for(ve.push(we(0));ve.length>0;){const je=ve.pop(),ft=je.x,it=je.y;let bt=je.fullyVisible;if(!bt){const vt=je.aabb.intersects(W);if(vt===0)continue;bt=vt===2}if(je.zoom!==Oe&&_t(je))for(let vt=0;vt<4;vt++){const zt=(ft<<1)+vt%2,Ut=(it<<1)+(vt>>1),Ht={aabb:b?je.aabb.quadrant(vt):s.tileAABB(this,I,je.zoom+1,zt,Ut,je.wrap,je.minZ,je.maxZ,this.projection),zoom:je.zoom+1,x:zt,y:Ut,wrap:je.wrap,fullyVisible:bt,tileID:void 0,shouldSplit:void 0,minZ:je.minZ,maxZ:je.maxZ};x&&!O&&(Ht.tileID=new s.OverscaledTileID(je.zoom+1===Oe?ht:je.zoom+1,je.wrap,je.zoom+1,zt,Ut),nt(Ht)),ve.push(Ht)}else{const vt=je.zoom===Oe?ht:je.zoom;if(o.minzoom&&o.minzoom>vt)continue;const zt=D[0]-(.5+ft+(je.wrap<<je.zoom))*(1<<u-je.zoom),Ut=D[1]-.5-it,Ht=je.tileID?je.tileID:new s.OverscaledTileID(vt,je.wrap,je.zoom,ft,it);Me.push({tileID:Ht,distanceSq:zt*zt+Ut*Ut})}}if(this.fogCullDistSq){const je=this.fogCullDistSq,ft=this.horizonLineFromTop();Me=Me.filter(it=>{const bt=[0,0,0,1],vt=[s.EXTENT,s.EXTENT,0,1],zt=this.calculateFogTileMatrix(it.tileID.toUnwrapped());s.transformMat4$1(bt,bt,zt),s.transformMat4$1(vt,vt,zt);const Ut=s.getAABBPointSquareDist(bt,vt);if(Ut===0)return!0;let Ht=!1;const pi=this._elevation;if(pi&&Ut>je&&ft!==0){const Rt=this.calculateProjMatrix(it.tileID.toUnwrapped());let Qt;o.isTerrainDEM||(Qt=pi.getMinMaxForTile(it.tileID)),Qt||(Qt={min:Ee,max:te});const Ei=s.furthestTileCorner(this.rotation),Ki=[Ei[0]*s.EXTENT,Ei[1]*s.EXTENT,Qt.max];s.transformMat4(Ki,Ki,Rt),Ht=(1-Ki[1])*this.height*.5<ft}return Ut<je||Ht})}return Me.sort((je,ft)=>je.distanceSq-ft.distanceSq).map(je=>je.tileID)}resize(o,u){this.width=o,this.height=u,this.pixelsToGLUnits=[2/o,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const u=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),g=this.projection.project(o.lng,u);return new s.pointGeometry(g.x*this.worldSize,g.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(o,u){let g,x;const b=this.centerPoint;if(this.projection.name==="globe"){const A=this.worldSize;g=(u.x-b.x)/A,x=(u.y-b.y)/A}else{const A=this.pointCoordinate(u),I=this.pointCoordinate(b);g=A.x-I.x,x=A.y-I.y}const S=this.locationCoordinate(o);this.setLocation(new s.MercatorCoordinate(S.x-g,S.y-x))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,u){const g=u?s.mercatorZfromAltitude(u,o.lat):void 0,x=this.projection.project(o.lng,o.lat);return new s.MercatorCoordinate(x.x,x.y,g)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,u){const g=u!=null?u:this._centerAltitude,x=[o.x,o.y,0,1],b=[o.x,o.y,1,1];s.transformMat4$1(x,x,this.pixelMatrixInverse),s.transformMat4$1(b,b,this.pixelMatrixInverse);const S=b[3];s.scale$1(x,x,1/x[3]),s.scale$1(b,b,1/S);const A=x[2],I=b[2];return{p0:x,p1:b,t:A===I?0:(g-A)/(I-A)}}screenPointToMercatorRay(o){const u=[o.x,o.y,0,1],g=[o.x,o.y,1,1];return s.transformMat4$1(u,u,this.pixelMatrixInverse),s.transformMat4$1(g,g,this.pixelMatrixInverse),s.scale$1(u,u,1/u[3]),s.scale$1(g,g,1/g[3]),u[2]=s.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,g[2]=s.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,s.scale$1(u,u,1/this.worldSize),s.scale$1(g,g,1/this.worldSize),new s.Ray([u[0],u[1],u[2]],s.normalize([],s.sub([],g,u)))}rayIntersectionCoordinate(o){const{p0:u,p1:g,t:x}=o,b=s.mercatorZfromAltitude(u[2],this._center.lat),S=s.mercatorZfromAltitude(g[2],this._center.lat);return new s.MercatorCoordinate(s.number(u[0],g[0],x)/this.worldSize,s.number(u[1],g[1],x)/this.worldSize,s.number(b,S,x))}pointCoordinate(o,u=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,u)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let u=this.projection.pointCoordinate3D(this,o.x,o.y);if(u)return new s.MercatorCoordinate(u[0],u[1],u[2]);let g=0,x=this.horizonLineFromTop();if(o.y>x)return this.pointCoordinate(o);const b=.02*x,S=o.clone();for(let A=0;A<10&&x-g>b;A++){S.y=s.number(g,x,.66);const I=this.projection.pointCoordinate3D(this,S.x,S.y);I?(x=S.y,u=I):g=S.y}return u?new s.MercatorCoordinate(u[0],u[1],u[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}_coordinatePoint(o,u){const g=u&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,x=[o.x*this.worldSize,o.y*this.worldSize,g+o.toAltitude(),1];return s.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new s.pointGeometry(x[0]/x[3],x[1]/x[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(o,u){const g=new s.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),x=new s.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),b=new s.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),S=new s.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let A=this.pointCoordinate(g,o),I=this.pointCoordinate(x,o);const D=this.pointCoordinate(b,u),O=this.pointCoordinate(S,u),U=(W,ee)=>(ee.y-W.y)/(ee.x-W.x);return A.y>1&&I.y>=0?A=new s.MercatorCoordinate((1-O.y)/U(O,A)+O.x,1):A.y<0&&I.y<=1&&(A=new s.MercatorCoordinate(-O.y/U(O,A)+O.x,0)),I.y>1&&A.y>=0?I=new s.MercatorCoordinate((1-D.y)/U(D,I)+D.x,1):I.y<0&&A.y<=1&&(I=new s.MercatorCoordinate(-D.y/U(D,I)+D.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(A)).extend(this.coordinateLocation(I)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(D))}_getBounds3D(){const o=this.elevation;if(!o.visibleDemTiles.length)return this._getBounds(0,0);const u=o.visibleDemTiles.reduce((g,x)=>{if(x.dem){const b=x.dem.tree;g.min=Math.min(g.min,b.minimums[0]),g.max=Math.max(g.max,b.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBounds(u.min*o.exaggeration(),u.max*o.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(o=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-u*(1-this._horizonShift);return o?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,u){return this.projection.createTileMatrix(this,u,o)}calculateDistanceTileData(o){const u=o.key,g=this._distanceTileDataCache;if(g[u])return g[u];const x=o.canonical,b=1/this.height,S=this.cameraWorldSize/this.zoomScale(x.z),A=(x.x+Math.pow(2,x.z)*o.wrap)*S,I=x.y*S,D=this.point,O=this.angle,U=Math.sin(-O),W=-Math.cos(-O);return g[u]={bearing:[U,W],center:[(D.x-A)*b,(D.y-I)*b],scale:S/s.EXTENT*b},g[u]}calculateFogTileMatrix(o){const u=o.key,g=this._fogTileMatrixCache;if(g[u])return g[u];const x=this.projection.createTileMatrix(this,this.cameraWorldSize,o);return s.multiply(x,this.worldToFogMatrix,x),g[u]=new Float32Array(x),g[u]}calculateProjMatrix(o,u=!1){const g=o.key,x=u?this._alignedProjMatrixCache:this._projMatrixCache;if(x[g])return x[g];const b=this.calculatePosMatrix(o,this.worldSize);return s.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,b),x[g]=new Float32Array(b),x[g]}calculatePixelsToTileUnitsMatrix(o){const u=o.tileID.key,g=this._pixelsToTileUnitsCache;if(g[u])return g[u];const x=function(b,S){const{scale:A}=b.tileTransform,I=A*s.EXTENT/(b.tileSize*Math.pow(2,S.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return D=new Float32Array(4),W=(O=S.inverseAdjustmentMatrix)[1],ee=O[2],K=O[3],Q=(U=[I,I])[1],D[0]=O[0]*(Y=U[0]),D[1]=W*Y,D[2]=ee*Q,D[3]=K*Q,D;var D,O,U,W,ee,K,Y,Q}(o,this);return g[u]=x,g[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const u=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),x=this._camera.forward(),b=s.mercatorZfromAltitude(1,this._center.lat);g[2]/=b,x[2]/=b,s.normalize(x,x);const S=o.raycast(g,x,o.exaggeration());if(S){const A=s.scaleAndAdd([],g,x,S),I=new s.MercatorCoordinate(A[0],A[1],s.mercatorZfromAltitude(A[2],s.latFromMercatorY(A[1]))),D=(I.z+s.length([I.x-g[0],I.y-g[1],I.z-g[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(D),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const o=this._elevation;this._updateCameraState();const u=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(u),x=o.getAtPointOrZero(new s.MercatorCoordinate(...g)),b=this._minimumHeightOverTerrain()*Math.cos(s.degToRad(this._maxPitch)),S=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*x;if(S<b){const A=this.locationCoordinate(this._center,this._centerAltitude),I=[A.x-g[0],A.y-g[1],A.z-g[2]],D=s.length(I);I[2]-=(b-S)/this._pixelsPerMercatorPixel;const O=s.length(I);if(O===0)return;s.scale$2(I,I,D/O*this._pixelsPerMercatorPixel),this._camera.position=[A.x-I[0],A.y-I[1],A.z*this._pixelsPerMercatorPixel-I[2]],this._camera.orientation=la(I,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const W=this.center;return W.lat=s.clamp(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(W.lng=s.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const u=this._unmodified,{x:g,y:x}=this.point;let b=0,S=g,A=x;const I=this.width/2,D=this.height/2,O=this.worldMinY*this.scale,U=this.worldMaxY*this.scale;if(x-D<O&&(A=O+D),x+D>U&&(A=U-D),U-O<this.height&&(b=Math.max(b,this.height/(U-O)),A=(U+O)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,ee=this.worldMaxX*this.scale,K=this.worldSize/2-(W+ee)/2;S=(g+K+this.worldSize)%this.worldSize-K,S-I<W&&(S=W+I),S+I>ee&&(S=ee-I),ee-W<this.width&&(b=Math.max(b,this.width/(ee-W)),S=(ee+W)/2)}S===g&&A===x||(this.center=this.unproject(new s.pointGeometry(S,A))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCameraAltitude(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,u=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const g=dl(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?u:1),b=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);b[8]=2*-o.x/this.width,b[9]=2*o.y/this.height;let S=s.mul([],b,x);if(this.projection.isReprojectedInTileSpace){const xe=this.locationCoordinate(this.center),pe=s.identity([]);s.translate(pe,pe,[xe.x*this.worldSize,xe.y*this.worldSize,0]),s.multiply(pe,pe,Mh(this)),s.translate(pe,pe,[-xe.x*this.worldSize,-xe.y*this.worldSize,0]),s.multiply(S,S,pe),this.inverseAdjustmentMatrix=function(we){const ve=Mh(we,!0);return He([],[ve[0],ve[1],ve[4],ve[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],S,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=S,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const A=s.invert([],b);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(A,this.horizonLineFromTop(),this.height);const I=new Float32Array(16);s.identity(I),s.scale(I,I,[1,-1,1]),s.rotateX(I,I,this._pitch),s.rotateZ(I,I,this.angle);const D=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),O=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;D[8]=2*-o.x/this.width,D[9]=2*(o.y+O)/this.height,this.skyboxMatrix=s.multiply(I,D,I);const U=this.point,W=U.x,ee=U.y,K=this.width%2/2,Y=this.height%2/2,Q=Math.cos(this.angle),X=Math.sin(this.angle),ae=W-Math.round(W)+Q*K+X*Y,te=ee-Math.round(ee)+Q*Y+X*K,Ee=new Float64Array(S);if(s.translate(Ee,Ee,[ae>.5?ae-1:ae,te>.5?te-1:te,0]),this.alignedProjMatrix=Ee,S=s.create(),s.scale(S,S,[this.width/2,-this.height/2,1]),s.translate(S,S,[1,-1,0]),this.labelPlaneMatrix=S,S=s.create(),s.scale(S,S,[1,-1,1]),s.translate(S,S,[-1,-1,0]),s.scale(S,S,[2/this.width,2/this.height,1]),this.glCoordMatrix=S,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},S=s.invert(new Float64Array(16),this.pixelMatrix),!S)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=S,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const xe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(xe,xe,x),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=S;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSize,u=this.cameraPixelsPerMeter,g=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,b=[o,o,u];s.scale$2(b,b,x),s.scale$2(g,g,-1),s.multiply$2(g,g,b);const S=s.create();s.translate(S,S,g),s.scale(S,S,b),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,u,x)}_computeCameraPosition(o){const u=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),x=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-o/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-g[0]*b,x.y/this.worldSize-g[1]*b,o/this.worldSize*this._centerAltitude-g[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=o[2];let x=1;g>0&&(x=Math.min((u-this._camera.position[2])/g,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,o,x),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const o=this._camera.position,u=this._camera.forward(),{pitch:g,bearing:x}=this._camera.getPitchBearing(),b=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),A=Math.max((o[2]-b)/Math.cos(g),S),I=this._zoomFromMercatorZ(A);s.scaleAndAdd(o,o,u,A),this._pitch=s.clamp(g,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(x,-Math.PI,Math.PI),this._setZoom(s.clamp(I,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,u){const g=Math.min(o.x,u.x),x=Math.max(o.x,u.x),b=Math.min(o.y,u.y),S=Math.max(o.y,u.y);if(b<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const A=[new s.pointGeometry(g,b),new s.pointGeometry(x,S),new s.pointGeometry(g,S),new s.pointGeometry(x,b)],I=this.renderWorldCopies?-3:0,D=this.renderWorldCopies?4:1;for(const O of A){const U=this.pointRayIntersection(O);if(U.t<0)return!0;const W=this.rayIntersectionCoordinate(U);if(W.x<I||W.y<0||W.x>D||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(o,u){const g=s.length(s.sub([],this._camera.position,o)),x=this._zoomFromMercatorZ(g)+u;return g-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const o=function(u,g){const x=[u[0],u[1],u[2],1];s.transformMat4$1(x,x,g);const b=Math.max(x[3],1e-6);return[x[0]/b,x[1]/b,x[2]/b,b]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,o))}}getCameraToCenterDistance(o){const u=dl(o,this.zoom,this.width,this.height,1024),g=o.pixelSpaceConversion(this.center.lat,this.worldSize,u);return .5/Math.tan(.5*this._fov)*this.height*g}}function ml(p,o){let u=!1,g=null;const x=()=>{g=null,u&&(p(),g=setTimeout(x,o),u=!1)};return()=>(u=!0,g||x(),g)}class Qf{constructor(o){this._hashName=o&&encodeURIComponent(o),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ml(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,s.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const u=kh(o);if(this._hashName){const g=this._hashName;let x=!1;const b=s.window.location.hash.slice(1).split("&").map(S=>{const A=S.split("=")[0];return A===g?(x=!0,`${A}=${u}`):S}).filter(S=>S);return x||b.push(`${g}=${u}`),`#${b.join("&")}`}return`#${u}`}_getCurrentHash(){const o=s.window.location.hash.replace("#","");if(this._hashName){let u;return o.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(u=g)}),(u&&u[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(g=>isNaN(g))){const g=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(u[3]||0):o.getBearing();return o.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,o)}}function kh(p,o){const u=p.getCenter(),g=Math.round(100*p.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,x),S=Math.round(u.lng*b)/b,A=Math.round(u.lat*b)/b,I=p.getBearing(),D=p.getPitch();let O=o?`/${S}/${A}/${g}`:`${g}/${A}/${S}`;return(I||D)&&(O+="/"+Math.round(10*I)/10),D&&(O+=`/${Math.round(D)}`),O}const Ps={linearity:.3,easing:s.bezier(0,0,.3,1)},E_=s.extend({deceleration:2500,maxSpeed:1400},Ps),S_=s.extend({deceleration:20,maxSpeed:1400},Ps),Jf=s.extend({deceleration:1e3,maxSpeed:360},Ps),Pc=s.extend({deceleration:1e3,maxSpeed:90},Ps);class Lh{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=s.exported.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const b=_l(u.pan.mag(),g,s.extend({},E_,o||{}));x.offset=u.pan.mult(b.amount/u.pan.mag()),x.center=this._map.transform.center,gl(x,b)}if(u.zoom){const b=_l(u.zoom,g,S_);x.zoom=this._map.transform.zoom+b.amount,gl(x,b)}if(u.bearing){const b=_l(u.bearing,g,Jf);x.bearing=this._map.transform.bearing+s.clamp(b.amount,-179,179),gl(x,b)}if(u.pitch){const b=_l(u.pitch,g,Pc);x.pitch=this._map.transform.pitch+b.amount,gl(x,b)}if(x.zoom||x.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;x.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function gl(p,o){(!p.duration||p.duration<o.duration)&&(p.duration=o.duration,p.easing=o.easing)}function _l(p,o,u){const{maxSpeed:g,linearity:x,deceleration:b}=u,S=s.clamp(p*x/(o/1e3),-g,g),A=Math.abs(S)/(b*x);return{easing:u.easing,duration:1e3*A,amount:S*(A/2)}}class Wn extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,g,x={}){const b=ie(u.getCanvasContainer(),g),S=u.unproject(b);super(o,s.extend({point:b,lngLat:S,originalEvent:g},x)),this._defaultPrevented=!1,this.target=u}}class ca extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,g){const x=o==="touchend"?g.changedTouches:g.touches,b=Ie(u.getCanvasContainer(),x),S=b.map(I=>u.unproject(I)),A=b.reduce((I,D,O,U)=>I.add(D.div(U.length)),new s.pointGeometry(0,0));super(o,{points:b,point:A,lngLats:S,lngLat:u.unproject(A),originalEvent:g}),this._defaultPrevented=!1}}class ep extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class tp{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new ep(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new Wn(o.type,this._map,o))}mouseup(o){this._map.fire(new Wn(o.type,this._map,o))}preclick(o){const u=s.extend({},o);u.type="preclick",this._map.fire(new Wn(u.type,this._map,u))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Wn(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Wn(o.type,this._map,o))}mouseover(o){this._map.fire(new Wn(o.type,this._map,o))}mouseout(o){this._map.fire(new Wn(o.type,this._map,o))}touchstart(o){return this._firePreventable(new ca(o.type,this._map,o))}touchmove(o){this._map.fire(new ca(o.type,this._map,o))}touchend(o){this._map.fire(new ca(o.type,this._map,o))}touchcancel(o){this._map.fire(new ca(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ip{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Wn(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Wn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Wn(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class np{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&o.button===0&&(j(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const g=u;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=g,this._box||(this._box=R("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const b=Math.min(x.x,g.x),S=Math.max(x.x,g.x),A=Math.min(x.y,g.y),I=Math.max(x.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${b}px,${A}px)`,this._box.style.width=S-b+"px",this._box.style.height=I-A+"px")})}mouseupWindow(o,u){if(!this._active||o.button!==0)return;const g=this._startPos,x=u;if(this.reset(),ge(),g.x!==x.x||g.y!==x.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:b=>b.fitScreenCoordinates(g,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),q(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new s.Event(o,{originalEvent:u}))}}function kc(p,o){const u={};for(let g=0;g<p.length;g++)u[p[g].identifier]=o[g];return u}class ua{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const b=new s.pointGeometry(0,0);for(const S of x)b._add(S);return b.div(x.length)}(u),this.touches=kc(g,u)))}touchmove(o,u,g){if(this.aborted||!this.centroid)return;const x=kc(g,u);for(const b in this.touches){const S=this.touches[b],A=x[b];(!A||A.dist(S)>30)&&(this.aborted=!0)}}touchend(o,u,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class Lc{constructor(o){this.singleTap=new ua(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,u,g){this.singleTap.touchstart(o,u,g)}touchmove(o,u,g){this.singleTap.touchmove(o,u,g)}touchend(o,u,g){const x=this.singleTap.touchend(o,u,g);if(x){const b=o.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(x)<30;if(b&&S||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class rp{constructor(){this._zoomIn=new Lc({numTouches:1,numTaps:2}),this._zoomOut=new Lc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,g){this._zoomIn.touchstart(o,u,g),this._zoomOut.touchstart(o,u,g)}touchmove(o,u,g){this._zoomIn.touchmove(o,u,g),this._zoomOut.touchmove(o,u,g)}touchend(o,u,g){const x=this._zoomIn.touchend(o,u,g),b=this._zoomOut.touchend(o,u,g);return x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(x)},{originalEvent:o})}):b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(b)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const sp={0:1,2:2};class zc{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,u){return!1}_move(o,u){return{}}mousedown(o,u){if(this._lastPoint)return;const g=ze(o);this._correctButton(o,g)&&(this._lastPoint=u,this._eventButton=g)}mousemoveWindow(o,u){const g=this._lastPoint;if(g){if(o.preventDefault(),this._eventButton!=null&&function(x,b){const S=sp[b];return x.buttons===void 0||(x.buttons&S)!==S}(o,this._eventButton))this.reset();else if(this._moved||!(u.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(g,u)}}mouseupWindow(o){this._lastPoint&&ze(o)===this._eventButton&&(this._moved&&ge(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class op extends zc{mousedown(o,u){super.mousedown(o,u),this._lastPoint&&(this._active=!0)}_correctButton(o,u){return u===0&&!o.ctrlKey}_move(o,u){return{around:u,panDelta:u.sub(o)}}}class zh extends zc{_correctButton(o,u){return u===0&&o.ctrlKey||u===2}_move(o,u){const g=.8*(u.x-o.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(o){o.preventDefault()}}class Dn extends zc{_correctButton(o,u){return u===0&&o.ctrlKey||u===2}_move(o,u){const g=-.5*(u.y-o.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(o){o.preventDefault()}}class A_{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(o,u,g){return this._calculateTransform(o,u,g)}touchmove(o,u,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,u,g)}}touchend(o,u,g){this._calculateTransform(o,u,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,g){g.length>0&&(this._active=!0);const x=kc(g,u),b=new s.pointGeometry(0,0),S=new s.pointGeometry(0,0);let A=0;for(const D in x){const O=x[D],U=this._touches[D];U&&(b._add(O),S._add(O.sub(U)),A++,x[D]=O)}if(this._touches=x,A<this._minTouches||!S.mag())return;const I=S.div(A);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(A),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Rc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,u,g){return{}}touchstart(o,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,g){const x=this._firstTwoTouches;if(!x)return;o.preventDefault();const[b,S]=x,A=Dc(g,u,b),I=Dc(g,u,S);if(!A||!I)return;const D=this._aroundCenter?null:A.add(I).div(2);return this._move([A,I],D,o)}touchend(o,u,g){if(!this._firstTwoTouches)return;const[x,b]=this._firstTwoTouches,S=Dc(g,u,x),A=Dc(g,u,b);S&&A||(this._active&&ge(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Dc(p,o,u){for(let g=0;g<p.length;g++)if(p[g].identifier===u)return o[g]}function ap(p,o){return Math.log(p/o)/Math.LN2}class ks extends Rc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ap(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ap(this._distance,g),pinchAround:u}}}function Rh(p,o){return 180*p.angleWith(o)/Math.PI}class ha extends Rc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u){const g=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Rh(this._vector,g),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,g=Rh(o,this._startVector);return Math.abs(g)<u}}function zr(p){return Math.abs(p.y)>Math.abs(p.x)}class Oc extends Rc{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,zr(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,g){const x=this._lastPoints;if(!x)return;const b=o[0].sub(x[0]),S=o[1].sub(x[1]);return this._map._cooperativeGestures&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(b,S,g.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(b.y+S.y)/2*-.5})}gestureBeginsVertically(o,u,g){if(this._valid!==void 0)return this._valid;const x=o.mag()>=2,b=u.mag()>=2;if(!x&&!b)return;if(!x||!b)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const S=o.y>0==u.y>0;return zr(o)&&zr(u)&&S}}const Ct={panStep:100,bearingStep:15,pitchStep:10};class lp{constructor(){const o=Ct;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,g=0,x=0,b=0,S=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),b=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),b=1);break;case 38:o.shiftKey?x=1:(o.preventDefault(),S=-1);break;case 40:o.shiftKey?x=-1:(o.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:A=>{const I=A.getZoom();A.easeTo({duration:300,easeId:"keyboardHandler",easing:cp,zoom:u?Math.round(I)+u*(o.shiftKey?2:1):I,bearing:A.getBearing()+g*this._bearingStep,pitch:A.getPitch()+x*this._pitchStep,offset:[-b*this._panStep,-S*this._panStep],center:A.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function cp(p){return p*(2-p)}const da=4.000244140625;class yl{constructor(o,u){this._map=o,this._el=o.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=o.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const g=s.exported.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%da==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=ie(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform,u=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>da?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&D!==0&&(D=1/D);const O=u(),U=Math.pow(2,O),W=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(W*D))),this._type==="wheel"&&(this._startZoom=O,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:u(),x=this._startZoom,b=this._easing;let S,A=!1;if(this._type==="wheel"&&x&&b){const I=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),D=b(I);S=s.number(x,g,D),I<1?this._frameId||(this._frameId=!0):A=!0}else S=g,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!A,zoomDelta:S-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=s.ease;if(this._prevEase){const g=this._prevEase,x=(s.exported.now()-g.start)/g.duration,b=g.easing(x+.01)-g.easing(x),S=.27/Math.sqrt(b*b+1e-4)*.01,A=Math.sqrt(.0729-S*S);u=s.bezier(S,A,.25,1)}return this._prevEase={start:s.exported.now(),duration:o,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=R("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class up{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class hp{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,u){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(o.shiftKey?-1:1),around:g.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dp{constructor(){this._tap=new Lc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,u,g){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=u[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(o,u,g))}touchmove(o,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=u[0],b=x.y-this._swipePoint.y;return this._swipePoint=x,o.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(o,u,g)}touchend(o,u,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(o,u,g)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fp{constructor(o,u,g){this._el=o,this._mousePan=u,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class pp{constructor(o,u,g){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=u,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class mp{constructor(o,u,g,x){this._el=o,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const vl=p=>p.zoom||p.drag||p.pitch||p.rotate;class Fc extends s.Event{}class Dh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,u){const g=s.sub([],u,o);this.radius=s.length(g[2]<0?s.div([],g,this.constants):[g[0],g[1],0])}projectRay(o){s.div(o,o,this.constants),s.normalize(o,o),s.mul$1(o,o,this.constants);const u=s.scale$2([],o,this.radius);if(u[2]>0){const g=s.scale$2([],[0,0,1],s.dot(u,[0,0,1])),x=s.scale$2([],s.normalize([],[u[0],u[1],0]),this.radius),b=s.add([],u,s.scale$2([],s.sub([],s.add([],x,g),u),2));u[0]=b[0],u[1]=b[1]}return u}}function Co(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class gp{constructor(o,u){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Lh(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Dh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),s.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[x,b,S]of this._listeners)x.addEventListener(b,x===s.window.document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[o,u,g]of this._listeners)o.removeEventListener(u,o===s.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(o){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new tp(u,o));const x=u.boxZoom=new np(u,o);this._add("boxZoom",x);const b=new rp,S=new hp;u.doubleClickZoom=new up(S,b),this._add("tapZoom",b),this._add("clickZoom",S);const A=new dp;this._add("tapDragZoom",A);const I=u.touchPitch=new Oc(u);this._add("touchPitch",I);const D=new zh(o),O=new Dn(o);u.dragRotate=new pp(o,D,O),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const U=new op(o),W=new A_(u,o);u.dragPan=new fp(g,U,W),this._add("mousePan",U),this._add("touchPan",W,["touchZoom","touchRotate"]);const ee=new ha,K=new ks;u.touchZoomRotate=new mp(g,K,ee,A),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ip(u));const Y=u.scrollZoom=new yl(u,this);this._add("scrollZoom",Y,["mousePan"]);const Q=u.keyboard=new lp;this._add("keyboard",Q);for(const X of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[X]&&u[X].enable(o[X])}_add(o,u,g){this._handlers.push({handlerName:o,handler:u,allowed:g}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!vl(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,u,g){for(const x in o)if(x!==g&&(!u||u.indexOf(x)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const u=[];for(const g of o)this._el.contains(g.target)&&u.push(g);return u}handleEvent(o,u){this._updatingCamera=!0;const g=o.type==="renderFrame",x=g?void 0:o,b={needsRenderFrame:!1},S={},A={},I=o.touches?this._getMapTouches(o.touches):void 0,D=I?Ie(this._el,I):g?void 0:ie(this._el,o);for(const{handlerName:W,handler:ee,allowed:K}of this._handlers){if(!ee.isEnabled())continue;let Y;this._blockedByActive(A,K,W)?ee.reset():ee[u||o.type]&&(Y=ee[u||o.type](o,D,I),this.mergeHandlerResult(b,S,Y,W,x),Y&&Y.needsRenderFrame&&this._triggerRenderFrame()),(Y||ee.isActive())&&(A[W]=ee)}const O={};for(const W in this._previousActiveHandlers)A[W]||(O[W]=x);this._previousActiveHandlers=A,(Object.keys(O).length||Co(b))&&(this._changes.push([b,S,O]),this._triggerRenderFrame()),(Object.keys(A).length||Co(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=b;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))}mergeHandlerResult(o,u,g,x,b){if(!g)return;s.extend(o,g);const S={handlerName:x,originalEvent:g.originalEvent||b};g.zoomDelta!==void 0&&(u.zoom=S),g.panDelta!==void 0&&(u.drag=S),g.pitchDelta!==void 0&&(u.pitch=S),g.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const o={},u={},g={};for(const[x,b,S]of this._changes)x.panDelta&&(o.panDelta=(o.panDelta||new s.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(o.around=x.around),x.aroundCoord!==void 0&&(o.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(o.pinchAround=x.pinchAround),x.noInertia&&(o.noInertia=x.noInertia),s.extend(u,b),s.extend(g,S);this._updateMapTransform(o,u,g),this._changes=[]}_updateMapTransform(o,u,g){const x=this._map,b=x.transform,S=ae=>[ae.x,ae.y,ae.z];if((ae=>{const te=this._eventsInProgress.drag;return te&&!this._handlersById[te.handlerName].isActive()})()&&!Co(o)){const ae=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",ae!==b.zoom&&this._map._update(!0)}if(!Co(o))return void this._fireEvents(u,g,!0);let{panDelta:A,zoomDelta:I,bearingDelta:D,pitchDelta:O,around:U,aroundCoord:W,pinchAround:ee}=o;ee!==void 0&&(U=ee),(ae=>u.drag&&!this._eventsInProgress.drag)()&&U&&(this._dragOrigin=S(b.pointCoordinate3D(U)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",x._stop(!0),U=U||x.transform.centerPoint,D&&(b.bearing+=D),O&&(b.pitch+=O),b._updateCameraState();const K=[0,0,0];if(A)if(b.projection.name==="mercator"){const ae=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(U).dir),te=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(U.sub(A)).dir);K[0]=te[0]-ae[0],K[1]=te[1]-ae[1]}else{const ae=b.pointCoordinate(U);if(b.projection.name==="globe"){A=A.rotate(-b.angle);const te=b._pixelsPerMercatorPixel/b.worldSize;K[0]=-A.x*s.mercatorScale(s.latFromMercatorY(ae.y))*te,K[1]=-A.y*s.mercatorScale(b.center.lat)*te}else{const te=b.pointCoordinate(U.sub(A));ae&&te&&(K[0]=te.x-ae.x,K[1]=te.y-ae.y)}}const Y=b.zoom,Q=[0,0,0];if(I){const ae=S(W||b.pointCoordinate3D(U)),te={dir:s.normalize([],s.sub([],ae,b._camera.position))};if(te.dir[2]<0){const Ee=b.zoomDeltaToMovement(ae,I);s.scale$2(Q,te.dir,Ee)}}const X=s.add(K,K,Q);b._translateCameraConstrained(X),I&&Math.abs(b.zoom-Y)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,g,!0)}_fireEvents(o,u,g){const x=vl(this._eventsInProgress),b=vl(o),S={};for(const O in o){const{originalEvent:U}=o[O];this._eventsInProgress[O]||(S[`${O}start`]=U),this._eventsInProgress[O]=o[O]}!x&&b&&this._fireEvent("movestart",b.originalEvent);for(const O in S)this._fireEvent(O,S[O]);b&&this._fireEvent("move",b.originalEvent);for(const O in o){const{originalEvent:U}=o[O];this._fireEvent(O,U)}const A={};let I;for(const O in this._eventsInProgress){const{handlerName:U,originalEvent:W}=this._eventsInProgress[O];this._handlersById[U].isActive()||(delete this._eventsInProgress[O],I=u[U]||W,A[`${O}end`]=I)}for(const O in A)this._fireEvent(O,A[O]);const D=vl(this._eventsInProgress);if(g&&(x||b)&&!D){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;O?(U(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:I})):(this._map.fire(new s.Event("moveend",{originalEvent:I})),U(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new s.Event(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new Fc("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Oh="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class _p extends s.Evented{constructor(o,u){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=u.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}panBy(o,u,g){return o=s.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,s.extend({offset:o},u),g)}panTo(o,u,g){return this.easeTo(s.extend({center:o},u),g)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,g){return this.easeTo(s.extend({zoom:o},u),g)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,g){return this.easeTo(s.extend({bearing:o},u),g)}resetNorth(o,u){return this.rotateTo(0,s.extend({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}cameraForBounds(o,u){this.transform.projection.name==="globe"&&s.warnOnce('Globe projection does not support cameraForBounds API, this API may behave unexpectedly."'),o=s.LngLatBounds.convert(o);const g=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),g,u)}_extendCameraOptions(o){const u={top:0,bottom:0,right:0,left:0};if(typeof(o=s.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const g=o.padding;o.padding={top:g,bottom:g,right:g,left:g}}return o.padding=s.extend(u,o.padding),o}_cameraForBoxAndBearing(o,u,g,x){const b=this._extendCameraOptions(x),S=this.transform,A=S.padding,I=S.project(s.LngLat.convert(o)),D=S.project(s.LngLat.convert(u)),O=new s.pointGeometry(I.x,D.y),U=new s.pointGeometry(D.x,I.y),W=-s.degToRad(g),ee=I.rotate(W),K=D.rotate(W),Y=O.rotate(W),Q=U.rotate(W),X=new s.pointGeometry(Math.max(ee.x,K.x,Y.x,Q.x),Math.max(ee.y,K.y,Y.y,Q.y)),ae=new s.pointGeometry(Math.min(ee.x,K.x,Y.x,Q.x),Math.min(ee.y,K.y,Y.y,Q.y)),te=X.sub(ae),Ee=(S.width-((A.left||0)+(A.right||0)+b.padding.left+b.padding.right))/te.x,xe=(S.height-((A.top||0)+(A.bottom||0)+b.padding.top+b.padding.bottom))/te.y;if(xe<0||Ee<0)return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const pe=Math.min(S.scaleZoom(S.scale*Math.min(Ee,xe)),b.maxZoom),we=typeof b.offset.x=="number"&&typeof b.offset.y=="number"?new s.pointGeometry(b.offset.x,b.offset.y):s.pointGeometry.convert(b.offset),ve=new s.pointGeometry((b.padding.left-b.padding.right)/2,(b.padding.top-b.padding.bottom)/2).rotate(g*Math.PI/180),Me=we.add(ve).mult(S.scale/S.zoomScale(pe));return{center:S.unproject(I.add(D).div(2).sub(Me)),zoom:pe,bearing:g}}_cameraForBox(o,u,g,x,b){const S=this._extendCameraOptions(b);g=g||0,x=x||0,o=s.LngLat.convert(o),u=s.LngLat.convert(u);const A=this.transform.clone();A.padding=S.padding;const I=this.getFreeCameraOptions(),D=new s.LngLat(.5*(o.lng+u.lng),.5*(o.lat+u.lat)),O=.5*(g+x);if(A._camera.position[2]<s.mercatorZfromAltitude(O,D.lat))return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");I.lookAtPoint(D),A.setFreeCameraOptions(I);const U=s.MercatorCoordinate.fromLngLat(o),W=s.MercatorCoordinate.fromLngLat(u),ee=A.pointRayIntersection(A.centerPoint,O),K=[(Y=A.rayIntersectionCoordinate(ee)).x,Y.y,Y.z];var Y;const Q=A.screenPointToMercatorRay(A.centerPoint),X=A.projection.name!=="globe";let ae,te=0;do{const Ee=Math.floor(A.zoom),xe=1<<Ee,pe=Math.min(xe*U.x,xe*W.x),we=Math.min(xe*U.y,xe*W.y),ve=Math.max(xe*U.x,xe*W.x),Me=Math.max(xe*U.y,xe*W.y),Oe=new s.Aabb([pe,we,g],[ve,Me,x]),ht=s.Frustum.fromInvProjectionMatrix(A.invProjMatrix,A.worldSize,Ee,X);if(Oe.intersects(ht)!==2){ae&&(A._camera.position=s.scaleAndAdd([],A._camera.position,Q.dir,-ae),A._updateStateFromCamera());break}const ke=s.sub([],A._camera.position,K);ae=.5*s.length(ke),A._camera.position=s.scaleAndAdd([],A._camera.position,Q.dir,ae);try{A._updateStateFromCamera()}catch{return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++te<10);return{center:A.center,zoom:A.zoom,bearing:A.bearing,pitch:A.pitch}}fitBounds(o,u,g){return this.transform.projection.name==="globe"&&s.warnOnce("Globe projection does not support fitBounds API, this API may behave unexpectedly."),this._fitInternal(this.cameraForBounds(o,u),u,g)}_raycastElevationBox(o,u){const g=this.transform.elevation;if(!g)return;const x=new s.pointGeometry(o.x,u.y),b=new s.pointGeometry(u.x,o.y),S=g.pointCoordinate(o);if(!S)return;const A=g.pointCoordinate(u);if(!A)return;const I=g.pointCoordinate(x);if(!I)return;const D=g.pointCoordinate(b);if(!D)return;const O=new s.MercatorCoordinate(S[0],S[1]).toLngLat(),U=new s.MercatorCoordinate(A[0],A[1]).toLngLat(),W=new s.MercatorCoordinate(I[0],I[1]).toLngLat(),ee=new s.MercatorCoordinate(D[0],D[1]).toLngLat(),K=Math.min(O.lng,Math.min(U.lng,Math.min(W.lng,ee.lng))),Y=Math.min(O.lat,Math.min(U.lat,Math.min(W.lat,ee.lat))),Q=Math.max(O.lng,Math.max(U.lng,Math.max(W.lng,ee.lng))),X=Math.max(O.lat,Math.max(U.lat,Math.max(W.lat,ee.lat))),ae=Math.min(S[3],Math.min(A[3],Math.min(I[3],D[3]))),te=Math.max(S[3],Math.max(A[3],Math.max(I[3],D[3])));return{minLngLat:new s.LngLat(K,Y),maxLngLat:new s.LngLat(Q,X),minAltitude:ae,maxAltitude:te}}fitScreenCoordinates(o,u,g,x,b){let S,A,I,D;this.transform.projection.name==="globe"&&s.warnOnce("Globe projection does not support fitScreenCoordinates API, this API may behave unexpectedly.");const O=s.pointGeometry.convert(o),U=s.pointGeometry.convert(u),W=this._raycastElevationBox(O,U);if(W)S=W.minLngLat,A=W.maxLngLat,I=W.minAltitude,D=W.maxAltitude;else{if(this.transform.anyCornerOffEdge(O,U))return this;S=this.transform.pointLocation(O),A=this.transform.pointLocation(U)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(s.pointGeometry.convert(o)),this.transform.pointLocation(s.pointGeometry.convert(u)),g,x):this._cameraForBox(S,A,I,D,x),x,b)}_fitInternal(o,u,g){return o?(delete(u=s.extend(o,u)).padding,u.linear?this.easeTo(u,g):this.flyTo(u,g)):this}jumpTo(o,u){this.stop();const g=o.preloadOnly?this.transform.clone():this.transform;let x=!1,b=!1,S=!1;return"zoom"in o&&g.zoom!==+o.zoom&&(x=!0,g.zoom=+o.zoom),o.center!==void 0&&(g.center=s.LngLat.convert(o.center)),"bearing"in o&&g.bearing!==+o.bearing&&(b=!0,g.bearing=+o.bearing),"pitch"in o&&g.pitch!==+o.pitch&&(S=!0,g.pitch=+o.pitch),o.padding==null||g.isPaddingEqual(o.padding)||(g.padding=o.padding),o.preloadOnly?(this._preloadTiles(g),this):(this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),x&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),b&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),S&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(Oh),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,u){const g=this.transform;if(!g.projection.supportsFreeCamera)return s.warnOnce(Oh),this;this.stop();const x=g.zoom,b=g.pitch,S=g.bearing;g.setFreeCameraOptions(o);const A=x!==g.zoom,I=b!==g.pitch,D=S!==g.bearing;return this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),A&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),D&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),I&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u)),this}easeTo(o,u){this._stop(!1,o.easeId),((o=s.extend({offset:[0,0],duration:500,easing:s.ease},o)).animate===!1||!o.essential&&s.exported.prefersReducedMotion)&&(o.duration=0);const g=this.transform,x=this.getZoom(),b=this.getBearing(),S=this.getPitch(),A=this.getPadding(),I="zoom"in o?+o.zoom:x,D="bearing"in o?this._normalizeBearing(o.bearing,b):b,O="pitch"in o?+o.pitch:S,U="padding"in o?o.padding:g.padding,W=s.pointGeometry.convert(o.offset);let ee,K,Y;if(g.projection.name==="globe"){const Me=s.MercatorCoordinate.fromLngLat(g.center),Oe=W.rotate(-g.angle);Me.x+=Oe.x/g.worldSize,Me.y+=Oe.y/g.worldSize;const ht=Me.toLngLat(),ke=s.LngLat.convert(o.center||ht);this._normalizeCenter(ke),ee=g.centerPoint.add(Oe),K=new s.pointGeometry(Me.x,Me.y).mult(g.worldSize),Y=new s.pointGeometry(s.mercatorXfromLng(ke.lng),s.mercatorYfromLat(ke.lat)).mult(g.worldSize).sub(K)}else{ee=g.centerPoint.add(W);const Me=g.pointLocation(ee),Oe=s.LngLat.convert(o.center||Me);this._normalizeCenter(Oe),K=g.project(Me),Y=g.project(Oe).sub(K)}const Q=g.zoomScale(I-x);let X,ae;o.around&&(X=s.LngLat.convert(o.around),ae=g.locationPoint(X));const te=this._zooming||I!==x,Ee=this._rotating||b!==D,xe=this._pitching||O!==S,pe=!g.isPaddingEqual(U),we=Me=>Oe=>{if(te&&(Me.zoom=s.number(x,I,Oe)),Ee&&(Me.bearing=s.number(b,D,Oe)),xe&&(Me.pitch=s.number(S,O,Oe)),pe&&(Me.interpolatePadding(A,U,Oe),ee=Me.centerPoint.add(W)),X)Me.setLocationAtPoint(X,ae);else{const ht=Me.zoomScale(Me.zoom-x),ke=I>x?Math.min(2,Q):Math.max(.5,Q),Xe=Math.pow(ke,1-Oe),nt=Me.unproject(K.add(Y.mult(Oe*Xe)).mult(ht));Me.setLocationAtPoint(Me.renderWorldCopies?nt.wrap():nt,ee)}return o.preloadOnly||this._fireMoveEvents(u),Me};if(o.preloadOnly){const Me=this._emulate(we,o.duration,g);return this._preloadTiles(Me),this}const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=te,this._rotating=Ee,this._pitching=xe,this._padding=pe,this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,ve),this._ease(we(g),Me=>{g.recenterOnTerrain(),this._afterEase(u,Me)},o),this}_prepareEase(o,u,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||g.moving||this.fire(new s.Event("movestart",o)),this._zooming&&!g.zooming&&this.fire(new s.Event("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new s.Event("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new s.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new s.Event("move",o)),this._zooming&&this.fire(new s.Event("zoom",o)),this._rotating&&this.fire(new s.Event("rotate",o)),this._pitching&&this.fire(new s.Event("pitch",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,x=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new s.Event("zoomend",o)),x&&this.fire(new s.Event("rotateend",o)),b&&this.fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o))}flyTo(o,u){if(!o.essential&&s.exported.prefersReducedMotion){const bt=s.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(bt,u)}this.stop(),o=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},o);const g=this.transform,x=this.getZoom(),b=this.getBearing(),S=this.getPitch(),A=this.getPadding(),I="zoom"in o?s.clamp(+o.zoom,g.minZoom,g.maxZoom):x,D="bearing"in o?this._normalizeBearing(o.bearing,b):b,O="pitch"in o?+o.pitch:S,U="padding"in o?o.padding:g.padding,W=g.zoomScale(I-x),ee=s.pointGeometry.convert(o.offset);let K=g.centerPoint.add(ee);const Y=g.pointLocation(K),Q=s.LngLat.convert(o.center||Y);this._normalizeCenter(Q);const X=g.project(Y),ae=g.project(Q).sub(X);let te=o.curve;const Ee=Math.max(g.width,g.height),xe=Ee/W,pe=ae.mag();if("minZoom"in o){const bt=s.clamp(Math.min(o.minZoom,x,I),g.minZoom,g.maxZoom),vt=Ee/g.zoomScale(bt-x);te=Math.sqrt(vt/pe*2)}const we=te*te;function ve(bt){const vt=(xe*xe-Ee*Ee+(bt?-1:1)*we*we*pe*pe)/(2*(bt?xe:Ee)*we*pe);return Math.log(Math.sqrt(vt*vt+1)-vt)}function Me(bt){return(Math.exp(bt)-Math.exp(-bt))/2}function Oe(bt){return(Math.exp(bt)+Math.exp(-bt))/2}const ht=ve(0);let ke=function(bt){return Oe(ht)/Oe(ht+te*bt)},Xe=function(bt){return Ee*((Oe(ht)*(Me(vt=ht+te*bt)/Oe(vt))-Me(ht))/we)/pe;var vt},nt=(ve(1)-ht)/te;if(Math.abs(pe)<1e-6||!isFinite(nt)){if(Math.abs(Ee-xe)<1e-6)return this.easeTo(o,u);const bt=xe<Ee?-1:1;nt=Math.abs(Math.log(xe/Ee))/te,Xe=function(){return 0},ke=function(vt){return Math.exp(bt*te*vt)}}o.duration="duration"in o?+o.duration:1e3*nt/("screenSpeed"in o?+o.screenSpeed/te:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const _t=b!==D,je=O!==S,ft=!g.isPaddingEqual(U),it=bt=>vt=>{const zt=vt*nt,Ut=1/ke(zt);bt.zoom=vt===1?I:x+bt.scaleZoom(Ut),_t&&(bt.bearing=s.number(b,D,vt)),je&&(bt.pitch=s.number(S,O,vt)),ft&&(bt.interpolatePadding(A,U,vt),K=bt.centerPoint.add(ee));const Ht=vt===1?Q:bt.unproject(X.add(ae.mult(Xe(zt))).mult(Ut));return bt.setLocationAtPoint(bt.renderWorldCopies?Ht.wrap():Ht,K),bt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(u),bt};if(o.preloadOnly){const bt=this._emulate(it,o.duration,g);return this._preloadTiles(bt),this}return this._zooming=!0,this._rotating=_t,this._pitching=je,this._padding=ft,this._prepareEase(u,!1),this._ease(it(g),()=>this._afterEase(u),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,u)}if(!o){const g=this.handlers;g&&g.stop(!1)}return this}_ease(o,u,g){g.animate===!1||g.duration===0?(o(1),u()):(this._easeStart=s.exported.now(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,u){o=s.wrap(o,-180,180);const g=Math.abs(o-u);return Math.abs(o-360-u)<g&&(o-=360),Math.abs(o+360-u)<g&&(o+=360),o}_normalizeCenter(o){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const g=o.lng-u.center.lng;o.lng+=g>180?-360:g<-180?360:0}_emulate(o,u,g){const x=Math.ceil(15*u/1e3),b=[],S=o(g.clone());for(let A=0;A<=x;A++){const I=S(A/x);b.push(I.clone())}return b}}class Fh{constructor(o={}){this.options=o,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const u=this.options&&this.options.compact;return this._map=o,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=R("button","mapboxgl-ctrl-attrib-button",this._container),R("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=R("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const g=this._map._getUIString(`AttributionControl.${u}`);o.setAttribute("aria-label",g),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(o){const g=u.reduce((x,b,S)=>(b.value&&(x+=`${b.key}=${b.value}${S<u.length-1?"&":""}`),x),"?");o.href=`${s.config.FEEDBACK_URL}/${g}#${kh(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style._sourceCaches;for(const x in u){const b=u[x];if(b.used){const S=b.getSource();S.attribution&&o.indexOf(S.attribution)<0&&o.push(S.attribution)}}o.sort((x,b)=>x.length-b.length),o=o.filter((x,b)=>{for(let S=b+1;S<o.length;S++)if(o[S].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Bh{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=R("div","mapboxgl-ctrl");const u=R("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const u in o){const g=o[u].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const u=o[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class Nh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const x of g)if(x.id===o)return void(x.cancelled=!0)}run(o=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Uh(p,o,u){if(p=new s.LngLat(p.lng,p.lat),o){const g=new s.LngLat(p.lng-360,p.lat),x=new s.LngLat(p.lng+360,p.lat),b=360*Math.ceil(Math.abs(p.lng-u.center.lng)/360),S=u.locationPoint(p).distSqr(o),A=o.x<0||o.y<0||o.x>u.width||o.y>u.height;u.locationPoint(g).distSqr(o)<S&&(A||Math.abs(g.lng-u.center.lng)<b)?p=g:u.locationPoint(x).distSqr(o)<S&&(A||Math.abs(x.lng-u.center.lng)<b)&&(p=x)}for(;Math.abs(p.lng-u.center.lng)>180;){const g=u.locationPoint(p);if(g.x>=0&&g.y>=0&&g.x<=u.width&&g.y<=u.height)break;p.lng>u.center.lng?p.lng-=360:p.lng+=360}return p}const xl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Bc extends s.Evented{constructor(o,u){if(super(),(o instanceof s.window.HTMLElement||u)&&(o=s.extend({element:o},u)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),o&&o.element)this._element=o.element,this._offset=s.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=R("div");const x=41,b=27,S=V("svg",{display:"block",height:x*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${x}`},this._element),A=V("radialGradient",{id:"shadowGradient"},V("defs",{},S));V("stop",{offset:"10%","stop-opacity":.4},A),V("stop",{offset:"100%","stop-opacity":.05},A),V("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},S),V("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},S),V("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},S),V("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},S),this._offset=s.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const g=this._element.classList;for(const x in xl)g.remove(`mapboxgl-marker-anchor-${x}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const u=o.code,g=o.charCode||o.keyCode;u!=="Space"&&u!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(o){const u=o.originalEvent.target,g=this._element;this._popup&&(u===g||g.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map;if(!o)return!1;const u=o.unproject(this._pos),g=o.getFreeCameraOptions();if(!g.position)return!1;const x=g.position.toLngLat();return x.distanceTo(u)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const u=this._pos;if(!u||u.x<0||u.x>o.transform.width||u.y<0||u.y>o.transform.height)return void this._clearFadeTimer();const g=o.unproject(u);let x;o._showingGlobe()&&s.isLngLatBehindGlobe(o.transform,this._lngLat)?x=0:(x=1-o._queryFogOpacity(g),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(x*=.2)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${xl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const o=this._pos,u=this._map,g=this.getPitchAlignment();if(!u||!o||g!=="map")return"";if(!u._showingGlobe()){const I=u.getPitch();return I?`rotateX(${I}deg)`:""}const x=s.radToDeg(s.globeTiltAtLngLat(u.transform,this._lngLat)),b=o.sub(s.globeCenterToScreenPoint(u.transform)),S=Math.abs(b.x)+Math.abs(b.y);if(S===0)return"";const A=x/S;return`rotateX(${-b.y*A}deg) rotateY(${b.x*A}deg)`}_calculateZTransform(){const o=this._pos,u=this._map;if(!u||!o)return"";let g=0;const x=this.getRotationAlignment();if(x==="map")if(u._showingGlobe()){const b=u.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),S=u.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);g=s.radToDeg(Math.atan2(S.y,S.x))-90}else g=-u.getBearing();else if(x==="horizon"){const b=s.smoothstep(4,6,u.getZoom()),S=s.globeCenterToScreenPoint(u.transform);S.y+=b*u.transform.height;const A=o.sub(S),I=s.radToDeg(Math.atan2(A.y,A.x));g=(I>90?I-270:I+90)*(1-b)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(o){s.window.cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=Uh(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),o===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=s.pointGeometry.convert(o),this._update(),this}_onMove(o){const u=this._map;if(u){if(!this._isDragging){const g=this._clickTolerance||u._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(o){const u=this._map;u&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos),this._pointerdownPos=o.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const u=this._map;return u&&(o?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}}class yp{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const u=s.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,u,g){this._start=this.getValue(u),this._end=o,this._startTime=u,this._endTime=u+g}}const vp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},xp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function bl(p){p.parentNode&&p.parentNode.removeChild(p)}const bp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Vh{constructor(o,u,g=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new zh({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,g&&(this.mousePitch=new Dn({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(o,u){this.mouseRotate.mousedown(o,u),this.mousePitch&&this.mousePitch.mousedown(o,u),j()}move(o,u){const g=this.map,x=this.mouseRotate.mousemoveWindow(o,u),b=x&&x.bearingDelta;if(b&&g.setBearing(g.getBearing()+b),this.mousePitch){const S=this.mousePitch.mousemoveWindow(o,u),A=S&&S.pitchDelta;A&&g.setPitch(g.getPitch()+A)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){q(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(s.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),ie(this.element,o)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,ie(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ie(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=Ie(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const wp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},$h={maxWidth:100,unit:"metric"};function jh(p,o,u){const g=Nc(o),x=g/o,b={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[u];this._map._requestDomTask(()=>{this._container.style.width=p*x+"px",this._container.innerHTML=`${g}&nbsp;${b}`})}function Nc(p){const o=Math.pow(10,`${Math.floor(p)}`.length-1);let u=p/o;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:u>=1?1:function(g){const x=Math.pow(10,Math.ceil(-Math.log(g)/Math.LN10));return Math.round(g*x)/x}(u),o*u}const C_={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},M_=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Uc(p=new s.pointGeometry(0,0),o="bottom"){if(typeof p=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(o){case"top":return new s.pointGeometry(0,p);case"top-left":return new s.pointGeometry(u,u);case"top-right":return new s.pointGeometry(-u,u);case"bottom":return new s.pointGeometry(0,-p);case"bottom-left":return new s.pointGeometry(u,-u);case"bottom-right":return new s.pointGeometry(-u,-u);case"left":return new s.pointGeometry(p,0);case"right":return new s.pointGeometry(-p,0)}return new s.pointGeometry(0,0)}return p instanceof s.pointGeometry||Array.isArray(p)?s.pointGeometry.convert(p):s.pointGeometry.convert(p[o]||[0,0])}const wl={version:s.version,supported:C,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends _p{constructor(p){if((p=s.extend({},xp,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(p.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new pl(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._optimizeForTerrain=p.optimizeForTerrain,this._language=p.language==="auto"?s.window.navigator.language:p.language,this._worldview=p.worldview,this._renderTaskQueue=new Nh,this._domRenderTaskQueue=new Nh,this._controls=[],this._markers=[],this._mapId=s.uniqueId(),this._locale=s.extend({},vp,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new yp(0),this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,typeof p.container=="string"){if(this._container=s.window.document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new gp(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this._hash=p.hash&&new Qf(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,s.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),p.attributionControl&&this.addControl(new Fh({customAttribution:p.customAttribution})),this._logoControl=new Bh,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update(o.dataType==="style"),this.fire(new s.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new s.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(p,o){if(o===void 0&&(o=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=p.onAdd(this);this._controls.push(p);const g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(p);return o>-1&&this._controls.splice(o,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),this.fire(new s.Event("resize",p)),o&&this.fire(new s.Event("moveend",p)),this}getBounds(){return this.transform.projection.name==="globe"&&s.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(s.LngLatBounds.convert(p)),this._update()}setMinZoom(p){if((p=p==null?-2:p)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p==null?22:p)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p==null?0:p)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p==null?85:p)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}getLanguage(){return this._language}setLanguage(p){if(this._language=p==="auto"?s.window.navigator.language:p,this.style)for(const o in this.style._sourceCaches){const u=this.style._sourceCaches[o]._source;u._setLanguage&&u._setLanguage(this._language)}for(const o of this._controls)o._setLanguage&&o._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){if(this._worldview=p,this.style)for(const o in this.style._sourceCaches){const u=this.style._sourceCaches[o]._source;u._setWorldview&&u._setWorldview(p)}return this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,o=p.projection.name;let u;o==="globe"&&p.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(p.setMercatorFromTransition(),u=!0):o==="mercator"&&p.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(p.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(p,o){return this._updateProjection(p||o||{name:"mercator"})}_updateProjection(p){let o;if(o=p.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const u in this.style._sourceCaches)this.style._sourceCaches[u].clearTiles();this._update(!0)}return this}project(p){return this.transform.locationPoint3D(s.LngLat.convert(p))}unproject(p){return this.transform.pointLocation3D(s.pointGeometry.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(p,o,u){if(p==="mouseenter"||p==="mouseover"){let g=!1;const x=S=>{const A=o.filter(D=>this.getLayer(D)),I=A.length?this.queryRenderedFeatures(S.point,{layers:A}):[];I.length?g||(g=!0,u.call(this,new Wn(p,this,S.originalEvent,{features:I}))):g=!1},b=()=>{g=!1};return{layers:new Set(o),listener:u,delegates:{mousemove:x,mouseout:b}}}if(p==="mouseleave"||p==="mouseout"){let g=!1;const x=S=>{const A=o.filter(I=>this.getLayer(I));(A.length?this.queryRenderedFeatures(S.point,{layers:A}):[]).length?g=!0:g&&(g=!1,u.call(this,new Wn(p,this,S.originalEvent)))},b=S=>{g&&(g=!1,u.call(this,new Wn(p,this,S.originalEvent)))};return{layers:new Set(o),listener:u,delegates:{mousemove:x,mouseout:b}}}{const g=x=>{const b=o.filter(A=>this.getLayer(A)),S=b.length?this.queryRenderedFeatures(x.point,{layers:b}):[];S.length&&(x.features=S,u.call(this,x),delete x.features)};return{layers:new Set(o),listener:u,delegates:{[p]:g}}}}on(p,o,u){if(u===void 0)return super.on(p,o);Array.isArray(o)||(o=[o]);const g=this._createDelegatedListener(p,o,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(g);for(const x in g.delegates)this.on(x,g.delegates[x]);return this}once(p,o,u){if(u===void 0)return super.once(p,o);Array.isArray(o)||(o=[o]);const g=this._createDelegatedListener(p,o,u);for(const x in g.delegates)this.once(x,g.delegates[x]);return this}off(p,o,u){if(u===void 0)return super.off(p,o);o=new Set(Array.isArray(o)?o:[o]);const g=(b,S)=>{if(b.size!==S.size)return!1;for(const A of b)if(!S.has(A))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[p]:void 0;return x&&(b=>{for(let S=0;S<b.length;S++){const A=b[S];if(A.listener===u&&g(A.layers,o)){for(const I in A.delegates)this.off(I,A.delegates[I]);return b.splice(S,1),this}}})(x),this}queryRenderedFeatures(p,o){return this.style?(o!==void 0||p===void 0||p instanceof s.pointGeometry||Array.isArray(p)||(o=p,p=void 0),this.style.queryRenderedFeatures(p=p||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(p,o){return this.style.querySourceFeatures(p,o)}queryTerrainElevation(p,o){const u=this.transform.elevation;return u?(o=s.extend({},{exaggerated:!0},o),u.getAtPoint(s.MercatorCoordinate.fromLngLat(p),null,o.exaggerated)):null}setStyle(p,o){return(o=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&p?(this._diffStyle(p,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(p,o))}_getUIString(p){const o=this._locale[p];if(o==null)throw new Error(`Missing UI string '${p}'`);return o}_updateStyle(p,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p&&(this.style=new Lr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p):this.style.loadJSON(p)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Lr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,o){if(typeof p=="string"){const u=this._requestManager.normalizeStyleURL(p),g=this._requestManager.transformRequest(u,s.ResourceType.Style);s.getJSON(g,(x,b)=>{x?this.fire(new s.ErrorEvent(x)):b&&this._updateDiff(b,o)})}else typeof p=="object"&&this._updateDiff(p,o)}_updateDiff(p,o){try{this.style.setState(p)&&this._update(!0)}catch(u){s.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(p,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(p,o){return this._lazyInitEmptyStyle(),this.style.addSource(p,o),this._update(!0)}isSourceLoaded(p){return!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){const p=this.style&&this.style._sourceCaches;for(const o in p){const u=p[o]._tiles;for(const g in u){const x=u[g];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}addSourceType(p,o,u){this._lazyInitEmptyStyle(),this.style.addSourceType(p,o,u)}removeSource(p){return this.style.removeSource(p),this._updateTerrain(),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,o,{pixelRatio:u=1,sdf:g=!1,stretchX:x,stretchY:b,content:S}={}){if(this._lazyInitEmptyStyle(),o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap){const{width:A,height:I,data:D}=s.exported.getImageData(o);this.style.addImage(p,{data:new s.RGBAImage({width:A,height:I},D),pixelRatio:u,stretchX:x,stretchY:b,content:S,sdf:g,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:A,height:I}=o,D=o;this.style.addImage(p,{data:new s.RGBAImage({width:A,height:I},new Uint8Array(D.data)),pixelRatio:u,stretchX:x,stretchY:b,content:S,sdf:g,version:0,userImage:D}),D.onAdd&&D.onAdd(this,p)}}updateImage(p,o){const u=this.style.getImage(p);if(!u)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap?s.exported.getImageData(o):o,{width:x,height:b}=g;x!==void 0&&b!==void 0?x===u.data.width&&b===u.data.height?(u.data.replace(g.data,!(o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap)),this.style.updateImage(p,u)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${b})
                must be that same as the previous version of the image
                (${u.data.width}, ${u.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,o){s.getImage(this._requestManager.transformRequest(p,s.ResourceType.Image),(u,g)=>{o(u,g instanceof s.window.HTMLImageElement?s.exported.getImageData(g):g)})}listImages(){return this.style.listImages()}addLayer(p,o){return this._lazyInitEmptyStyle(),this.style.addLayer(p,o),this._update(!0)}moveLayer(p,o){return this.style.moveLayer(p,o),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}setLayerZoomRange(p,o,u){return this.style.setLayerZoomRange(p,o,u),this._update(!0)}setFilter(p,o,u={}){return this.style.setFilter(p,o,u),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,o,u,g={}){return this.style.setPaintProperty(p,o,u,g),this._update(!0)}getPaintProperty(p,o){return this.style.getPaintProperty(p,o)}setLayoutProperty(p,o,u,g={}){return this.style.setLayoutProperty(p,o,u,g),this._update(!0)}getLayoutProperty(p,o){return this.style.getLayoutProperty(p,o)}setLight(p,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(p),this.transform):0}setFeatureState(p,o){return this.style.setFeatureState(p,o),this._update()}removeFeatureState(p,o){return this.style.removeFeatureState(p,o),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let u,g,x,b=this._container;for(;b&&(!g||!x);){const S=s.window.getComputedStyle(b).transform;S&&S!=="none"&&(u=S.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(g=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(x=u[3])),b=b.parentElement}this._containerWidth=g?Math.abs(p/g):p,this._containerHeight=x?Math.abs(o/x):o}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=R("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=R("div","mapboxgl-canvas-container",p);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=R("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=R("div","mapboxgl-control-container",p),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{g[x]=R("div",`mapboxgl-ctrl-${x}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,o){const u=s.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(p),this._canvas.height=u*Math.ceil(o),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${o}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const o=this._markers.indexOf(p);o!==-1&&this._markers.splice(o,1)}_setupPainter(){const p=s.extend({},C.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);o?(s.storeAuthState(o,!0),this.painter=new Ah(o,this.transform),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(o)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let o;const u=this.painter.context.extTimerQuery,g=s.exported.now();if(this.listens("gpu-timing-frame")&&(o=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();let x=!1;const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,D=this.transform.pitch,O=s.exported.now();this.style.zoomHistory.update(I,O);const U=new s.EvaluationParameters(I,{now:O,fadeDuration:b,pitch:D,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=U.crossFadingFactor();W===1&&W===this._crossFadingFactor||(x=!0,this._crossFadingFactor=W),this.style.update(U)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerUpdate()):S=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||x)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const I=s.exported.now()-g;u.endQueryEXT(u.TIME_ELAPSED_EXT,o),setTimeout(()=>{const D=u.getQueryObjectEXT(o,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(o),this.fire(new s.Event("gpu-timing-frame",{cpuTime:I,gpuTime:D})),s.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:D}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const D=this.painter.queryGpuTimers(I);this.fire(new s.Event("gpu-timing-layer",{layerTimes:D}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const D=this.painter.queryGpuTimeDeferredRender(I);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:D}))},50)}const A=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(A||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(S=this._updateAverageElevation(g,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const D=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:D})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||A||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const p of this._markers)p._update()}_updateAverageElevation(p,o=!1){const u=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);if((o||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const g=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=p;const S=Math.abs(g-x);if(S>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(x),u(x);this._averageElevation.easeTo(x,p,300)}else if(S>1e-4)return this._averageElevation.jumpTo(x),u(x)}return!!this._averageElevation.isEasing(p)&&u(this._averageElevation.getValue(p))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===s.AUTH_ERR_MSG||p.status===401)){const o=this.painter.context.gl;s.storeAuthState(o,!1),this._logoControl instanceof Bh&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const u=this.painter.context.gl,g=u.createFramebuffer();function x(b){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,b,0);const S=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,S),S}return u.bindFramebuffer(u.FRAMEBUFFER,g),this._canvasPixelComparison(x(p),o.canvasCopies.map(x),o.timeStamps)}_canvasPixelComparison(p,o,u){let g=u[1]-u[0];const x=p.length/4;for(let b=0;b<o.length;b++){const S=o[b];let A=0;for(let I=0;I<S.length;I+=4)S[I]===p[I]&&S[I+1]===p[I+1]&&S[I+2]===p[I+2]&&S[I+3]===p[I+3]&&(A+=1);g+=(u[b+2]-u[b+1])*(1-A/x)}return g}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1));const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),bl(this._canvasContainer),bl(this._controlContainer),bl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=s.exported.frame(o=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(o)}))}_preloadTiles(p){const o=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(o,(u,g)=>u._preloadTiles(p,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}_setCacheLimits(p,o){s.setCacheLimits(p,o)}get version(){return s.version}},NavigationControl:class{constructor(p){this.options=s.extend({},bp,p),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),R("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),R("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:o}):u.resetNorth({},{originalEvent:o}))}),this._compassIcon=R("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const o=p.getZoom(),u=o===p.getMaxZoom(),g=o===p.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Vh(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,o){const u=R("button",p,this._container);return u.type="button",u.addEventListener("click",o),u}_setButtonTitle(p,o){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${o}`);p.setAttribute("aria-label",u),p.firstElementChild&&p.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends s.Evented{constructor(p){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},wp,p),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ml(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){this._supportsGeolocation!==void 0?p(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(o=>{this._supportsGeolocation=o.state!=="denied",p(this._supportsGeolocation)}):(this._supportsGeolocation=!!this.options.geolocation,p(this._supportsGeolocation))}_isOutOfMapMaxBounds(p){const o=this._map.getMaxBounds(),u=p.coords;return!!o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",p)),this._finish()}}_updateCamera(p){const o=new s.LngLat(p.coords.longitude,p.coords.latitude),u=p.coords.accuracy,g=this._map.getBearing(),x=s.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(u),x,{geolocateSource:!0})}_updateMarker(p){if(p){const o=new s.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,o=s.mercatorZfromAltitude(1,p._center.lat)*p.worldSize,u=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=R("button","mapboxgl-ctrl-geolocate",this._container),R("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=R("div","mapboxgl-user-location"),this._dotElement.appendChild(R("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(R("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Bc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=R("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Fh,ScaleControl:class{constructor(p){this.options=s.extend({},$h,p),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=jh.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,o=this._map,u=o._containerHeight/2,g=o._containerWidth/2-p/2,x=o.unproject([g,u]),b=o.unproject([g+p,u]),S=x.distanceTo(b);if(this.options.unit==="imperial"){const A=3.2808*S;A>5280?this._setScale(p,A/5280,"mile"):this._setScale(p,A,"foot")}else this.options.unit==="nautical"?this._setScale(p,S/1852,"nautical-mile"):S>=1e3?this._setScale(p,S/1e3,"kilometer"):this._setScale(p,S,"meter")}_setScale(p,o,u){const g=Nc(o),x=g/o;this._map._requestDomTask(()=>{this._container.style.width=p*x+"px",this._container.innerHTML=u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:u}).format(g):`${g}&nbsp;nm`})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=R("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p){this._fullscreen=!1,p&&p.container&&(p.container instanceof s.window.HTMLElement?this._container=p.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=R("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=R("button","mapboxgl-ctrl-fullscreen",this._controlContainer);R("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(p){super(),this.options=s.extend(Object.create(C_),p),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=s.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(s.window.document.createTextNode(p))}setHTML(p){const o=s.window.document.createDocumentFragment(),u=s.window.document.createElement("body");let g;for(u.innerHTML=p;g=u.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=R("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(p),this.options.closeButton){const u=this._closeButton=R("button","mapboxgl-popup-close-button",o);u.type="button",u.setAttribute("aria-label","Close popup"),u.setAttribute("aria-hidden","true"),u.innerHTML="&#215;",u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let o;return this._classList.delete(p)?o=!1:(this._classList.add(p),o=!0),this._updateClassList(),o}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const o=this._map,u=this._container,g=this._pos;if(!o||!u||!g)return"bottom";const x=u.offsetWidth,b=u.offsetHeight,S=g.x<x/2,A=g.x>o.transform.width-x/2;if(g.y+p<b)return S?"top-left":A?"top-right":"top";if(g.y>o.transform.height-b){if(S)return"bottom-left";if(A)return"bottom-right"}return S?"left":A?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),p.className=o.join(" ")}_update(p){const o=this._map,u=this._content;if(!o||!this._lngLat&&!this._trackPointer||!u)return;let g=this._container;if(g||(g=this._container=R("div","mapboxgl-popup",o.getContainer()),this._tip=R("div","mapboxgl-popup-tip",g),g.appendChild(u)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Uh(this._lngLat,this._pos,o.transform)),!this._trackPointer||p){const x=this._pos=this._trackPointer&&p?p:o.project(this._lngLat),b=Uc(this.options.offset),S=this._anchor=this._getAnchor(b.y),A=Uc(this.options.offset,S),I=x.add(A).round();o._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${xl[S]} translate(${I.x}px,${I.y}px)`)})}if(!this._marker&&o._showingGlobe()){const x=s.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(M_);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:Bc,Style:Lr,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:St,Evented:s.Evented,config:s.config,prewarm:function(){qt().acquire(_e)},clearPrewarmedResources:function(){const p=pt;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(_e),pt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(p){s.config.ACCESS_TOKEN=p},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(p){s.config.API_URL=p},get workerCount(){return qe.workerCount},set workerCount(p){qe.workerCount=p},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){s.config.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){s.clearTileCache(p)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return wl});var y=d;return y})})(sM);const _r=sM.exports;const S4={name:"AsmspotterDemo",data(){return{asmSpotterMaps:{Suriname:{2016:"cktk976si0j8s18jy85eurve2",2017:"cktk9ai6o7xbt17qakqy6x3ve",2018:"cktk9czvr4pa117pfcjykiir1",2019:"cktk9fhkp0dqg18mtngolduef",2020:"cktk9h5080ds918mtrw5ljotn"},Guyana:{7:"ckrc50azi0mon17o3ssskenb6",8:"ckrc73ooz0kef18qyzb8acnsa",9:"ckrc7jh2g195e18ph97z5nvew"},Peru:{2019:"cktlpczcs10s618o1056etpqi",2020:"cktlpduc39bwd17qagpnzg2iz",2021:"cktlpe8jb629w18nyxsrhqby7"}},asmSpotterMapActive:2016,asmSpotterMap:null,asmSpotterMapCurrentZoom:12,asmSpotterMapCurrentCenter:[-55.409107,5.030173],asmSpotterCountryActive:"Suriname",calendarImg:"https://cdn.dida.do/demos/asmspotter-demo/date_range.svg",peruImg:"https://cdn.dida.do/demos/asmspotter-demo/peru.svg",surinameImg:"https://cdn.dida.do/demos/asmspotter-demo/suriname.svg",congoImg:"https://cdn.dida.do/demos/asmspotter-demo/congo.svg",guyanaImg:"https://cdn.dida.do/demos/asmspotter-demo/guyana.svg",guyanaPlot:"https://cdn.dida.do/demos/asmspotter-demo/guyana_analysis_total-area.png",surinamePlot:"https://cdn.dida.do/demos/asmspotter-demo/suriname_analysis.png",peruPlot:"https://cdn.dida.do/demos/asmspotter-demo/peru_analysis_total-area.png",partnerLogo:"https://cdn.dida.do/logos/logo_levin_sources.svg"}},methods:{changeMapSuriname(e){if(_r.accessToken="pk.eyJ1IjoibWdsYXNzLWRpZGEiLCJhIjoiY2tvMXdwcnpyMGQyOTJxbHB3NnpyNmJvbCJ9.9LtCaXaEqEDKwlGyKmeLqw",this.asmSpotterMapActive!==e){this.asmSpotterMapCurrentZoom=this.asmSpotterMap.getZoom(),this.asmSpotterMapCurrentCenter=this.asmSpotterMap.getCenter();const i=document.querySelector("#map");for(;i.firstChild;)i.removeChild(i.firstChild);this.asmSpotterMap.remove(),this.asmSpotterMapActive=e}this.asmSpotterMap=new _r.Map({container:"map",style:"mapbox://styles/mglass-dida/"+this.asmSpotterMaps[this.asmSpotterCountryActive][e],center:this.asmSpotterMapCurrentCenter,zoom:this.asmSpotterMapCurrentZoom}),this.asmSpotterMap.addControl(new _r.NavigationControl)},changeMapGuyana(e){if(_r.accessToken="pk.eyJ1Ijoiam9oYW5uZXNkaWRhIiwiYSI6ImNrcmMzdm9iejFjaHYyd3A4Mnloenp4eDkifQ.tiYLdyuURO87efgU3mdX6g",this.asmSpotterMapActive!==e){this.asmSpotterMapCurrentZoom=this.asmSpotterMap.getZoom(),this.asmSpotterMapCurrentCenter=this.asmSpotterMap.getCenter();const i=document.querySelector("#map");for(;i.firstChild;)i.removeChild(i.firstChild);this.asmSpotterMap.remove(),this.asmSpotterMapActive=e}this.asmSpotterMap=new _r.Map({container:"map",style:"mapbox://styles/johannesdida/"+this.asmSpotterMaps[this.asmSpotterCountryActive][e],center:this.asmSpotterMapCurrentCenter,zoom:this.asmSpotterMapCurrentZoom}),this.asmSpotterMap.addControl(new _r.NavigationControl),this.$refs.togglepreds.classList.remove("bg-gray-200"),this.$refs.togglepreds.classList.add("bg-green-400"),this.$refs.togglepreds_circle.classList.remove("left-[-1px]"),this.$refs.togglepreds_circle.classList.add("right-[-1px]"),this.$refs.toggleraster.classList.remove("bg-gray-200"),this.$refs.toggleraster.classList.add("bg-green-400"),this.$refs.toggleraster_circle.classList.remove("left-[-1px]"),this.$refs.toggleraster_circle.classList.add("right-[-1px]"),this.$refs.toggleareas.classList.remove("bg-gray-200"),this.$refs.toggleareas.classList.add("bg-green-400"),this.$refs.toggleareas_circle.classList.remove("left-[-1px]"),this.$refs.toggleareas_circle.classList.add("right-[-1px]"),this.$refs.toggleconcessions.classList.remove("bg-gray-200"),this.$refs.toggleconcessions.classList.add("bg-green-400"),this.$refs.toggleconcessions_circle.classList.remove("left-[-1px]"),this.$refs.toggleconcessions_circle.classList.add("right-[-1px]")},changeMapPeru(e){if(_r.accessToken="pk.eyJ1IjoibWdsYXNzLWRpZGEiLCJhIjoiY2tvMXdwcnpyMGQyOTJxbHB3NnpyNmJvbCJ9.9LtCaXaEqEDKwlGyKmeLqw",this.asmSpotterMapActive!==e){this.asmSpotterMapCurrentZoom=this.asmSpotterMap.getZoom(),this.asmSpotterMapCurrentCenter=this.asmSpotterMap.getCenter();const i=document.querySelector("#map");for(;i.firstChild;)i.removeChild(i.firstChild);this.asmSpotterMap.remove(),this.asmSpotterMapActive=e}this.asmSpotterMap=new _r.Map({container:"map",style:"mapbox://styles/mglass-dida/"+this.asmSpotterMaps[this.asmSpotterCountryActive][e],center:this.asmSpotterMapCurrentCenter,zoom:this.asmSpotterMapCurrentZoom}),this.asmSpotterMap.addControl(new _r.NavigationControl),this.$refs.togglepreds.classList.remove("bg-gray-200"),this.$refs.togglepreds.classList.add("bg-green-400"),this.$refs.togglepreds_circle.classList.remove("left-[-1px]"),this.$refs.togglepreds_circle.classList.add("right-[-1px]"),this.$refs.toggleraster.classList.remove("bg-gray-200"),this.$refs.toggleraster.classList.add("bg-green-400"),this.$refs.toggleraster_circle.classList.remove("left-[-1px]"),this.$refs.toggleraster_circle.classList.add("right-[-1px]"),this.$refs.toggleareas.classList.remove("bg-gray-200"),this.$refs.toggleareas.classList.add("bg-green-400"),this.$refs.toggleareas_circle.classList.remove("left-[-1px]"),this.$refs.toggleareas_circle.classList.add("right-[-1px]"),this.$refs.toggleconcessions.classList.remove("bg-gray-200"),this.$refs.toggleconcessions.classList.add("bg-green-400"),this.$refs.toggleconcessions_circle.classList.remove("left-[-1px]"),this.$refs.toggleconcessions_circle.classList.add("right-[-1px]")},changeCountry(e){this.asmSpotterCountryActive!==e&&(this.asmSpotterCountryActive=e,this.asmSpotterCountryActive==="Suriname"?(this.asmSpotterMapActive=2016,this.asmSpotterMapCurrentZoom=12,this.asmSpotterMapCurrentCenter=[-55.409107,5.030173],_r.accessToken="pk.eyJ1IjoibWdsYXNzLWRpZGEiLCJhIjoiY2tvMXdwcnpyMGQyOTJxbHB3NnpyNmJvbCJ9.9LtCaXaEqEDKwlGyKmeLqw",this.asmSpotterMap=new _r.Map({container:"map",style:"mapbox://styles/mglass-dida/"+this.asmSpotterMaps[this.asmSpotterCountryActive][this.asmSpotterMapActive],center:this.asmSpotterMapCurrentCenter,zoom:this.asmSpotterMapCurrentZoom})):this.asmSpotterCountryActive==="Guyana"?(this.asmSpotterMapActive=7,this.asmSpotterMapCurrentZoom=10,this.asmSpotterMapCurrentCenter=[-59.82332,6.78004],_r.accessToken="pk.eyJ1Ijoiam9oYW5uZXNkaWRhIiwiYSI6ImNrcmMzdm9iejFjaHYyd3A4Mnloenp4eDkifQ.tiYLdyuURO87efgU3mdX6g",this.asmSpotterMap=new _r.Map({container:"map",style:"mapbox://styles/johannesdida/"+this.asmSpotterMaps[this.asmSpotterCountryActive][this.asmSpotterMapActive],center:this.asmSpotterMapCurrentCenter,zoom:this.asmSpotterMapCurrentZoom})):(this.asmSpotterMapActive=2019,this.asmSpotterMapCurrentZoom=10,this.asmSpotterMapCurrentCenter=[-69.838,-12.587],_r.accessToken="pk.eyJ1IjoibWdsYXNzLWRpZGEiLCJhIjoiY2tvMXdwcnpyMGQyOTJxbHB3NnpyNmJvbCJ9.9LtCaXaEqEDKwlGyKmeLqw",this.asmSpotterMap=new _r.Map({container:"map",style:"mapbox://styles/mglass-dida/"+this.asmSpotterMaps[this.asmSpotterCountryActive][this.asmSpotterMapActive],center:this.asmSpotterMapCurrentCenter,zoom:this.asmSpotterMapCurrentZoom}))),this.asmSpotterMap.addControl(new _r.NavigationControl)},togglePreds(){var e=this.asmSpotterMap.getStyle().layers;for(const a of e)if(a.type==="fill"&&this.asmSpotterMap.getPaintProperty(a.id,"fill-color")!=="#44f425"&&this.asmSpotterMap.getPaintProperty(a.id,"fill-color")!=="#181ff2"){var i=this.asmSpotterMap.getLayoutProperty(a.id,"visibility");i==="visible"||i===void 0?(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","none"),this.$refs.togglepreds.classList.remove("bg-green-400"),this.$refs.togglepreds.classList.add("bg-gray-200"),this.$refs.togglepreds_circle.classList.remove("right-[-1px]"),this.$refs.togglepreds_circle.classList.add("left-[-1px]")):(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","visible"),this.$refs.togglepreds.classList.remove("bg-gray-200"),this.$refs.togglepreds.classList.add("bg-green-400"),this.$refs.togglepreds_circle.classList.remove("left-[-1px]"),this.$refs.togglepreds_circle.classList.add("right-[-1px]"))}},toggleRaster(){var e=this.asmSpotterMap.getStyle().layers;for(const a of e)if(a.type==="raster"){var i=this.asmSpotterMap.getLayoutProperty(a.id,"visibility");i==="visible"||i===void 0?(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","none"),this.$refs.toggleraster.classList.remove("bg-green-400"),this.$refs.toggleraster.classList.add("bg-gray-200"),this.$refs.toggleraster_circle.classList.remove("right-[-1px]"),this.$refs.toggleraster_circle.classList.add("left-[-1px]")):(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","visible"),this.$refs.toggleraster.classList.remove("bg-gray-200"),this.$refs.toggleraster.classList.add("bg-green-400"),this.$refs.toggleraster_circle.classList.remove("left-[-1px]"),this.$refs.toggleraster_circle.classList.add("right-[-1px]"))}},toggleAreas(){var e=this.asmSpotterMap.getStyle().layers;for(const a of e)if(a.type==="fill"&&this.asmSpotterMap.getPaintProperty(a.id,"fill-color")==="#44f425"){var i=this.asmSpotterMap.getLayoutProperty(a.id,"visibility");i==="visible"||i===void 0?(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","none"),this.$refs.toggleareas.classList.remove("bg-green-400"),this.$refs.toggleareas.classList.add("bg-gray-200"),this.$refs.toggleareas_circle.classList.remove("right-[-1px]"),this.$refs.toggleareas_circle.classList.add("left-[-1px]")):(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","visible"),this.$refs.toggleareas.classList.remove("bg-gray-200"),this.$refs.toggleareas.classList.add("bg-green-400"),this.$refs.toggleareas_circle.classList.remove("left-[-1px]"),this.$refs.toggleareas_circle.classList.add("right-[-1px]"))}},toggleConcessions(){var e=this.asmSpotterMap.getStyle().layers;for(const a of e)if(a.type==="fill"&&this.asmSpotterMap.getPaintProperty(a.id,"fill-color")==="#181ff2"){var i=this.asmSpotterMap.getLayoutProperty(a.id,"visibility");i==="visible"||i===void 0?(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","none"),this.$refs.toggleconcessions.classList.remove("bg-green-400"),this.$refs.toggleconcessions.classList.add("bg-gray-200"),this.$refs.toggleconcessions_circle.classList.remove("right-[-1px]"),this.$refs.toggleconcessions_circle.classList.add("left-[-1px]")):(this.asmSpotterMap.setLayoutProperty(a.id,"visibility","visible"),this.$refs.toggleconcessions.classList.remove("bg-gray-200"),this.$refs.toggleconcessions.classList.add("bg-green-400"),this.$refs.toggleconcessions_circle.classList.remove("left-[-1px]"),this.$refs.toggleconcessions_circle.classList.add("right-[-1px]"))}}},mounted(){this.changeCountry("Peru")}},A4={class:"w-full text-sm"},C4={class:"w-full flex flex-col md:flex-row md:items-end justify-center"},M4={class:"text-xl font-bold"},I4=Ir(" Peru "),P4={key:0,class:"text-primary"},k4=Fe("p",null,"Madre de Dios",-1),L4={class:"flex flex-row items-center justify-start"},z4=["src"],R4=Fe("p",{class:"text-black text-opacity-60 text-sm"}," 2019 - 2021 ",-1),D4=["src"],O4={class:"text-xl font-bold"},F4=Ir(" Suriname "),B4={key:0,class:"text-primary"},N4=Fe("p",null,"Brokopondo",-1),U4={class:"flex flex-row items-center justify-start"},V4=["src"],$4=Fe("p",{class:"text-black text-opacity-60 text-sm"}," 2016 - 2020 ",-1),j4=["src"],G4={class:"text-xl font-bold"},q4=Ir(" Guyana "),W4={key:0,class:"text-primary"},H4=Fe("p",null,"Cuyuni-Mazaruni",-1),Z4={class:"flex flex-row items-center justify-start"},X4=["src"],K4=Fe("p",{class:"text-black text-opacity-60 text-sm"}," Jul. 2020 - Sep. 2020 ",-1),Y4=["src"],Q4={class:"border-t-8 border-primary border-opacity-20"},J4={class:"bg-primary-nonessential"},e5={class:"p-6"},t5=qu('<p class="mb-2 text-primary font-bold flex flex-row items-center"><svg height="20px" width="20px" class="fill-current mr-2" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 100 100" x="0px" y="0px"><title>13</title><path d="M57.64111,20.0545A5.20472,5.20472,0,1,0,61.32135,26.429,5.20472,5.20472,0,0,0,57.64111,20.0545Z"></path><path d="M60.11377,69.0827c-4.46149,1.97675-11.31714,4.0896-9.51837-2.62353L58.767,35.96252l-17.7461,1.22467a2.70539,2.70539,0,0,0,.36231,5.39863l1.29889-.08472a3.26744,3.26744,0,0,1,3.36865,4.1062L38.76453,73.79968c-1.38642,5.17426,4.60193,8.56653,12.4956,4.5716a39.60121,39.60121,0,0,0,9.83423-7.91938A.85956.85956,0,0,0,60.11377,69.0827Z"></path><path d="M50,5A45,45,0,1,0,95,50,45,45,0,0,0,50,5Zm0,85A40,40,0,1,1,90,50,40.04527,40.04527,0,0,1,50,90Z"></path></svg> Choose a year to see the expansion of artisanal mining sites per year, each colour representing the expansion to the previous year. </p>',1),i5={key:0,class:"w-full flex flex-col sm:flex-row justify-between items-end"},n5={key:1,class:"w-full flex flex-col sm:flex-row justify-between items-end"},r5={key:2,class:"w-full flex flex-col sm:flex-row justify-between items-end"},s5={class:"relative"},o5={class:"absolute top-1 left-3 z-10"},a5=Fe("div",{class:"mt-0 text-xs xs:text-sm sm:text-base"},"Detected ASGM sites",-1),l5={ref:"togglepreds",class:"h-4 w-8 border rounded-full border-black relative bg-green-400"},c5={ref:"togglepreds_circle",class:"rounded-full h-4 w-4 border border-black absolute right-[-1px] inset-y-[-1px] bg-white"},u5=Fe("div",{class:"mt-0 text-xs xs:text-sm sm:text-base"},"Satellite images",-1),h5={ref:"toggleraster",class:"h-4 w-8 border rounded-full border-black relative bg-green-400"},d5={ref:"toggleraster_circle",class:"rounded-full h-4 w-4 border border-black absolute right-[-1px] inset-y-[-1px] bg-white"},f5=Fe("div",{class:"mt-0 text-xs xs:text-sm sm:text-base"},"Protected areas",-1),p5={ref:"toggleareas",class:"h-4 w-8 border rounded-full border-black relative bg-green-400"},m5={ref:"toggleareas_circle",class:"rounded-full h-4 w-4 border border-black absolute right-[-1px] inset-y-[-1px] bg-white"},g5=Fe("div",{class:"mt-0 text-xs xs:text-sm sm:text-base"},"Mining areas",-1),_5={ref:"toggleconcessions",class:"h-4 w-8 border rounded-full border-black relative bg-green-400"},y5={ref:"toggleconcessions_circle",class:"rounded-full h-4 w-4 border border-black absolute right-[-1px] inset-y-[-1px] bg-white"},v5=Fe("div",{id:"map"},null,-1),x5={key:0,class:"my-legend w-full"},b5=qu('<div class="legend-scale"><ul class="legend-labels"><li><span style="background:#f31be8;"></span>Indigenous areas </li><li><span style="background:#44f425;"></span>Protected areas </li><li><span style="background:#181ff2;"></span>Mining areas </li></ul></div>',1),w5=[b5],T5={key:1,class:"w-full max-w-6xl m-auto"},E5=["src"],S5={key:2,class:"w-full max-w-6xl m-auto"},A5=["src"],C5={key:3,class:"w-full max-w-6xl m-auto"},M5=["src"],I5={class:"w-full fluid-container--inner m-auto mt-10 mb-10 flex gap-y-4 flex-col-reverse sm:flex-row items-start justify-between"},P5=Fe("div",{class:"sm:w-1/2"},[Fe("h4",{class:"mb-2 font-bold"}," Analysis provided by Levin Sources: "),Fe("p",{class:"text-sm"}," Levin Sources is an advisory firm specialising in promoting responsible business conduct and good governance in minerals production and sourcing. We build sustainable minerals sectors and supply chains that generate enduring value for humanity by upholding human rights, protecting the environment, and enabling sustainable development in line with major voluntary and mandatory Environmental, Social and Governance (ESG) standards. ")],-1),k5={href:"https://www.levinsources.com",target:"_blank",class:"sm:w-1/3"},L5=["src"],z5={key:4,class:"mb-4 mt-6 text-2xl fluid-container--inner"},R5={key:5,class:"w-full fluid-container--inner"},D5=qu('<p class="mb-6"> Artisanal and small scale gold mining (ASGM) in Suriname started in the 1990s and it has been growing ever since.<sup>1</sup> ASGM is vital to the country\u2019s economy, as it is responsible for 60 percent of all Surinamese gold production.<sup>2</sup> Moreover, ASGM is one of the largest employers in Suriname, employing an estimated 40,000 workers, and it attracts miners from bordering countries, mainly from Brazil (also known as garimpeiros).<sup>3</sup> ASGM is loosely regulated in Suriname, without adequate legal, social and environmental frameworks.<sup>4</sup> Moreover, indigenous and maroon<sup>5</sup> land claims are not fully recognised.<sup>6</sup> Therefore, the ASGM remains mostly informal, without sufficient safeguards for environmental protection and human rights. Gold rushes involve both Surinamese and migrants from neighbouring countries.<sup>7</sup> In some locations, however, the majority of ASGM is undertaken by Brazilian migrant populations.<sup>8</sup></p><p class="mb-6"> Brokopondo, the focus area of this ASMSpotter demo, is one of Suriname\u2019s ASGM hotspots, together with Sipaliwini and Para districts.<sup>9</sup> ASGM in Brokopondo was reported as early as 1997.<sup>10</sup> The timelapse focusses on the northwestern area of the lake, near Brinckheuvel Nature Reserve, and clearly shows periods of rapid expansion of ASGM in the area from 2016 onwards. However, there seems to be no direct correlation between the expansion of ASGM in the area and the development of international gold prices over the same time period. Other factors could be at play and impact on this rapid development, such as increased inmigration into the area, as well as increased financial investment flowing into gold extraction, resulting in increased mechanisation of prospection, extraction and processing of gold. </p><p class="mb-6"> The area in Brokopondo also hosts an industrial gold mine, the IAMGold-owned Rosebel gold mine, which has been operating since 2004. Part of the concession of IAMGold can be seen on the right side of the images. Looking at the rate of ASM expansion and the development of the industrial mine and its surroundings, including the construction of roads, it seems that both developments correlate over the timeframe from 2016 \u2013 2021. However, the reasons for this and the factors driving it would require more detailed ground truthing. The timelapse of the demo also shows that ASGM expansion in this area of Brokopondo corresponds with seasonality, as gold expansion happens mostly during the drier season. This is common in other ASGM locations as well, as mining becomes more difficult during the rainy season. </p><p class="mb-6"> In 2017, it was estimated that ASGM in Suriname was responsible for around 43 percent of total deforestation in the country.<sup>11</sup> The ASMSpotter demo case study shows that deforestation in Brokopondo has increased since 2017, which indicates that current total deforestation caused by mining in the country could have further increased, posing a threat to local communities, indigenous peoples and local biodiversity. </p><div class="infos bg-primary-nonessential text-xs p-3 text-gray-500"><p class="mb-4 uppercase font-bold">References</p><ol><li> Jacopo Seccatore, Marjo de Theije, Socio-technical study of small-scale gold mining in Suriname, Journal of Cleaner Production (2016), doi: 10.1016/j.jclepro.2016.12.119 </li><li> Intergovernmental Forum on Mining, Minerals, Metals and Sustainable Development (IGF). (2017). IGF Mining Policy Framework Assessment: Suriname. Winnipeg: IISD; and https://www.thegef.org/sites/default/files/web-documents/10569_CW_PFD_child_projects.pdf </li><li> Intergovernmental Forum on Mining, Minerals, Metals and Sustainable Development (IGF). (2017). IGF Mining Policy Framework Assessment: Suriname. Winnipeg: IISD; Jacopo Seccatore, Marjo de Theije, Socio- technical study of small-scale gold mining in Suriname, Journal of Cleaner Production (2016), doi: 10.1016/j.jclepro.2016.12.119; and https://www.thegef.org/sites/default/files/web- documents/10569_CW_PFD_child_projects.pdf </li><li> Jacopo Seccatore, Marjo de Theije, Socio-technical study of small-scale gold mining in Suriname, Journal of Cleaner Production (2016), doi: 10.1016/j.jclepro.2016.12.119 </li><li> Maroons are descendants of Africans in the Americas who formed settlements away from slavery </li><li> Jacopo Seccatore, Marjo de Theije, Socio-technical study of small-scale gold mining in Suriname, Journal of Cleaner Production (2016), doi: 10.1016/j.jclepro.2016.12.119 </li><li> Jacopo Seccatore, Marjo de Theije, Socio-technical study of small-scale gold mining in Suriname, Journal of Cleaner Production (2016), doi: 10.1016/j.jclepro.2016.12.119 </li><li> Jacopo Seccatore, Marjo de Theije, Socio-technical study of small-scale gold mining in Suriname, Journal of Cleaner Production (2016), doi: 10.1016/j.jclepro.2016.12.119 </li><li> https://www.thegef.org/sites/default/files/web-documents/10569_CW_PFD_child_projects.pdf </li><li> Veiga, Marcello (1997): Artisanal Gold Mining Activities in Suriname, prepared for UNIDO. http://artisanalmining.org/Repository/02/The_GMP_Files/raw%20files%20- %20globalmercuryproject.org/LatAmerica/Suriname/UNIDO%20Veiga%20Suriname1997-nomap.pdf </li><li> Crawford and Bliss, 2017 \u2013 CHECK FULL REFERENCE FROM PROFOR </li></ol></div>',5),O5=[D5],F5={key:6,class:"w-full fluid-container--inner"},B5=qu('<p class="mb-6"> Guyana is heavily dependent on its mining sector, which has emerged as the main source of economic growth and earner of foreign exchange. With increased gold prices and demand for gold on international markets, the number of mining permits in Guyana has expanded, and foreign direct investment (FDI) has increased over the past 20 years. <sup>1</sup> It is only since 2015 that large, industrial gold mines are operating in Guyana, and until today a large part of the gold sector remains artisanal, small and medium-scale mining (ASM), <sup>2</sup> with an estimate 70% of gold production coming from ASM. <sup>3</sup> In 2017, was estimated that 17,000-18,000 people were employed directly in the gold mining sector in Guyana, including indigenous peoples, with around 70,000 persons benefitting indirectly from the activity. Mining therefore plays an important role in national efforts to reduce poverty, especially in remote and rural communities. <sup>4</sup></p><p class="mb-6"> At the same time, gold mining in Guyana poses significant environmental, social and health risks and challenges. Mining is reportedly the largest driver of deforestation and degradation of ecosystems in the country <sup>5</sup> , especially as 85% of Guyana\u2019s territory is covered by rainforest. There has been significant degradation of soil, vegetation and biological degradation in all of Guyana\u2019s Mining Districts, as well as large negative impacts on aquatic life due to river dredging. Much of the mining happens in state-owned forests: <sup>6</sup> In 2013, it was found that over 90% of mining leases issued were within a state forest boundary, and approximately 60% or prospecting licenses also overlap with state forests. <sup>7</sup> Mercury is widely used in the processing of gold from ASM operations, which poses grave dangers to human and animal health as well as to the environment. <sup>8</sup> In addition, gold mining activities are also linked to land disputes with indigenous peoples, especially where they do not have formal land titles or their land remains un-demarcated. <sup>9</sup></p><p class="mb-6"> While Guyana has a modern regulatory framework for mining which allows for and supports ASM, there are challenges related to governance and enforcement of this framework. Nevertheless, Guyana was the first of 8 countries to implement a national programme under the global, GEF- funded Planet Gold programme, which aims at making Guyana mercury-free by 2025 as per Guyanas National Action Plan under the Minamata Convention. <sup>10</sup></p><div class="infos bg-primary-nonessential text-xs p-3 text-gray-500"><p class="mb-4 uppercase font-bold">References</p><ol><li> &#39;https://publications.iadb.org/publications/english/document/Toward-the-Greening-of-the-Gold-Mining-Sector-of-Guyana-Transition-Issues-and-Challenges.pdf&#39; </li><li> &#39;https://publications.iadb.org/publications/english/document/Toward-the-Greening-of-the-Gold-Mining-Sector-of-Guyana-Transition-Issues-and-Challenges.pdf&#39; </li><li>&#39;https://www.planetgold.org/guyana&#39;</li><li> &#39;https://publications.iadb.org/publications/english/document/Toward-the-Greening-of-the-Gold-Mining-Sector-of-Guyana-Transition-Issues-and-Challenges.pdf&#39; </li><li> &#39;http://www.thegef.org/news/guyana-launches-%E2%80%9Cel-dorado%E2%80%9D-project-eliminate-mercury-use-small-scale-artisanal-gold-mining&#39; </li><li> &#39;https://publications.iadb.org/publications/english/document/Toward-the-Greening-of-the-Gold-Mining-Sector-of-Guyana-Transition-Issues-and-Challenges.pdf&#39; </li><li> &#39;https://publications.iadb.org/publications/english/document/Toward-the-Greening-of-the-Gold-Mining-Sector-of-Guyana-Transition-Issues-and-Challenges.pdf&#39; </li><li> &#39;http://www.thegef.org/news/guyana-launches-%E2%80%9Cel-dorado%E2%80%9D-project-eliminate-mercury-use-small-scale-artisanal-gold-mining&#39; </li><li> &#39;https://publications.iadb.org/publications/english/document/Toward-the-Greening-of-the-Gold-Mining-Sector-of-Guyana-Transition-Issues-and-Challenges.pdf&#39; </li><li> &#39;http://www.thegef.org/news/guyana-launches-%E2%80%9Cel-dorado%E2%80%9D-project-eliminate-mercury-use-small-scale-artisanal-gold-mining&#39; </li></ol></div>',4),N5=[B5],U5={key:7,class:"w-full fluid-container--inner"},V5=qu('<p class="mb-6"> Mining has a long tradition in Peru, and today it is a large contributor to the country\u2019s economy with a share of over 50% of Peru\u2019s overall exports<sup>1</sup>. While large-scale industrial mining is predominantly focusing on copper extraction, artisanal and small-scale mining (ASM) is mainly focusing on gold production. Official estimates from 2016 state that of 150,000 people employed in ASM in Peru in total, 70,000 people are working in ASM for gold (ASGM). Approximately 890,000 ounces of gold was mined by ASM in 2016<sup>2</sup>. Given the growth of the sector since then \u2013 as described below and visualized by the ASMSpotter\u2013 these numbers will have increased significantly.<br> A large part of ASGM operations is informal and/or illegal across the country<sup>3</sup>. The Peruvian government however is working to formalize the ASM sector. As a result, more than 51,000 miners and 8,000 miner associations have begun the process of formalization as of April 2020. </p><p class="mb-6"> The department of Madre de Dios \u2013 the focus area of this ASMSpotter demo \u2013 in the southeast of Peru and in the Amazonas has become a centre of informal and illegal alluvial ASGM. Deforestation often goes hand in hand with ASGM operations in this area. The expansion of ASGM was strongly driven by the construction of the interoceanic highway construction (2006 \u2013 2012) and when gold prices increased. However, even with decreasing prices between 2012 \u2013 2017, ASGM expanded by over 50%.<sup>4</sup></p><p class="mb-6"> As can be seen in the demo, ASGM is now also taking place in protected areas (green). To visualise such impacts, the application of the ASMSpotter on this area of Madre de Dios is overlaid with location data of natural reserves, restricted zones, mining cadaster etc. This shows that ASGM can pose a significant threat to biodiversity and protected areas through land clearing that leads to habitat loss and fragmentation; pollution from harmful chemicals, such as mercury and cyanide; and changes in hydrological regimes and sedimentation, among other impacts.<sup>5</sup></p><p class="mb-6"> Alone in the two years period covered by the ASMSpotter 2019 \u2013 2021, the total land area affected by ASGM grew by the factor 1.5. While drivers of uncontrolled ASGM in Madre de Dios in the past were high gold prices, this cannot be seen as the only factor driving the expansion. The Covid-19 pandemic has been a key factor in this over the past two years, and it has been reported that this may have occurred through two main drivers: First, unscrupulous criminal groups and business opportunists may have taken advantage of the much more limited monitoring, enforcement and presence by authorities during lockdowns. And second, as many urban worker lost their jobs and income during this time, they moved back to rural areas and took up informal ASGM as an activity that provides immediate emergency income and cash and does not require applications or qualifications. In this context, ASGM provided the last safety net for many of the 72% of Peru\u2019s population working in the informal economy.<sup>6</sup></p><p class="mb-6"> Finally, another factor in the expansion of ASGM beyond Madre de Dios in recent years has been the crack down and enforcement by the police on operations within Madre de Dios, which has caused miners to move into other areas to continue work, including regions of La Libertad, Arequipa and near Cusco, where deforestation impacts are now also on the rise.<sup>7</sup></p><div class="infos bg-primary-nonessential text-xs p-3 text-gray-500 break-words"><p class="mb-4 uppercase font-bold">References</p><ol><li> JG Simoes, CA Hidalgo. The Economic Complexity Observatory: An Analytical Tool for Understanding the Dynamics of Economic Development. Workshops at the Twenty-Fifth AAAI Conference on Artificial Intelligence. (2011), updated in 2019: <a href="https://oec.world/en/profile/country/per">https://oec.world/en/profile/country/per</a> (06-10-2021) </li><li> World Bank. 2019. 2019 State of the Artisanal and Small-Scale Mining Sector. Washington, D.C.: World Bank. </li><li> USAID Case Study | Artisanal and Small-Scale Mining in Peru (2020): <a class="break-words" href="https://www.planetgold.org/sites/default/files/2020-12/USAID.%202020.%20Case%20Study%20ASM%20and%20ASGM%20in%20Madre%20de%20Dios.pdf">https://www.planetgold.org/sites/default/files/2020-12/USAID.%202020.%20Case%20Study%20ASM%20and%20ASGM%20in%20Madre%20de%20Dios.pdf</a> (06-10-2021) </li><li> Caballero Espejo, J.; Messinger, M.; Rom\xE1n-Da\xF1obeytia, F.; Ascorra, C.; Fernandez, L.E.; Silman, M. Deforestation and Forest Degradation Due to Gold Mining in the Peruvian Amazon: A 34-Year Perspective. Remote Sens. 2018, 10, 1903. <a href="https://doi.org/10.3390/rs10121903">https://doi.org/10.3390/rs10121903</a></li><li> Caballero Espejo, J.; Messinger, M.; Rom\xE1n-Da\xF1obeytia, F.; Ascorra, C.; Fernandez, L.E.; Silman, M. Deforestation and Forest Degradation Due to Gold Mining in the Peruvian Amazon: A 34-Year Perspective. Remote Sens. 2018, 10, 1903. <a href="https://doi.org/10.3390/rs10121903">https://doi.org/10.3390/rs10121903</a></li><li> See for example <a href="https://www.bbc.com/future/article/20200518-why-lockdown-is-harming-the-amazon-rainforest">https://www.bbc.com/future/article/20200518-why-lockdown-is-harming-the-amazon-rainforest</a>; <a href="https://www.swissinfo.ch/eng/gold-finds-favour-in-the-pandemic-but-at-what-cost-/45987080">https://www.swissinfo.ch/eng/gold-finds-favour-in-the-pandemic-but-at-what-cost-/45987080</a></li><li><a href="https://www.swissinfo.ch/eng/gold-finds-favour-in-the-pandemic-but-at-what-cost-/45987080">https://www.swissinfo.ch/eng/gold-finds-favour-in-the-pandemic-but-at-what-cost-/45987080</a></li></ol></div>',6),$5=[V5];function j5(e,i,a,c,d,f){return Ft(),Nt("div",A4,[Fe("div",C4,[Fe("div",{onClick:i[0]||(i[0]=y=>f.changeCountry("Peru")),class:$i(["max-w-max md:max-w-none md:w-1/3 px-10 h-44 rounded-t-xl flex flex-row items-center cursor-pointer justify-between",{"h-44 bg-primary-nonessential":d.asmSpotterCountryActive=="Peru","bg-white bg-opacity-10":d.asmSpotterCountryActive!="Peru"}])},[Fe("div",null,[Fe("h4",M4,[I4,d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("span",P4,"(active)")):Ri("",!0)]),k4,Fe("div",L4,[Fe("img",{src:d.calendarImg,alt:"Calendar icon",class:"w-6 h-6 mr-2 opacity-60"},null,8,z4),R4])]),Fe("img",{src:d.peruImg,alt:"Peru silhouette"},null,8,D4)],2),Fe("div",{onClick:i[1]||(i[1]=y=>f.changeCountry("Suriname")),class:$i(["max-w-max md:max-w-none md:w-1/3 px-10 h-44 rounded-t-xl flex flex-row items-center cursor-pointer justify-between",{"h-44 bg-primary-nonessential":d.asmSpotterCountryActive=="Suriname","bg-white bg-opacity-10":d.asmSpotterCountryActive!="Suriname"}])},[Fe("div",null,[Fe("h4",O4,[F4,d.asmSpotterCountryActive=="Suriname"?(Ft(),Nt("span",B4,"(active)")):Ri("",!0)]),N4,Fe("div",U4,[Fe("img",{src:d.calendarImg,alt:"Calendar icon",class:"w-6 h-6 mr-2 opacity-60"},null,8,V4),$4])]),Fe("img",{src:d.surinameImg,alt:"Suriname silhouette"},null,8,j4)],2),Fe("div",{onClick:i[2]||(i[2]=y=>f.changeCountry("Guyana")),class:$i(["max-w-max md:max-w-none md:w-1/3 px-10 h-44 rounded-t-xl flex flex-row items-center cursor-pointer justify-between",{"h-44 bg-primary-nonessential":d.asmSpotterCountryActive=="Guyana","bg-white bg-opacity-10":d.asmSpotterCountryActive!="Guyana"}])},[Fe("div",null,[Fe("h4",G4,[q4,d.asmSpotterCountryActive=="Guyana"?(Ft(),Nt("span",W4,"(active)")):Ri("",!0)]),H4,Fe("div",Z4,[Fe("img",{src:d.calendarImg,alt:"Calendar icon",class:"w-6 h-6 mr-2 opacity-60"},null,8,X4),K4])]),Fe("img",{src:d.guyanaImg,alt:"Guyana silhouette"},null,8,Y4)],2)]),Fe("div",Q4,[Fe("div",J4,[Fe("div",e5,[t5,d.asmSpotterCountryActive=="Suriname"?(Ft(),Nt("div",i5,[Fe("div",{onClick:i[3]||(i[3]=y=>f.changeMapSuriname(2016)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==2016,"":d.asmSpotterMapActive!=2016}]),style:{"background-color":"#ffe72e"}}," 2016 "+Pi(d.asmSpotterMapActive==2016?"(active)":""),3),Fe("div",{onClick:i[4]||(i[4]=y=>f.changeMapSuriname(2017)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==2017,"":d.asmSpotterMapActive!=2017}]),style:{"background-color":"#ff930f"}}," 2017 "+Pi(d.asmSpotterMapActive==2017?"(active)":""),3),Fe("div",{onClick:i[5]||(i[5]=y=>f.changeMapSuriname(2018)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==2018,"":d.asmSpotterMapActive!=2018}]),style:{"background-color":"#ff2f05"}}," 2018 "+Pi(d.asmSpotterMapActive==2018?"(active)":""),3),Fe("div",{onClick:i[6]||(i[6]=y=>f.changeMapSuriname(2019)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==2019,"":d.asmSpotterMapActive!=2019}]),style:{"background-color":"#fa00a7"}}," 2019 "+Pi(d.asmSpotterMapActive==2019?"(active)":""),3),Fe("div",{onClick:i[7]||(i[7]=y=>f.changeMapSuriname(2020)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200 text-white",{"h-14 shadow-lg":d.asmSpotterMapActive==2020,"":d.asmSpotterMapActive!=2020}]),style:{"background-color":"#570fff"}}," 2020 "+Pi(d.asmSpotterMapActive==2020?"(active)":""),3)])):d.asmSpotterCountryActive=="Guyana"?(Ft(),Nt("div",n5,[Fe("div",{onClick:i[8]||(i[8]=y=>f.changeMapGuyana(7)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==7,"":d.asmSpotterMapActive!=7}]),style:{"background-color":"#ffe72e"}}," 07/2020 "+Pi(d.asmSpotterMapActive==7?"(active)":""),3),Fe("div",{onClick:i[9]||(i[9]=y=>f.changeMapGuyana(8)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==8,"":d.asmSpotterMapActive!=8}]),style:{"background-color":"#ff930f"}}," 08/2020 "+Pi(d.asmSpotterMapActive==8?"(active)":""),3),Fe("div",{onClick:i[10]||(i[10]=y=>f.changeMapGuyana(9)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==9,"":d.asmSpotterMapActive!=9}]),style:{"background-color":"#ff2f05"}}," 09/2020 "+Pi(d.asmSpotterMapActive==9?"(active)":""),3)])):d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("div",r5,[Fe("div",{onClick:i[11]||(i[11]=y=>f.changeMapPeru(2019)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==2019,"":d.asmSpotterMapActive!=2019}]),style:{"background-color":"#ffe72e"}}," 2019 "+Pi(d.asmSpotterMapActive==2019?"(active)":""),3),Fe("div",{onClick:i[12]||(i[12]=y=>f.changeMapPeru(2020)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==2020,"":d.asmSpotterMapActive!=2020}]),style:{"background-color":"#ff930f"}}," 2020 "+Pi(d.asmSpotterMapActive==2020?"(active)":""),3),Fe("div",{onClick:i[13]||(i[13]=y=>f.changeMapPeru(2021)),class:$i(["w-full h-12 flex flex-col justify-end px-4 py-2 font-bold text-md cursor-pointer hover:h-14 transition-height ease-out duration-200",{"h-14 shadow-lg":d.asmSpotterMapActive==2021,"":d.asmSpotterMapActive!=2021}]),style:{"background-color":"#ff2f05"}}," 2021 "+Pi(d.asmSpotterMapActive==2021?"(active)":""),3)])):Ri("",!0)]),Fe("div",s5,[Fe("div",o5,[Fe("div",{onClick:i[14]||(i[14]=y=>f.togglePreds()),class:"flex flex-wrap items-center justify-between cursor-pointer mt-3 p-2 pl-3 bg-white hover:bg-gray-100 text-black max-w-64"},[a5,Fe("div",l5,[Fe("div",c5,null,512)],512)]),Fe("div",{onClick:i[15]||(i[15]=y=>f.toggleRaster()),class:"flex flex-wrap items-center justify-between cursor-pointer mt-3 p-2 pl-3 bg-white hover:bg-gray-100 text-black max-w-64"},[u5,Fe("div",h5,[Fe("div",d5,null,512)],512)]),d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("div",{key:0,onClick:i[16]||(i[16]=y=>f.toggleAreas()),class:"flex flex-wrap items-center justify-between cursor-pointer mt-3 text-left align-top mx-auto p-2 pl-3 bg-white hover:bg-gray-100 text-black max-w-64"},[f5,Fe("div",p5,[Fe("div",m5,null,512)],512)])):Ri("",!0),d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("div",{key:1,onClick:i[17]||(i[17]=y=>f.toggleConcessions()),class:"flex flex-wrap items-center justify-between cursor-pointer mt-3 text-left align-top mx-auto p-2 pl-3 bg-white hover:bg-gray-100 text-black max-w-64"},[g5,Fe("div",_5,[Fe("div",y5,null,512)],512)])):Ri("",!0)]),v5])])]),d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("div",x5,w5)):Ri("",!0),d.asmSpotterCountryActive=="Suriname"?(Ft(),Nt("div",T5,[Fe("img",{src:d.surinamePlot,alt:"Suriname analysis",class:"mt-20 mb-10 block mx-auto"},null,8,E5)])):Ri("",!0),d.asmSpotterCountryActive=="Guyana"?(Ft(),Nt("div",S5,[Fe("img",{src:d.guyanaPlot,alt:"Guyana analysis",class:"mt-20 mb-10 block mx-auto"},null,8,A5)])):Ri("",!0),d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("div",C5,[Fe("img",{src:d.peruPlot,alt:"Peru analysis",class:"mt-20 mb-10 block mx-auto"},null,8,M5)])):Ri("",!0),Fe("div",I5,[P5,Fe("a",k5,[Fe("img",{src:d.partnerLogo,alt:"partner logo"},null,8,L5)])]),d.asmSpotterCountryActive=="Suriname"||d.asmSpotterCountryActive=="Guyana"||d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("h4",z5," About the region ")):Ri("",!0),d.asmSpotterCountryActive=="Suriname"?(Ft(),Nt("div",R5,O5)):Ri("",!0),d.asmSpotterCountryActive=="Guyana"?(Ft(),Nt("div",F5,N5)):Ri("",!0),d.asmSpotterCountryActive=="Peru"?(Ft(),Nt("div",U5,$5)):Ri("",!0)])}const G5=qa(S4,[["render",j5]]);var aM={exports:{}};/**
 * Countable is a script to allow for live paragraph-, word- and character-
 * counting on an HTML element.
 *
 * @author   Sacha Schmid (<https://github.com/RadLikeWhoa>)
 * @version  3.0.1
 * @license  MIT
 * @see      <http://radlikewhoa.github.io/Countable/>
 */(function(e,i){(function(a){let c=[];const d=Array.prototype.forEach;function f(C){const L=[];let k=0;const R=C.length;for(;k<R;){const V=C.charCodeAt(k++);if(V>=55296&&V<=56319&&k<R){const H=C.charCodeAt(k++);(H&64512)==56320?L.push(((V&1023)<<10)+(H&1023)+65536):(L.push(V),k--)}else L.push(V)}return L}function y(C,L){const k=Object.prototype.toString.call(C),R=typeof C=="string"||k==="[object NodeList]"||k==="[object HTMLCollection]"||C.nodeType===1,V=typeof L=="function";return R||console.error("Countable: Not a valid target"),V||console.error("Countable: Not a valid callback function"),R&&V}function s(C,L){let k=""+(typeof C=="string"?C:"value"in C?C.value:C.textContent);L=L||{},L.stripTags&&(k=k.replace(/<\/?[a-z][^>]*>/gi,"")),L.ignore&&d.call(L.ignore,function(V){k=k.replace(V,"")});const R=k.trim();return{paragraphs:R?(R.match(L.hardReturns?/\n{2,}/g:/\n+/g)||[]).length+1:0,sentences:R?(R.match(/[.?!…]+./g)||[]).length+1:0,words:R?(R.replace(/['";:,.?¿\-!¡]+/g,"").match(/\S+/g)||[]).length:0,characters:R?f(R.replace(/\s/g,"")).length:0,all:f(k).length}}const w={on:function(C,L,k){if(!!y(C,L))return Array.isArray(C)||(C=[C]),d.call(C,function(R){const V=function(){L.call(R,s(R,k))};c.push({element:R,handler:V}),V(),R.addEventListener("input",V)}),this},off:function(C){if(!!y(C,function(){}))return Array.isArray(C)||(C=[C]),c.filter(function(L){return C.indexOf(L.element)!==-1}).forEach(function(L){L.element.removeEventListener("input",L.handler)}),c=c.filter(function(L){return C.indexOf(L.element)===-1}),this},count:function(C,L,k){if(!!y(C,L))return Array.isArray(C)||(C=[C]),d.call(C,function(R){L.call(R,s(R,k))}),this},enabled:function(C){return C.length===void 0&&(C=[C]),c.filter(function(L){return C.indexOf(L.element)!==-1}).length===C.length}};e.exports=w})()})(aM);const $l=aM.exports;function PE(e){return e.replace(/[,.)-?!]\s*$/,"")}const q5={name:"FaqDemo",data:()=>({language:"german",requestId:"",loading:!1,FAQquestion:"",FAQanswer:"",FAQpairs:[],query:"",examples:{german:{easyJet:{FAQpairs:[{FAQquestion:"Wie viel kostet ein gro\xDFes Handgep\xE4ckst\xFCck?",FAQanswer:"Der Preis f\xFCr die Buchung eines gro\xDFen Handgep\xE4ckst\xFCcks beginnt bei \xA35,99. Kunden, die es vorziehen, einen Sitzplatz Up Front oder Extra Legroom zu w\xE4hlen, die ein gro\xDFes Handgep\xE4ckst\xFCck beinhalten, k\xF6nnen dies auf easyJet.com oder \xFCber unsere App tun und die Preise beginnen bei \xA37,99. Beide Optionen beinhalten auch Speedy Boarding. Alternativ k\xF6nnen Sie auch ein Gepackst\xFCck f\xFCr den Laderaum mitnehmen, die Preise beginnen bei \xA36,99 f\xFCr eine 15 kg schwere Tasche."},{FAQquestion:"Wie viele gro\xDFe Handgep\xE4ckst\xFCcke kann ich pro Person buchen?",FAQanswer:"Kunden k\xF6nnen ein gro\xDFes Handgep\xE4ckst\xFCck pro Person und Flug buchen. Kunden k\xF6nnen entweder ein gro\xDFes Handgep\xE4ckst\xFCck buchen oder einen Sitzplatz Up Front oder Extra Legroom ausw\xE4hlen, die ein gro\xDFes Handgep\xE4ckst\xFCck beinhalten. Beide Optionen sind auch f\xFCr Kinder und Kleinkinder mit gebuchtem Sitzplatz verf\xFCgbar."},{FAQquestion:"Ist die Anzahl gro\xDFer Handgep\xE4ckst\xFCcke auf jedem Flug begrenzt?",FAQanswer:"Ja, aufgrund des begrenzten Platzes in den Gep\xE4ckf\xE4chern an Bord ist die Anzahl der auf jedem Flug verf\xFCgbaren gro\xDFen Handgep\xE4ckst\xFCcke begrenzt. Wie bei den Sitzpl\xE4tzen empfehlen wir allen Kunden, fr\xFChzeitig zu buchen, um die Verf\xFCgbarkeit zu gew\xE4hrleisten."},{FAQquestion:"Kann ich ein gro\xDFes Handgep\xE4ckst\xFCck f\xFCr die einfache Flugstrecke erwerben?",FAQanswer:"Ja, \xFCber unsere App ist es aktuell m\xF6glich, gro\xDFe Handgep\xE4ckst\xFCcke pro Passagier und Flug zu buchen."},{FAQquestion:"Ich habe einen Sitzplatz Up Front bzw. Extra Legroom oder ein gro\xDFes Handgep\xE4ckst\xFCck f\xFCr meinen Hinflug gebucht. Leider war diese Option f\xFCr meinen R\xFCckflug nicht verf\xFCgbar. Welche M\xF6glichkeiten habe ich?",FAQanswer:"Du kannst f\xFCr deinen R\xFCckflug \xFCber easyJet.com oder unsere App einen Sitzplatz Up Front oder Extra Legroom buchen oder ein gro\xDFes Handgep\xE4ck hinzuf\xFCgen. Falls dies f\xFCr einen Teilabschnitt deiner Reise nicht erh\xE4ltlich ist, du aber ein weiteres Gep\xE4ckst\xFCck mitnehmen m\xF6chtest, kannst du f\xFCr alle Fl\xFCge auf deiner Buchung ein St\xFCck Aufgabegep\xE4ck hinzubuchen. Wir bieten bereits eine Reihe von Gep\xE4ckoptionen an, darunter ein Gep\xE4ckst\xFCck mit 15 kg schon ab \xA36,99, sodass Du nur das buchen und bezahlen musst, was Du auch wirklich ben\xF6tigen."},{FAQquestion:"Was passiert, wenn gro\xDFe Handgep\xE4ckst\xFCcke und die Sitzpl\xE4tze Up Front und Extra Legroom ausverkauft sind? Kann ich auf andere Weise ein gro\xDFes Handgep\xE4ckst\xFCck mit an Bord bringen?",FAQanswer:"Wenn die Sitzpl\xE4tze Up Front bzw. Extra Legroom oder gro\xDFe Handgep\xE4ckst\xFCcke nicht buchbar sind, kannst du nur ein kleines Handgep\xE4ckst\xFCck f\xFCr den Platz unter dem Vordersitz mit an Bord nehmen. Wir bieten bereits eine Reihe von Gep\xE4ckoptionen an, darunter ein Gep\xE4ckst\xFCck mit 15 kg schon ab \xA36,99, sodass Du nur das buchen und bezahlen musst, was Du auch wirklich ben\xF6tigst."},{FAQquestion:"Ich habe weder meinen Sitzplatz ausgew\xE4hlt noch ein gro\xDFes Handgep\xE4ckst\xFCck zu meiner Buchung hinzugef\xFCgt. Wie viel Handgep\xE4ck darf ich mitnehmen?",FAQanswer:"Wenn du keinen Sitzplatz ausw\xE4hlst, wird unser System beim Einchecken automatisch einen Platz f\xFCr dich reservieren. Deine Handgep\xE4ck-Freimenge beinhaltet ein kleines Handgep\xE4ckst\xFCck (max. 45 x 36 x 20 cm), das unter den Vordersitz passen muss, auch wenn dir automatisch ein Sitzplatz Up Front oder Extra Legroom zugewiesen wird."}],query:"Darf ich Handgep\xE4ck mitnehmen, wenn ich keinen Sitzplatz gebucht habe?"},zalando:{FAQpairs:[{FAQquestion:"Wie erhalte ich einen neuen R\xFCcksendeaufkleber?",FAQanswer:"Melde die R\xFCcksendung im Kundenkonto an und lade neue R\xFCcksendeunterlagen herunter"},{FAQquestion:"An welche Adresse schicke ich mein Paket zur\xFCck?",FAQanswer:"Du brauchst keine R\xFCcksendeadresse anzugeben. Mit unserem R\xFCcksendeaufkleber geht deine R\xFCcksendung immer kostenfrei an die richtige Adresse. Bitte stelle sicher, dass nur der R\xFCcksendeaufkleber au\xDFen zu sehen ist und nicht mehr der Aufkleber der urspr\xFCnglichen Lieferung."},{FAQquestion:"Kann ich Partner-Artikel zusammen mit anderen Artikeln zur\xFCckschicken?",FAQanswer:"Wenn deine Partner-Artikel im selben Paket mit Zalando-Artikeln geliefert wurden, kannst du alle Artikel zusammen zur\xFCckschicken. Wenn die Partner-Artikel in einer separaten Lieferung kamen, schicke sie bitte separat wieder zur\xFCck. Falls du keinen R\xFCcksendeaufkleber hast, kontaktiere uns bitte - wir fordern ihn beim Partner f\xFCr dich an. Hier gibt es alle Hinweise zur Partner-R\xFCcksendung."},{FAQquestion:"Wann erhalte ich die Best\xE4tigung meiner R\xFCcksendung?",FAQanswer:"Nachdem deine R\xFCcksendung bei uns eingegangen ist, pr\xFCfen wir, was du zur\xFCckgeschickt hast. Bitte gib uns daf\xFCr bis zu 14 Tage Zeit."}],query:"Wie lange dauert es, bis ich eine R\xFCcksendebest\xE4tigung bekomme?"},bauhaus:{FAQpairs:[{FAQquestion:"Wann erhalte ich meine R\xFCckzahlung?",FAQanswer:"Sobald Sie Ihre R\xFCcksendung veranlasst haben, erhalten Sie bei Paketsendungen i. d. R. nach 5 - 7 Tagen die R\xFCckzahlung auf dem von Ihnen gew\xE4hlten Zahlungsweg. Ist Ihre Bestellung hingegen ein Sperrgut, dann erhalten Sie i. d. R nach 9 - 11 Tagen die R\xFCckzahlung. Sp\xE4testens nach 21 Tagen werden Sie die R\xFCckzahlung erhalten haben."},{FAQquestion:"Wie lange kann ich den gekauften Artikel zur\xFCckgeben?",FAQanswer:"Zus\xE4tzlich zu Ihrem Widerrufsrecht bietet BAUHAUS unabh\xE4ngig davon, ob Sie bei uns im Online-Shop oder im Fachcentrum einkaufen, eine Umtauschgarantie von 30 Tagen nach Erhalt des Produktes bei unversehrter und originalverpackter Ware. Weitere Informationen erhalten Sie hier. Retouren k\xF6nnen Sie \xFCber das Retourenportal abwickeln."},{FAQquestion:'Wie kann ich Produkte zur\xFCckgeben, die ich \xFCber den Service "Reservieren & Abholen" gekauft habe?',FAQanswer:'Beim Service "Reservieren & Abholen" bestellen Sie online und holen die Ware im Fachcentrum ab. Im BAUHAUS Online-Shop erworbene Produkte k\xF6nnen in jedem BAUHAUS Fachcentrum in Deutschland zur\xFCckgegeben werden. Bitte beachten Sie, dass die Rechnung vorgezeigt werden muss.'},{FAQquestion:"Wie kann ich meine Bestellung widerrufen?",FAQanswer:"Wenn Sie bei uns im Online-Shop einkaufen, haben Sie das Recht, Ihre Bestellungen innerhalb von 14 Tagen nach Zugang der Bestellung ohne Angabe von Gr\xFCnden zu widerrufen. Bitte beachten Sie diesbez\xFCglich die weitergehenden Informationen zum Widerrufsrecht. Zus\xE4tzlich zu Ihrem Widerrufsrecht bietet BAUHAUS unabh\xE4ngig davon, ob Sie bei uns im Online-Shop oder im Fachcentrum einkaufen, eine Umtauschgarantie von 30 Tagen nach Erhalt des Produktes bei unversehrter und originalverpackter Ware unter Vorlage des Kassenbons bzw. der Rechnung an. Weiteres zur BAUHAUS-Umtauschgarantie finden Sie hier."},{FAQquestion:'Was versteht man unter der "Umtauschgaranie"?',FAQanswer:"Wenn Sie einmal zu viel oder nicht das Richtige gekauft haben, tauschen Sie es einfach in einem BAUHAUS Fachcentrum in Deutschland um \u2013 bis zu 30 Tage nach Erhalt der Produkte. Weiteres zur BAUHAUS Umtauschgarantie finden Sie hier."},{FAQquestion:"Wie lange habe ich Garantie auf BAUHAUS Produkte?",FAQanswer:"F\xFCr elektro- und motorbetriebene Ger\xE4te, au\xDFer Akkus, Batterien, Leuchtmittel und Verschlei\xDFteile, gibt BAUHAUS Ihnen f\xFCnf Jahre Garantie. Gesetzliche Gew\xE4hrleistungsrechte bleiben selbstverst\xE4ndlich unber\xFChrt. Dar\xFCber hinaus gibt BAUHAUS auf eine Vielzahl von entsprechend ausgezeichneten Produkten eine BAUHAUS-Garantie."},{FAQquestion:"Habe ich auch noch Garantie, wenn das Produkt bereits ge\xF6ffnet ist?",FAQanswer:"Die Garantie erlischt, sobald Sie das Ger\xE4tegeh\xE4use selbst \xF6ffnen oder durch Dritte, die keine BAUHAUS Mitarbeiter sind, \xF6ffnen lassen."},{FAQquestion:"Wenn ein defektes Produkt noch Garantie hat: Wird es dann repariert oder umgetauscht?",FAQanswer:"BAUHAUS kann je nach Fall nach eigenem Ermessen entweder reparieren, im Austausch ein Ersatzger\xE4t liefern oder den Kaufpreis gegen R\xFCckgabe des Ger\xE4tes erstatten."},{FAQquestion:"Was ben\xF6tige ich, um nachzuweisen, dass ich noch Garantieanspruch habe?",FAQanswer:"Bringen Sie bitte einfach das defekte Ger\xE4t und den Kassenbon ins n\xE4chste Fachcentrum. Sie k\xF6nnen Ihre Garantieanspr\xFCche in jedem BAUHAUS in Deutschland geltend machen \u2013 unabh\xE4ngig davon, wo Sie das Ger\xE4t gekauft haben."}],query:"?"},tier:{FAQpairs:[{FAQquestion:"Warum reserviert TIER zus\xE4tzliche Kosten, wenn ich eine Fahrt starte?",FAQanswer:"Der Betrag, den du m\xF6glicherweise bemerkt hast, wird Vorautorisierung genannt. Wenn du eine Anmietung in der TIER App startest, wird das System versuchen, diesen Betrag zu reservieren, um sicherzustellen, dass die Zahlungsmethode, die du benutzt, genug Geld hat, um sp\xE4ter die Fahrt zu bezahlen. Die Vorautorisierung wird innerhalb von 7-14 Werktagen wieder freigegeben, dies h\xE4ngt ganz von deinem Zahlungsanbieter ab. Wenn die Kosten f\xFCr die Fahrt geringer sind als die Vorautorisierung, verwenden wir diese, um die Kosten f\xFCr deine Fahrt zu decken und erstatten dir dann die Differenz - so dass du am Ende nat\xFCrlich nur die Kosten f\xFCr deine Fahrt bezahlst. Nehmen wir ein Beispiel: Wenn die Vorautorisierung 5 \u20AC betr\xE4gt und Ihre Fahrt 2 \u20AC kostet, erstatten wir Ihnen 3 \u20AC. Der Vorautorisierungsbetrag variiert von Stadt zu Stadt, f\xFCr eine komplette \xDCbersicht klicken Sie bitte hier."},{FAQquestion:"Wie kann ich meinen F\xFChrerschein verifizieren?",FAQanswer:'Die Verifizierung des F\xFChrerscheins wird innerhalb unserer App durchgef\xFChrt. Klicke einfach auf "Meinen F\xFChrerschein verifizieren" in der Navigationsleiste links und folge den Anweisungen. Stelle sicher, dass du deinen F\xFChrerschein dabei hast und in der Lage bist, deine Frontkamera zu verwenden, um Fotos von deinem F\xFChrerschein und dir selbst zu machen. Achte darauf dass die Beleuchtung stimmt, wenn du Fotos von deinem F\xFChrerschein und dir selbst machst. Wenn du den Prozess abgeschlossen hast, dauert es normalerweise bis zu f\xFCnf Minuten, um deinen F\xFChrerschein zu verifizieren. Solltest du w\xE4hrend des Prozesses Probleme haben, z\xF6gere nicht, eine E-Mail an support@tier.app zu schreiben und unser Customer Care Team wird dir weiterhelfen.'},{FAQquestion:"Kann ich meine Fahrt pausieren?",FAQanswer:"Du kannst die Anmietung w\xE4hrend der Fahrt mit der In-App-Pausenfunktion unterbrechen, aber bitte beachte, dass die maximale Mietdauer zwei Stunden betr\xE4gt. Du kannst deine Fahrt jedoch so oft unterbrechen, wie du m\xF6chtest, solange die maximale Mietdauer von 2 Stunden nicht \xFCberschritten wird. W\xE4hrend der Pausenfunktion kann der Scooter nicht bewegt werden, den Minutenpreis wird aber trotzdem berechnet. Nach den zwei Stunden endet die Miete automatisch."},{FAQquestion:"Wie lange kann ich fahren?",FAQanswer:"Die maximale Mietdauer mit unseren E-Scootern betr\xE4gt 2 Stunden. Nach 120 Minuten wird die Fahrt automatisch beendet. Bitte beachte, dass die maximale Mietdauer auch die Zeit einschlie\xDFt, in der du deine Fahrt unterbrichst. Wir haben eine maximale Fahrtdauer festgelegt, um sicherzustellen, dass du nicht unn\xF6tig belastet wirst, falls du vergisst, deine Fahrt zu beenden :)"},{FAQquestion:"Bin ich versichert?",FAQanswer:"Ja, unsere Fahrzeuge sind versichert und haben eine Haftpflichtversicherung bei der gr\xF6\xDFten deutschen Stra\xDFenversicherungsgesellschaft HUK-Coburg. In Gro\xDFbritannien und anderen europ\xE4ischen L\xE4ndern sind wir \xFCber AXA versichert. F\xFCr Sch\xE4den berechnen wir dir nur bis zu einem bestimmten Betrag - die weiteren Kosten kannst du hier einsehen. Solltest du in einen Unfall verwickelt worden sein, wende dich bitte an uns unter accident@tier.app oder kontaktiere uns direkt \xFCber die App. Um mehr dar\xFCber zu erfahren, was im Falle eines Unfalls zu tun ist, klicke hier."},{FAQquestion:"Was soll ich im Falle eines Unfalls tun?",FAQanswer:"Sicherheit geht vor: Im Falle eines Unfalls verst\xE4ndige bitte die Polizei und - falls n\xF6tig - rufe einen Krankenwagen (112 oder 911 anrufen). Wenn du dich um deine pers\xF6nliche Sicherheit gek\xFCmmert hast, kontaktiere uns bitte sofort. Alle unsere Telefonnummern findest du hier. Wenn du versuchst, uns au\xDFerhalb unserer Kundenbetreuungszeiten zu erreichen, kannst du stattdessen eine E-Mail an accident@tier.app schreiben. Bitte gebe in deiner E-Mail alle relevanten Informationen an, wie Kontaktdaten, das Datum des Vorfalls und die Fahrzeug-ID. Wir ermutigen dich, uns so schnell wie m\xF6glich zu erreichen.  damit wir weitere Vorf\xE4lle mit diesem Fahrzeug verhindern k\xF6nnen."}],query:"Was muss ich tun, wenn ich einen Schaden verursacht habe?"}},english:{easyJet:{FAQpairs:[{FAQquestion:"How much is it to add a large cabin bag?",FAQanswer:"Prices start from \xA35.99 to book a large cabin bag. If you would prefer to select an Up Front or Extra Legroom seat which includes a large cabin bag, you can do this on easyJet.com or our app, and prices start from \xA37.99. Both options also include Speedy Boarding. Alternatively, you can choose to bring a hold bag, with prices starting from \xA36.99 for a 15kg bag."},{FAQquestion:"How many large cabin bags can you book per person?",FAQanswer:"Customers can book one large cabin bag per person per flight. You can either book a large cabin bag or select an Up Front or Extra Legroom seat which includes a large cabin bag. Both options are also available for children and infants with a booked seat."},{FAQquestion:"Is there a limit to the number of large cabin bags available on each flight?",FAQanswer:"Yes, with limited locker space on board there will be a restriction on the number of large cabin bags available on each flight. As with seats, we encourage all customers to book early for the best availability."},{FAQquestion:"Can I purchase a large cabin bag one way?",FAQanswer:"Yes, large cabin bags can be booked per passenger per flight."},{FAQquestion:"I booked an Up Front/Extra Legroom seat or a large cabin bag on the way out, but it wasn\u2019t available to book for my flight back. What are my options?",FAQanswer:"You can book an Up Front or Extra Legroom seat or add a large cabin bag, for your return flight via easyJet.com or our app. If this isn\u2019t available for one leg of your trip and you\u2019d like to bring another bag with you, you can book a hold bag for all flights on your booking. We also offer a range of hold bag options including a small, 15kg option from \xA36.99, so you only need to book and pay for what you need."},{FAQquestion:"What happens if large cabin bags and Up Front and Extra Legroom seats are sold out? Will I be able to bring a large cabin bag on board another way?",FAQanswer:"Wenn die Sitzpl\xE4tze Up Front bzw. Extra Legroom oder gro\xDFe Handgep\xE4ckst\xFCcke nicht buchbar sind, kannst du nur ein kleines Handgep\xE4ckst\xFCck f\xFCr den Platz unter dem Vordersitz mit an Bord nehmen. Wir bieten bereits eine Reihe von Gep\xE4ckoptionen an, darunter ein Gep\xE4ckst\xFCck mit 15 kg schon ab \xA36,99, sodass Du nur das buchen und bezahlen musst, was Du auch wirklich ben\xF6tigst."},{FAQquestion:"I didn\u2019t select my seat or add a large cabin bag to my booking. What is my cabin bag allowance?",FAQanswer:"If you don\u2019t select your own seat, our system will automatically allocate your seat when you check in. Your cabin bag allowance is one small cabin bag (max. 45 x 36 x 20 cm), which needs to fit under the seat in front of you, even if you are auto-allocated an Up Front or Extra Legroom seat."}],query:"Can I take a cabin bag if I have not booked a seat?"},zalando:{FAQpairs:[{FAQquestion:"How do I get a new return label??",FAQanswer:"Register the return in the customer account and download new return documents"},{FAQquestion:"To which address do I return my package?",FAQanswer:"You do not need to provide a return address. With our return label your return will always be sent to the correct address free of charge. Please make sure that only the return label is visible on the outside and not the label of the original delivery."},{FAQquestion:"Can I return partner items together with other items?",FAQanswer:"If your partner items were delivered in the same package with Zalando items, you can return all items together. If the partner items came in a separate shipment, please return them separately. If you do not have a return label, please contact us - we will request it from the partner for you. Here are all the instructions for partner returns."},{FAQquestion:"When will I receive confirmation of my return?",FAQanswer:"After we receive your return, we will check what you have sent back. Please allow up to 14 days for this to happen."}],query:"How long does it take to get a return confirmation?"},bauhaus:{FAQpairs:[{FAQquestion:"",FAQanswer:""}],query:""},tier:{FAQpairs:[{FAQquestion:"Why do you reserve additional costs when I start a ride??",FAQanswer:"The amount you might have noticed is called pre-authorization. When you start a rental in the TIER app, the system will try to reserve this amount to make sure that the payment method you are using has enough funds to later pay for the ride. The pre-authorization will be released again within 7-14 working days, this depends completely on your payment provider. If your ride amount is less than the pre-authorization, we will use it to cover the cost of your ride and then refund you the difference - so that you in the end of course only pay for the cost of your ride. Let us take an example; if the pre-authorization is 5 \u20AC and your ride amount is 2 \u20AC, we will refund you 3 \u20AC. The pre-auth amount varies from city to city, to see a complete overview click right here."},{FAQquestion:"How can I verify my licence?",FAQanswer:"Your driver licence verification will be done within our app. Just click on verify my licence in the navigation bar on the left and follow the instructions. Make sure you have your licence with you and are able to use your front camera to take photos of your licence and yourself. Please make sure you have proper lighting when taking photos of your licence as well as yourself. If you finished the process it will normally take up to five minutes to verify your licence. In case you experience any issues during the process do not hesitate to write an email to support@tier.app and our Customer Care team will assist you further."},{FAQquestion:"Can I pause my ride?",FAQanswer:"You are able to pause your rental during the ride by using the in-app pause function, but please bear in mind that the maximal rental duration is two hours, pause included. However, you can pause your ride as many times as you would like, as long as it does not exceed the maximal 2-hour rental duration. During the pause function, the bike will not be able to be moved, but you will still pay the price per minute. After the two hours, the rental will automatically end."},{FAQquestion:"How long can I ride?",FAQanswer:"When riding our e-scooters the max rental duration time is 2 hours. After 120 minutes the ride will automatically end. Have in mind that the max rental duration time also includes the time you pause your ride. We have set a max ride duration time to make sure you are not charged unnecessarily in case you forget to end your ride :)"},{FAQquestion:"Am I insured?",FAQanswer:"Yes, our vehicles are insured and have a third-party insurance with the largest German road insurance company HUK-Coburg. In the UK and other European countries we are insured through AXA. For damages, we only charge you up to a certain amount - you can check additional charges here. In case you were involved in an accident please reach out to us at accident@tier.app or contact us directly through the app. To learn more about what to do in case of an accident click right here."},{FAQquestion:"What shall I do in case of an accident?",FAQanswer:"Safety first: In case of an accident, please contact the police and - if needed - call an ambulance (call 112 or 911). If you are injured, please immediately call your local emergency services. If any third parties are involved in an accident, contact your local police to report the case. When your personal safety have been taken care of, please contact us immediately. You can find all our phone numbers right here. If you try to reach us outside of our customer care hours you can write an email on accident@tier.app instead. Please include all relevant information in your email such as your contact information, date of the incident and the vehicle ID. We encourage you to reach out to as us as fast as possible so we can prevent any other incidents with this vehicle."}],query:"What do I have to do if I have caused damage?"}}},result:null,start:null,end:null,score:null,FAQquestionWordCount:0,FAQanswerWordCount:0,queryWordCount:0,resultWordCount:0,modelError:null,feedback:null,responseTime:null,userInfo:{ip:"",country:"",region:"",city:"",userAgent:navigator.userAgent,screenInfo:{devicePixelRatio:window.devicePixelRatio,viewportHeightCssPixel:window.screen.height,viewportWidthCssPixel:window.screen.width}}}),methods:{async getMatchingFaqPair(){this.loading=!0,await er.get("https://ipinfo.io/json").then(e=>{this.userInfo.ip=e.data.ip,this.userInfo.city=e.data.city,this.userInfo.region=e.data.region,this.userInfo.country=e.data.country}).finally(async()=>{var e=[];for(const i of this.FAQpairs)e.push(i.FAQquestion);await er({method:"post",url:"https://api-inference.huggingface.co/models/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2",data:{inputs:{source_sentence:this.query,sentences:e}},headers:{Authorization:"Bearer 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"}}).catch(i=>{i?this.modelError="Error 503: Model is currently loading, please retry in a few seconds.":this.modelError=null}).then(async i=>{this.loading=!1;var a=i.data,c=a.indexOf(Math.max(...a));this.result=this.FAQpairs[c],this.modelError=null}).catch(()=>{this.loading=!1}).finally(this.feedback=null)})},async getAnswer(){this.loading=!0,await er.get("https://ipinfo.io/json").then(e=>{this.userInfo.ip=e.data.ip,this.userInfo.city=e.data.city,this.userInfo.region=e.data.region,this.userInfo.country=e.data.country}).finally(async()=>{this.language==="english"?await er.post("https://website-qa-dot-try-apis-175016.ey.r.appspot.com/answer-question?question="+this.question+"&context="+this.context).then(async e=>{this.loading=!1,this.answer=PE(e.data.answer),this.score=e.data.score,this.start=e.data.start,this.end=e.data.end,await er.post("https://dida-bert-qa-data-service-83l32.ondigitalocean.app/",{context:this.context,question:this.question,answer:this.answer,start:this.start,end:this.end,score:this.score,contextWordCount:this.contextWordCount,questionWordCount:this.questionWordCount,answerWordCount:this.answerWordCount,feedback:null,responseTime:this.responseTime,userInfo:{ip:this.userInfo.ip,country:this.userInfo.country,region:this.userInfo.region,city:this.userInfo.city,userAgent:this.userInfo.userAgent,screenInfo:{devicePixelRatio:this.userInfo.screenInfo.devicePixelRatio,viewportHeightCssPixel:this.userInfo.screenInfo.viewportHeightCssPixel,viewportWidthCssPixel:this.userInfo.screenInfo.viewportWidthCssPixel}}}).then(i=>this.requestId=i.data)}).catch(()=>{this.loading=!1}).finally(this.feedback=null):this.language==="german"&&await er({method:"post",url:"https://api-inference.huggingface.co/models/deepset/gelectra-large-germanquad",data:{inputs:{question:this.question,context:this.context}},headers:{Authorization:"Bearer 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"}}).then(async e=>{this.loading=!1,this.answer=PE(e.data.answer),this.score=e.data.score,this.start=e.data.start,this.end=e.data.end,await er.post("https://dida-bert-qa-data-service-83l32.ondigitalocean.app/",{language:this.language,context:this.context,question:this.question,answer:this.answer,start:this.start,end:this.end,score:this.score,contextWordCount:this.contextWordCount,questionWordCount:this.questionWordCount,answerWordCount:this.answerWordCount,feedback:null,responseTime:this.responseTime,userInfo:{ip:this.userInfo.ip,country:this.userInfo.country,region:this.userInfo.region,city:this.userInfo.city,userAgent:this.userInfo.userAgent,screenInfo:{devicePixelRatio:this.userInfo.screenInfo.devicePixelRatio,viewportHeightCssPixel:this.userInfo.screenInfo.viewportHeightCssPixel,viewportWidthCssPixel:this.userInfo.screenInfo.viewportWidthCssPixel}}}).then(i=>this.requestId=i.data)}).catch(()=>{this.loading=!1}).finally(this.feedback=null)})},async giveFeedback(e){this.feedback===null&&await er.put("https://dida-bert-qa-data-service-83l32.ondigitalocean.app/",{requestId:this.requestId,feedback:e}).then(i=>{this.feedback=e}).catch(i=>{})},insertExample(e){this.FAQpairs=e.FAQpairs,this.query=e.query,this.result=""},clearInputs(){this.FAQquestion="",this.FAQanswer="",this.FAQpairs=[],this.query="",this.result=""},highlight(){return this.context?("..."+this.context.substring(this.start-20,this.end+20)+"...").replace(this.context.substring(this.start,this.end),i=>'<span class="text-range__highlight">'+i+"</span>"):this.context},pushPair(){this.FAQquestion!=""&&this.FAQanswer!=""&&this.FAQpairs.push({FAQquestion:this.FAQquestion,FAQanswer:this.FAQanswer}),this.FAQquestion="",this.FAQanswer=""},removePair(e){return this.FAQpairs.splice(e,1),this.FAQpairs}},computed:{FAQquestionValid(){return this.FAQquestionWordCount<=256&&this.FAQquestion!==""},FAQanswerValid(){return this.FAQanswerWordCount<=256&&this.FAQanswer!==""},isValid(){return this.FAQquestion!==""&&this.FAQquestionWordCount<=256&&this.query!==""&&this.FAQanswer!==""}},watch:{FAQquestion(e){$l.count(e,i=>this.FAQquestionWordCount=i.words)},FAQanswer(e){$l.count(e,i=>this.FAQanswerWordCount=i.words)},query(e){$l.count(e,i=>this.queryWordCount=i.words)},result(e){$l.count(e,i=>this.resultWordCount=i.words)}}},W5={class:"w-full",id:"faq-demo-full"},H5={class:"overlay"},Z5=Fe("div",{class:"gradient"},[Fe("p",{class:"loading-message"},[Ir("Processing"),Fe("br"),Ir("request")]),Fe("div",{id:"loading-animation-qa"})],-1),X5=[Z5],K5={class:"examples"},Y5={class:"p-10"},Q5=Fe("p",{class:"example-instructions"}," Enter your own text or use one of these examples: ",-1),J5={class:"example-wrapper flex-wrap gap-4"},eU={class:"language-selector flex-wrap"},tU={class:"selector"},iU=Ir("English "),nU=Fe("span",{class:"checkmark"},null,-1),rU={class:"selector"},sU=Ir("German "),oU=Fe("span",{class:"checkmark"},null,-1),aU={class:"w-full"},lU=["onClick"],cU={class:"min-h-[200px] relative border-2 rounded border-gray my-12 focus-within:border-dida"},uU=Fe("h5",{class:"text-2xl"},"Paste the question of one FAQ pair",-1),hU={class:"mt-4"},dU={class:"absolute top-0 left-0 bottom-0 flex flex-col w-full p-2"},fU={key:0,class:"text-dida"},pU={class:"min-h-[250px] relative border-2 rounded border-gray my-12 focus-within:border-dida"},mU=Fe("h5",{class:"text-2xl"},"Paste the answer of one FAQ pair",-1),gU={class:"mt-4"},_U={class:"absolute top-0 left-0 bottom-0 w-full flex flex-col p-2"},yU={key:0,class:"text-dida"},vU=Fe("h5",{class:"text-2xl"},"Enter a query",-1),xU={class:"mt-4"},bU={class:"absolute top-0 left-0 bottom-0 flex flex-col w-full p-2"},wU={key:0,class:"text-dida"},TU=["disabled"],EU={class:"step"},SU={key:0,class:"step__arrow step__arrow--valid"},AU={key:0,xmlns:"http://www.w3.org/2000/svg",width:"14.828",height:"8.828",viewBox:"0 0 14.828 8.828"},CU=Fe("g",{id:"Group_620","data-name":"Group 620",transform:"translate(-939.086 -1069.086)"},[Fe("line",{id:"Line_216","data-name":"Line 216",x2:"6",y2:"6",transform:"translate(940.5 1070.5)",fill:"none",stroke:"#bababa","stroke-linecap":"square","stroke-width":"2"}),Fe("line",{id:"Line_217","data-name":"Line 217",x1:"6",y2:"6",transform:"translate(946.5 1070.5)",fill:"none",stroke:"#bababa","stroke-linecap":"square","stroke-width":"2"})],-1),MU=[CU],IU={key:2,class:"model-error"},PU={style:{"margin-left":"10px","margin-right":"10px"}},kU={key:3,class:"answer"},LU=Fe("h6",null,"Best matching FAQ pair",-1),zU={class:"answer__wrapper"},RU={style:{"font-size":"18px"}},DU=Fe("b",null,"FAQ question:",-1),OU={style:{"font-size":"18px"}},FU=Fe("b",null,"FAQ answer:",-1),BU={height:"30px",width:"30px",style:{"margin-right":"10px"},fill:"#FFFFFF",xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 1",viewBox:"0 0 100 100",x:"0px",y:"0px"},NU=Fe("title",null,"07",-1),UU=Fe("path",{d:"M86.13,59.37a3,3,0,0,0-3.73,2c-3.61,12.09-14.8,24.28-31.67,24.28-15.93,0-33-13.26-33-33,0-15.93,13.26-33,33-33,10.6,0,19.26,5.37,24.67,11.15l-16.13-.25h0a3,3,0,0,0,0,6l22.6.35a3,3,0,0,0,2.17-.88,3,3,0,0,0,.88-2.17l-.35-22.6a3,3,0,0,0-3-3h0a3,3,0,0,0-3,3l.22,14.21a39.61,39.61,0,0,0-28-11.9c-23.32,0-39,20.16-39,39s15.67,39,39,39c20,0,33.17-14.35,37.42-28.56A3,3,0,0,0,86.13,59.37Z"},null,-1),VU=[NU,UU];function $U(e,i,a,c,d,f){return Ft(),Nt("div",W5,[Vs(Fe("div",H5,X5,512),[[t_,e.loading]]),Fe("div",K5,[Fe("div",Y5,[Q5,Fe("div",J5,[Fe("button",{onClick:i[0]||(i[0]=y=>f.insertExample(e.examples[e.language].easyJet)),class:"example"}," easyJet "),Fe("button",{onClick:i[1]||(i[1]=y=>f.insertExample(e.examples[e.language].zalando)),class:"example"}," Zalando "),Fe("button",{onClick:i[2]||(i[2]=y=>f.insertExample(e.examples[e.language].bauhaus)),class:"example"}," Bauhaus "),Fe("button",{onClick:i[3]||(i[3]=y=>f.insertExample(e.examples[e.language].tier)),class:"example"}," Tier Mobility "),Fe("button",{onClick:i[4]||(i[4]=y=>f.clearInputs()),class:"clear"},"Clear")])])]),Fe("div",eU,[Fe("label",tU,[iU,Vs(Fe("input",{type:"radio",name:"radio",value:"english","onUpdate:modelValue":i[5]||(i[5]=y=>e.language=y)},null,512),[[cf,e.language]]),nU]),Fe("label",rU,[sU,Vs(Fe("input",{type:"radio",checked:"checked",name:"radio",value:"german","onUpdate:modelValue":i[6]||(i[6]=y=>e.language=y)},null,512),[[cf,e.language]]),oU])]),Fe("ul",null,[(Ft(!0),Nt(dn,null,Wo(e.FAQpairs,(y,s)=>(Ft(),Nt("li",{key:s,class:"list-input justify-between"},[Fe("div",aU,[Fe("p",null,Pi(s+1)+". FAQ pair:",1),Fe("p",null,Pi(y.FAQquestion),1),Fe("p",null,Pi(y.FAQanswer),1)]),Fe("button",{onClick:w=>f.removePair(s),class:"remove-item"}," \xD7 ",8,lU)]))),128))]),Fe("div",cU,[Fe("div",{class:$i(["text-gray-400 p-4",{"opacity-0":e.FAQquestion!==""}])},[uU,Fe("p",hU," Paste the question in "+Pi(e.language==="german"?"German":"English")+" of one FAQ pair ",1)],2),Fe("div",dU,[e.result&&e.FAQquestion||e.FAQquestion?(Ft(),Nt("h6",fU," FAQ question ")):Ri("",!0),Vs(Fe("textarea",{class:$i(["h-full w-full grow border-none ring-0 focus:ring-0 p-0 bg-transparent resize-none",[f.FAQquestionValid?"input--valid":e.FAQquestionWordCount>256?"input--error":""]]),"onUpdate:modelValue":i[7]||(i[7]=y=>e.FAQquestion=y),required:"",autofocus:!0},null,2),[[xo,e.FAQquestion]]),e.FAQquestionWordCount>181?(Ft(),Nt("h6",{key:1,class:$i([[e.FAQquestionWordCount>256?"text-red-500":"text-dida"],"word-count"])},Pi(e.FAQquestionWordCount)+" of 256 words ",3)):Ri("",!0)])]),Fe("div",pU,[Fe("div",{class:$i(["text-gray-400 p-4",{"opacity-0":e.FAQanswer!==""}])},[mU,Fe("p",gU," Paste the answer in "+Pi(e.language==="german"?"German":"English")+" of one FAQ pair ",1)],2),Fe("div",_U,[e.result&&e.FAQanswer||e.FAQanswer?(Ft(),Nt("h6",yU," FAQ answer ")):Ri("",!0),Vs(Fe("textarea",{class:$i(["h-full w-full grow border-none ring-0 focus:ring-0 p-0 bg-transparent resize-none",[f.FAQanswerValid?"input--valid":e.FAQanswerWordCount>256?"input--error":""]]),"onUpdate:modelValue":i[8]||(i[8]=y=>e.FAQanswer=y),required:"",autofocus:!0},null,2),[[xo,e.FAQanswer]]),e.FAQanswerWordCount>181?(Ft(),Nt("h6",{key:1,class:$i([[e.FAQanswerWordCount>256?"text-red-500":"text-dida"],"word-count"])},Pi(e.FAQanswerWordCount)+" of 256 words ",3)):Ri("",!0)])]),e.FAQquestion&&e.FAQanswer?(Ft(),Nt("button",{key:0,onClick:i[9]||(i[9]=y=>f.pushPair()),class:"btn-cta add"}," Add this FAQ pair ")):Ri("",!0),Fe("div",{class:$i(["min-h-[200px] relative border-2 rounded border-gray my-12 focus-within:border-dida",{"bg-gray-400/25":e.FAQquestionWordCount>256||!e.FAQpairs.length}])},[Fe("div",{class:$i(["text-gray-400 p-4",{"opacity-0":e.query!==""}])},[vU,Fe("p",xU," Enter a question in your own words in "+Pi(e.language==="german"?"German":"English")+" for which the best matching FAQ should be returned ",1)],2),Fe("div",bU,[e.result&&e.query||e.query?(Ft(),Nt("h6",wU," User query ")):Ri("",!0),Vs(Fe("textarea",{class:$i(["h-full w-full grow border-none ring-0 focus:ring-0 p-0 bg-transparent resize-none",[e.query!==""&&e.FAQanswer!==""&&e.FAQquestion!==""?"input--valid":""]]),disabled:e.FAQquestionWordCount>256||!e.FAQpairs.length,"onUpdate:modelValue":i[10]||(i[10]=y=>e.query=y),required:""},null,10,TU),[[xo,e.query]])])],2),Fe("div",EU,[e.result?(Ft(),Nt("div",SU,[e.FAQquestionWordCount<257?(Ft(),Nt("svg",AU,MU)):Ri("",!0)])):Ri("",!0)]),e.result?Ri("",!0):(Ft(),Nt("button",{key:1,onClick:i[11]||(i[11]=y=>e.FAQpairs.length!=0?f.getMatchingFaqPair():{}),class:$i(["btn-cta",{"btn-cta--deactivated":!f.isValid,"btn-cta--filled-dida":f.isValid}])}," Get best matching FAQ ("+Pi(e.language==="german"?"German":"English")+") ",3)),e.modelError?(Ft(),Nt("div",IU,[Fe("p",PU,Pi(e.modelError),1)])):Ri("",!0),e.result?(Ft(),Nt("div",kU,[LU,Fe("div",zU,[Fe("p",RU,[DU,Ir(" "+Pi(e.result.FAQquestion),1)]),Fe("p",OU,[FU,Ir(" "+Pi(e.result.FAQanswer),1)])])])):Ri("",!0),e.result?(Ft(),Nt("button",{key:4,onClick:i[12]||(i[12]=y=>e.FAQpairs.length!=0?f.getMatchingFaqPair():{}),class:$i(["btn-cta rerun-button",{"btn-cta--deactivated":!f.isValid,"btn-cta--filled-dida":f.isValid}])},[(Ft(),Nt("svg",BU,VU)),Ir(" Re-run ("+Pi(e.language==="german"?"German":"English")+") ",1)],2)):Ri("",!0)])}const jU=qa(q5,[["render",$U]]);function jx(e,i){const a=Object.create(null),c=e.split(",");for(let d=0;d<c.length;d++)a[c[d]]=!0;return i?d=>!!a[d.toLowerCase()]:d=>!!a[d]}const GU={},kE=()=>{},hv=()=>!1,qU=/^on[^a-z]/,lM=e=>qU.test(e),xu=Object.assign,Ou=Array.isArray,ar=e=>typeof e=="string",Gx=e=>typeof e=="symbol",WU=e=>e!==null&&typeof e=="object",LE=jx(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),HU=jx("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),n_=e=>{const i=Object.create(null);return a=>i[a]||(i[a]=e(a))},ZU=/-(\w)/g,qx=n_(e=>e.replace(ZU,(i,a)=>a?a.toUpperCase():"")),XU=/\B([A-Z])/g,KU=n_(e=>e.replace(XU,"-$1").toLowerCase()),cM=n_(e=>e.charAt(0).toUpperCase()+e.slice(1)),YU=n_(e=>e?`on${cM(e)}`:"");function Wx(e){throw e}function uM(e){}function Tn(e,i,a,c){const d=e,f=new SyntaxError(String(d));return f.code=e,f.loc=i,f}const hf=Symbol(""),tf=Symbol(""),Hx=Symbol(""),Qm=Symbol(""),hM=Symbol(""),ic=Symbol(""),dM=Symbol(""),fM=Symbol(""),Zx=Symbol(""),Xx=Symbol(""),Pf=Symbol(""),Kx=Symbol(""),pM=Symbol(""),Yx=Symbol(""),Jm=Symbol(""),Qx=Symbol(""),Jx=Symbol(""),e1=Symbol(""),t1=Symbol(""),mM=Symbol(""),gM=Symbol(""),r_=Symbol(""),eg=Symbol(""),i1=Symbol(""),n1=Symbol(""),df=Symbol(""),kf=Symbol(""),r1=Symbol(""),_0=Symbol(""),QU=Symbol(""),y0=Symbol(""),tg=Symbol(""),JU=Symbol(""),e6=Symbol(""),s1=Symbol(""),t6=Symbol(""),i6=Symbol(""),o1=Symbol(""),_M=Symbol(""),Fu={[hf]:"Fragment",[tf]:"Teleport",[Hx]:"Suspense",[Qm]:"KeepAlive",[hM]:"BaseTransition",[ic]:"openBlock",[dM]:"createBlock",[fM]:"createElementBlock",[Zx]:"createVNode",[Xx]:"createElementVNode",[Pf]:"createCommentVNode",[Kx]:"createTextVNode",[pM]:"createStaticVNode",[Yx]:"resolveComponent",[Jm]:"resolveDynamicComponent",[Qx]:"resolveDirective",[Jx]:"resolveFilter",[e1]:"withDirectives",[t1]:"renderList",[mM]:"renderSlot",[gM]:"createSlots",[r_]:"toDisplayString",[eg]:"mergeProps",[i1]:"normalizeClass",[n1]:"normalizeStyle",[df]:"normalizeProps",[kf]:"guardReactiveProps",[r1]:"toHandlers",[_0]:"camelize",[QU]:"capitalize",[y0]:"toHandlerKey",[tg]:"setBlockTracking",[JU]:"pushScopeId",[e6]:"popScopeId",[s1]:"withCtx",[t6]:"unref",[i6]:"isRef",[o1]:"withMemo",[_M]:"isMemoSame"};function n6(e){Object.getOwnPropertySymbols(e).forEach(i=>{Fu[i]=e[i]})}const hs={source:"",start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}};function r6(e,i=hs){return{type:0,children:e,helpers:[],components:[],directives:[],hoists:[],imports:[],cached:0,temps:0,codegenNode:void 0,loc:i}}function ff(e,i,a,c,d,f,y,s=!1,w=!1,C=!1,L=hs){return e&&(s?(e.helper(ic),e.helper(Uu(e.inSSR,C))):e.helper(Nu(e.inSSR,C)),y&&e.helper(e1)),{type:13,tag:i,props:a,children:c,patchFlag:d,dynamicProps:f,directives:y,isBlock:s,disableTracking:w,isComponent:C,loc:L}}function Lf(e,i=hs){return{type:17,loc:i,elements:e}}function Es(e,i=hs){return{type:15,loc:i,properties:e}}function Cn(e,i){return{type:16,loc:hs,key:ar(e)?Ci(e,!0):e,value:i}}function Ci(e,i=!1,a=hs,c=0){return{type:4,loc:a,content:e,isStatic:i,constType:i?3:c}}function Gs(e,i=hs){return{type:8,loc:i,children:e}}function Ln(e,i=[],a=hs){return{type:14,loc:a,callee:e,arguments:i}}function Bu(e,i=void 0,a=!1,c=!1,d=hs){return{type:18,params:e,returns:i,newline:a,isSlot:c,loc:d}}function v0(e,i,a,c=!0){return{type:19,test:e,consequent:i,alternate:a,newline:c,loc:hs}}function s6(e,i,a=!1){return{type:20,index:e,value:i,isVNode:a,loc:hs}}function o6(e){return{type:21,body:e,loc:hs}}const as=e=>e.type===4&&e.isStatic,fu=(e,i)=>e===i||e===KU(i);function yM(e){if(fu(e,"Teleport"))return tf;if(fu(e,"Suspense"))return Hx;if(fu(e,"KeepAlive"))return Qm;if(fu(e,"BaseTransition"))return hM}const a6=/^\d|[^\$\w]/,a1=e=>!a6.test(e),l6=/[A-Za-z_$\xA0-\uFFFF]/,c6=/[\.\?\w$\xA0-\uFFFF]/,u6=/\s+[.[]\s*|\s*[.[]\s+/g,h6=e=>{e=e.trim().replace(u6,y=>y.trim());let i=0,a=[],c=0,d=0,f=null;for(let y=0;y<e.length;y++){const s=e.charAt(y);switch(i){case 0:if(s==="[")a.push(i),i=1,c++;else if(s==="(")a.push(i),i=2,d++;else if(!(y===0?l6:c6).test(s))return!1;break;case 1:s==="'"||s==='"'||s==="`"?(a.push(i),i=3,f=s):s==="["?c++:s==="]"&&(--c||(i=a.pop()));break;case 2:if(s==="'"||s==='"'||s==="`")a.push(i),i=3,f=s;else if(s==="(")d++;else if(s===")"){if(y===e.length-1)return!1;--d||(i=a.pop())}break;case 3:s===f&&(i=a.pop(),f=null);break}}return!c&&!d},vM=h6;function xM(e,i,a){const d={source:e.source.slice(i,i+a),start:ig(e.start,e.source,i),end:e.end};return a!=null&&(d.end=ig(e.start,e.source,i+a)),d}function ig(e,i,a=i.length){return ng(xu({},e),i,a)}function ng(e,i,a=i.length){let c=0,d=-1;for(let f=0;f<a;f++)i.charCodeAt(f)===10&&(c++,d=f);return e.offset+=a,e.line+=c,e.column=d===-1?e.column+a:a-d,e}function ws(e,i,a=!1){for(let c=0;c<e.props.length;c++){const d=e.props[c];if(d.type===7&&(a||d.exp)&&(ar(i)?d.name===i:i.test(d.name)))return d}}function s_(e,i,a=!1,c=!1){for(let d=0;d<e.props.length;d++){const f=e.props[d];if(f.type===6){if(a)continue;if(f.name===i&&(f.value||c))return f}else if(f.name==="bind"&&(f.exp||c)&&jl(f.arg,i))return f}}function jl(e,i){return!!(e&&as(e)&&e.content===i)}function d6(e){return e.props.some(i=>i.type===7&&i.name==="bind"&&(!i.arg||i.arg.type!==4||!i.arg.isStatic))}function dv(e){return e.type===5||e.type===2}function f6(e){return e.type===7&&e.name==="slot"}function rg(e){return e.type===1&&e.tagType===3}function sg(e){return e.type===1&&e.tagType===2}function Nu(e,i){return e||i?Zx:Xx}function Uu(e,i){return e||i?dM:fM}const p6=new Set([df,kf]);function bM(e,i=[]){if(e&&!ar(e)&&e.type===14){const a=e.callee;if(!ar(a)&&p6.has(a))return bM(e.arguments[0],i.concat(e))}return[e,i]}function og(e,i,a){let c,d=e.type===13?e.props:e.arguments[2],f=[],y;if(d&&!ar(d)&&d.type===14){const s=bM(d);d=s[0],f=s[1],y=f[f.length-1]}if(d==null||ar(d))c=Es([i]);else if(d.type===14){const s=d.arguments[0];!ar(s)&&s.type===15?s.properties.unshift(i):d.callee===r1?c=Ln(a.helper(eg),[Es([i]),d]):d.arguments.unshift(Es([i])),!c&&(c=d)}else if(d.type===15){let s=!1;if(i.key.type===4){const w=i.key.content;s=d.properties.some(C=>C.key.type===4&&C.key.content===w)}s||d.properties.unshift(i),c=d}else c=Ln(a.helper(eg),[Es([i]),d]),y&&y.callee===kf&&(y=f[f.length-2]);e.type===13?y?y.arguments[0]=c:e.props=c:y?y.arguments[0]=c:e.arguments[2]=c}function pf(e,i){return`_${i}_${e.replace(/[^\w]/g,(a,c)=>a==="-"?"_":e.charCodeAt(c).toString())}`}function m6(e){return e.type===14&&e.callee===o1?e.arguments[1].returns:e}function l1(e,{helper:i,removeHelper:a,inSSR:c}){e.isBlock||(e.isBlock=!0,a(Nu(c,e.isComponent)),i(ic),i(Uu(c,e.isComponent)))}function zE(e,i){const a=i.options?i.options.compatConfig:i.compatConfig,c=a&&a[e];return e==="MODE"?c||3:c}function Ql(e,i){const a=zE("MODE",i),c=zE(e,i);return a===3?c===!0:c!==!1}function mf(e,i,a,...c){return Ql(e,i)}const g6=/&(gt|lt|amp|apos|quot);/g,_6={gt:">",lt:"<",amp:"&",apos:"'",quot:'"'},RE={delimiters:["{{","}}"],getNamespace:()=>0,getTextMode:()=>0,isVoidTag:hv,isPreTag:hv,isCustomElement:hv,decodeEntities:e=>e.replace(g6,(i,a)=>_6[a]),onError:Wx,onWarn:uM,comments:!1};function y6(e,i={}){const a=v6(e,i),c=ls(a);return r6(c1(a,0,[]),Ss(a,c))}function v6(e,i){const a=xu({},RE);let c;for(c in i)a[c]=i[c]===void 0?RE[c]:i[c];return{options:a,column:1,line:1,offset:0,originalSource:e,source:e,inPre:!1,inVPre:!1,onWarn:a.onWarn}}function c1(e,i,a){const c=o_(a),d=c?c.ns:0,f=[];for(;!M6(e,i,a);){const s=e.source;let w;if(i===0||i===1){if(!e.inVPre&&vr(s,e.options.delimiters[0]))w=A6(e,i);else if(i===0&&s[0]==="<")if(s.length===1)en(e,5,1);else if(s[1]==="!")vr(s,"<!--")?w=b6(e):vr(s,"<!DOCTYPE")?w=Id(e):vr(s,"<![CDATA[")?d!==0?w=x6(e,a):(en(e,1),w=Id(e)):(en(e,11),w=Id(e));else if(s[1]==="/")if(s.length===2)en(e,5,2);else if(s[2]===">"){en(e,14,2),Vn(e,3);continue}else if(/[a-z]/i.test(s[2])){en(e,23),x0(e,1,c);continue}else en(e,12,2),w=Id(e);else/[a-z]/i.test(s[1])?(w=w6(e,a),Ql("COMPILER_NATIVE_TEMPLATE",e)&&w&&w.tag==="template"&&!w.props.some(C=>C.type===7&&wM(C.name))&&(w=w.children)):s[1]==="?"?(en(e,21,1),w=Id(e)):en(e,12,1)}if(w||(w=C6(e,i)),Ou(w))for(let C=0;C<w.length;C++)DE(f,w[C]);else DE(f,w)}let y=!1;if(i!==2&&i!==1){const s=e.options.whitespace!=="preserve";for(let w=0;w<f.length;w++){const C=f[w];if(!e.inPre&&C.type===2)if(/[^\t\r\n\f ]/.test(C.content))s&&(C.content=C.content.replace(/[\t\r\n\f ]+/g," "));else{const L=f[w-1],k=f[w+1];!L||!k||s&&(L.type===3||k.type===3||L.type===1&&k.type===1&&/[\r\n]/.test(C.content))?(y=!0,f[w]=null):C.content=" "}else C.type===3&&!e.options.comments&&(y=!0,f[w]=null)}if(e.inPre&&c&&e.options.isPreTag(c.tag)){const w=f[0];w&&w.type===2&&(w.content=w.content.replace(/^\r?\n/,""))}}return y?f.filter(Boolean):f}function DE(e,i){if(i.type===2){const a=o_(e);if(a&&a.type===2&&a.loc.end.offset===i.loc.start.offset){a.content+=i.content,a.loc.end=i.loc.end,a.loc.source+=i.loc.source;return}}e.push(i)}function x6(e,i){Vn(e,9);const a=c1(e,3,i);return e.source.length===0?en(e,6):Vn(e,3),a}function b6(e){const i=ls(e);let a;const c=/--(\!)?>/.exec(e.source);if(!c)a=e.source.slice(4),Vn(e,e.source.length),en(e,7);else{c.index<=3&&en(e,0),c[1]&&en(e,10),a=e.source.slice(4,c.index);const d=e.source.slice(0,c.index);let f=1,y=0;for(;(y=d.indexOf("<!--",f))!==-1;)Vn(e,y-f+1),y+4<d.length&&en(e,16),f=y+1;Vn(e,c.index+c[0].length-f+1)}return{type:3,content:a,loc:Ss(e,i)}}function Id(e){const i=ls(e),a=e.source[1]==="?"?1:2;let c;const d=e.source.indexOf(">");return d===-1?(c=e.source.slice(a),Vn(e,e.source.length)):(c=e.source.slice(a,d),Vn(e,d+1)),{type:3,content:c,loc:Ss(e,i)}}function w6(e,i){const a=e.inPre,c=e.inVPre,d=o_(i),f=x0(e,0,d),y=e.inPre&&!a,s=e.inVPre&&!c;if(f.isSelfClosing||e.options.isVoidTag(f.tag))return y&&(e.inPre=!1),s&&(e.inVPre=!1),f;i.push(f);const w=e.options.getTextMode(f,d),C=c1(e,w,i);i.pop();{const L=f.props.find(k=>k.type===6&&k.name==="inline-template");if(L&&mf("COMPILER_INLINE_TEMPLATE",e,L.loc)){const k=Ss(e,f.loc.end);L.value={type:2,content:k.source,loc:k}}}if(f.children=C,b0(e.source,f.tag))x0(e,1,d);else if(en(e,24,0,f.loc.start),e.source.length===0&&f.tag.toLowerCase()==="script"){const L=C[0];L&&vr(L.loc.source,"<!--")&&en(e,8)}return f.loc=Ss(e,f.loc.start),y&&(e.inPre=!1),s&&(e.inVPre=!1),f}const wM=jx("if,else,else-if,for,slot");function x0(e,i,a){const c=ls(e),d=/^<\/?([a-z][^\t\r\n\f />]*)/i.exec(e.source),f=d[1],y=e.options.getNamespace(f,a);Vn(e,d[0].length),gf(e);const s=ls(e),w=e.source;e.options.isPreTag(f)&&(e.inPre=!0);let C=OE(e,i);i===0&&!e.inVPre&&C.some(R=>R.type===7&&R.name==="pre")&&(e.inVPre=!0,xu(e,s),e.source=w,C=OE(e,i).filter(R=>R.name!=="v-pre"));let L=!1;if(e.source.length===0?en(e,9):(L=vr(e.source,"/>"),i===1&&L&&en(e,4),Vn(e,L?2:1)),i===1)return;let k=0;return e.inVPre||(f==="slot"?k=2:f==="template"?C.some(R=>R.type===7&&wM(R.name))&&(k=3):T6(f,C,e)&&(k=1)),{type:1,ns:y,tag:f,tagType:k,props:C,isSelfClosing:L,children:[],loc:Ss(e,c),codegenNode:void 0}}function T6(e,i,a){const c=a.options;if(c.isCustomElement(e))return!1;if(e==="component"||/^[A-Z]/.test(e)||yM(e)||c.isBuiltInComponent&&c.isBuiltInComponent(e)||c.isNativeTag&&!c.isNativeTag(e))return!0;for(let d=0;d<i.length;d++){const f=i[d];if(f.type===6){if(f.name==="is"&&f.value){if(f.value.content.startsWith("vue:"))return!0;if(mf("COMPILER_IS_ON_ELEMENT",a,f.loc))return!0}}else{if(f.name==="is")return!0;if(f.name==="bind"&&jl(f.arg,"is")&&!0&&mf("COMPILER_IS_ON_ELEMENT",a,f.loc))return!0}}}function OE(e,i){const a=[],c=new Set;for(;e.source.length>0&&!vr(e.source,">")&&!vr(e.source,"/>");){if(vr(e.source,"/")){en(e,22),Vn(e,1),gf(e);continue}i===1&&en(e,3);const d=E6(e,c);d.type===6&&d.value&&d.name==="class"&&(d.value.content=d.value.content.replace(/\s+/g," ").trim()),i===0&&a.push(d),/^[^\t\r\n\f />]/.test(e.source)&&en(e,15),gf(e)}return a}function E6(e,i){const a=ls(e),d=/^[^\t\r\n\f />][^\t\r\n\f />=]*/.exec(e.source)[0];i.has(d)&&en(e,2),i.add(d),d[0]==="="&&en(e,19);{const s=/["'<]/g;let w;for(;w=s.exec(d);)en(e,17,w.index)}Vn(e,d.length);let f;/^[\t\r\n\f ]*=/.test(e.source)&&(gf(e),Vn(e,1),gf(e),f=S6(e),f||en(e,13));const y=Ss(e,a);if(!e.inVPre&&/^(v-[A-Za-z0-9-]|:|\.|@|#)/.test(d)){const s=/(?:^v-([a-z0-9-]+))?(?:(?::|^\.|^@|^#)(\[[^\]]+\]|[^\.]+))?(.+)?$/i.exec(d);let w=vr(d,"."),C=s[1]||(w||vr(d,":")?"bind":vr(d,"@")?"on":"slot"),L;if(s[2]){const R=C==="slot",V=d.lastIndexOf(s[2]),H=Ss(e,FE(e,a,V),FE(e,a,V+s[2].length+(R&&s[3]||"").length));let J=s[2],ue=!0;J.startsWith("[")?(ue=!1,J.endsWith("]")?J=J.slice(1,J.length-1):(en(e,27),J=J.slice(1))):R&&(J+=s[3]||""),L={type:4,content:J,isStatic:ue,constType:ue?3:0,loc:H}}if(f&&f.isQuoted){const R=f.loc;R.start.offset++,R.start.column++,R.end=ig(R.start,f.content),R.source=R.source.slice(1,-1)}const k=s[3]?s[3].slice(1).split("."):[];return w&&k.push("prop"),C==="bind"&&L&&k.includes("sync")&&mf("COMPILER_V_BIND_SYNC",e,y,L.loc.source)&&(C="model",k.splice(k.indexOf("sync"),1)),{type:7,name:C,exp:f&&{type:4,content:f.content,isStatic:!1,constType:0,loc:f.loc},arg:L,modifiers:k,loc:y}}return!e.inVPre&&vr(d,"v-")&&en(e,26),{type:6,name:d,value:f&&{type:2,content:f.content,loc:f.loc},loc:y}}function S6(e){const i=ls(e);let a;const c=e.source[0],d=c==='"'||c==="'";if(d){Vn(e,1);const f=e.source.indexOf(c);f===-1?a=nf(e,e.source.length,4):(a=nf(e,f,4),Vn(e,1))}else{const f=/^[^\t\r\n\f >]+/.exec(e.source);if(!f)return;const y=/["'<=`]/g;let s;for(;s=y.exec(f[0]);)en(e,18,s.index);a=nf(e,f[0].length,4)}return{content:a,isQuoted:d,loc:Ss(e,i)}}function A6(e,i){const[a,c]=e.options.delimiters,d=e.source.indexOf(c,a.length);if(d===-1){en(e,25);return}const f=ls(e);Vn(e,a.length);const y=ls(e),s=ls(e),w=d-a.length,C=e.source.slice(0,w),L=nf(e,w,i),k=L.trim(),R=L.indexOf(k);R>0&&ng(y,C,R);const V=w-(L.length-k.length-R);return ng(s,C,V),Vn(e,c.length),{type:5,content:{type:4,isStatic:!1,constType:0,content:k,loc:Ss(e,y,s)},loc:Ss(e,f)}}function C6(e,i){const a=i===3?["]]>"]:["<",e.options.delimiters[0]];let c=e.source.length;for(let y=0;y<a.length;y++){const s=e.source.indexOf(a[y],1);s!==-1&&c>s&&(c=s)}const d=ls(e),f=nf(e,c,i);return{type:2,content:f,loc:Ss(e,d)}}function nf(e,i,a){const c=e.source.slice(0,i);return Vn(e,i),a===2||a===3||!c.includes("&")?c:e.options.decodeEntities(c,a===4)}function ls(e){const{column:i,line:a,offset:c}=e;return{column:i,line:a,offset:c}}function Ss(e,i,a){return a=a||ls(e),{start:i,end:a,source:e.originalSource.slice(i.offset,a.offset)}}function o_(e){return e[e.length-1]}function vr(e,i){return e.startsWith(i)}function Vn(e,i){const{source:a}=e;ng(e,a,i),e.source=a.slice(i)}function gf(e){const i=/^[\t\r\n\f ]+/.exec(e.source);i&&Vn(e,i[0].length)}function FE(e,i,a){return ig(i,e.originalSource.slice(i.offset,a),a)}function en(e,i,a,c=ls(e)){a&&(c.offset+=a,c.column+=a),e.options.onError(Tn(i,{start:c,end:c,source:""}))}function M6(e,i,a){const c=e.source;switch(i){case 0:if(vr(c,"</")){for(let d=a.length-1;d>=0;--d)if(b0(c,a[d].tag))return!0}break;case 1:case 2:{const d=o_(a);if(d&&b0(c,d.tag))return!0;break}case 3:if(vr(c,"]]>"))return!0;break}return!c}function b0(e,i){return vr(e,"</")&&e.slice(2,2+i.length).toLowerCase()===i.toLowerCase()&&/[\t\r\n\f />]/.test(e[2+i.length]||">")}function I6(e,i){Lm(e,i,TM(e,e.children[0]))}function TM(e,i){const{children:a}=e;return a.length===1&&i.type===1&&!sg(i)}function Lm(e,i,a=!1){const{children:c}=e,d=c.length;let f=0;for(let y=0;y<c.length;y++){const s=c[y];if(s.type===1&&s.tagType===0){const w=a?0:ss(s,i);if(w>0){if(w>=2){s.codegenNode.patchFlag=-1+"",s.codegenNode=i.hoist(s.codegenNode),f++;continue}}else{const C=s.codegenNode;if(C.type===13){const L=CM(C);if((!L||L===512||L===1)&&SM(s,i)>=2){const k=AM(s);k&&(C.props=i.hoist(k))}C.dynamicProps&&(C.dynamicProps=i.hoist(C.dynamicProps))}}}else s.type===12&&ss(s.content,i)>=2&&(s.codegenNode=i.hoist(s.codegenNode),f++);if(s.type===1){const w=s.tagType===1;w&&i.scopes.vSlot++,Lm(s,i),w&&i.scopes.vSlot--}else if(s.type===11)Lm(s,i,s.children.length===1);else if(s.type===9)for(let w=0;w<s.branches.length;w++)Lm(s.branches[w],i,s.branches[w].children.length===1)}f&&i.transformHoist&&i.transformHoist(c,i,e),f&&f===d&&e.type===1&&e.tagType===0&&e.codegenNode&&e.codegenNode.type===13&&Ou(e.codegenNode.children)&&(e.codegenNode.children=i.hoist(Lf(e.codegenNode.children)))}function ss(e,i){const{constantCache:a}=i;switch(e.type){case 1:if(e.tagType!==0)return 0;const c=a.get(e);if(c!==void 0)return c;const d=e.codegenNode;if(d.type!==13||d.isBlock&&e.tag!=="svg"&&e.tag!=="foreignObject")return 0;if(CM(d))return a.set(e,0),0;{let s=3;const w=SM(e,i);if(w===0)return a.set(e,0),0;w<s&&(s=w);for(let C=0;C<e.children.length;C++){const L=ss(e.children[C],i);if(L===0)return a.set(e,0),0;L<s&&(s=L)}if(s>1)for(let C=0;C<e.props.length;C++){const L=e.props[C];if(L.type===7&&L.name==="bind"&&L.exp){const k=ss(L.exp,i);if(k===0)return a.set(e,0),0;k<s&&(s=k)}}if(d.isBlock){for(let C=0;C<e.props.length;C++)if(e.props[C].type===7)return a.set(e,0),0;i.removeHelper(ic),i.removeHelper(Uu(i.inSSR,d.isComponent)),d.isBlock=!1,i.helper(Nu(i.inSSR,d.isComponent))}return a.set(e,s),s}case 2:case 3:return 3;case 9:case 11:case 10:return 0;case 5:case 12:return ss(e.content,i);case 4:return e.constType;case 8:let y=3;for(let s=0;s<e.children.length;s++){const w=e.children[s];if(ar(w)||Gx(w))continue;const C=ss(w,i);if(C===0)return 0;C<y&&(y=C)}return y;default:return 0}}const P6=new Set([i1,n1,df,kf]);function EM(e,i){if(e.type===14&&!ar(e.callee)&&P6.has(e.callee)){const a=e.arguments[0];if(a.type===4)return ss(a,i);if(a.type===14)return EM(a,i)}return 0}function SM(e,i){let a=3;const c=AM(e);if(c&&c.type===15){const{properties:d}=c;for(let f=0;f<d.length;f++){const{key:y,value:s}=d[f],w=ss(y,i);if(w===0)return w;w<a&&(a=w);let C;if(s.type===4?C=ss(s,i):s.type===14?C=EM(s,i):C=0,C===0)return C;C<a&&(a=C)}}return a}function AM(e){const i=e.codegenNode;if(i.type===13)return i.props}function CM(e){const i=e.patchFlag;return i?parseInt(i,10):void 0}function k6(e,{filename:i="",prefixIdentifiers:a=!1,hoistStatic:c=!1,cacheHandlers:d=!1,nodeTransforms:f=[],directiveTransforms:y={},transformHoist:s=null,isBuiltInComponent:w=kE,isCustomElement:C=kE,expressionPlugins:L=[],scopeId:k=null,slotted:R=!0,ssr:V=!1,inSSR:H=!1,ssrCssVars:J="",bindingMetadata:ue=GU,inline:j=!1,isTS:q=!1,onError:se=Wx,onWarn:ge=uM,compatConfig:ie}){const Ie=i.replace(/\?.*$/,"").match(/([^/\\]+)\.\w+$/),ze={selfName:Ie&&cM(qx(Ie[1])),prefixIdentifiers:a,hoistStatic:c,cacheHandlers:d,nodeTransforms:f,directiveTransforms:y,transformHoist:s,isBuiltInComponent:w,isCustomElement:C,expressionPlugins:L,scopeId:k,slotted:R,ssr:V,inSSR:H,ssrCssVars:J,bindingMetadata:ue,inline:j,isTS:q,onError:se,onWarn:ge,compatConfig:ie,root:e,helpers:new Map,components:new Set,directives:new Set,hoists:[],imports:[],constantCache:new Map,temps:0,cached:0,identifiers:Object.create(null),scopes:{vFor:0,vSlot:0,vPre:0,vOnce:0},parent:null,currentNode:e,childIndex:0,inVOnce:!1,helper(Ae){const He=ze.helpers.get(Ae)||0;return ze.helpers.set(Ae,He+1),Ae},removeHelper(Ae){const He=ze.helpers.get(Ae);if(He){const Ce=He-1;Ce?ze.helpers.set(Ae,Ce):ze.helpers.delete(Ae)}},helperString(Ae){return`_${Fu[ze.helper(Ae)]}`},replaceNode(Ae){ze.parent.children[ze.childIndex]=ze.currentNode=Ae},removeNode(Ae){const He=ze.parent.children,Ce=Ae?He.indexOf(Ae):ze.currentNode?ze.childIndex:-1;!Ae||Ae===ze.currentNode?(ze.currentNode=null,ze.onNodeRemoved()):ze.childIndex>Ce&&(ze.childIndex--,ze.onNodeRemoved()),ze.parent.children.splice(Ce,1)},onNodeRemoved:()=>{},addIdentifiers(Ae){},removeIdentifiers(Ae){},hoist(Ae){ar(Ae)&&(Ae=Ci(Ae)),ze.hoists.push(Ae);const He=Ci(`_hoisted_${ze.hoists.length}`,!1,Ae.loc,2);return He.hoisted=Ae,He},cache(Ae,He=!1){return s6(ze.cached++,Ae,He)}};return ze.filters=new Set,ze}function L6(e,i){const a=k6(e,i);a_(e,a),i.hoistStatic&&I6(e,a),i.ssr||z6(e,a),e.helpers=[...a.helpers.keys()],e.components=[...a.components],e.directives=[...a.directives],e.imports=a.imports,e.hoists=a.hoists,e.temps=a.temps,e.cached=a.cached,e.filters=[...a.filters]}function z6(e,i){const{helper:a}=i,{children:c}=e;if(c.length===1){const d=c[0];if(TM(e,d)&&d.codegenNode){const f=d.codegenNode;f.type===13&&l1(f,i),e.codegenNode=f}else e.codegenNode=d}else if(c.length>1){let d=64;e.codegenNode=ff(i,a(hf),void 0,e.children,d+"",void 0,void 0,!0,void 0,!1)}}function R6(e,i){let a=0;const c=()=>{a--};for(;a<e.children.length;a++){const d=e.children[a];ar(d)||(i.parent=e,i.childIndex=a,i.onNodeRemoved=c,a_(d,i))}}function a_(e,i){i.currentNode=e;const{nodeTransforms:a}=i,c=[];for(let f=0;f<a.length;f++){const y=a[f](e,i);if(y&&(Ou(y)?c.push(...y):c.push(y)),i.currentNode)e=i.currentNode;else return}switch(e.type){case 3:i.ssr||i.helper(Pf);break;case 5:i.ssr||i.helper(r_);break;case 9:for(let f=0;f<e.branches.length;f++)a_(e.branches[f],i);break;case 10:case 11:case 1:case 0:R6(e,i);break}i.currentNode=e;let d=c.length;for(;d--;)c[d]()}function MM(e,i){const a=ar(e)?c=>c===e:c=>e.test(c);return(c,d)=>{if(c.type===1){const{props:f}=c;if(c.tagType===3&&f.some(f6))return;const y=[];for(let s=0;s<f.length;s++){const w=f[s];if(w.type===7&&a(w.name)){f.splice(s,1),s--;const C=i(c,w,d);C&&y.push(C)}}return y}}}const l_="/*#__PURE__*/",IM=e=>`${Fu[e]}: _${Fu[e]}`;function D6(e,{mode:i="function",prefixIdentifiers:a=i==="module",sourceMap:c=!1,filename:d="template.vue.html",scopeId:f=null,optimizeImports:y=!1,runtimeGlobalName:s="Vue",runtimeModuleName:w="vue",ssrRuntimeModuleName:C="vue/server-renderer",ssr:L=!1,isTS:k=!1,inSSR:R=!1}){const V={mode:i,prefixIdentifiers:a,sourceMap:c,filename:d,scopeId:f,optimizeImports:y,runtimeGlobalName:s,runtimeModuleName:w,ssrRuntimeModuleName:C,ssr:L,isTS:k,inSSR:R,source:e.loc.source,code:"",column:1,line:1,offset:0,indentLevel:0,pure:!1,map:void 0,helper(J){return`_${Fu[J]}`},push(J,ue){V.code+=J},indent(){H(++V.indentLevel)},deindent(J=!1){J?--V.indentLevel:H(--V.indentLevel)},newline(){H(V.indentLevel)}};function H(J){V.push(`
`+"  ".repeat(J))}return V}function O6(e,i={}){const a=D6(e,i);i.onContextCreated&&i.onContextCreated(a);const{mode:c,push:d,prefixIdentifiers:f,indent:y,deindent:s,newline:w,scopeId:C,ssr:L}=a,k=e.helpers.length>0,R=!f&&c!=="module";F6(e,a);const H=L?"ssrRender":"render",ue=(L?["_ctx","_push","_parent","_attrs"]:["_ctx","_cache"]).join(", ");if(d(`function ${H}(${ue}) {`),y(),R&&(d("with (_ctx) {"),y(),k&&(d(`const { ${e.helpers.map(IM).join(", ")} } = _Vue`),d(`
`),w())),e.components.length&&(fv(e.components,"component",a),(e.directives.length||e.temps>0)&&w()),e.directives.length&&(fv(e.directives,"directive",a),e.temps>0&&w()),e.filters&&e.filters.length&&(w(),fv(e.filters,"filter",a),w()),e.temps>0){d("let ");for(let j=0;j<e.temps;j++)d(`${j>0?", ":""}_temp${j}`)}return(e.components.length||e.directives.length||e.temps)&&(d(`
`),w()),L||d("return "),e.codegenNode?br(e.codegenNode,a):d("null"),R&&(s(),d("}")),s(),d("}"),{ast:e,code:a.code,preamble:"",map:a.map?a.map.toJSON():void 0}}function F6(e,i){const{ssr:a,prefixIdentifiers:c,push:d,newline:f,runtimeModuleName:y,runtimeGlobalName:s,ssrRuntimeModuleName:w}=i,C=s;if(e.helpers.length>0&&(d(`const _Vue = ${C}
`),e.hoists.length)){const L=[Zx,Xx,Pf,Kx,pM].filter(k=>e.helpers.includes(k)).map(IM).join(", ");d(`const { ${L} } = _Vue
`)}B6(e.hoists,i),f(),d("return ")}function fv(e,i,{helper:a,push:c,newline:d,isTS:f}){const y=a(i==="filter"?Jx:i==="component"?Yx:Qx);for(let s=0;s<e.length;s++){let w=e[s];const C=w.endsWith("__self");C&&(w=w.slice(0,-6)),c(`const ${pf(w,i)} = ${y}(${JSON.stringify(w)}${C?", true":""})${f?"!":""}`),s<e.length-1&&d()}}function B6(e,i){if(!e.length)return;i.pure=!0;const{push:a,newline:c,helper:d,scopeId:f,mode:y}=i;c();for(let s=0;s<e.length;s++){const w=e[s];w&&(a(`const _hoisted_${s+1} = `),br(w,i),c())}i.pure=!1}function u1(e,i){const a=e.length>3||!1;i.push("["),a&&i.indent(),zf(e,i,a),a&&i.deindent(),i.push("]")}function zf(e,i,a=!1,c=!0){const{push:d,newline:f}=i;for(let y=0;y<e.length;y++){const s=e[y];ar(s)?d(s):Ou(s)?u1(s,i):br(s,i),y<e.length-1&&(a?(c&&d(","),f()):c&&d(", "))}}function br(e,i){if(ar(e)){i.push(e);return}if(Gx(e)){i.push(i.helper(e));return}switch(e.type){case 1:case 9:case 11:br(e.codegenNode,i);break;case 2:N6(e,i);break;case 4:PM(e,i);break;case 5:U6(e,i);break;case 12:br(e.codegenNode,i);break;case 8:kM(e,i);break;case 3:$6(e,i);break;case 13:j6(e,i);break;case 14:q6(e,i);break;case 15:W6(e,i);break;case 17:H6(e,i);break;case 18:Z6(e,i);break;case 19:X6(e,i);break;case 20:K6(e,i);break;case 21:zf(e.body,i,!0,!1);break}}function N6(e,i){i.push(JSON.stringify(e.content),e)}function PM(e,i){const{content:a,isStatic:c}=e;i.push(c?JSON.stringify(a):a,e)}function U6(e,i){const{push:a,helper:c,pure:d}=i;d&&a(l_),a(`${c(r_)}(`),br(e.content,i),a(")")}function kM(e,i){for(let a=0;a<e.children.length;a++){const c=e.children[a];ar(c)?i.push(c):br(c,i)}}function V6(e,i){const{push:a}=i;if(e.type===8)a("["),kM(e,i),a("]");else if(e.isStatic){const c=a1(e.content)?e.content:JSON.stringify(e.content);a(c,e)}else a(`[${e.content}]`,e)}function $6(e,i){const{push:a,helper:c,pure:d}=i;d&&a(l_),a(`${c(Pf)}(${JSON.stringify(e.content)})`,e)}function j6(e,i){const{push:a,helper:c,pure:d}=i,{tag:f,props:y,children:s,patchFlag:w,dynamicProps:C,directives:L,isBlock:k,disableTracking:R,isComponent:V}=e;L&&a(c(e1)+"("),k&&a(`(${c(ic)}(${R?"true":""}), `),d&&a(l_);const H=k?Uu(i.inSSR,V):Nu(i.inSSR,V);a(c(H)+"(",e),zf(G6([f,y,s,w,C]),i),a(")"),k&&a(")"),L&&(a(", "),br(L,i),a(")"))}function G6(e){let i=e.length;for(;i--&&e[i]==null;);return e.slice(0,i+1).map(a=>a||"null")}function q6(e,i){const{push:a,helper:c,pure:d}=i,f=ar(e.callee)?e.callee:c(e.callee);d&&a(l_),a(f+"(",e),zf(e.arguments,i),a(")")}function W6(e,i){const{push:a,indent:c,deindent:d,newline:f}=i,{properties:y}=e;if(!y.length){a("{}",e);return}const s=y.length>1||!1;a(s?"{":"{ "),s&&c();for(let w=0;w<y.length;w++){const{key:C,value:L}=y[w];V6(C,i),a(": "),br(L,i),w<y.length-1&&(a(","),f())}s&&d(),a(s?"}":" }")}function H6(e,i){u1(e.elements,i)}function Z6(e,i){const{push:a,indent:c,deindent:d}=i,{params:f,returns:y,body:s,newline:w,isSlot:C}=e;C&&a(`_${Fu[s1]}(`),a("(",e),Ou(f)?zf(f,i):f&&br(f,i),a(") => "),(w||s)&&(a("{"),c()),y?(w&&a("return "),Ou(y)?u1(y,i):br(y,i)):s&&br(s,i),(w||s)&&(d(),a("}")),C&&(e.isNonScopedSlot&&a(", undefined, true"),a(")"))}function X6(e,i){const{test:a,consequent:c,alternate:d,newline:f}=e,{push:y,indent:s,deindent:w,newline:C}=i;if(a.type===4){const k=!a1(a.content);k&&y("("),PM(a,i),k&&y(")")}else y("("),br(a,i),y(")");f&&s(),i.indentLevel++,f||y(" "),y("? "),br(c,i),i.indentLevel--,f&&C(),f||y(" "),y(": ");const L=d.type===19;L||i.indentLevel++,br(d,i),L||i.indentLevel--,f&&w(!0)}function K6(e,i){const{push:a,helper:c,indent:d,deindent:f,newline:y}=i;a(`_cache[${e.index}] || (`),e.isVNode&&(d(),a(`${c(tg)}(-1),`),y()),a(`_cache[${e.index}] = `),br(e.value,i),e.isVNode&&(a(","),y(),a(`${c(tg)}(1),`),y(),a(`_cache[${e.index}]`),f()),a(")")}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments,typeof,void".split(",").join("\\b|\\b")+"\\b");const Y6=MM(/^(if|else|else-if)$/,(e,i,a)=>Q6(e,i,a,(c,d,f)=>{const y=a.parent.children;let s=y.indexOf(c),w=0;for(;s-->=0;){const C=y[s];C&&C.type===9&&(w+=C.branches.length)}return()=>{if(f)c.codegenNode=NE(d,w,a);else{const C=J6(c.codegenNode);C.alternate=NE(d,w+c.branches.length-1,a)}}}));function Q6(e,i,a,c){if(i.name!=="else"&&(!i.exp||!i.exp.content.trim())){const d=i.exp?i.exp.loc:e.loc;a.onError(Tn(28,i.loc)),i.exp=Ci("true",!1,d)}if(i.name==="if"){const d=BE(e,i),f={type:9,loc:e.loc,branches:[d]};if(a.replaceNode(f),c)return c(f,d,!0)}else{const d=a.parent.children;let f=d.indexOf(e);for(;f-->=-1;){const y=d[f];if(y&&y.type===2&&!y.content.trim().length){a.removeNode(y);continue}if(y&&y.type===9){i.name==="else-if"&&y.branches[y.branches.length-1].condition===void 0&&a.onError(Tn(30,e.loc)),a.removeNode();const s=BE(e,i);y.branches.push(s);const w=c&&c(y,s,!1);a_(s,a),w&&w(),a.currentNode=null}else a.onError(Tn(30,e.loc));break}}}function BE(e,i){const a=e.tagType===3;return{type:10,loc:e.loc,condition:i.name==="else"?void 0:i.exp,children:a&&!ws(e,"for")?e.children:[e],userKey:s_(e,"key"),isTemplateIf:a}}function NE(e,i,a){return e.condition?v0(e.condition,UE(e,i,a),Ln(a.helper(Pf),['""',"true"])):UE(e,i,a)}function UE(e,i,a){const{helper:c}=a,d=Cn("key",Ci(`${i}`,!1,hs,2)),{children:f}=e,y=f[0];if(f.length!==1||y.type!==1)if(f.length===1&&y.type===11){const w=y.codegenNode;return og(w,d,a),w}else{let w=64;return ff(a,c(hf),Es([d]),f,w+"",void 0,void 0,!0,!1,!1,e.loc)}else{const w=y.codegenNode,C=m6(w);return C.type===13&&l1(C,a),og(C,d,a),w}}function J6(e){for(;;)if(e.type===19)if(e.alternate.type===19)e=e.alternate;else return e;else e.type===20&&(e=e.value)}const eV=MM("for",(e,i,a)=>{const{helper:c,removeHelper:d}=a;return tV(e,i,a,f=>{const y=Ln(c(t1),[f.source]),s=rg(e),w=ws(e,"memo"),C=s_(e,"key"),L=C&&(C.type===6?Ci(C.value.content,!0):C.exp),k=C?Cn("key",L):null,R=f.source.type===4&&f.source.constType>0,V=R?64:C?128:256;return f.codegenNode=ff(a,c(hf),void 0,y,V+"",void 0,void 0,!0,!R,!1,e.loc),()=>{let H;const{children:J}=f,ue=J.length!==1||J[0].type!==1,j=sg(e)?e:s&&e.children.length===1&&sg(e.children[0])?e.children[0]:null;if(j?(H=j.codegenNode,s&&k&&og(H,k,a)):ue?H=ff(a,c(hf),k?Es([k]):void 0,e.children,64+"",void 0,void 0,!0,void 0,!1):(H=J[0].codegenNode,s&&k&&og(H,k,a),H.isBlock!==!R&&(H.isBlock?(d(ic),d(Uu(a.inSSR,H.isComponent))):d(Nu(a.inSSR,H.isComponent))),H.isBlock=!R,H.isBlock?(c(ic),c(Uu(a.inSSR,H.isComponent))):c(Nu(a.inSSR,H.isComponent))),w){const q=Bu(w0(f.parseResult,[Ci("_cached")]));q.body=o6([Gs(["const _memo = (",w.exp,")"]),Gs(["if (_cached",...L?[" && _cached.key === ",L]:[],` && ${a.helperString(_M)}(_cached, _memo)) return _cached`]),Gs(["const _item = ",H]),Ci("_item.memo = _memo"),Ci("return _item")]),y.arguments.push(q,Ci("_cache"),Ci(String(a.cached++)))}else y.arguments.push(Bu(w0(f.parseResult),H,!0))}})});function tV(e,i,a,c){if(!i.exp){a.onError(Tn(31,i.loc));return}const d=LM(i.exp);if(!d){a.onError(Tn(32,i.loc));return}const{addIdentifiers:f,removeIdentifiers:y,scopes:s}=a,{source:w,value:C,key:L,index:k}=d,R={type:11,loc:i.loc,source:w,valueAlias:C,keyAlias:L,objectIndexAlias:k,parseResult:d,children:rg(e)?e.children:[e]};a.replaceNode(R),s.vFor++;const V=c&&c(R);return()=>{s.vFor--,V&&V()}}const iV=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,VE=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,nV=/^\(|\)$/g;function LM(e,i){const a=e.loc,c=e.content,d=c.match(iV);if(!d)return;const[,f,y]=d,s={source:xm(a,y.trim(),c.indexOf(y,f.length)),value:void 0,key:void 0,index:void 0};let w=f.trim().replace(nV,"").trim();const C=f.indexOf(w),L=w.match(VE);if(L){w=w.replace(VE,"").trim();const k=L[1].trim();let R;if(k&&(R=c.indexOf(k,C+w.length),s.key=xm(a,k,R)),L[2]){const V=L[2].trim();V&&(s.index=xm(a,V,c.indexOf(V,s.key?R+k.length:C+w.length)))}}return w&&(s.value=xm(a,w,C)),s}function xm(e,i,a){return Ci(i,!1,xM(e,a,i.length))}function w0({value:e,key:i,index:a},c=[]){return rV([e,i,a,...c])}function rV(e){let i=e.length;for(;i--&&!e[i];);return e.slice(0,i+1).map((a,c)=>a||Ci("_".repeat(c+1),!1))}const $E=Ci("undefined",!1),sV=(e,i)=>{if(e.type===1&&(e.tagType===1||e.tagType===3)){const a=ws(e,"slot");if(a)return a.exp,i.scopes.vSlot++,()=>{i.scopes.vSlot--}}},oV=(e,i,a)=>Bu(e,i,!1,!0,i.length?i[0].loc:a);function aV(e,i,a=oV){i.helper(s1);const{children:c,loc:d}=e,f=[],y=[];let s=i.scopes.vSlot>0||i.scopes.vFor>0;const w=ws(e,"slot",!0);if(w){const{arg:J,exp:ue}=w;J&&!as(J)&&(s=!0),f.push(Cn(J||Ci("default",!0),a(ue,c,d)))}let C=!1,L=!1;const k=[],R=new Set;for(let J=0;J<c.length;J++){const ue=c[J];let j;if(!rg(ue)||!(j=ws(ue,"slot",!0))){ue.type!==3&&k.push(ue);continue}if(w){i.onError(Tn(37,j.loc));break}C=!0;const{children:q,loc:se}=ue,{arg:ge=Ci("default",!0),exp:ie,loc:Ie}=j;let ze;as(ge)?ze=ge?ge.content:"default":s=!0;const Ae=a(ie,q,se);let He,Ce,Ge;if(He=ws(ue,"if"))s=!0,y.push(v0(He.exp,bm(ge,Ae),$E));else if(Ce=ws(ue,/^else(-if)?$/,!0)){let De=J,We;for(;De--&&(We=c[De],We.type===3););if(We&&rg(We)&&ws(We,"if")){c.splice(J,1),J--;let et=y[y.length-1];for(;et.alternate.type===19;)et=et.alternate;et.alternate=Ce.exp?v0(Ce.exp,bm(ge,Ae),$E):bm(ge,Ae)}else i.onError(Tn(30,Ce.loc))}else if(Ge=ws(ue,"for")){s=!0;const De=Ge.parseResult||LM(Ge.exp);De?y.push(Ln(i.helper(t1),[De.source,Bu(w0(De),bm(ge,Ae),!0)])):i.onError(Tn(32,Ge.loc))}else{if(ze){if(R.has(ze)){i.onError(Tn(38,Ie));continue}R.add(ze),ze==="default"&&(L=!0)}f.push(Cn(ge,Ae))}}if(!w){const J=(ue,j)=>{const q=a(ue,j,d);return i.compatConfig&&(q.isNonScopedSlot=!0),Cn("default",q)};C?k.length&&k.some(ue=>zM(ue))&&(L?i.onError(Tn(39,k[0].loc)):f.push(J(void 0,k))):f.push(J(void 0,c))}const V=s?2:zm(e.children)?3:1;let H=Es(f.concat(Cn("_",Ci(V+"",!1))),d);return y.length&&(H=Ln(i.helper(gM),[H,Lf(y)])),{slots:H,hasDynamicSlots:s}}function bm(e,i){return Es([Cn("name",e),Cn("fn",i)])}function zm(e){for(let i=0;i<e.length;i++){const a=e[i];switch(a.type){case 1:if(a.tagType===2||zm(a.children))return!0;break;case 9:if(zm(a.branches))return!0;break;case 10:case 11:if(zm(a.children))return!0;break}}return!1}function zM(e){return e.type!==2&&e.type!==12?!0:e.type===2?!!e.content.trim():zM(e.content)}const RM=new WeakMap,lV=(e,i)=>function(){if(e=i.currentNode,!(e.type===1&&(e.tagType===0||e.tagType===1)))return;const{tag:c,props:d}=e,f=e.tagType===1;let y=f?cV(e,i):`"${c}"`;const s=WU(y)&&y.callee===Jm;let w,C,L,k=0,R,V,H,J=s||y===tf||y===Hx||!f&&(c==="svg"||c==="foreignObject");if(d.length>0){const ue=DM(e,i,void 0,f,s);w=ue.props,k=ue.patchFlag,V=ue.dynamicPropNames;const j=ue.directives;H=j&&j.length?Lf(j.map(q=>hV(q,i))):void 0,ue.shouldUseBlock&&(J=!0)}if(e.children.length>0)if(y===Qm&&(J=!0,k|=1024),f&&y!==tf&&y!==Qm){const{slots:j,hasDynamicSlots:q}=aV(e,i);C=j,q&&(k|=1024)}else if(e.children.length===1&&y!==tf){const j=e.children[0],q=j.type,se=q===5||q===8;se&&ss(j,i)===0&&(k|=1),se||q===2?C=j:C=e.children}else C=e.children;k!==0&&(L=String(k),V&&V.length&&(R=dV(V))),e.codegenNode=ff(i,y,w,C,L,R,H,!!J,!1,f,e.loc)};function cV(e,i,a=!1){let{tag:c}=e;const d=T0(c),f=s_(e,"is");if(f)if(d||Ql("COMPILER_IS_ON_ELEMENT",i)){const w=f.type===6?f.value&&Ci(f.value.content,!0):f.exp;if(w)return Ln(i.helper(Jm),[w])}else f.type===6&&f.value.content.startsWith("vue:")&&(c=f.value.content.slice(4));const y=!d&&ws(e,"is");if(y&&y.exp)return Ln(i.helper(Jm),[y.exp]);const s=yM(c)||i.isBuiltInComponent(c);return s?(a||i.helper(s),s):(i.helper(Yx),i.components.add(c),pf(c,"component"))}function DM(e,i,a=e.props,c,d,f=!1){const{tag:y,loc:s,children:w}=e;let C=[];const L=[],k=[],R=w.length>0;let V=!1,H=0,J=!1,ue=!1,j=!1,q=!1,se=!1,ge=!1;const ie=[],Ie=({key:Ae,value:He})=>{if(as(Ae)){const Ce=Ae.content,Ge=lM(Ce);if(Ge&&(!c||d)&&Ce.toLowerCase()!=="onclick"&&Ce!=="onUpdate:modelValue"&&!LE(Ce)&&(q=!0),Ge&&LE(Ce)&&(ge=!0),He.type===20||(He.type===4||He.type===8)&&ss(He,i)>0)return;Ce==="ref"?J=!0:Ce==="class"?ue=!0:Ce==="style"?j=!0:Ce!=="key"&&!ie.includes(Ce)&&ie.push(Ce),c&&(Ce==="class"||Ce==="style")&&!ie.includes(Ce)&&ie.push(Ce)}else se=!0};for(let Ae=0;Ae<a.length;Ae++){const He=a[Ae];if(He.type===6){const{loc:Ce,name:Ge,value:De}=He;let We=!0;if(Ge==="ref"&&(J=!0,i.scopes.vFor>0&&C.push(Cn(Ci("ref_for",!0),Ci("true")))),Ge==="is"&&(T0(y)||De&&De.content.startsWith("vue:")||Ql("COMPILER_IS_ON_ELEMENT",i)))continue;C.push(Cn(Ci(Ge,!0,xM(Ce,0,Ge.length)),Ci(De?De.content:"",We,De?De.loc:Ce)))}else{const{name:Ce,arg:Ge,exp:De,loc:We}=He,et=Ce==="bind",Gt=Ce==="on";if(Ce==="slot"){c||i.onError(Tn(40,We));continue}if(Ce==="once"||Ce==="memo"||Ce==="is"||et&&jl(Ge,"is")&&(T0(y)||Ql("COMPILER_IS_ON_ELEMENT",i))||Gt&&f)continue;if((et&&jl(Ge,"key")||Gt&&R&&jl(Ge,"vue:before-update"))&&(V=!0),et&&jl(Ge,"ref")&&i.scopes.vFor>0&&C.push(Cn(Ci("ref_for",!0),Ci("true"))),!Ge&&(et||Gt)){if(se=!0,De)if(C.length&&(L.push(Es(pv(C),s)),C=[]),et){if(Ql("COMPILER_V_BIND_OBJECT_ORDER",i)){L.unshift(De);continue}L.push(De)}else L.push({type:14,loc:We,callee:i.helper(r1),arguments:[De]});else i.onError(Tn(et?34:35,We));continue}const Vt=i.directiveTransforms[Ce];if(Vt){const{props:fi,needRuntime:Yt}=Vt(He,e,i);!f&&fi.forEach(Ie),C.push(...fi),Yt&&(k.push(He),Gx(Yt)&&RM.set(He,Yt))}else HU(Ce)||(k.push(He),R&&(V=!0))}}let ze;if(L.length?(C.length&&L.push(Es(pv(C),s)),L.length>1?ze=Ln(i.helper(eg),L,s):ze=L[0]):C.length&&(ze=Es(pv(C),s)),se?H|=16:(ue&&!c&&(H|=2),j&&!c&&(H|=4),ie.length&&(H|=8),q&&(H|=32)),!V&&(H===0||H===32)&&(J||ge||k.length>0)&&(H|=512),!i.inSSR&&ze)switch(ze.type){case 15:let Ae=-1,He=-1,Ce=!1;for(let We=0;We<ze.properties.length;We++){const et=ze.properties[We].key;as(et)?et.content==="class"?Ae=We:et.content==="style"&&(He=We):et.isHandlerKey||(Ce=!0)}const Ge=ze.properties[Ae],De=ze.properties[He];Ce?ze=Ln(i.helper(df),[ze]):(Ge&&!as(Ge.value)&&(Ge.value=Ln(i.helper(i1),[Ge.value])),De&&(j||De.value.type===4&&De.value.content.trim()[0]==="["||De.value.type===17)&&(De.value=Ln(i.helper(n1),[De.value])));break;case 14:break;default:ze=Ln(i.helper(df),[Ln(i.helper(kf),[ze])]);break}return{props:ze,directives:k,patchFlag:H,dynamicPropNames:ie,shouldUseBlock:V}}function pv(e){const i=new Map,a=[];for(let c=0;c<e.length;c++){const d=e[c];if(d.key.type===8||!d.key.isStatic){a.push(d);continue}const f=d.key.content,y=i.get(f);y?(f==="style"||f==="class"||lM(f))&&uV(y,d):(i.set(f,d),a.push(d))}return a}function uV(e,i){e.value.type===17?e.value.elements.push(i.value):e.value=Lf([e.value,i.value],e.loc)}function hV(e,i){const a=[],c=RM.get(e);c?a.push(i.helperString(c)):(i.helper(Qx),i.directives.add(e.name),a.push(pf(e.name,"directive")));const{loc:d}=e;if(e.exp&&a.push(e.exp),e.arg&&(e.exp||a.push("void 0"),a.push(e.arg)),Object.keys(e.modifiers).length){e.arg||(e.exp||a.push("void 0"),a.push("void 0"));const f=Ci("true",!1,d);a.push(Es(e.modifiers.map(y=>Cn(y,f)),d))}return Lf(a,e.loc)}function dV(e){let i="[";for(let a=0,c=e.length;a<c;a++)i+=JSON.stringify(e[a]),a<c-1&&(i+=", ");return i+"]"}function T0(e){return e==="component"||e==="Component"}const fV=e=>{const i=Object.create(null);return a=>i[a]||(i[a]=e(a))},pV=/-(\w)/g,jE=fV(e=>e.replace(pV,(i,a)=>a?a.toUpperCase():"")),mV=(e,i)=>{if(sg(e)){const{children:a,loc:c}=e,{slotName:d,slotProps:f}=gV(e,i),y=[i.prefixIdentifiers?"_ctx.$slots":"$slots",d,"{}","undefined","true"];let s=2;f&&(y[2]=f,s=3),a.length&&(y[3]=Bu([],a,!1,!1,c),s=4),i.scopeId&&!i.slotted&&(s=5),y.splice(s),e.codegenNode=Ln(i.helper(mM),y,c)}};function gV(e,i){let a='"default"',c;const d=[];for(let f=0;f<e.props.length;f++){const y=e.props[f];y.type===6?y.value&&(y.name==="name"?a=JSON.stringify(y.value.content):(y.name=jE(y.name),d.push(y))):y.name==="bind"&&jl(y.arg,"name")?y.exp&&(a=y.exp):(y.name==="bind"&&y.arg&&as(y.arg)&&(y.arg.content=jE(y.arg.content)),d.push(y))}if(d.length>0){const{props:f,directives:y}=DM(e,i,d,!1,!1);c=f,y.length&&i.onError(Tn(36,y[0].loc))}return{slotName:a,slotProps:c}}const _V=/^\s*([\w$_]+|(async\s*)?\([^)]*?\))\s*=>|^\s*(async\s+)?function(?:\s+[\w$]+)?\s*\(/,OM=(e,i,a,c)=>{const{loc:d,modifiers:f,arg:y}=e;!e.exp&&!f.length&&a.onError(Tn(35,d));let s;if(y.type===4)if(y.isStatic){let k=y.content;k.startsWith("vue:")&&(k=`vnode-${k.slice(4)}`),s=Ci(YU(qx(k)),!0,y.loc)}else s=Gs([`${a.helperString(y0)}(`,y,")"]);else s=y,s.children.unshift(`${a.helperString(y0)}(`),s.children.push(")");let w=e.exp;w&&!w.content.trim()&&(w=void 0);let C=a.cacheHandlers&&!w&&!a.inVOnce;if(w){const k=vM(w.content),R=!(k||_V.test(w.content)),V=w.content.includes(";");(R||C&&k)&&(w=Gs([`${R?"$event":"(...args)"} => ${V?"{":"("}`,w,V?"}":")"]))}let L={props:[Cn(s,w||Ci("() => {}",!1,d))]};return c&&(L=c(L)),C&&(L.props[0].value=a.cache(L.props[0].value)),L.props.forEach(k=>k.key.isHandlerKey=!0),L},yV=(e,i,a)=>{const{exp:c,modifiers:d,loc:f}=e,y=e.arg;return y.type!==4?(y.children.unshift("("),y.children.push(') || ""')):y.isStatic||(y.content=`${y.content} || ""`),d.includes("camel")&&(y.type===4?y.isStatic?y.content=qx(y.content):y.content=`${a.helperString(_0)}(${y.content})`:(y.children.unshift(`${a.helperString(_0)}(`),y.children.push(")"))),a.inSSR||(d.includes("prop")&&GE(y,"."),d.includes("attr")&&GE(y,"^")),!c||c.type===4&&!c.content.trim()?(a.onError(Tn(34,f)),{props:[Cn(y,Ci("",!0,f))]}):{props:[Cn(y,c)]}},GE=(e,i)=>{e.type===4?e.isStatic?e.content=i+e.content:e.content=`\`${i}\${${e.content}}\``:(e.children.unshift(`'${i}' + (`),e.children.push(")"))},vV=(e,i)=>{if(e.type===0||e.type===1||e.type===11||e.type===10)return()=>{const a=e.children;let c,d=!1;for(let f=0;f<a.length;f++){const y=a[f];if(dv(y)){d=!0;for(let s=f+1;s<a.length;s++){const w=a[s];if(dv(w))c||(c=a[f]=Gs([y],y.loc)),c.children.push(" + ",w),a.splice(s,1),s--;else{c=void 0;break}}}}if(!(!d||a.length===1&&(e.type===0||e.type===1&&e.tagType===0&&!e.props.find(f=>f.type===7&&!i.directiveTransforms[f.name])&&e.tag!=="template")))for(let f=0;f<a.length;f++){const y=a[f];if(dv(y)||y.type===8){const s=[];(y.type!==2||y.content!==" ")&&s.push(y),!i.ssr&&ss(y,i)===0&&s.push(1+""),a[f]={type:12,content:y,loc:y.loc,codegenNode:Ln(i.helper(Kx),s)}}}}},qE=new WeakSet,xV=(e,i)=>{if(e.type===1&&ws(e,"once",!0))return qE.has(e)||i.inVOnce?void 0:(qE.add(e),i.inVOnce=!0,i.helper(tg),()=>{i.inVOnce=!1;const a=i.currentNode;a.codegenNode&&(a.codegenNode=i.cache(a.codegenNode,!0))})},FM=(e,i,a)=>{const{exp:c,arg:d}=e;if(!c)return a.onError(Tn(41,e.loc)),mv();const f=c.loc.source,y=c.type===4?c.content:f;a.bindingMetadata[f];const s=!1;if(!y.trim()||!vM(y)&&!s)return a.onError(Tn(42,c.loc)),mv();const w=d||Ci("modelValue",!0),C=d?as(d)?`onUpdate:${d.content}`:Gs(['"onUpdate:" + ',d]):"onUpdate:modelValue";let L;const k=a.isTS?"($event: any)":"$event";L=Gs([`${k} => ((`,c,") = $event)"]);const R=[Cn(w,e.exp),Cn(C,L)];if(e.modifiers.length&&i.tagType===1){const V=e.modifiers.map(J=>(a1(J)?J:JSON.stringify(J))+": true").join(", "),H=d?as(d)?`${d.content}Modifiers`:Gs([d,' + "Modifiers"']):"modelModifiers";R.push(Cn(H,Ci(`{ ${V} }`,!1,e.loc,2)))}return mv(R)};function mv(e=[]){return{props:e}}const bV=/[\w).+\-_$\]]/,wV=(e,i)=>{!Ql("COMPILER_FILTER",i)||(e.type===5&&ag(e.content,i),e.type===1&&e.props.forEach(a=>{a.type===7&&a.name!=="for"&&a.exp&&ag(a.exp,i)}))};function ag(e,i){if(e.type===4)WE(e,i);else for(let a=0;a<e.children.length;a++){const c=e.children[a];typeof c=="object"&&(c.type===4?WE(c,i):c.type===8?ag(e,i):c.type===5&&ag(c.content,i))}}function WE(e,i){const a=e.content;let c=!1,d=!1,f=!1,y=!1,s=0,w=0,C=0,L=0,k,R,V,H,J=[];for(V=0;V<a.length;V++)if(R=k,k=a.charCodeAt(V),c)k===39&&R!==92&&(c=!1);else if(d)k===34&&R!==92&&(d=!1);else if(f)k===96&&R!==92&&(f=!1);else if(y)k===47&&R!==92&&(y=!1);else if(k===124&&a.charCodeAt(V+1)!==124&&a.charCodeAt(V-1)!==124&&!s&&!w&&!C)H===void 0?(L=V+1,H=a.slice(0,V).trim()):ue();else{switch(k){case 34:d=!0;break;case 39:c=!0;break;case 96:f=!0;break;case 40:C++;break;case 41:C--;break;case 91:w++;break;case 93:w--;break;case 123:s++;break;case 125:s--;break}if(k===47){let j=V-1,q;for(;j>=0&&(q=a.charAt(j),q===" ");j--);(!q||!bV.test(q))&&(y=!0)}}H===void 0?H=a.slice(0,V).trim():L!==0&&ue();function ue(){J.push(a.slice(L,V).trim()),L=V+1}if(J.length){for(V=0;V<J.length;V++)H=TV(H,J[V],i);e.content=H}}function TV(e,i,a){a.helper(Jx);const c=i.indexOf("(");if(c<0)return a.filters.add(i),`${pf(i,"filter")}(${e})`;{const d=i.slice(0,c),f=i.slice(c+1);return a.filters.add(d),`${pf(d,"filter")}(${e}${f!==")"?","+f:f}`}}const HE=new WeakSet,EV=(e,i)=>{if(e.type===1){const a=ws(e,"memo");return!a||HE.has(e)?void 0:(HE.add(e),()=>{const c=e.codegenNode||i.currentNode.codegenNode;c&&c.type===13&&(e.tagType!==1&&l1(c,i),e.codegenNode=Ln(i.helper(o1),[a.exp,Bu(void 0,c),"_cache",String(i.cached++)]))})}};function SV(e){return[[xV,Y6,EV,eV,wV,mV,lV,sV,vV],{on:OM,bind:yV,model:FM}]}function AV(e,i={}){const a=i.onError||Wx,c=i.mode==="module";i.prefixIdentifiers===!0?a(Tn(46)):c&&a(Tn(47));const d=!1;i.cacheHandlers&&a(Tn(48)),i.scopeId&&!c&&a(Tn(49));const f=ar(e)?y6(e,i):e,[y,s]=SV();return L6(f,xu({},i,{prefixIdentifiers:d,nodeTransforms:[...y,...i.nodeTransforms||[]],directiveTransforms:xu({},s,i.directiveTransforms||{})})),O6(f,xu({},i,{prefixIdentifiers:d}))}const CV=()=>({props:[]});function Wa(e,i){const a=Object.create(null),c=e.split(",");for(let d=0;d<c.length;d++)a[c[d]]=!0;return i?d=>!!a[d.toLowerCase()]:d=>!!a[d]}const MV=/;(?![^(]*\))/g,IV=/:(.+)/;function PV(e){const i={};return e.split(MV).forEach(a=>{if(a){const c=a.split(IV);c.length>1&&(i[c[0].trim()]=c[1].trim())}}),i}const kV="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",LV="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",zV="area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr",RV=Wa(kV),DV=Wa(LV),OV=Wa(zV),ZE=Object.assign,FV=e=>{const i=Object.create(null);return a=>i[a]||(i[a]=e(a))},BV=FV(e=>e.charAt(0).toUpperCase()+e.slice(1)),BM=Symbol(""),NM=Symbol(""),UM=Symbol(""),VM=Symbol(""),E0=Symbol(""),$M=Symbol(""),jM=Symbol(""),GM=Symbol(""),qM=Symbol(""),WM=Symbol("");n6({[BM]:"vModelRadio",[NM]:"vModelCheckbox",[UM]:"vModelText",[VM]:"vModelSelect",[E0]:"vModelDynamic",[$M]:"withModifiers",[jM]:"withKeys",[GM]:"vShow",[qM]:"Transition",[WM]:"TransitionGroup"});let au;function NV(e,i=!1){return au||(au=document.createElement("div")),i?(au.innerHTML=`<div foo="${e.replace(/"/g,"&quot;")}">`,au.children[0].getAttribute("foo")):(au.innerHTML=e,au.textContent)}const UV=Wa("style,iframe,script,noscript",!0),VV={isVoidTag:OV,isNativeTag:e=>RV(e)||DV(e),isPreTag:e=>e==="pre",decodeEntities:NV,isBuiltInComponent:e=>{if(fu(e,"Transition"))return qM;if(fu(e,"TransitionGroup"))return WM},getNamespace(e,i){let a=i?i.ns:0;if(i&&a===2)if(i.tag==="annotation-xml"){if(e==="svg")return 1;i.props.some(c=>c.type===6&&c.name==="encoding"&&c.value!=null&&(c.value.content==="text/html"||c.value.content==="application/xhtml+xml"))&&(a=0)}else/^m(?:[ions]|text)$/.test(i.tag)&&e!=="mglyph"&&e!=="malignmark"&&(a=0);else i&&a===1&&(i.tag==="foreignObject"||i.tag==="desc"||i.tag==="title")&&(a=0);if(a===0){if(e==="svg")return 1;if(e==="math")return 2}return a},getTextMode({tag:e,ns:i}){if(i===0){if(e==="textarea"||e==="title")return 1;if(UV(e))return 2}return 0}},$V=e=>{e.type===1&&e.props.forEach((i,a)=>{i.type===6&&i.name==="style"&&i.value&&(e.props[a]={type:7,name:"bind",arg:Ci("style",!0,i.loc),exp:jV(i.value.content,i.loc),modifiers:[],loc:i.loc})})},jV=(e,i)=>{const a=PV(e);return Ci(JSON.stringify(a),!1,i,3)};function Ho(e,i){return Tn(e,i)}const GV=(e,i,a)=>{const{exp:c,loc:d}=e;return c||a.onError(Ho(50,d)),i.children.length&&(a.onError(Ho(51,d)),i.children.length=0),{props:[Cn(Ci("innerHTML",!0,d),c||Ci("",!0))]}},qV=(e,i,a)=>{const{exp:c,loc:d}=e;return c||a.onError(Ho(52,d)),i.children.length&&(a.onError(Ho(53,d)),i.children.length=0),{props:[Cn(Ci("textContent",!0),c?ss(c,a)>0?c:Ln(a.helperString(r_),[c],d):Ci("",!0))]}},WV=(e,i,a)=>{const c=FM(e,i,a);if(!c.props.length||i.tagType===1)return c;e.arg&&a.onError(Ho(55,e.arg.loc));const{tag:d}=i,f=a.isCustomElement(d);if(d==="input"||d==="textarea"||d==="select"||f){let y=UM,s=!1;if(d==="input"||f){const w=s_(i,"type");if(w){if(w.type===7)y=E0;else if(w.value)switch(w.value.content){case"radio":y=BM;break;case"checkbox":y=NM;break;case"file":s=!0,a.onError(Ho(56,e.loc));break}}else d6(i)&&(y=E0)}else d==="select"&&(y=VM);s||(c.needRuntime=a.helper(y))}else a.onError(Ho(54,e.loc));return c.props=c.props.filter(y=>!(y.key.type===4&&y.key.content==="modelValue")),c},HV=Wa("passive,once,capture"),ZV=Wa("stop,prevent,self,ctrl,shift,alt,meta,exact,middle"),XV=Wa("left,right"),HM=Wa("onkeyup,onkeydown,onkeypress",!0),KV=(e,i,a,c)=>{const d=[],f=[],y=[];for(let s=0;s<i.length;s++){const w=i[s];w==="native"&&mf("COMPILER_V_ON_NATIVE",a)||HV(w)?y.push(w):XV(w)?as(e)?HM(e.content)?d.push(w):f.push(w):(d.push(w),f.push(w)):ZV(w)?f.push(w):d.push(w)}return{keyModifiers:d,nonKeyModifiers:f,eventOptionModifiers:y}},XE=(e,i)=>as(e)&&e.content.toLowerCase()==="onclick"?Ci(i,!0):e.type!==4?Gs(["(",e,`) === "onClick" ? "${i}" : (`,e,")"]):e,YV=(e,i,a)=>OM(e,i,a,c=>{const{modifiers:d}=e;if(!d.length)return c;let{key:f,value:y}=c.props[0];const{keyModifiers:s,nonKeyModifiers:w,eventOptionModifiers:C}=KV(f,d,a,e.loc);if(w.includes("right")&&(f=XE(f,"onContextmenu")),w.includes("middle")&&(f=XE(f,"onMouseup")),w.length&&(y=Ln(a.helper($M),[y,JSON.stringify(w)])),s.length&&(!as(f)||HM(f.content))&&(y=Ln(a.helper(jM),[y,JSON.stringify(s)])),C.length){const L=C.map(BV).join("");f=as(f)?Ci(`${f.content}${L}`,!0):Gs(["(",f,`) + "${L}"`])}return{props:[Cn(f,y)]}}),QV=(e,i,a)=>{const{exp:c,loc:d}=e;return c||a.onError(Ho(58,d)),{props:[],needRuntime:a.helper(GM)}},JV=(e,i)=>{e.type===1&&e.tagType===0&&(e.tag==="script"||e.tag==="style")&&(i.onError(Ho(60,e.loc)),i.removeNode())},e$=[$V],t$={cloak:CV,html:GV,text:qV,model:WV,on:YV,show:QV};function i$(e,i={}){return AV(e,ZE({},VV,i,{nodeTransforms:[JV,...e$,...i.nodeTransforms||[]],directiveTransforms:ZE({},t$,i.directiveTransforms||{}),transformHoist:null}))}const KE=()=>{},n$=Object.assign,r$=e=>typeof e=="string",YE=Object.create(null);function s$(e,i){if(!r$(e))if(e.nodeType)e=e.innerHTML;else return KE;const a=e,c=YE[a];if(c)return c;if(e[0]==="#"){const y=document.querySelector(e);e=y?y.innerHTML:""}const{code:d}=i$(e,n$({hoistStatic:!0,onError:void 0,onWarn:KE},i)),f=new Function("Vue",d)(DB);return f._rc=!0,YE[a]=f}pC(s$);function QE(e){return e.replace(/[,.)-?!]\s*$/,"")}ac({data(){return{language:"german",requestId:"",loading:!1,context:"",question:"",answer:"",examples:{english:{food:{context:"Xylitol is also known as birch sugar. Xylitol tastes just as sweet as sugar, and you can replace it one-to-one in recipes. But why should you do that? Birch sugar has some positive advantages over table sugar. On the one hand, it is tooth-friendly and even has a non-cariogenic effect, i.e. it does not cause caries. Secondly, xylitol is particularly popular because of its low glycemic index. It has a glycemic index of 7 to 11, while that of regular sugar is 65 to 100. So if you want to consciously avoid the negative properties of sugar, but not its sweetness, you should give xylitol a try. However, in moderation, because in high doses it can have a laxative effect. Birch sugar should also be kept away from dogs, as it can even be fatal for the four-legged friends.",question:"What is the advantage of birch sugar?"},electronics:{context:"The iPhone SE (2020) scores very well in the test and allows Apple fans to dive into the iPhone world for less money. The performance is excellent and the battery lasts for a really long time. The camera also does a decent job, but has to admit defeat to the top models. iPhone SE packs Apple's powerful A13 Bionic chip into Apple's most popular size at a most affordable price. It\u2019s just what you\u2019ve been waiting for. It has a height of 138.4 mm, a width of 67.3 mm and a depth of 7.3 mm. It starts at $399.",question:"What chip is in the iPhone SE?"},techSupport:{context:"The Apache Lucene project develops open-source search software. The project releases a core search library, named Lucene core, as well as the Solr search server. Solr is a high performance search server built using Lucene Core. Solr is highly scalable, providing fully fault tolerant distributed indexing, search and analytics. It exposes Lucene's features through easy to use JSON/HTTP interfaces or native clients for Java and other languages.",question:"How can I connect to the search server?"}},german:{food:{context:"Xylitol ist auch als Birkenzucker bekannt. Xylit schmeckt genauso s\xFC\xDF wie Zucker, und Sie k\xF6nnen es in Rezepten eins zu eins ersetzen. Aber warum sollten Sie das tun? Birkenzucker hat einige positive Vorteile gegen\xFCber Haushaltszucker. Zum einen ist er zahnfreundlich und wirkt sogar nicht kariogen, d.h. er verursacht keine Karies. Zum anderen ist Xylit besonders beliebt wegen seines niedrigen glyk\xE4mischen Index. Er hat einen glyk\xE4mischen Index von 7 bis 11, w\xE4hrend der von normalem Zucker bei 65 bis 100 liegt. Wer also bewusst auf die negativen Eigenschaften des Zuckers, nicht aber auf seine S\xFC\xDFe verzichten m\xF6chte, sollte Xylit ausprobieren. Allerdings in Ma\xDFen, denn in hohen Dosen kann es abf\xFChrend wirken. Auch von Hunden sollte Birkenzucker ferngehalten werden, da er f\xFCr die Vierbeiner sogar t\xF6dlich sein kann.",question:"Was ist der Vorteil von Birkenzucker?"},electronics:{context:"Das iPhone SE (2020) schneidet im Test sehr gut ab und erm\xF6glicht Apple-Fans den Einstieg in die iPhone-Welt f\xFCr weniger Geld. Die Leistung ist hervorragend und der Akku h\xE4lt wirklich lange durch. Auch die Kamera macht einen ordentlichen Job, muss sich aber den Top-Modellen geschlagen geben. Das iPhone SE packt Apples leistungsstarken A13-Bionic-Chip in die beliebteste Apple-Gr\xF6\xDFe zu einem \xE4u\xDFerst g\xFCnstigen Preis. Es ist genau das, worauf Sie gewartet haben. Es hat eine H\xF6he von 138,4 mm, eine Breite von 67,3 mm und eine Tiefe von 7,3 mm. Es beginnt bei 399 $.",question:"Welcher Prozessor ist im iPhone SE?"},techSupport:{context:"Das Apache Lucene-Projekt entwickelt Open-Source-Such-Software. Das Projekt ver\xF6ffentlicht eine Kern-Suchbibliothek, genannt Lucene Core, sowie den Solr-Suchserver. Solr ist ein hochleistungsf\xE4higer Suchserver, der auf Lucene Core aufbaut. Solr ist hoch skalierbar und bietet vollst\xE4ndig fehlertolerante verteilte Indizierung, Suche und Analyse. Er stellt die Funktionen von Lucene \xFCber einfach zu verwendende JSON/HTTP-Schnittstellen oder native Clients f\xFCr Java und andere Sprachen zur Verf\xFCgung.",question:"Wie kann ich den Suchserver ansprechen?"}}},start:null,end:null,score:null,contextWordCount:0,questionWordCount:0,answerWordCount:0,feedback:null,responseTime:null,userInfo:{ip:"",country:"",region:"",city:"",userAgent:navigator.userAgent,screenInfo:{devicePixelRatio:window.devicePixelRatio,viewportHeightCssPixel:window.screen.height,viewportWidthCssPixel:window.screen.width}}}},methods:{async getAnswer(){this.loading=!0,this.language==="english"?await er.post("https://website-qa-dot-try-apis-175016.ey.r.appspot.com/answer-question?question="+this.question+"&context="+this.context).then(async e=>{this.loading=!1,this.answer=QE(e.data.answer),this.score=e.data.score,this.start=e.data.start,this.end=e.data.end,await er.post("https://dida-bert-qa-data-service-83l32.ondigitalocean.app/",{context:this.context,question:this.question,answer:this.answer,start:this.start,end:this.end,score:this.score,contextWordCount:this.contextWordCount,questionWordCount:this.questionWordCount,answerWordCount:this.answerWordCount,feedback:null,responseTime:this.responseTime,userInfo:{ip:this.userInfo.ip,country:this.userInfo.country,region:this.userInfo.region,city:this.userInfo.city,userAgent:this.userInfo.userAgent,screenInfo:{devicePixelRatio:this.userInfo.screenInfo.devicePixelRatio,viewportHeightCssPixel:this.userInfo.screenInfo.viewportHeightCssPixel,viewportWidthCssPixel:this.userInfo.screenInfo.viewportWidthCssPixel}}}).then(i=>this.requestId=i.data)}).catch(()=>{this.loading=!1}).finally(this.feedback=null):this.language==="german"&&await er({method:"post",url:"https://api-inference.huggingface.co/models/deepset/gelectra-large-germanquad",data:{inputs:{question:this.question,context:this.context}},headers:{Authorization:"Bearer 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"}}).then(async e=>{this.loading=!1,this.answer=QE(e.data.answer),this.score=e.data.score,this.start=e.data.start,this.end=e.data.end,await er.post("https://dida-bert-qa-data-service-83l32.ondigitalocean.app/",{language:this.language,context:this.context,question:this.question,answer:this.answer,start:this.start,end:this.end,score:this.score,contextWordCount:this.contextWordCount,questionWordCount:this.questionWordCount,answerWordCount:this.answerWordCount,feedback:null,responseTime:this.responseTime,userInfo:{ip:this.userInfo.ip,country:this.userInfo.country,region:this.userInfo.region,city:this.userInfo.city,userAgent:this.userInfo.userAgent,screenInfo:{devicePixelRatio:this.userInfo.screenInfo.devicePixelRatio,viewportHeightCssPixel:this.userInfo.screenInfo.viewportHeightCssPixel,viewportWidthCssPixel:this.userInfo.screenInfo.viewportWidthCssPixel}}}).then(i=>this.requestId=i.data)}).catch(()=>{this.loading=!1}).finally(this.feedback=null)},async giveFeedback(e){this.feedback===null&&await er.put("https://dida-bert-qa-data-service-83l32.ondigitalocean.app/",{requestId:this.requestId,feedback:e}).then(i=>{this.feedback=e}).catch(i=>{})},insertExample(e){this.context=e.context,this.question=e.question,this.answer=""},clearInputs(){this.context="",this.question="",this.answer=""},highlight(){return this.context?("..."+this.context.substring(this.start-20,this.end+20)+"...").replace(this.context.substring(this.start,this.end),i=>'<span class="text-range__highlight">'+i+"</span>"):this.context}},computed:{contextValid(){return this.contextWordCount<=256&&this.context!==""},isValid(){return this.context!==""&&this.contextWordCount<=256&&this.question!==""}},watch:{newsletterEmailAddress(e){e?this.newsletterStatus.emailAddressValid=!0:(this.newsletterStatus.emailAddressValid=!0,this.newsletterStatus.alreadySignedUp=!1)},context(e){$l.count(e,i=>this.contextWordCount=i.words)},question(e){$l.count(e,i=>this.questionWordCount=i.words)},answer(e){$l.count(e,i=>this.answerWordCount=i.words)}}}).mount("#qa-demo");const o$="modulepreload",a$=function(e){return"/build/"+e},JE={},l$=function(i,a,c){return!a||a.length===0?i():Promise.all(a.map(d=>{if(d=a$(d),d in JE)return;JE[d]=!0;const f=d.endsWith(".css"),y=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${y}`))return;const s=document.createElement("link");if(s.rel=f?"stylesheet":o$,f||(s.as="script",s.crossOrigin=""),s.href=d,document.head.appendChild(s),f)return new Promise((w,C)=>{s.addEventListener("load",w),s.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${d}`)))})})).then(()=>i())};const c$={},u$={class:"flex flex-col gap-4"};function h$(e,i){return Ft(),Nt("ul",u$,[(Ft(),Nt(dn,null,Wo(5,(a,c)=>Fe("li",{key:c,class:"skeleton w-full rounded border h-2"})),64))])}const d$=qa(c$,[["render",h$],["__scopeId","data-v-44b21115"]]),f$={name:"Knowledge Base",components:{Menu:FA(()=>l$(()=>import("./Menu.08fd8e55.js"),[])),LoadingSkeleton:d$},data(){return{lang:"english",slug:"overview"}},created(){this.lang=this.$route.path.split("/").includes("de")?"german":"english",this.$watch(()=>this.$route.path,(e,i)=>{if(e){const a=e.split("/");this.lang=a.includes("de")?"german":"english",this.slug=a[a.length-1]}})}},p$={class:"grid lg:grid-cols-[1fr_minmax(30vw,50vw)_1fr] mt-4 lg:mt-24"};function m$(e,i,a,c,d,f){const y=Xd("Menu"),s=Xd("LoadingSkeleton"),w=Xd("router-view");return Ft(),Nt("div",p$,[(Ft(),Xg(LA,null,{fallback:Mu(()=>[Hi(s)]),default:Mu(()=>[Hi(y,{lang:d.lang,slug:d.slug},null,8,["lang","slug"])]),_:1})),Hi(w)])}const g$=qa(f$,[["render",m$]]);const _$={name:"Conference Registration Form",data(){return{name:"",email:"",company:"",errorMessage:null,successMessage:null,lang:"en",csrfToken:""}},created(){this.fetchCsrfToken()},mounted(){this.lang=window.location.pathname.split("/").includes("de")?"de":"en"},methods:{fetchCsrfToken(){er.get("/get-csrf-token").then(e=>{this.csrfToken=e.data.csrfToken}).catch(e=>console.error("Error:",e))},async register(){if(!this.formIsFilled){this.errorMessage=this.lang==="de"?"Bitte f\xFCllen Sie alle Felder aus.":"Please fill in all the fields.",setTimeout(()=>this.errorMessage=null,3e3);return}const e="dida_conference_31_05_2024",i={name:this.name.replace(/\s+/g," ").trim(),email:this.email.replace(/\s+/g," ").trim().toLowerCase(),company:this.company.replace(/\s+/g," ").trim()};if(this.formIsFilled)try{await er.post(`/forms/${e}/create-entry`,i,{headers:{"X-CSRF-TOKEN":this.csrfToken,"Content-Type":"application/json"}}).then(a=>a.data),this.successMessage=this.lang==="de"?"Sie wurden erfolgreich f\xFCr die Konferenz registriert!":"You have been successfully registered for the conference!",this.resetData()}catch(a){if(a.response&&a.response.status===409)switch(a.response.status){case 409:this.errorMessage=this.lang==="de"?`Eine Person mit der E-Mail ${this.email} wurde bereits registriert.`:`A person with the email ${this.email} has already been registered.`,setTimeout(()=>{this.errorMessage=null},3e3);break;default:this.errorMessage=this.lang==="de"?"Die Registrierung ist aufgrund eines Serverfehlers fehlgeschlagen.":"Registration failed due to server error.",setTimeout(()=>{this.errorMessage=null},3e3);break}}},resetData(){this.name="",this.email="",this.company="",setTimeout(()=>{this.errorMessage=null,this.successMessage=null},6e3)}},computed:{formIsFilled(){return this.name&&this.email&&this.company}}},y$={class:"flex flex-col gap-4 relative"},v$=["placeholder"],x$=["placeholder"],b$=["placeholder"];function w$(e,i,a,c,d,f){return Ft(),Nt("form",y$,[Fe("div",null,[Vs(Fe("input",{class:"w-full",type:"text",name:"name",placeholder:d.lang==="de"?"Name":"Full Name","onUpdate:modelValue":i[0]||(i[0]=y=>d.name=y)},null,8,v$),[[xo,d.name,void 0,{trim:!0}]])]),Fe("div",null,[Vs(Fe("input",{class:"w-full",type:"email",name:"email",placeholder:d.lang==="de"?"E-Mail":"Email","onUpdate:modelValue":i[1]||(i[1]=y=>d.email=y)},null,8,x$),[[xo,d.email,void 0,{trim:!0}]])]),Fe("div",null,[Vs(Fe("input",{class:"w-full",type:"text",name:"company",placeholder:d.lang==="de"?"Unternehmen":"Company","onUpdate:modelValue":i[2]||(i[2]=y=>d.company=y)},null,8,b$),[[xo,d.company,void 0,{trim:!0}]])]),Fe("button",{class:$i(["p-4 text-lg font-medium text-white bg-[#47D1B0]",{"cursor-not-allowed":!this.formIsFilled}]),onClick:i[3]||(i[3]=Rx(y=>f.register(),["prevent"]))},Pi(d.lang==="de"?"Anmelden":"Register"),3),Hi(e_,null,{default:Mu(()=>{var y;return[Vs(Fe("div",{class:"absolute -bottom-8 text-white translate-y-1/2 text-xs sm:text-base"},Pi((y=d.errorMessage)!=null?y:d.successMessage),513),[[t_,d.errorMessage||d.successMessage]])]}),_:1})])}const T$=qa(_$,[["render",w$],["__scopeId","data-v-528c0060"]]);(()=>{var e={792:(c,d,f)=>{f.d(d,{Z:()=>w});var y=f(609),s=f.n(y)()(function(C){return C[1]});s.push([c.id,':host{--divider-width: 1px;--divider-color: #fff;--divider-shadow: none;--default-handle-width: 50px;--default-handle-color: #fff;--default-handle-opacity: 1;--default-handle-shadow: none;--handle-position-start: 50%;position:relative;display:inline-block;overflow:hidden;line-height:0;direction:ltr}@media screen and (-webkit-min-device-pixel-ratio: 0)and (min-resolution: 0.001dpcm){:host{outline-offset:1px}}::slotted(*){-webkit-user-drag:none;-khtml-user-drag:none;-moz-user-drag:none;-o-user-drag:none;user-drag:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.first{position:absolute;left:0;top:0;right:0;line-height:normal;font-size:100%;max-height:100%;height:100%;width:100%;--exposure: 50%;--keyboard-transition-time: 0ms;--default-transition-time: 0ms;--transition-time: var(--default-transition-time)}.first .first-overlay-container{position:relative;clip-path:inset(0 var(--exposure) 0 0);transition:clip-path var(--transition-time);height:100%}.first .first-overlay{overflow:hidden;height:100%}.first.focused{will-change:clip-path}.first.focused .first-overlay-container{will-change:clip-path}@media not all and (min-resolution: 0.001dpcm){@supports(-webkit-appearance: none){.first{--keyboard-transition-time: 50ms;--default-transition-time: 10ms;transform:translateX(calc(var(--exposure) * -1));transition:transform var(--transition-time);right:auto}.first .first-overlay-container{transform:translateX(var(--exposure));transition:transform var(--transition-time);clip-path:none}.first.focused{will-change:auto}.first.focused .first-overlay-container{will-change:auto}}}.second{position:relative}.handle-container{transform:translateX(50%);position:absolute;top:0;right:var(--exposure);height:100%;transition:right var(--transition-time),bottom var(--transition-time)}.focused .handle-container{will-change:right}@media not all and (min-resolution: 0.001dpcm){@supports(-webkit-appearance: none){.handle-container{right:0}.focused .handle-container{will-change:auto}}}.divider{position:absolute;height:100%;width:100%;left:0;top:0;display:flex;align-items:center;justify-content:center;flex-direction:column}.divider:after{content:" ";display:block;height:100%;border-left-width:var(--divider-width);border-left-style:solid;border-left-color:var(--divider-color);box-shadow:var(--divider-shadow)}.handle{position:absolute;top:var(--handle-position-start);pointer-events:none;box-sizing:border-box;margin-left:1px;transform:translate(calc(-50% - 0.5px), -50%);line-height:0}.default-handle{width:var(--default-handle-width);opacity:var(--default-handle-opacity);transition:all 1s;filter:drop-shadow(var(--default-handle-shadow))}.default-handle path{stroke:var(--default-handle-color)}.vertical .first-overlay-container{clip-path:inset(0 0 var(--exposure) 0)}.vertical .handle-container{transform:translateY(50%);height:auto;top:unset;bottom:var(--exposure);width:100%;left:0;flex-direction:row}.vertical .divider:after{height:1px;width:100%;border-top-width:var(--divider-width);border-top-style:solid;border-top-color:var(--divider-color);border-left:0}.vertical .handle{top:auto;left:var(--handle-position-start);transform:translate(calc(-50% - 0.5px), -50%) rotate(90deg)}@media not all and (min-resolution: 0.001dpcm){@supports(-webkit-appearance: none){.vertical.first{transform:translateY(calc(var(--exposure) * -1))}.vertical .first-overlay-container{transform:translateY(var(--exposure));clip-path:none}.vertical .handle-container{bottom:0}}}',""]);const w=s},609:c=>{c.exports=function(d){var f=[];return f.toString=function(){return this.map(function(y){var s=d(y);return y[2]?"@media ".concat(y[2]," {").concat(s,"}"):s}).join("")},f.i=function(y,s,w){typeof y=="string"&&(y=[[null,y,""]]);var C={};if(w)for(var L=0;L<this.length;L++){var k=this[L][0];k!=null&&(C[k]=!0)}for(var R=0;R<y.length;R++){var V=[].concat(y[R]);w&&C[V[0]]||(s&&(V[2]?V[2]="".concat(s," and ").concat(V[2]):V[2]=s),f.push(V))}},f}}},i={};function a(c){var d=i[c];if(d!==void 0)return d.exports;var f=i[c]={id:c,exports:{}};return e[c](f,f.exports,a),f.exports}a.n=c=>{var d=c&&c.__esModule?()=>c.default:()=>c;return a.d(d,{a:d}),d},a.d=(c,d)=>{for(var f in d)a.o(d,f)&&!a.o(c,f)&&Object.defineProperty(c,f,{enumerable:!0,get:d[f]})},a.o=(c,d)=>Object.prototype.hasOwnProperty.call(c,d),(()=>{var c=a(792);const d="rendered",f=document.createElement("template");f.innerHTML='<div class="second" id="second"> <slot name="second"><slot name="before"></slot></slot> </div> <div class="first" id="first"> <div class="first-overlay"> <div class="first-overlay-container" id="firstImageContainer"> <slot name="first"><slot name="after"></slot></slot> </div> </div> <div class="handle-container"> <div class="divider"></div> <div class="handle"> <slot name="handle"> <svg xmlns="http://www.w3.org/2000/svg" class="default-handle" viewBox="-8 -3 16 6"> <path d="M -5 -2 L -7 0 L -5 2 M 5 -2 L 7 0 L 5 2" fill="none" vector-effect="non-scaling-stroke"/> </svg> </slot> </div> </div> </div> ';const y={ArrowLeft:-1,ArrowRight:1},s=["horizontal","vertical"],w=k=>({x:k.touches[0].pageX,y:k.touches[0].pageY}),C=k=>({x:k.pageX,y:k.pageY});class L extends HTMLElement{constructor(){super(),this.exposure=this.hasAttribute("value")?parseFloat(this.getAttribute("value")):50,this.slideOnHover=!1,this.slideDirection="horizontal",this.keyboard="enabled",this.isMouseDown=!1,this.animationDirection=0,this.isFocused=!1,this.onMouseMove=H=>{if(this.isMouseDown||this.slideOnHover){const J=C(H);this.slideToPage(J)}},this.bodyUserSelectStyle="",this.onMouseDown=H=>{if(this.slideOnHover)return;window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),this.isMouseDown=!0,this.enableTransition();const J=C(H);this.slideToPage(J),this.focus(),this.bodyUserSelectStyle=window.document.body.style.userSelect,window.document.body.style.userSelect="none"},this.onWindowMouseUp=()=>{this.isMouseDown=!1,window.document.body.style.userSelect=this.bodyUserSelectStyle,window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp)},this.isTouchComparing=!1,this.hasTouchMoved=!1,this.onTouchStart=H=>{this.touchStartPoint=w(H),this.isFocused&&(this.enableTransition(),this.slideToPage(this.touchStartPoint))},this.onTouchMove=H=>{const J=w(H);if(this.isTouchComparing)return this.slideToPage(J),H.preventDefault(),!1;if(!this.hasTouchMoved){const ue=Math.abs(J.y-this.touchStartPoint.y),j=Math.abs(J.x-this.touchStartPoint.x);if(this.slideDirection==="horizontal"&&ue<j||this.slideDirection==="vertical"&&ue>j)return this.isTouchComparing=!0,this.focus(),this.slideToPage(J),H.preventDefault(),!1;this.hasTouchMoved=!0}},this.onTouchEnd=()=>{this.isTouchComparing=!1,this.hasTouchMoved=!1},this.onBlur=()=>{this.stopSlideAnimation(),this.isFocused=!1,this.firstElement.classList.remove("focused")},this.onFocus=()=>{this.isFocused=!0,this.firstElement.classList.add("focused")},this.onKeyDown=H=>{if(this.keyboard==="disabled")return;const J=y[H.key];this.animationDirection!==J&&J!==void 0&&(this.animationDirection=J,this.startSlideAnimation())},this.onKeyUp=H=>{if(this.keyboard==="disabled")return;const J=y[H.key];J!==void 0&&this.animationDirection===J&&this.stopSlideAnimation()},this.resetDimensions=()=>{this.imageWidth=this.offsetWidth,this.imageHeight=this.offsetHeight};const R=this.attachShadow({mode:"open"}),V=document.createElement("style");V.innerHTML=c.Z,this.getAttribute("nonce")&&V.setAttribute("nonce",this.getAttribute("nonce")),R.appendChild(V),R.appendChild(f.content.cloneNode(!0)),this.firstElement=R.getElementById("first"),this.secondElement=R.getElementById("second")}get value(){return this.exposure}set value(R){const V=parseFloat(R);V!==this.exposure&&(this.exposure=V,this.enableTransition(),this.setExposure())}get hover(){return this.slideOnHover}set hover(R){this.slideOnHover=R.toString().toLowerCase()!=="false",this.removeEventListener("mousemove",this.onMouseMove),this.slideOnHover&&this.addEventListener("mousemove",this.onMouseMove)}get direction(){return this.slideDirection}set direction(R){this.slideDirection=R.toString().toLowerCase(),this.slide(0),this.firstElement.classList.remove(...s),s.includes(this.slideDirection)&&this.firstElement.classList.add(this.slideDirection)}static get observedAttributes(){return["hover","direction"]}connectedCallback(){this.hasAttribute("tabindex")||(this.tabIndex=0),this.addEventListener("dragstart",R=>(R.preventDefault(),!1)),new ResizeObserver(this.resetDimensions).observe(this),this.setExposure(0),this.keyboard=this.hasAttribute("keyboard")&&this.getAttribute("keyboard")==="disabled"?"disabled":"enabled",this.addEventListener("keydown",this.onKeyDown),this.addEventListener("keyup",this.onKeyUp),this.addEventListener("focus",this.onFocus),this.addEventListener("blur",this.onBlur),this.addEventListener("touchstart",this.onTouchStart,{passive:!0}),this.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.addEventListener("touchend",this.onTouchEnd),this.addEventListener("mousedown",this.onMouseDown),this.hover=!!this.hasAttribute("hover")&&this.getAttribute("hover"),this.direction=this.hasAttribute("direction")?this.getAttribute("direction"):"horizontal",this.resetDimensions(),this.classList.contains(d)||this.classList.add(d),this.querySelectorAll('[slot="before"], [slot="after"]').length>0&&console.warn(`<img-comparison-slider>: slot names "before" and "after" are deprecated and soon won't be supported. Please use slot="first" instead of slot="after", and slot="second" instead of slot="before".`)}disconnectedCallback(){this.transitionTimer&&window.clearTimeout(this.transitionTimer)}attributeChangedCallback(R,V,H){R==="hover"&&(this.hover=H),R==="direction"&&(this.direction=H),R==="keyboard"&&(this.keyboard=H==="disabled"?"disabled":"enabled")}setExposure(R=0){var V;this.exposure=(V=this.exposure+R)<0?0:V>100?100:V,this.firstElement.style.setProperty("--exposure",100-this.exposure+"%")}slide(R=0){this.setExposure(R);const V=new Event("slide");this.dispatchEvent(V)}slideToPage(R){this.slideDirection==="horizontal"&&this.slideToPageX(R.x),this.slideDirection==="vertical"&&this.slideToPageY(R.y)}slideToPageX(R){const V=R-this.getBoundingClientRect().left-window.scrollX;this.exposure=V/this.imageWidth*100,this.slide(0)}slideToPageY(R){const V=R-this.getBoundingClientRect().top-window.scrollY;this.exposure=V/this.imageHeight*100,this.slide(0)}enableTransition(){this.firstElement.style.setProperty("--transition-time","100ms"),this.transitionTimer=window.setTimeout(()=>{this.firstElement.style.setProperty("--transition-time","var(--default-transition-time)"),this.transitionTimer=null},100)}startSlideAnimation(){let R=null,V=this.animationDirection;this.firstElement.style.setProperty("--transition-time","var(--keyboard-transition-time)");const H=J=>{if(this.animationDirection===0||V!==this.animationDirection)return;R===null&&(R=J);const ue=(J-R)/16.666666666666668*this.animationDirection;this.slide(ue),setTimeout(()=>window.requestAnimationFrame(H),0),R=J};window.requestAnimationFrame(H)}stopSlideAnimation(){this.animationDirection=0,this.firstElement.style.setProperty("--transition-time","var(--default-transition-time)")}}typeof window<"u"&&window.customElements.define("img-comparison-slider",L)})()})();Gu({name:"ImgComparisonSlider",setup(e,{slots:i}){return()=>Cf("img-comparison-slider",i.default())}});/*! @license DOMPurify 3.0.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.6/LICENSE */const{entries:ZM,setPrototypeOf:eS,isFrozen:E$,getPrototypeOf:S$,getOwnPropertyDescriptor:XM}=Object;let{freeze:Pr,seal:Zs,create:KM}=Object,{apply:S0,construct:A0}=typeof Reflect<"u"&&Reflect;Pr||(Pr=function(i){return i});Zs||(Zs=function(i){return i});S0||(S0=function(i,a,c){return i.apply(a,c)});A0||(A0=function(i,a){return new i(...a)});const wm=As(Array.prototype.forEach),tS=As(Array.prototype.pop),Pd=As(Array.prototype.push),Rm=As(String.prototype.toLowerCase),gv=As(String.prototype.toString),A$=As(String.prototype.match),kd=As(String.prototype.replace),C$=As(String.prototype.indexOf),M$=As(String.prototype.trim),Jr=As(RegExp.prototype.test),Ld=I$(TypeError);function As(e){return function(i){for(var a=arguments.length,c=new Array(a>1?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];return S0(e,i,c)}}function I$(e){return function(){for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return A0(e,a)}}function wi(e,i){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Rm;eS&&eS(e,null);let c=i.length;for(;c--;){let d=i[c];if(typeof d=="string"){const f=a(d);f!==d&&(E$(i)||(i[c]=f),d=f)}e[d]=!0}return e}function lu(e){const i=KM(null);for(const[a,c]of ZM(e))XM(e,a)!==void 0&&(i[a]=c);return i}function Tm(e,i){for(;e!==null;){const c=XM(e,i);if(c){if(c.get)return As(c.get);if(typeof c.value=="function")return As(c.value)}e=S$(e)}function a(c){return console.warn("fallback value for",c),null}return a}const iS=Pr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_v=Pr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),yv=Pr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),P$=Pr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),vv=Pr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),k$=Pr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),nS=Pr(["#text"]),rS=Pr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),xv=Pr(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sS=Pr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Em=Pr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),L$=Zs(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z$=Zs(/<%[\w\W]*|[\w\W]*%>/gm),R$=Zs(/\${[\w\W]*}/gm),D$=Zs(/^data-[\-\w.\u00B7-\uFFFF]/),O$=Zs(/^aria-[\-\w]+$/),YM=Zs(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),F$=Zs(/^(?:\w+script|data):/i),B$=Zs(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),QM=Zs(/^html$/i);var oS=Object.freeze({__proto__:null,MUSTACHE_EXPR:L$,ERB_EXPR:z$,TMPLIT_EXPR:R$,DATA_ATTR:D$,ARIA_ATTR:O$,IS_ALLOWED_URI:YM,IS_SCRIPT_OR_DATA:F$,ATTR_WHITESPACE:B$,DOCTYPE_NAME:QM});const N$=function(){return typeof window>"u"?null:window},U$=function(i,a){if(typeof i!="object"||typeof i.createPolicy!="function")return null;let c=null;const d="data-tt-policy-suffix";a&&a.hasAttribute(d)&&(c=a.getAttribute(d));const f="dompurify"+(c?"#"+c:"");try{return i.createPolicy(f,{createHTML(y){return y},createScriptURL(y){return y}})}catch{return console.warn("TrustedTypes policy "+f+" could not be created."),null}};function JM(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N$();const i=lt=>JM(lt);if(i.version="3.0.6",i.removed=[],!e||!e.document||e.document.nodeType!==9)return i.isSupported=!1,i;let{document:a}=e;const c=a,d=c.currentScript,{DocumentFragment:f,HTMLTemplateElement:y,Node:s,Element:w,NodeFilter:C,NamedNodeMap:L=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:k,DOMParser:R,trustedTypes:V}=e,H=w.prototype,J=Tm(H,"cloneNode"),ue=Tm(H,"nextSibling"),j=Tm(H,"childNodes"),q=Tm(H,"parentNode");if(typeof y=="function"){const lt=a.createElement("template");lt.content&&lt.content.ownerDocument&&(a=lt.content.ownerDocument)}let se,ge="";const{implementation:ie,createNodeIterator:Ie,createDocumentFragment:ze,getElementsByTagName:Ae}=a,{importNode:He}=c;let Ce={};i.isSupported=typeof ZM=="function"&&typeof q=="function"&&ie&&ie.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Ge,ERB_EXPR:De,TMPLIT_EXPR:We,DATA_ATTR:et,ARIA_ATTR:Gt,IS_SCRIPT_OR_DATA:Vt,ATTR_WHITESPACE:fi}=oS;let{IS_ALLOWED_URI:Yt}=oS,_i=null;const tn=wi({},[...iS,..._v,...yv,...vv,...nS]);let Mi=null;const yi=wi({},[...rS,...xv,...sS,...Em]);let Kt=Object.seal(KM(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),fn=null,gn=null,xn=!0,Ke=!0,Pt=!1,Mt=!0,Lt=!1,li=!1,Ai=!1,he=!1,de=!1,Ne=!1,at=!1,Ye=!0,gt=!1;const It="user-content-";let tt=!0,xt=!1,ut={},Ot=null;const Dt=wi({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let $t=null;const Zt=wi({},["audio","video","img","source","image","track"]);let ci=null;const oi=wi({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ui="http://www.w3.org/1998/Math/MathML",bi="http://www.w3.org/2000/svg",nn="http://www.w3.org/1999/xhtml";let Zi=nn,Gn=!1,ur=null;const fs=wi({},[ui,bi,nn],gv);let Xi=null;const Mn=["application/xhtml+xml","text/html"],ps="text/html";let pn=null,$r=null;const Ha=a.createElement("form"),jr=function(_e){return _e instanceof RegExp||_e instanceof Function},wr=function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!($r&&$r===_e)){if((!_e||typeof _e!="object")&&(_e={}),_e=lu(_e),Xi=Mn.indexOf(_e.PARSER_MEDIA_TYPE)===-1?Xi=ps:Xi=_e.PARSER_MEDIA_TYPE,pn=Xi==="application/xhtml+xml"?gv:Rm,_i="ALLOWED_TAGS"in _e?wi({},_e.ALLOWED_TAGS,pn):tn,Mi="ALLOWED_ATTR"in _e?wi({},_e.ALLOWED_ATTR,pn):yi,ur="ALLOWED_NAMESPACES"in _e?wi({},_e.ALLOWED_NAMESPACES,gv):fs,ci="ADD_URI_SAFE_ATTR"in _e?wi(lu(oi),_e.ADD_URI_SAFE_ATTR,pn):oi,$t="ADD_DATA_URI_TAGS"in _e?wi(lu(Zt),_e.ADD_DATA_URI_TAGS,pn):Zt,Ot="FORBID_CONTENTS"in _e?wi({},_e.FORBID_CONTENTS,pn):Dt,fn="FORBID_TAGS"in _e?wi({},_e.FORBID_TAGS,pn):{},gn="FORBID_ATTR"in _e?wi({},_e.FORBID_ATTR,pn):{},ut="USE_PROFILES"in _e?_e.USE_PROFILES:!1,xn=_e.ALLOW_ARIA_ATTR!==!1,Ke=_e.ALLOW_DATA_ATTR!==!1,Pt=_e.ALLOW_UNKNOWN_PROTOCOLS||!1,Mt=_e.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Lt=_e.SAFE_FOR_TEMPLATES||!1,li=_e.WHOLE_DOCUMENT||!1,de=_e.RETURN_DOM||!1,Ne=_e.RETURN_DOM_FRAGMENT||!1,at=_e.RETURN_TRUSTED_TYPE||!1,he=_e.FORCE_BODY||!1,Ye=_e.SANITIZE_DOM!==!1,gt=_e.SANITIZE_NAMED_PROPS||!1,tt=_e.KEEP_CONTENT!==!1,xt=_e.IN_PLACE||!1,Yt=_e.ALLOWED_URI_REGEXP||YM,Zi=_e.NAMESPACE||nn,Kt=_e.CUSTOM_ELEMENT_HANDLING||{},_e.CUSTOM_ELEMENT_HANDLING&&jr(_e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Kt.tagNameCheck=_e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_e.CUSTOM_ELEMENT_HANDLING&&jr(_e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Kt.attributeNameCheck=_e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_e.CUSTOM_ELEMENT_HANDLING&&typeof _e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Kt.allowCustomizedBuiltInElements=_e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Lt&&(Ke=!1),Ne&&(de=!0),ut&&(_i=wi({},[...nS]),Mi=[],ut.html===!0&&(wi(_i,iS),wi(Mi,rS)),ut.svg===!0&&(wi(_i,_v),wi(Mi,xv),wi(Mi,Em)),ut.svgFilters===!0&&(wi(_i,yv),wi(Mi,xv),wi(Mi,Em)),ut.mathMl===!0&&(wi(_i,vv),wi(Mi,sS),wi(Mi,Em))),_e.ADD_TAGS&&(_i===tn&&(_i=lu(_i)),wi(_i,_e.ADD_TAGS,pn)),_e.ADD_ATTR&&(Mi===yi&&(Mi=lu(Mi)),wi(Mi,_e.ADD_ATTR,pn)),_e.ADD_URI_SAFE_ATTR&&wi(ci,_e.ADD_URI_SAFE_ATTR,pn),_e.FORBID_CONTENTS&&(Ot===Dt&&(Ot=lu(Ot)),wi(Ot,_e.FORBID_CONTENTS,pn)),tt&&(_i["#text"]=!0),li&&wi(_i,["html","head","body"]),_i.table&&(wi(_i,["tbody"]),delete fn.tbody),_e.TRUSTED_TYPES_POLICY){if(typeof _e.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ld('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof _e.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ld('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');se=_e.TRUSTED_TYPES_POLICY,ge=se.createHTML("")}else se===void 0&&(se=U$(V,d)),se!==null&&typeof ge=="string"&&(ge=se.createHTML(""));Pr&&Pr(_e),$r=_e}},Ms=wi({},["mi","mo","mn","ms","mtext"]),wo=wi({},["foreignobject","desc","title","annotation-xml"]),qn=wi({},["title","style","font","a","script"]),ms=wi({},_v);wi(ms,yv),wi(ms,P$);const re=wi({},vv);wi(re,k$);const N=function(_e){let qe=q(_e);(!qe||!qe.tagName)&&(qe={namespaceURI:Zi,tagName:"template"});const pt=Rm(_e.tagName),qt=Rm(qe.tagName);return ur[_e.namespaceURI]?_e.namespaceURI===bi?qe.namespaceURI===nn?pt==="svg":qe.namespaceURI===ui?pt==="svg"&&(qt==="annotation-xml"||Ms[qt]):Boolean(ms[pt]):_e.namespaceURI===ui?qe.namespaceURI===nn?pt==="math":qe.namespaceURI===bi?pt==="math"&&wo[qt]:Boolean(re[pt]):_e.namespaceURI===nn?qe.namespaceURI===bi&&!wo[qt]||qe.namespaceURI===ui&&!Ms[qt]?!1:!re[pt]&&(qn[pt]||!ms[pt]):!!(Xi==="application/xhtml+xml"&&ur[_e.namespaceURI]):!1},$=function(_e){Pd(i.removed,{element:_e});try{_e.parentNode.removeChild(_e)}catch{_e.remove()}},ne=function(_e,qe){try{Pd(i.removed,{attribute:qe.getAttributeNode(_e),from:qe})}catch{Pd(i.removed,{attribute:null,from:qe})}if(qe.removeAttribute(_e),_e==="is"&&!Mi[_e])if(de||Ne)try{$(qe)}catch{}else try{qe.setAttribute(_e,"")}catch{}},ce=function(_e){let qe=null,pt=null;if(he)_e="<remove></remove>"+_e;else{const Jt=A$(_e,/^[\r\n\t ]+/);pt=Jt&&Jt[0]}Xi==="application/xhtml+xml"&&Zi===nn&&(_e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_e+"</body></html>");const qt=se?se.createHTML(_e):_e;if(Zi===nn)try{qe=new R().parseFromString(qt,Xi)}catch{}if(!qe||!qe.documentElement){qe=ie.createDocument(Zi,"template",null);try{qe.documentElement.innerHTML=Gn?ge:qt}catch{}}const ti=qe.body||qe.documentElement;return _e&&pt&&ti.insertBefore(a.createTextNode(pt),ti.childNodes[0]||null),Zi===nn?Ae.call(qe,li?"html":"body")[0]:li?qe.documentElement:ti},Te=function(_e){return Ie.call(_e.ownerDocument||_e,_e,C.SHOW_ELEMENT|C.SHOW_COMMENT|C.SHOW_TEXT,null)},Le=function(_e){return _e instanceof k&&(typeof _e.nodeName!="string"||typeof _e.textContent!="string"||typeof _e.removeChild!="function"||!(_e.attributes instanceof L)||typeof _e.removeAttribute!="function"||typeof _e.setAttribute!="function"||typeof _e.namespaceURI!="string"||typeof _e.insertBefore!="function"||typeof _e.hasChildNodes!="function")},Pe=function(_e){return typeof s=="function"&&_e instanceof s},be=function(_e,qe,pt){!Ce[_e]||wm(Ce[_e],qt=>{qt.call(i,qe,pt,$r)})},Re=function(_e){let qe=null;if(be("beforeSanitizeElements",_e,null),Le(_e))return $(_e),!0;const pt=pn(_e.nodeName);if(be("uponSanitizeElement",_e,{tagName:pt,allowedTags:_i}),_e.hasChildNodes()&&!Pe(_e.firstElementChild)&&Jr(/<[/\w]/g,_e.innerHTML)&&Jr(/<[/\w]/g,_e.textContent))return $(_e),!0;if(!_i[pt]||fn[pt]){if(!fn[pt]&&wt(pt)&&(Kt.tagNameCheck instanceof RegExp&&Jr(Kt.tagNameCheck,pt)||Kt.tagNameCheck instanceof Function&&Kt.tagNameCheck(pt)))return!1;if(tt&&!Ot[pt]){const qt=q(_e)||_e.parentNode,ti=j(_e)||_e.childNodes;if(ti&&qt){const Jt=ti.length;for(let kt=Jt-1;kt>=0;--kt)qt.insertBefore(J(ti[kt],!0),ue(_e))}}return $(_e),!0}return _e instanceof w&&!N(_e)||(pt==="noscript"||pt==="noembed"||pt==="noframes")&&Jr(/<\/no(script|embed|frames)/i,_e.innerHTML)?($(_e),!0):(Lt&&_e.nodeType===3&&(qe=_e.textContent,wm([Ge,De,We],qt=>{qe=kd(qe,qt," ")}),_e.textContent!==qe&&(Pd(i.removed,{element:_e.cloneNode()}),_e.textContent=qe)),be("afterSanitizeElements",_e,null),!1)},rt=function(_e,qe,pt){if(Ye&&(qe==="id"||qe==="name")&&(pt in a||pt in Ha))return!1;if(!(Ke&&!gn[qe]&&Jr(et,qe))){if(!(xn&&Jr(Gt,qe))){if(!Mi[qe]||gn[qe]){if(!(wt(_e)&&(Kt.tagNameCheck instanceof RegExp&&Jr(Kt.tagNameCheck,_e)||Kt.tagNameCheck instanceof Function&&Kt.tagNameCheck(_e))&&(Kt.attributeNameCheck instanceof RegExp&&Jr(Kt.attributeNameCheck,qe)||Kt.attributeNameCheck instanceof Function&&Kt.attributeNameCheck(qe))||qe==="is"&&Kt.allowCustomizedBuiltInElements&&(Kt.tagNameCheck instanceof RegExp&&Jr(Kt.tagNameCheck,pt)||Kt.tagNameCheck instanceof Function&&Kt.tagNameCheck(pt))))return!1}else if(!ci[qe]){if(!Jr(Yt,kd(pt,fi,""))){if(!((qe==="src"||qe==="xlink:href"||qe==="href")&&_e!=="script"&&C$(pt,"data:")===0&&$t[_e])){if(!(Pt&&!Jr(Vt,kd(pt,fi,"")))){if(pt)return!1}}}}}}return!0},wt=function(_e){return _e.indexOf("-")>0},ct=function(_e){be("beforeSanitizeAttributes",_e,null);const{attributes:qe}=_e;if(!qe)return;const pt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Mi};let qt=qe.length;for(;qt--;){const ti=qe[qt],{name:Jt,namespaceURI:kt,value:Ve}=ti,Sn=pn(Jt);let vi=Jt==="value"?Ve:M$(Ve);if(pt.attrName=Sn,pt.attrValue=vi,pt.keepAttr=!0,pt.forceKeepAttr=void 0,be("uponSanitizeAttribute",_e,pt),vi=pt.attrValue,pt.forceKeepAttr||(ne(Jt,_e),!pt.keepAttr))continue;if(!Mt&&Jr(/\/>/i,vi)){ne(Jt,_e);continue}Lt&&wm([Ge,De,We],To=>{vi=kd(vi,To," ")});const Gr=pn(_e.nodeName);if(!!rt(Gr,Sn,vi)){if(gt&&(Sn==="id"||Sn==="name")&&(ne(Jt,_e),vi=It+vi),se&&typeof V=="object"&&typeof V.getAttributeType=="function"&&!kt)switch(V.getAttributeType(Gr,Sn)){case"TrustedHTML":{vi=se.createHTML(vi);break}case"TrustedScriptURL":{vi=se.createScriptURL(vi);break}}try{kt?_e.setAttributeNS(kt,Jt,vi):_e.setAttribute(Jt,vi),tS(i.removed)}catch{}}}be("afterSanitizeAttributes",_e,null)},jt=function lt(_e){let qe=null;const pt=Te(_e);for(be("beforeSanitizeShadowDOM",_e,null);qe=pt.nextNode();)be("uponSanitizeShadowNode",qe,null),!Re(qe)&&(qe.content instanceof f&&lt(qe.content),ct(qe));be("afterSanitizeShadowDOM",_e,null)};return i.sanitize=function(lt){let _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},qe=null,pt=null,qt=null,ti=null;if(Gn=!lt,Gn&&(lt="<!-->"),typeof lt!="string"&&!Pe(lt))if(typeof lt.toString=="function"){if(lt=lt.toString(),typeof lt!="string")throw Ld("dirty is not a string, aborting")}else throw Ld("toString is not a function");if(!i.isSupported)return lt;if(Ai||wr(_e),i.removed=[],typeof lt=="string"&&(xt=!1),xt){if(lt.nodeName){const Ve=pn(lt.nodeName);if(!_i[Ve]||fn[Ve])throw Ld("root node is forbidden and cannot be sanitized in-place")}}else if(lt instanceof s)qe=ce("<!---->"),pt=qe.ownerDocument.importNode(lt,!0),pt.nodeType===1&&pt.nodeName==="BODY"||pt.nodeName==="HTML"?qe=pt:qe.appendChild(pt);else{if(!de&&!Lt&&!li&&lt.indexOf("<")===-1)return se&&at?se.createHTML(lt):lt;if(qe=ce(lt),!qe)return de?null:at?ge:""}qe&&he&&$(qe.firstChild);const Jt=Te(xt?lt:qe);for(;qt=Jt.nextNode();)Re(qt)||(qt.content instanceof f&&jt(qt.content),ct(qt));if(xt)return lt;if(de){if(Ne)for(ti=ze.call(qe.ownerDocument);qe.firstChild;)ti.appendChild(qe.firstChild);else ti=qe;return(Mi.shadowroot||Mi.shadowrootmode)&&(ti=He.call(c,ti,!0)),ti}let kt=li?qe.outerHTML:qe.innerHTML;return li&&_i["!doctype"]&&qe.ownerDocument&&qe.ownerDocument.doctype&&qe.ownerDocument.doctype.name&&Jr(QM,qe.ownerDocument.doctype.name)&&(kt="<!DOCTYPE "+qe.ownerDocument.doctype.name+`>
`+kt),Lt&&wm([Ge,De,We],Ve=>{kt=kd(kt,Ve," ")}),se&&at?se.createHTML(kt):kt},i.setConfig=function(){let lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wr(lt),Ai=!0},i.clearConfig=function(){$r=null,Ai=!1},i.isValidAttribute=function(lt,_e,qe){$r||wr({});const pt=pn(lt),qt=pn(_e);return rt(pt,qt,qe)},i.addHook=function(lt,_e){typeof _e=="function"&&(Ce[lt]=Ce[lt]||[],Pd(Ce[lt],_e))},i.removeHook=function(lt){if(Ce[lt])return tS(Ce[lt])},i.removeHooks=function(lt){Ce[lt]&&(Ce[lt]=[])},i.removeAllHooks=function(){Ce={}},i}var V$=JM();const $$={},j$=e=>(IA("data-v-59b7ce5c"),e=e(),PA(),e),G$={class:"h-full w-full relative"},q$=j$(()=>Fe("div",{class:"lds-roller absolute left-1/2 top-1/3 -translate-x-1/2 -translate-y-1/2"},[Fe("div"),Fe("div"),Fe("div"),Fe("div"),Fe("div"),Fe("div"),Fe("div"),Fe("div")],-1)),W$=[q$];function H$(e,i){return Ft(),Nt("div",G$,W$)}const Z$=qa($$,[["render",H$],["__scopeId","data-v-59b7ce5c"]]);function X$(){const e={};return async(i,a)=>{if(!(i in e)){const c=await er.get(`/collections/knowledge-base/${i}/${a}`).then(d=>d.data).catch(d=>console.log(d));e[i]=c}return e[i]}}const aS=X$(),K$={name:"Knowledge Base Article",data(){return{content:null}},props:{lang:{type:String,default:"english",required:!0}},components:{Loading:Z$},async mounted(){var e;this.content=await aS((e=this.$route.params.slug)!=null?e:"overview",this.lang),this.$nextTick(()=>{this.highlightTOCItemsOnScroll()}),this.$watch(()=>this.$route.params,async(i,a)=>{if(i){const c=i.slug;await this.updateContent(c,this.lang),this.$nextTick(()=>{this.highlightTOCItemsOnScroll()})}})},methods:{highlightTOCItemsOnScroll(){const e=Array.from(document.getElementsByClassName("toc-item")),i=new IntersectionObserver(c=>{c.forEach(d=>{const f=d.target.id,y=e.find(s=>s.dataset.sectionId===f);y.classList.toggle("text-dida",d.isIntersecting),y.classList.toggle("font-medium",d.isIntersecting)})},{root:null,rootMargin:"0px 0px 0px 0px",threshold:.25});Array.from(document.getElementsByClassName("observable")).forEach(c=>{i.observe(c)})},mergeContent(e){let i="";return e.forEach(a=>{var c;switch(a.type){case"text":i+=a.text;break;case"image":const d=(c=a.align)==null?void 0:c.value;i+=`
              <div class='my-4 w-full flex ${d==="center"||!d?"justify-center":d==="left"?"justify-start":"justify-end"}'>
                <img src="${a.image.url}" />
              </div>
            `;break;case"video":i+=`<iframe class="w-full max-w-2xl my-4 mx-auto aspect-video" src="${a.video}"></iframe>`;break;default:throw new Error(`Unknown content snippet type ${a.type}`)}}),i},sanitize(e){return V$.sanitize(e,{ALLOWED_TAGS:["iframe","img","a","strong","ul","ol","li","div","p"]})},scrollToSection(e){window.scrollTo({behavior:"smooth",top:document.getElementById(e).getBoundingClientRect().top+window.pageYOffset-200})},async updateContent(e,i){this.content=null,this.content=await aS(e,i)}},computed:{}},Y$={key:0},Q$={class:"px-12"},J$={class:"flex flex-col gap-6"},ej={class:"text-3xl"},tj=["innerHTML"],ij=["id"],nj=["src"],rj={class:"text-2xl my-2"},sj=["innerHTML"],oj={class:"text-xl my-2"},aj=["innerHTML"],lj={key:1,class:"px-8 border-l h-max sticky top-24 hidden lg:block overflow-y-auto max-h-[calc(90vh-6rem)]"},cj={class:"font-medium"},uj=["onClick","data-section-id"],hj={key:2,class:"min-h-screen"};function dj(e,i,a,c,d,f){const y=Xd("Loading");return Ft(),Nt(dn,null,[d.content?(Ft(),Nt("article",Y$,[Fe("div",Q$,[Fe("header",J$,[Fe("h1",ej,Pi(d.content.introduction[0].title),1),Fe("div",{innerHTML:f.sanitize(f.mergeContent(d.content.introduction[0].content)),class:"bard"},null,8,tj)]),Fe("main",null,[(Ft(!0),Nt(dn,null,Wo(d.content.sections,(s,w)=>(Ft(),Nt("section",{class:"observable my-14",key:w,id:s.id},[s.image?(Ft(),Nt("div",{key:0,class:$i(["w-full flex",{"justify-start":s.align.value==="left","justify-end":s.align.value==="right","justify-center":s.align.value==="center"}])},[Fe("img",{src:s.image.url},null,8,nj)],2)):Ri("",!0),Fe("h2",rj,Pi(s.title),1),Fe("div",{innerHTML:f.sanitize(f.mergeContent(s.content)),class:"bard"},null,8,sj),(Ft(!0),Nt(dn,null,Wo(s.subsections,(C,L)=>(Ft(),Nt("section",{class:"mt-8",key:L},[Fe("h3",oj,Pi(C.title),1),Fe("div",{innerHTML:f.sanitize(f.mergeContent(C.content)),class:"bard"},null,8,aj)]))),128))],8,ij))),128))])])])):Ri("",!0),d.content?(Ft(),Nt("aside",lj,[Fe("p",cj,Pi(a.lang=="english"?"ON THIS PAGE:":"INHALT"),1),Fe("ul",null,[(Ft(!0),Nt(dn,null,Wo(d.content.sections,(s,w)=>{var C;return Ft(),Nt("li",{key:w,class:""},[Fe("p",{onClick:Rx(L=>f.scrollToSection(s.id),["prevent"]),"data-section-id":s.id,class:"toc-item cursor-pointer"},Pi((C=s.title_toc)!=null?C:s.title),9,uj)])}),128))])])):Ri("",!0),d.content?Ri("",!0):(Ft(),Nt("div",hj,[Hi(y)]))],64)}const lS=qa(K$,[["render",dj]]),fj=[{path:"/knowledge/:slug",name:"Article",component:lS,props:{lang:"english"}},{path:"/de/knowledge/:slug",name:"Article_de",component:lS,props:{lang:"german"}}],pj=F3({history:JB(),routes:fj});function cS(e){return e!==null&&typeof e=="object"&&"constructor"in e&&e.constructor===Object}function h1(e,i){e===void 0&&(e={}),i===void 0&&(i={}),Object.keys(i).forEach(a=>{typeof e[a]>"u"?e[a]=i[a]:cS(i[a])&&cS(e[a])&&Object.keys(i[a]).length>0&&h1(e[a],i[a])})}const eI={body:{},addEventListener(){},removeEventListener(){},activeElement:{blur(){},nodeName:""},querySelector(){return null},querySelectorAll(){return[]},getElementById(){return null},createEvent(){return{initEvent(){}}},createElement(){return{children:[],childNodes:[],style:{},setAttribute(){},getElementsByTagName(){return[]}}},createElementNS(){return{}},importNode(){return null},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""}};function Wu(){const e=typeof document<"u"?document:{};return h1(e,eI),e}const mj={document:eI,navigator:{userAgent:""},location:{hash:"",host:"",hostname:"",href:"",origin:"",pathname:"",protocol:"",search:""},history:{replaceState(){},pushState(){},go(){},back(){}},CustomEvent:function(){return this},addEventListener(){},removeEventListener(){},getComputedStyle(){return{getPropertyValue(){return""}}},Image(){},Date(){},screen:{},setTimeout(){},clearTimeout(){},matchMedia(){return{}},requestAnimationFrame(e){return typeof setTimeout>"u"?(e(),null):setTimeout(e,0)},cancelAnimationFrame(e){typeof setTimeout>"u"||clearTimeout(e)}};function ds(){const e=typeof window<"u"?window:{};return h1(e,mj),e}function gj(e){return e===void 0&&(e=""),e.trim().split(" ").filter(i=>!!i.trim())}function _j(e){const i=e;Object.keys(i).forEach(a=>{try{i[a]=null}catch{}try{delete i[a]}catch{}})}function C0(e,i){return i===void 0&&(i=0),setTimeout(e,i)}function lg(){return Date.now()}function yj(e){const i=ds();let a;return i.getComputedStyle&&(a=i.getComputedStyle(e,null)),!a&&e.currentStyle&&(a=e.currentStyle),a||(a=e.style),a}function vj(e,i){i===void 0&&(i="x");const a=ds();let c,d,f;const y=yj(e);return a.WebKitCSSMatrix?(d=y.transform||y.webkitTransform,d.split(",").length>6&&(d=d.split(", ").map(s=>s.replace(",",".")).join(", ")),f=new a.WebKitCSSMatrix(d==="none"?"":d)):(f=y.MozTransform||y.OTransform||y.MsTransform||y.msTransform||y.transform||y.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),c=f.toString().split(",")),i==="x"&&(a.WebKitCSSMatrix?d=f.m41:c.length===16?d=parseFloat(c[12]):d=parseFloat(c[4])),i==="y"&&(a.WebKitCSSMatrix?d=f.m42:c.length===16?d=parseFloat(c[13]):d=parseFloat(c[5])),d||0}function Sm(e){return typeof e=="object"&&e!==null&&e.constructor&&Object.prototype.toString.call(e).slice(8,-1)==="Object"}function xj(e){return typeof window<"u"&&typeof window.HTMLElement<"u"?e instanceof HTMLElement:e&&(e.nodeType===1||e.nodeType===11)}function is(){const e=Object(arguments.length<=0?void 0:arguments[0]),i=["__proto__","constructor","prototype"];for(let a=1;a<arguments.length;a+=1){const c=a<0||arguments.length<=a?void 0:arguments[a];if(c!=null&&!xj(c)){const d=Object.keys(Object(c)).filter(f=>i.indexOf(f)<0);for(let f=0,y=d.length;f<y;f+=1){const s=d[f],w=Object.getOwnPropertyDescriptor(c,s);w!==void 0&&w.enumerable&&(Sm(e[s])&&Sm(c[s])?c[s].__swiper__?e[s]=c[s]:is(e[s],c[s]):!Sm(e[s])&&Sm(c[s])?(e[s]={},c[s].__swiper__?e[s]=c[s]:is(e[s],c[s])):e[s]=c[s])}}}return e}function Am(e,i,a){e.style.setProperty(i,a)}function tI(e){let{swiper:i,targetPosition:a,side:c}=e;const d=ds(),f=-i.translate;let y=null,s;const w=i.params.speed;i.wrapperEl.style.scrollSnapType="none",d.cancelAnimationFrame(i.cssModeFrameID);const C=a>f?"next":"prev",L=(R,V)=>C==="next"&&R>=V||C==="prev"&&R<=V,k=()=>{s=new Date().getTime(),y===null&&(y=s);const R=Math.max(Math.min((s-y)/w,1),0),V=.5-Math.cos(R*Math.PI)/2;let H=f+V*(a-f);if(L(H,a)&&(H=a),i.wrapperEl.scrollTo({[c]:H}),L(H,a)){i.wrapperEl.style.overflow="hidden",i.wrapperEl.style.scrollSnapType="",setTimeout(()=>{i.wrapperEl.style.overflow="",i.wrapperEl.scrollTo({[c]:H})}),d.cancelAnimationFrame(i.cssModeFrameID);return}i.cssModeFrameID=d.requestAnimationFrame(k)};k()}function _o(e,i){return i===void 0&&(i=""),[...e.children].filter(a=>a.matches(i))}function cg(e){try{console.warn(e);return}catch{}}function ug(e,i){i===void 0&&(i=[]);const a=document.createElement(e);return a.classList.add(...Array.isArray(i)?i:gj(i)),a}function bj(e,i){const a=[];for(;e.previousElementSibling;){const c=e.previousElementSibling;i?c.matches(i)&&a.push(c):a.push(c),e=c}return a}function wj(e,i){const a=[];for(;e.nextElementSibling;){const c=e.nextElementSibling;i?c.matches(i)&&a.push(c):a.push(c),e=c}return a}function Ra(e,i){return ds().getComputedStyle(e,null).getPropertyValue(i)}function hg(e){let i=e,a;if(i){for(a=0;(i=i.previousSibling)!==null;)i.nodeType===1&&(a+=1);return a}}function iI(e,i){const a=[];let c=e.parentElement;for(;c;)i?c.matches(i)&&a.push(c):a.push(c),c=c.parentElement;return a}function M0(e,i,a){const c=ds();return a?e[i==="width"?"offsetWidth":"offsetHeight"]+parseFloat(c.getComputedStyle(e,null).getPropertyValue(i==="width"?"margin-right":"margin-top"))+parseFloat(c.getComputedStyle(e,null).getPropertyValue(i==="width"?"margin-left":"margin-bottom")):e.offsetWidth}function Jn(e){return(Array.isArray(e)?e:[e]).filter(i=>!!i)}let bv;function Tj(){const e=ds(),i=Wu();return{smoothScroll:i.documentElement&&i.documentElement.style&&"scrollBehavior"in i.documentElement.style,touch:!!("ontouchstart"in e||e.DocumentTouch&&i instanceof e.DocumentTouch)}}function nI(){return bv||(bv=Tj()),bv}let wv;function Ej(e){let{userAgent:i}=e===void 0?{}:e;const a=nI(),c=ds(),d=c.navigator.platform,f=i||c.navigator.userAgent,y={ios:!1,android:!1},s=c.screen.width,w=c.screen.height,C=f.match(/(Android);?[\s\/]+([\d.]+)?/);let L=f.match(/(iPad).*OS\s([\d_]+)/);const k=f.match(/(iPod)(.*OS\s([\d_]+))?/),R=!L&&f.match(/(iPhone\sOS|iOS)\s([\d_]+)/),V=d==="Win32";let H=d==="MacIntel";const J=["1024x1366","1366x1024","834x1194","1194x834","834x1112","1112x834","768x1024","1024x768","820x1180","1180x820","810x1080","1080x810"];return!L&&H&&a.touch&&J.indexOf(`${s}x${w}`)>=0&&(L=f.match(/(Version)\/([\d.]+)/),L||(L=[0,1,"13_0_0"]),H=!1),C&&!V&&(y.os="android",y.android=!0),(L||R||k)&&(y.os="ios",y.ios=!0),y}function rI(e){return e===void 0&&(e={}),wv||(wv=Ej(e)),wv}let Tv;function Sj(){const e=ds(),i=rI();let a=!1;function c(){const s=e.navigator.userAgent.toLowerCase();return s.indexOf("safari")>=0&&s.indexOf("chrome")<0&&s.indexOf("android")<0}if(c()){const s=String(e.navigator.userAgent);if(s.includes("Version/")){const[w,C]=s.split("Version/")[1].split(" ")[0].split(".").map(L=>Number(L));a=w<16||w===16&&C<2}}const d=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(e.navigator.userAgent),f=c(),y=f||d&&i.ios;return{isSafari:a||f,needPerspectiveFix:a,need3dFix:y,isWebView:d}}function Aj(){return Tv||(Tv=Sj()),Tv}function Cj(e){let{swiper:i,on:a,emit:c}=e;const d=ds();let f=null,y=null;const s=()=>{!i||i.destroyed||!i.initialized||(c("beforeResize"),c("resize"))},w=()=>{!i||i.destroyed||!i.initialized||(f=new ResizeObserver(k=>{y=d.requestAnimationFrame(()=>{const{width:R,height:V}=i;let H=R,J=V;k.forEach(ue=>{let{contentBoxSize:j,contentRect:q,target:se}=ue;se&&se!==i.el||(H=q?q.width:(j[0]||j).inlineSize,J=q?q.height:(j[0]||j).blockSize)}),(H!==R||J!==V)&&s()})}),f.observe(i.el))},C=()=>{y&&d.cancelAnimationFrame(y),f&&f.unobserve&&i.el&&(f.unobserve(i.el),f=null)},L=()=>{!i||i.destroyed||!i.initialized||c("orientationchange")};a("init",()=>{if(i.params.resizeObserver&&typeof d.ResizeObserver<"u"){w();return}d.addEventListener("resize",s),d.addEventListener("orientationchange",L)}),a("destroy",()=>{C(),d.removeEventListener("resize",s),d.removeEventListener("orientationchange",L)})}function Mj(e){let{swiper:i,extendParams:a,on:c,emit:d}=e;const f=[],y=ds(),s=function(L,k){k===void 0&&(k={});const R=y.MutationObserver||y.WebkitMutationObserver,V=new R(H=>{if(i.__preventObserver__)return;if(H.length===1){d("observerUpdate",H[0]);return}const J=function(){d("observerUpdate",H[0])};y.requestAnimationFrame?y.requestAnimationFrame(J):y.setTimeout(J,0)});V.observe(L,{attributes:typeof k.attributes>"u"?!0:k.attributes,childList:typeof k.childList>"u"?!0:k.childList,characterData:typeof k.characterData>"u"?!0:k.characterData}),f.push(V)},w=()=>{if(!!i.params.observer){if(i.params.observeParents){const L=iI(i.hostEl);for(let k=0;k<L.length;k+=1)s(L[k])}s(i.hostEl,{childList:i.params.observeSlideChildren}),s(i.wrapperEl,{attributes:!1})}},C=()=>{f.forEach(L=>{L.disconnect()}),f.splice(0,f.length)};a({observer:!1,observeParents:!1,observeSlideChildren:!1}),c("init",w),c("destroy",C)}var Ij={on(e,i,a){const c=this;if(!c.eventsListeners||c.destroyed||typeof i!="function")return c;const d=a?"unshift":"push";return e.split(" ").forEach(f=>{c.eventsListeners[f]||(c.eventsListeners[f]=[]),c.eventsListeners[f][d](i)}),c},once(e,i,a){const c=this;if(!c.eventsListeners||c.destroyed||typeof i!="function")return c;function d(){c.off(e,d),d.__emitterProxy&&delete d.__emitterProxy;for(var f=arguments.length,y=new Array(f),s=0;s<f;s++)y[s]=arguments[s];i.apply(c,y)}return d.__emitterProxy=i,c.on(e,d,a)},onAny(e,i){const a=this;if(!a.eventsListeners||a.destroyed||typeof e!="function")return a;const c=i?"unshift":"push";return a.eventsAnyListeners.indexOf(e)<0&&a.eventsAnyListeners[c](e),a},offAny(e){const i=this;if(!i.eventsListeners||i.destroyed||!i.eventsAnyListeners)return i;const a=i.eventsAnyListeners.indexOf(e);return a>=0&&i.eventsAnyListeners.splice(a,1),i},off(e,i){const a=this;return!a.eventsListeners||a.destroyed||!a.eventsListeners||e.split(" ").forEach(c=>{typeof i>"u"?a.eventsListeners[c]=[]:a.eventsListeners[c]&&a.eventsListeners[c].forEach((d,f)=>{(d===i||d.__emitterProxy&&d.__emitterProxy===i)&&a.eventsListeners[c].splice(f,1)})}),a},emit(){const e=this;if(!e.eventsListeners||e.destroyed||!e.eventsListeners)return e;let i,a,c;for(var d=arguments.length,f=new Array(d),y=0;y<d;y++)f[y]=arguments[y];return typeof f[0]=="string"||Array.isArray(f[0])?(i=f[0],a=f.slice(1,f.length),c=e):(i=f[0].events,a=f[0].data,c=f[0].context||e),a.unshift(c),(Array.isArray(i)?i:i.split(" ")).forEach(w=>{e.eventsAnyListeners&&e.eventsAnyListeners.length&&e.eventsAnyListeners.forEach(C=>{C.apply(c,[w,...a])}),e.eventsListeners&&e.eventsListeners[w]&&e.eventsListeners[w].forEach(C=>{C.apply(c,a)})}),e}};function Pj(){const e=this;let i,a;const c=e.el;typeof e.params.width<"u"&&e.params.width!==null?i=e.params.width:i=c.clientWidth,typeof e.params.height<"u"&&e.params.height!==null?a=e.params.height:a=c.clientHeight,!(i===0&&e.isHorizontal()||a===0&&e.isVertical())&&(i=i-parseInt(Ra(c,"padding-left")||0,10)-parseInt(Ra(c,"padding-right")||0,10),a=a-parseInt(Ra(c,"padding-top")||0,10)-parseInt(Ra(c,"padding-bottom")||0,10),Number.isNaN(i)&&(i=0),Number.isNaN(a)&&(a=0),Object.assign(e,{width:i,height:a,size:e.isHorizontal()?i:a}))}function kj(){const e=this;function i(Ce,Ge){return parseFloat(Ce.getPropertyValue(e.getDirectionLabel(Ge))||0)}const a=e.params,{wrapperEl:c,slidesEl:d,size:f,rtlTranslate:y,wrongRTL:s}=e,w=e.virtual&&a.virtual.enabled,C=w?e.virtual.slides.length:e.slides.length,L=_o(d,`.${e.params.slideClass}, swiper-slide`),k=w?e.virtual.slides.length:L.length;let R=[];const V=[],H=[];let J=a.slidesOffsetBefore;typeof J=="function"&&(J=a.slidesOffsetBefore.call(e));let ue=a.slidesOffsetAfter;typeof ue=="function"&&(ue=a.slidesOffsetAfter.call(e));const j=e.snapGrid.length,q=e.slidesGrid.length;let se=a.spaceBetween,ge=-J,ie=0,Ie=0;if(typeof f>"u")return;typeof se=="string"&&se.indexOf("%")>=0?se=parseFloat(se.replace("%",""))/100*f:typeof se=="string"&&(se=parseFloat(se)),e.virtualSize=-se,L.forEach(Ce=>{y?Ce.style.marginLeft="":Ce.style.marginRight="",Ce.style.marginBottom="",Ce.style.marginTop=""}),a.centeredSlides&&a.cssMode&&(Am(c,"--swiper-centered-offset-before",""),Am(c,"--swiper-centered-offset-after",""));const ze=a.grid&&a.grid.rows>1&&e.grid;ze?e.grid.initSlides(L):e.grid&&e.grid.unsetSlides();let Ae;const He=a.slidesPerView==="auto"&&a.breakpoints&&Object.keys(a.breakpoints).filter(Ce=>typeof a.breakpoints[Ce].slidesPerView<"u").length>0;for(let Ce=0;Ce<k;Ce+=1){Ae=0;let Ge;if(L[Ce]&&(Ge=L[Ce]),ze&&e.grid.updateSlide(Ce,Ge,L),!(L[Ce]&&Ra(Ge,"display")==="none")){if(a.slidesPerView==="auto"){He&&(L[Ce].style[e.getDirectionLabel("width")]="");const De=getComputedStyle(Ge),We=Ge.style.transform,et=Ge.style.webkitTransform;if(We&&(Ge.style.transform="none"),et&&(Ge.style.webkitTransform="none"),a.roundLengths)Ae=e.isHorizontal()?M0(Ge,"width",!0):M0(Ge,"height",!0);else{const Gt=i(De,"width"),Vt=i(De,"padding-left"),fi=i(De,"padding-right"),Yt=i(De,"margin-left"),_i=i(De,"margin-right"),tn=De.getPropertyValue("box-sizing");if(tn&&tn==="border-box")Ae=Gt+Yt+_i;else{const{clientWidth:Mi,offsetWidth:yi}=Ge;Ae=Gt+Vt+fi+Yt+_i+(yi-Mi)}}We&&(Ge.style.transform=We),et&&(Ge.style.webkitTransform=et),a.roundLengths&&(Ae=Math.floor(Ae))}else Ae=(f-(a.slidesPerView-1)*se)/a.slidesPerView,a.roundLengths&&(Ae=Math.floor(Ae)),L[Ce]&&(L[Ce].style[e.getDirectionLabel("width")]=`${Ae}px`);L[Ce]&&(L[Ce].swiperSlideSize=Ae),H.push(Ae),a.centeredSlides?(ge=ge+Ae/2+ie/2+se,ie===0&&Ce!==0&&(ge=ge-f/2-se),Ce===0&&(ge=ge-f/2-se),Math.abs(ge)<1/1e3&&(ge=0),a.roundLengths&&(ge=Math.floor(ge)),Ie%a.slidesPerGroup===0&&R.push(ge),V.push(ge)):(a.roundLengths&&(ge=Math.floor(ge)),(Ie-Math.min(e.params.slidesPerGroupSkip,Ie))%e.params.slidesPerGroup===0&&R.push(ge),V.push(ge),ge=ge+Ae+se),e.virtualSize+=Ae+se,ie=Ae,Ie+=1}}if(e.virtualSize=Math.max(e.virtualSize,f)+ue,y&&s&&(a.effect==="slide"||a.effect==="coverflow")&&(c.style.width=`${e.virtualSize+se}px`),a.setWrapperSize&&(c.style[e.getDirectionLabel("width")]=`${e.virtualSize+se}px`),ze&&e.grid.updateWrapperSize(Ae,R),!a.centeredSlides){const Ce=[];for(let Ge=0;Ge<R.length;Ge+=1){let De=R[Ge];a.roundLengths&&(De=Math.floor(De)),R[Ge]<=e.virtualSize-f&&Ce.push(De)}R=Ce,Math.floor(e.virtualSize-f)-Math.floor(R[R.length-1])>1&&R.push(e.virtualSize-f)}if(w&&a.loop){const Ce=H[0]+se;if(a.slidesPerGroup>1){const Ge=Math.ceil((e.virtual.slidesBefore+e.virtual.slidesAfter)/a.slidesPerGroup),De=Ce*a.slidesPerGroup;for(let We=0;We<Ge;We+=1)R.push(R[R.length-1]+De)}for(let Ge=0;Ge<e.virtual.slidesBefore+e.virtual.slidesAfter;Ge+=1)a.slidesPerGroup===1&&R.push(R[R.length-1]+Ce),V.push(V[V.length-1]+Ce),e.virtualSize+=Ce}if(R.length===0&&(R=[0]),se!==0){const Ce=e.isHorizontal()&&y?"marginLeft":e.getDirectionLabel("marginRight");L.filter((Ge,De)=>!a.cssMode||a.loop?!0:De!==L.length-1).forEach(Ge=>{Ge.style[Ce]=`${se}px`})}if(a.centeredSlides&&a.centeredSlidesBounds){let Ce=0;H.forEach(De=>{Ce+=De+(se||0)}),Ce-=se;const Ge=Ce-f;R=R.map(De=>De<=0?-J:De>Ge?Ge+ue:De)}if(a.centerInsufficientSlides){let Ce=0;if(H.forEach(Ge=>{Ce+=Ge+(se||0)}),Ce-=se,Ce<f){const Ge=(f-Ce)/2;R.forEach((De,We)=>{R[We]=De-Ge}),V.forEach((De,We)=>{V[We]=De+Ge})}}if(Object.assign(e,{slides:L,snapGrid:R,slidesGrid:V,slidesSizesGrid:H}),a.centeredSlides&&a.cssMode&&!a.centeredSlidesBounds){Am(c,"--swiper-centered-offset-before",`${-R[0]}px`),Am(c,"--swiper-centered-offset-after",`${e.size/2-H[H.length-1]/2}px`);const Ce=-e.snapGrid[0],Ge=-e.slidesGrid[0];e.snapGrid=e.snapGrid.map(De=>De+Ce),e.slidesGrid=e.slidesGrid.map(De=>De+Ge)}if(k!==C&&e.emit("slidesLengthChange"),R.length!==j&&(e.params.watchOverflow&&e.checkOverflow(),e.emit("snapGridLengthChange")),V.length!==q&&e.emit("slidesGridLengthChange"),a.watchSlidesProgress&&e.updateSlidesOffset(),e.emit("slidesUpdated"),!w&&!a.cssMode&&(a.effect==="slide"||a.effect==="fade")){const Ce=`${a.containerModifierClass}backface-hidden`,Ge=e.el.classList.contains(Ce);k<=a.maxBackfaceHiddenSlides?Ge||e.el.classList.add(Ce):Ge&&e.el.classList.remove(Ce)}}function Lj(e){const i=this,a=[],c=i.virtual&&i.params.virtual.enabled;let d=0,f;typeof e=="number"?i.setTransition(e):e===!0&&i.setTransition(i.params.speed);const y=s=>c?i.slides[i.getSlideIndexByData(s)]:i.slides[s];if(i.params.slidesPerView!=="auto"&&i.params.slidesPerView>1)if(i.params.centeredSlides)(i.visibleSlides||[]).forEach(s=>{a.push(s)});else for(f=0;f<Math.ceil(i.params.slidesPerView);f+=1){const s=i.activeIndex+f;if(s>i.slides.length&&!c)break;a.push(y(s))}else a.push(y(i.activeIndex));for(f=0;f<a.length;f+=1)if(typeof a[f]<"u"){const s=a[f].offsetHeight;d=s>d?s:d}(d||d===0)&&(i.wrapperEl.style.height=`${d}px`)}function zj(){const e=this,i=e.slides,a=e.isElement?e.isHorizontal()?e.wrapperEl.offsetLeft:e.wrapperEl.offsetTop:0;for(let c=0;c<i.length;c+=1)i[c].swiperSlideOffset=(e.isHorizontal()?i[c].offsetLeft:i[c].offsetTop)-a-e.cssOverflowAdjustment()}function Rj(e){e===void 0&&(e=this&&this.translate||0);const i=this,a=i.params,{slides:c,rtlTranslate:d,snapGrid:f}=i;if(c.length===0)return;typeof c[0].swiperSlideOffset>"u"&&i.updateSlidesOffset();let y=-e;d&&(y=e),c.forEach(w=>{w.classList.remove(a.slideVisibleClass,a.slideFullyVisibleClass)}),i.visibleSlidesIndexes=[],i.visibleSlides=[];let s=a.spaceBetween;typeof s=="string"&&s.indexOf("%")>=0?s=parseFloat(s.replace("%",""))/100*i.size:typeof s=="string"&&(s=parseFloat(s));for(let w=0;w<c.length;w+=1){const C=c[w];let L=C.swiperSlideOffset;a.cssMode&&a.centeredSlides&&(L-=c[0].swiperSlideOffset);const k=(y+(a.centeredSlides?i.minTranslate():0)-L)/(C.swiperSlideSize+s),R=(y-f[0]+(a.centeredSlides?i.minTranslate():0)-L)/(C.swiperSlideSize+s),V=-(y-L),H=V+i.slidesSizesGrid[w],J=V>=0&&V<=i.size-i.slidesSizesGrid[w];(V>=0&&V<i.size-1||H>1&&H<=i.size||V<=0&&H>=i.size)&&(i.visibleSlides.push(C),i.visibleSlidesIndexes.push(w),c[w].classList.add(a.slideVisibleClass)),J&&c[w].classList.add(a.slideFullyVisibleClass),C.progress=d?-k:k,C.originalProgress=d?-R:R}}function Dj(e){const i=this;if(typeof e>"u"){const L=i.rtlTranslate?-1:1;e=i&&i.translate&&i.translate*L||0}const a=i.params,c=i.maxTranslate()-i.minTranslate();let{progress:d,isBeginning:f,isEnd:y,progressLoop:s}=i;const w=f,C=y;if(c===0)d=0,f=!0,y=!0;else{d=(e-i.minTranslate())/c;const L=Math.abs(e-i.minTranslate())<1,k=Math.abs(e-i.maxTranslate())<1;f=L||d<=0,y=k||d>=1,L&&(d=0),k&&(d=1)}if(a.loop){const L=i.getSlideIndexByData(0),k=i.getSlideIndexByData(i.slides.length-1),R=i.slidesGrid[L],V=i.slidesGrid[k],H=i.slidesGrid[i.slidesGrid.length-1],J=Math.abs(e);J>=R?s=(J-R)/H:s=(J+H-V)/H,s>1&&(s-=1)}Object.assign(i,{progress:d,progressLoop:s,isBeginning:f,isEnd:y}),(a.watchSlidesProgress||a.centeredSlides&&a.autoHeight)&&i.updateSlidesProgress(e),f&&!w&&i.emit("reachBeginning toEdge"),y&&!C&&i.emit("reachEnd toEdge"),(w&&!f||C&&!y)&&i.emit("fromEdge"),i.emit("progress",d)}const Ev=(e,i,a)=>{i&&!e.classList.contains(a)?e.classList.add(a):!i&&e.classList.contains(a)&&e.classList.remove(a)};function Oj(){const e=this,{slides:i,params:a,slidesEl:c,activeIndex:d}=e,f=e.virtual&&a.virtual.enabled,y=e.grid&&a.grid&&a.grid.rows>1,s=k=>_o(c,`.${a.slideClass}${k}, swiper-slide${k}`)[0];let w,C,L;if(f)if(a.loop){let k=d-e.virtual.slidesBefore;k<0&&(k=e.virtual.slides.length+k),k>=e.virtual.slides.length&&(k-=e.virtual.slides.length),w=s(`[data-swiper-slide-index="${k}"]`)}else w=s(`[data-swiper-slide-index="${d}"]`);else y?(w=i.filter(k=>k.column===d)[0],L=i.filter(k=>k.column===d+1)[0],C=i.filter(k=>k.column===d-1)[0]):w=i[d];w&&(y||(L=wj(w,`.${a.slideClass}, swiper-slide`)[0],a.loop&&!L&&(L=i[0]),C=bj(w,`.${a.slideClass}, swiper-slide`)[0],a.loop&&!C===0&&(C=i[i.length-1]))),i.forEach(k=>{Ev(k,k===w,a.slideActiveClass),Ev(k,k===L,a.slideNextClass),Ev(k,k===C,a.slidePrevClass)}),e.emitSlidesClasses()}const Dm=(e,i)=>{if(!e||e.destroyed||!e.params)return;const a=()=>e.isElement?"swiper-slide":`.${e.params.slideClass}`,c=i.closest(a());if(c){let d=c.querySelector(`.${e.params.lazyPreloaderClass}`);!d&&e.isElement&&(c.shadowRoot?d=c.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`):requestAnimationFrame(()=>{c.shadowRoot&&(d=c.shadowRoot.querySelector(`.${e.params.lazyPreloaderClass}`),d&&d.remove())})),d&&d.remove()}},Sv=(e,i)=>{if(!e.slides[i])return;const a=e.slides[i].querySelector('[loading="lazy"]');a&&a.removeAttribute("loading")},I0=e=>{if(!e||e.destroyed||!e.params)return;let i=e.params.lazyPreloadPrevNext;const a=e.slides.length;if(!a||!i||i<0)return;i=Math.min(i,a);const c=e.params.slidesPerView==="auto"?e.slidesPerViewDynamic():Math.ceil(e.params.slidesPerView),d=e.activeIndex;if(e.params.grid&&e.params.grid.rows>1){const y=d,s=[y-i];s.push(...Array.from({length:i}).map((w,C)=>y+c+C)),e.slides.forEach((w,C)=>{s.includes(w.column)&&Sv(e,C)});return}const f=d+c-1;if(e.params.rewind||e.params.loop)for(let y=d-i;y<=f+i;y+=1){const s=(y%a+a)%a;(s<d||s>f)&&Sv(e,s)}else for(let y=Math.max(d-i,0);y<=Math.min(f+i,a-1);y+=1)y!==d&&(y>f||y<d)&&Sv(e,y)};function Fj(e){const{slidesGrid:i,params:a}=e,c=e.rtlTranslate?e.translate:-e.translate;let d;for(let f=0;f<i.length;f+=1)typeof i[f+1]<"u"?c>=i[f]&&c<i[f+1]-(i[f+1]-i[f])/2?d=f:c>=i[f]&&c<i[f+1]&&(d=f+1):c>=i[f]&&(d=f);return a.normalizeSlideIndex&&(d<0||typeof d>"u")&&(d=0),d}function Bj(e){const i=this,a=i.rtlTranslate?i.translate:-i.translate,{snapGrid:c,params:d,activeIndex:f,realIndex:y,snapIndex:s}=i;let w=e,C;const L=V=>{let H=V-i.virtual.slidesBefore;return H<0&&(H=i.virtual.slides.length+H),H>=i.virtual.slides.length&&(H-=i.virtual.slides.length),H};if(typeof w>"u"&&(w=Fj(i)),c.indexOf(a)>=0)C=c.indexOf(a);else{const V=Math.min(d.slidesPerGroupSkip,w);C=V+Math.floor((w-V)/d.slidesPerGroup)}if(C>=c.length&&(C=c.length-1),w===f&&!i.params.loop){C!==s&&(i.snapIndex=C,i.emit("snapIndexChange"));return}if(w===f&&i.params.loop&&i.virtual&&i.params.virtual.enabled){i.realIndex=L(w);return}const k=i.grid&&d.grid&&d.grid.rows>1;let R;if(i.virtual&&d.virtual.enabled&&d.loop)R=L(w);else if(k){const V=i.slides.filter(J=>J.column===w)[0];let H=parseInt(V.getAttribute("data-swiper-slide-index"),10);Number.isNaN(H)&&(H=Math.max(i.slides.indexOf(V),0)),R=Math.floor(H/d.grid.rows)}else if(i.slides[w]){const V=i.slides[w].getAttribute("data-swiper-slide-index");V?R=parseInt(V,10):R=w}else R=w;Object.assign(i,{previousSnapIndex:s,snapIndex:C,previousRealIndex:y,realIndex:R,previousIndex:f,activeIndex:w}),i.initialized&&I0(i),i.emit("activeIndexChange"),i.emit("snapIndexChange"),(i.initialized||i.params.runCallbacksOnInit)&&(y!==R&&i.emit("realIndexChange"),i.emit("slideChange"))}function Nj(e,i){const a=this,c=a.params;let d=e.closest(`.${c.slideClass}, swiper-slide`);!d&&a.isElement&&i&&i.length>1&&i.includes(e)&&[...i.slice(i.indexOf(e)+1,i.length)].forEach(s=>{!d&&s.matches&&s.matches(`.${c.slideClass}, swiper-slide`)&&(d=s)});let f=!1,y;if(d){for(let s=0;s<a.slides.length;s+=1)if(a.slides[s]===d){f=!0,y=s;break}}if(d&&f)a.clickedSlide=d,a.virtual&&a.params.virtual.enabled?a.clickedIndex=parseInt(d.getAttribute("data-swiper-slide-index"),10):a.clickedIndex=y;else{a.clickedSlide=void 0,a.clickedIndex=void 0;return}c.slideToClickedSlide&&a.clickedIndex!==void 0&&a.clickedIndex!==a.activeIndex&&a.slideToClickedSlide()}var Uj={updateSize:Pj,updateSlides:kj,updateAutoHeight:Lj,updateSlidesOffset:zj,updateSlidesProgress:Rj,updateProgress:Dj,updateSlidesClasses:Oj,updateActiveIndex:Bj,updateClickedSlide:Nj};function Vj(e){e===void 0&&(e=this.isHorizontal()?"x":"y");const i=this,{params:a,rtlTranslate:c,translate:d,wrapperEl:f}=i;if(a.virtualTranslate)return c?-d:d;if(a.cssMode)return d;let y=vj(f,e);return y+=i.cssOverflowAdjustment(),c&&(y=-y),y||0}function $j(e,i){const a=this,{rtlTranslate:c,params:d,wrapperEl:f,progress:y}=a;let s=0,w=0;const C=0;a.isHorizontal()?s=c?-e:e:w=e,d.roundLengths&&(s=Math.floor(s),w=Math.floor(w)),a.previousTranslate=a.translate,a.translate=a.isHorizontal()?s:w,d.cssMode?f[a.isHorizontal()?"scrollLeft":"scrollTop"]=a.isHorizontal()?-s:-w:d.virtualTranslate||(a.isHorizontal()?s-=a.cssOverflowAdjustment():w-=a.cssOverflowAdjustment(),f.style.transform=`translate3d(${s}px, ${w}px, ${C}px)`);let L;const k=a.maxTranslate()-a.minTranslate();k===0?L=0:L=(e-a.minTranslate())/k,L!==y&&a.updateProgress(e),a.emit("setTranslate",a.translate,i)}function jj(){return-this.snapGrid[0]}function Gj(){return-this.snapGrid[this.snapGrid.length-1]}function qj(e,i,a,c,d){e===void 0&&(e=0),i===void 0&&(i=this.params.speed),a===void 0&&(a=!0),c===void 0&&(c=!0);const f=this,{params:y,wrapperEl:s}=f;if(f.animating&&y.preventInteractionOnTransition)return!1;const w=f.minTranslate(),C=f.maxTranslate();let L;if(c&&e>w?L=w:c&&e<C?L=C:L=e,f.updateProgress(L),y.cssMode){const k=f.isHorizontal();if(i===0)s[k?"scrollLeft":"scrollTop"]=-L;else{if(!f.support.smoothScroll)return tI({swiper:f,targetPosition:-L,side:k?"left":"top"}),!0;s.scrollTo({[k?"left":"top"]:-L,behavior:"smooth"})}return!0}return i===0?(f.setTransition(0),f.setTranslate(L),a&&(f.emit("beforeTransitionStart",i,d),f.emit("transitionEnd"))):(f.setTransition(i),f.setTranslate(L),a&&(f.emit("beforeTransitionStart",i,d),f.emit("transitionStart")),f.animating||(f.animating=!0,f.onTranslateToWrapperTransitionEnd||(f.onTranslateToWrapperTransitionEnd=function(R){!f||f.destroyed||R.target===this&&(f.wrapperEl.removeEventListener("transitionend",f.onTranslateToWrapperTransitionEnd),f.onTranslateToWrapperTransitionEnd=null,delete f.onTranslateToWrapperTransitionEnd,f.animating=!1,a&&f.emit("transitionEnd"))}),f.wrapperEl.addEventListener("transitionend",f.onTranslateToWrapperTransitionEnd))),!0}var Wj={getTranslate:Vj,setTranslate:$j,minTranslate:jj,maxTranslate:Gj,translateTo:qj};function Hj(e,i){const a=this;a.params.cssMode||(a.wrapperEl.style.transitionDuration=`${e}ms`,a.wrapperEl.style.transitionDelay=e===0?"0ms":""),a.emit("setTransition",e,i)}function sI(e){let{swiper:i,runCallbacks:a,direction:c,step:d}=e;const{activeIndex:f,previousIndex:y}=i;let s=c;if(s||(f>y?s="next":f<y?s="prev":s="reset"),i.emit(`transition${d}`),a&&f!==y){if(s==="reset"){i.emit(`slideResetTransition${d}`);return}i.emit(`slideChangeTransition${d}`),s==="next"?i.emit(`slideNextTransition${d}`):i.emit(`slidePrevTransition${d}`)}}function Zj(e,i){e===void 0&&(e=!0);const a=this,{params:c}=a;c.cssMode||(c.autoHeight&&a.updateAutoHeight(),sI({swiper:a,runCallbacks:e,direction:i,step:"Start"}))}function Xj(e,i){e===void 0&&(e=!0);const a=this,{params:c}=a;a.animating=!1,!c.cssMode&&(a.setTransition(0),sI({swiper:a,runCallbacks:e,direction:i,step:"End"}))}var Kj={setTransition:Hj,transitionStart:Zj,transitionEnd:Xj};function Yj(e,i,a,c,d){e===void 0&&(e=0),a===void 0&&(a=!0),typeof e=="string"&&(e=parseInt(e,10));const f=this;let y=e;y<0&&(y=0);const{params:s,snapGrid:w,slidesGrid:C,previousIndex:L,activeIndex:k,rtlTranslate:R,wrapperEl:V,enabled:H}=f;if(!H&&!c&&!d||f.destroyed||f.animating&&s.preventInteractionOnTransition)return!1;typeof i>"u"&&(i=f.params.speed);const J=Math.min(f.params.slidesPerGroupSkip,y);let ue=J+Math.floor((y-J)/f.params.slidesPerGroup);ue>=w.length&&(ue=w.length-1);const j=-w[ue];if(s.normalizeSlideIndex)for(let se=0;se<C.length;se+=1){const ge=-Math.floor(j*100),ie=Math.floor(C[se]*100),Ie=Math.floor(C[se+1]*100);typeof C[se+1]<"u"?ge>=ie&&ge<Ie-(Ie-ie)/2?y=se:ge>=ie&&ge<Ie&&(y=se+1):ge>=ie&&(y=se)}if(f.initialized&&y!==k&&(!f.allowSlideNext&&(R?j>f.translate&&j>f.minTranslate():j<f.translate&&j<f.minTranslate())||!f.allowSlidePrev&&j>f.translate&&j>f.maxTranslate()&&(k||0)!==y))return!1;y!==(L||0)&&a&&f.emit("beforeSlideChangeStart"),f.updateProgress(j);let q;if(y>k?q="next":y<k?q="prev":q="reset",R&&-j===f.translate||!R&&j===f.translate)return f.updateActiveIndex(y),s.autoHeight&&f.updateAutoHeight(),f.updateSlidesClasses(),s.effect!=="slide"&&f.setTranslate(j),q!=="reset"&&(f.transitionStart(a,q),f.transitionEnd(a,q)),!1;if(s.cssMode){const se=f.isHorizontal(),ge=R?j:-j;if(i===0){const ie=f.virtual&&f.params.virtual.enabled;ie&&(f.wrapperEl.style.scrollSnapType="none",f._immediateVirtual=!0),ie&&!f._cssModeVirtualInitialSet&&f.params.initialSlide>0?(f._cssModeVirtualInitialSet=!0,requestAnimationFrame(()=>{V[se?"scrollLeft":"scrollTop"]=ge})):V[se?"scrollLeft":"scrollTop"]=ge,ie&&requestAnimationFrame(()=>{f.wrapperEl.style.scrollSnapType="",f._immediateVirtual=!1})}else{if(!f.support.smoothScroll)return tI({swiper:f,targetPosition:ge,side:se?"left":"top"}),!0;V.scrollTo({[se?"left":"top"]:ge,behavior:"smooth"})}return!0}return f.setTransition(i),f.setTranslate(j),f.updateActiveIndex(y),f.updateSlidesClasses(),f.emit("beforeTransitionStart",i,c),f.transitionStart(a,q),i===0?f.transitionEnd(a,q):f.animating||(f.animating=!0,f.onSlideToWrapperTransitionEnd||(f.onSlideToWrapperTransitionEnd=function(ge){!f||f.destroyed||ge.target===this&&(f.wrapperEl.removeEventListener("transitionend",f.onSlideToWrapperTransitionEnd),f.onSlideToWrapperTransitionEnd=null,delete f.onSlideToWrapperTransitionEnd,f.transitionEnd(a,q))}),f.wrapperEl.addEventListener("transitionend",f.onSlideToWrapperTransitionEnd)),!0}function Qj(e,i,a,c){e===void 0&&(e=0),a===void 0&&(a=!0),typeof e=="string"&&(e=parseInt(e,10));const d=this;if(d.destroyed)return;typeof i>"u"&&(i=d.params.speed);const f=d.grid&&d.params.grid&&d.params.grid.rows>1;let y=e;if(d.params.loop)if(d.virtual&&d.params.virtual.enabled)y=y+d.virtual.slidesBefore;else{let s;if(f){const R=y*d.params.grid.rows;s=d.slides.filter(V=>V.getAttribute("data-swiper-slide-index")*1===R)[0].column}else s=d.getSlideIndexByData(y);const w=f?Math.ceil(d.slides.length/d.params.grid.rows):d.slides.length,{centeredSlides:C}=d.params;let L=d.params.slidesPerView;L==="auto"?L=d.slidesPerViewDynamic():(L=Math.ceil(parseFloat(d.params.slidesPerView,10)),C&&L%2===0&&(L=L+1));let k=w-s<L;if(C&&(k=k||s<Math.ceil(L/2)),c&&C&&d.params.slidesPerView!=="auto"&&!f&&(k=!1),k){const R=C?s<d.activeIndex?"prev":"next":s-d.activeIndex-1<d.params.slidesPerView?"next":"prev";d.loopFix({direction:R,slideTo:!0,activeSlideIndex:R==="next"?s+1:s-w+1,slideRealIndex:R==="next"?d.realIndex:void 0})}if(f){const R=y*d.params.grid.rows;y=d.slides.filter(V=>V.getAttribute("data-swiper-slide-index")*1===R)[0].column}else y=d.getSlideIndexByData(y)}return requestAnimationFrame(()=>{d.slideTo(y,i,a,c)}),d}function Jj(e,i,a){i===void 0&&(i=!0);const c=this,{enabled:d,params:f,animating:y}=c;if(!d||c.destroyed)return c;typeof e>"u"&&(e=c.params.speed);let s=f.slidesPerGroup;f.slidesPerView==="auto"&&f.slidesPerGroup===1&&f.slidesPerGroupAuto&&(s=Math.max(c.slidesPerViewDynamic("current",!0),1));const w=c.activeIndex<f.slidesPerGroupSkip?1:s,C=c.virtual&&f.virtual.enabled;if(f.loop){if(y&&!C&&f.loopPreventsSliding)return!1;if(c.loopFix({direction:"next"}),c._clientLeft=c.wrapperEl.clientLeft,c.activeIndex===c.slides.length-1&&f.cssMode)return requestAnimationFrame(()=>{c.slideTo(c.activeIndex+w,e,i,a)}),!0}return f.rewind&&c.isEnd?c.slideTo(0,e,i,a):c.slideTo(c.activeIndex+w,e,i,a)}function eG(e,i,a){i===void 0&&(i=!0);const c=this,{params:d,snapGrid:f,slidesGrid:y,rtlTranslate:s,enabled:w,animating:C}=c;if(!w||c.destroyed)return c;typeof e>"u"&&(e=c.params.speed);const L=c.virtual&&d.virtual.enabled;if(d.loop){if(C&&!L&&d.loopPreventsSliding)return!1;c.loopFix({direction:"prev"}),c._clientLeft=c.wrapperEl.clientLeft}const k=s?c.translate:-c.translate;function R(j){return j<0?-Math.floor(Math.abs(j)):Math.floor(j)}const V=R(k),H=f.map(j=>R(j));let J=f[H.indexOf(V)-1];if(typeof J>"u"&&d.cssMode){let j;f.forEach((q,se)=>{V>=q&&(j=se)}),typeof j<"u"&&(J=f[j>0?j-1:j])}let ue=0;if(typeof J<"u"&&(ue=y.indexOf(J),ue<0&&(ue=c.activeIndex-1),d.slidesPerView==="auto"&&d.slidesPerGroup===1&&d.slidesPerGroupAuto&&(ue=ue-c.slidesPerViewDynamic("previous",!0)+1,ue=Math.max(ue,0))),d.rewind&&c.isBeginning){const j=c.params.virtual&&c.params.virtual.enabled&&c.virtual?c.virtual.slides.length-1:c.slides.length-1;return c.slideTo(j,e,i,a)}else if(d.loop&&c.activeIndex===0&&d.cssMode)return requestAnimationFrame(()=>{c.slideTo(ue,e,i,a)}),!0;return c.slideTo(ue,e,i,a)}function tG(e,i,a){i===void 0&&(i=!0);const c=this;if(!c.destroyed)return typeof e>"u"&&(e=c.params.speed),c.slideTo(c.activeIndex,e,i,a)}function iG(e,i,a,c){i===void 0&&(i=!0),c===void 0&&(c=.5);const d=this;if(d.destroyed)return;typeof e>"u"&&(e=d.params.speed);let f=d.activeIndex;const y=Math.min(d.params.slidesPerGroupSkip,f),s=y+Math.floor((f-y)/d.params.slidesPerGroup),w=d.rtlTranslate?d.translate:-d.translate;if(w>=d.snapGrid[s]){const C=d.snapGrid[s],L=d.snapGrid[s+1];w-C>(L-C)*c&&(f+=d.params.slidesPerGroup)}else{const C=d.snapGrid[s-1],L=d.snapGrid[s];w-C<=(L-C)*c&&(f-=d.params.slidesPerGroup)}return f=Math.max(f,0),f=Math.min(f,d.slidesGrid.length-1),d.slideTo(f,e,i,a)}function nG(){const e=this;if(e.destroyed)return;const{params:i,slidesEl:a}=e,c=i.slidesPerView==="auto"?e.slidesPerViewDynamic():i.slidesPerView;let d=e.clickedIndex,f;const y=e.isElement?"swiper-slide":`.${i.slideClass}`;if(i.loop){if(e.animating)return;f=parseInt(e.clickedSlide.getAttribute("data-swiper-slide-index"),10),i.centeredSlides?d<e.loopedSlides-c/2||d>e.slides.length-e.loopedSlides+c/2?(e.loopFix(),d=e.getSlideIndex(_o(a,`${y}[data-swiper-slide-index="${f}"]`)[0]),C0(()=>{e.slideTo(d)})):e.slideTo(d):d>e.slides.length-c?(e.loopFix(),d=e.getSlideIndex(_o(a,`${y}[data-swiper-slide-index="${f}"]`)[0]),C0(()=>{e.slideTo(d)})):e.slideTo(d)}else e.slideTo(d)}var rG={slideTo:Yj,slideToLoop:Qj,slideNext:Jj,slidePrev:eG,slideReset:tG,slideToClosest:iG,slideToClickedSlide:nG};function sG(e){const i=this,{params:a,slidesEl:c}=i;if(!a.loop||i.virtual&&i.params.virtual.enabled)return;const d=()=>{_o(c,`.${a.slideClass}, swiper-slide`).forEach((k,R)=>{k.setAttribute("data-swiper-slide-index",R)})},f=i.grid&&a.grid&&a.grid.rows>1,y=a.slidesPerGroup*(f?a.grid.rows:1),s=i.slides.length%y!==0,w=f&&i.slides.length%a.grid.rows!==0,C=L=>{for(let k=0;k<L;k+=1){const R=i.isElement?ug("swiper-slide",[a.slideBlankClass]):ug("div",[a.slideClass,a.slideBlankClass]);i.slidesEl.append(R)}};if(s){if(a.loopAddBlankSlides){const L=y-i.slides.length%y;C(L),i.recalcSlides(),i.updateSlides()}else cg("Swiper Loop Warning: The number of slides is not even to slidesPerGroup, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");d()}else if(w){if(a.loopAddBlankSlides){const L=a.grid.rows-i.slides.length%a.grid.rows;C(L),i.recalcSlides(),i.updateSlides()}else cg("Swiper Loop Warning: The number of slides is not even to grid.rows, loop mode may not function properly. You need to add more slides (or make duplicates, or empty slides)");d()}else d();i.loopFix({slideRealIndex:e,direction:a.centeredSlides?void 0:"next"})}function oG(e){let{slideRealIndex:i,slideTo:a=!0,direction:c,setTranslate:d,activeSlideIndex:f,byController:y,byMousewheel:s}=e===void 0?{}:e;const w=this;if(!w.params.loop)return;w.emit("beforeLoopFix");const{slides:C,allowSlidePrev:L,allowSlideNext:k,slidesEl:R,params:V}=w,{centeredSlides:H}=V;if(w.allowSlidePrev=!0,w.allowSlideNext=!0,w.virtual&&V.virtual.enabled){a&&(!V.centeredSlides&&w.snapIndex===0?w.slideTo(w.virtual.slides.length,0,!1,!0):V.centeredSlides&&w.snapIndex<V.slidesPerView?w.slideTo(w.virtual.slides.length+w.snapIndex,0,!1,!0):w.snapIndex===w.snapGrid.length-1&&w.slideTo(w.virtual.slidesBefore,0,!1,!0)),w.allowSlidePrev=L,w.allowSlideNext=k,w.emit("loopFix");return}let J=V.slidesPerView;J==="auto"?J=w.slidesPerViewDynamic():(J=Math.ceil(parseFloat(V.slidesPerView,10)),H&&J%2===0&&(J=J+1));const ue=V.slidesPerGroupAuto?J:V.slidesPerGroup;let j=ue;j%ue!==0&&(j+=ue-j%ue),j+=V.loopAdditionalSlides,w.loopedSlides=j;const q=w.grid&&V.grid&&V.grid.rows>1;C.length<J+j?cg("Swiper Loop Warning: The number of slides is not enough for loop mode, it will be disabled and not function properly. You need to add more slides (or make duplicates) or lower the values of slidesPerView and slidesPerGroup parameters"):q&&V.grid.fill==="row"&&cg("Swiper Loop Warning: Loop mode is not compatible with grid.fill = `row`");const se=[],ge=[];let ie=w.activeIndex;typeof f>"u"?f=w.getSlideIndex(C.filter(We=>We.classList.contains(V.slideActiveClass))[0]):ie=f;const Ie=c==="next"||!c,ze=c==="prev"||!c;let Ae=0,He=0;const Ce=q?Math.ceil(C.length/V.grid.rows):C.length,De=(q?C[f].column:f)+(H&&typeof d>"u"?-J/2+.5:0);if(De<j){Ae=Math.max(j-De,ue);for(let We=0;We<j-De;We+=1){const et=We-Math.floor(We/Ce)*Ce;if(q){const Gt=Ce-et-1;for(let Vt=C.length-1;Vt>=0;Vt-=1)C[Vt].column===Gt&&se.push(Vt)}else se.push(Ce-et-1)}}else if(De+J>Ce-j){He=Math.max(De-(Ce-j*2),ue);for(let We=0;We<He;We+=1){const et=We-Math.floor(We/Ce)*Ce;q?C.forEach((Gt,Vt)=>{Gt.column===et&&ge.push(Vt)}):ge.push(et)}}if(w.__preventObserver__=!0,requestAnimationFrame(()=>{w.__preventObserver__=!1}),ze&&se.forEach(We=>{C[We].swiperLoopMoveDOM=!0,R.prepend(C[We]),C[We].swiperLoopMoveDOM=!1}),Ie&&ge.forEach(We=>{C[We].swiperLoopMoveDOM=!0,R.append(C[We]),C[We].swiperLoopMoveDOM=!1}),w.recalcSlides(),V.slidesPerView==="auto"?w.updateSlides():q&&(se.length>0&&ze||ge.length>0&&Ie)&&w.slides.forEach((We,et)=>{w.grid.updateSlide(et,We,w.slides)}),V.watchSlidesProgress&&w.updateSlidesOffset(),a){if(se.length>0&&ze){if(typeof i>"u"){const We=w.slidesGrid[ie],Gt=w.slidesGrid[ie+Ae]-We;s?w.setTranslate(w.translate-Gt):(w.slideTo(ie+Math.ceil(Ae),0,!1,!0),d&&(w.touchEventsData.startTranslate=w.touchEventsData.startTranslate-Gt,w.touchEventsData.currentTranslate=w.touchEventsData.currentTranslate-Gt))}else if(d){const We=q?se.length/V.grid.rows:se.length;w.slideTo(w.activeIndex+We,0,!1,!0),w.touchEventsData.currentTranslate=w.translate}}else if(ge.length>0&&Ie)if(typeof i>"u"){const We=w.slidesGrid[ie],Gt=w.slidesGrid[ie-He]-We;s?w.setTranslate(w.translate-Gt):(w.slideTo(ie-He,0,!1,!0),d&&(w.touchEventsData.startTranslate=w.touchEventsData.startTranslate-Gt,w.touchEventsData.currentTranslate=w.touchEventsData.currentTranslate-Gt))}else{const We=q?ge.length/V.grid.rows:ge.length;w.slideTo(w.activeIndex-We,0,!1,!0)}}if(w.allowSlidePrev=L,w.allowSlideNext=k,w.controller&&w.controller.control&&!y){const We={slideRealIndex:i,direction:c,setTranslate:d,activeSlideIndex:f,byController:!0};Array.isArray(w.controller.control)?w.controller.control.forEach(et=>{!et.destroyed&&et.params.loop&&et.loopFix({...We,slideTo:et.params.slidesPerView===V.slidesPerView?a:!1})}):w.controller.control instanceof w.constructor&&w.controller.control.params.loop&&w.controller.control.loopFix({...We,slideTo:w.controller.control.params.slidesPerView===V.slidesPerView?a:!1})}w.emit("loopFix")}function aG(){const e=this,{params:i,slidesEl:a}=e;if(!i.loop||e.virtual&&e.params.virtual.enabled)return;e.recalcSlides();const c=[];e.slides.forEach(d=>{const f=typeof d.swiperSlideIndex>"u"?d.getAttribute("data-swiper-slide-index")*1:d.swiperSlideIndex;c[f]=d}),e.slides.forEach(d=>{d.removeAttribute("data-swiper-slide-index")}),c.forEach(d=>{a.append(d)}),e.recalcSlides(),e.slideTo(e.realIndex,0)}var lG={loopCreate:sG,loopFix:oG,loopDestroy:aG};function cG(e){const i=this;if(!i.params.simulateTouch||i.params.watchOverflow&&i.isLocked||i.params.cssMode)return;const a=i.params.touchEventsTarget==="container"?i.el:i.wrapperEl;i.isElement&&(i.__preventObserver__=!0),a.style.cursor="move",a.style.cursor=e?"grabbing":"grab",i.isElement&&requestAnimationFrame(()=>{i.__preventObserver__=!1})}function uG(){const e=this;e.params.watchOverflow&&e.isLocked||e.params.cssMode||(e.isElement&&(e.__preventObserver__=!0),e[e.params.touchEventsTarget==="container"?"el":"wrapperEl"].style.cursor="",e.isElement&&requestAnimationFrame(()=>{e.__preventObserver__=!1}))}var hG={setGrabCursor:cG,unsetGrabCursor:uG};function dG(e,i){i===void 0&&(i=this);function a(c){if(!c||c===Wu()||c===ds())return null;c.assignedSlot&&(c=c.assignedSlot);const d=c.closest(e);return!d&&!c.getRootNode?null:d||a(c.getRootNode().host)}return a(i)}function uS(e,i,a){const c=ds(),{params:d}=e,f=d.edgeSwipeDetection,y=d.edgeSwipeThreshold;return f&&(a<=y||a>=c.innerWidth-y)?f==="prevent"?(i.preventDefault(),!0):!1:!0}function fG(e){const i=this,a=Wu();let c=e;c.originalEvent&&(c=c.originalEvent);const d=i.touchEventsData;if(c.type==="pointerdown"){if(d.pointerId!==null&&d.pointerId!==c.pointerId)return;d.pointerId=c.pointerId}else c.type==="touchstart"&&c.targetTouches.length===1&&(d.touchId=c.targetTouches[0].identifier);if(c.type==="touchstart"){uS(i,c,c.targetTouches[0].pageX);return}const{params:f,touches:y,enabled:s}=i;if(!s||!f.simulateTouch&&c.pointerType==="mouse"||i.animating&&f.preventInteractionOnTransition)return;!i.animating&&f.cssMode&&f.loop&&i.loopFix();let w=c.target;if(f.touchEventsTarget==="wrapper"&&!i.wrapperEl.contains(w)||"which"in c&&c.which===3||"button"in c&&c.button>0||d.isTouched&&d.isMoved)return;const C=!!f.noSwipingClass&&f.noSwipingClass!=="",L=c.composedPath?c.composedPath():c.path;C&&c.target&&c.target.shadowRoot&&L&&(w=L[0]);const k=f.noSwipingSelector?f.noSwipingSelector:`.${f.noSwipingClass}`,R=!!(c.target&&c.target.shadowRoot);if(f.noSwiping&&(R?dG(k,w):w.closest(k))){i.allowClick=!0;return}if(f.swipeHandler&&!w.closest(f.swipeHandler))return;y.currentX=c.pageX,y.currentY=c.pageY;const V=y.currentX,H=y.currentY;if(!uS(i,c,V))return;Object.assign(d,{isTouched:!0,isMoved:!1,allowTouchCallbacks:!0,isScrolling:void 0,startMoving:void 0}),y.startX=V,y.startY=H,d.touchStartTime=lg(),i.allowClick=!0,i.updateSize(),i.swipeDirection=void 0,f.threshold>0&&(d.allowThresholdMove=!1);let J=!0;w.matches(d.focusableElements)&&(J=!1,w.nodeName==="SELECT"&&(d.isTouched=!1)),a.activeElement&&a.activeElement.matches(d.focusableElements)&&a.activeElement!==w&&a.activeElement.blur();const ue=J&&i.allowTouchMove&&f.touchStartPreventDefault;(f.touchStartForcePreventDefault||ue)&&!w.isContentEditable&&c.preventDefault(),f.freeMode&&f.freeMode.enabled&&i.freeMode&&i.animating&&!f.cssMode&&i.freeMode.onTouchStart(),i.emit("touchStart",c)}function pG(e){const i=Wu(),a=this,c=a.touchEventsData,{params:d,touches:f,rtlTranslate:y,enabled:s}=a;if(!s||!d.simulateTouch&&e.pointerType==="mouse")return;let w=e;if(w.originalEvent&&(w=w.originalEvent),w.type==="pointermove"&&(c.touchId!==null||w.pointerId!==c.pointerId))return;let C;if(w.type==="touchmove"){if(C=[...w.changedTouches].filter(Ie=>Ie.identifier===c.touchId)[0],!C||C.identifier!==c.touchId)return}else C=w;if(!c.isTouched){c.startMoving&&c.isScrolling&&a.emit("touchMoveOpposite",w);return}const L=C.pageX,k=C.pageY;if(w.preventedByNestedSwiper){f.startX=L,f.startY=k;return}if(!a.allowTouchMove){w.target.matches(c.focusableElements)||(a.allowClick=!1),c.isTouched&&(Object.assign(f,{startX:L,startY:k,currentX:L,currentY:k}),c.touchStartTime=lg());return}if(d.touchReleaseOnEdges&&!d.loop){if(a.isVertical()){if(k<f.startY&&a.translate<=a.maxTranslate()||k>f.startY&&a.translate>=a.minTranslate()){c.isTouched=!1,c.isMoved=!1;return}}else if(L<f.startX&&a.translate<=a.maxTranslate()||L>f.startX&&a.translate>=a.minTranslate())return}if(i.activeElement&&w.target===i.activeElement&&w.target.matches(c.focusableElements)){c.isMoved=!0,a.allowClick=!1;return}c.allowTouchCallbacks&&a.emit("touchMove",w),f.previousX=f.currentX,f.previousY=f.currentY,f.currentX=L,f.currentY=k;const R=f.currentX-f.startX,V=f.currentY-f.startY;if(a.params.threshold&&Math.sqrt(R**2+V**2)<a.params.threshold)return;if(typeof c.isScrolling>"u"){let Ie;a.isHorizontal()&&f.currentY===f.startY||a.isVertical()&&f.currentX===f.startX?c.isScrolling=!1:R*R+V*V>=25&&(Ie=Math.atan2(Math.abs(V),Math.abs(R))*180/Math.PI,c.isScrolling=a.isHorizontal()?Ie>d.touchAngle:90-Ie>d.touchAngle)}if(c.isScrolling&&a.emit("touchMoveOpposite",w),typeof c.startMoving>"u"&&(f.currentX!==f.startX||f.currentY!==f.startY)&&(c.startMoving=!0),c.isScrolling||w.type==="touchmove"&&c.preventTouchMoveFromPointerMove){c.isTouched=!1;return}if(!c.startMoving)return;a.allowClick=!1,!d.cssMode&&w.cancelable&&w.preventDefault(),d.touchMoveStopPropagation&&!d.nested&&w.stopPropagation();let H=a.isHorizontal()?R:V,J=a.isHorizontal()?f.currentX-f.previousX:f.currentY-f.previousY;d.oneWayMovement&&(H=Math.abs(H)*(y?1:-1),J=Math.abs(J)*(y?1:-1)),f.diff=H,H*=d.touchRatio,y&&(H=-H,J=-J);const ue=a.touchesDirection;a.swipeDirection=H>0?"prev":"next",a.touchesDirection=J>0?"prev":"next";const j=a.params.loop&&!d.cssMode,q=a.touchesDirection==="next"&&a.allowSlideNext||a.touchesDirection==="prev"&&a.allowSlidePrev;if(!c.isMoved){if(j&&q&&a.loopFix({direction:a.swipeDirection}),c.startTranslate=a.getTranslate(),a.setTransition(0),a.animating){const Ie=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});a.wrapperEl.dispatchEvent(Ie)}c.allowMomentumBounce=!1,d.grabCursor&&(a.allowSlideNext===!0||a.allowSlidePrev===!0)&&a.setGrabCursor(!0),a.emit("sliderFirstMove",w)}let se;if(new Date().getTime(),c.isMoved&&c.allowThresholdMove&&ue!==a.touchesDirection&&j&&q&&Math.abs(H)>=1){Object.assign(f,{startX:L,startY:k,currentX:L,currentY:k,startTranslate:c.currentTranslate}),c.loopSwapReset=!0,c.startTranslate=c.currentTranslate;return}a.emit("sliderMove",w),c.isMoved=!0,c.currentTranslate=H+c.startTranslate;let ge=!0,ie=d.resistanceRatio;if(d.touchReleaseOnEdges&&(ie=0),H>0?(j&&q&&!se&&c.allowThresholdMove&&c.currentTranslate>(d.centeredSlides?a.minTranslate()-a.slidesSizesGrid[a.activeIndex+1]:a.minTranslate())&&a.loopFix({direction:"prev",setTranslate:!0,activeSlideIndex:0}),c.currentTranslate>a.minTranslate()&&(ge=!1,d.resistance&&(c.currentTranslate=a.minTranslate()-1+(-a.minTranslate()+c.startTranslate+H)**ie))):H<0&&(j&&q&&!se&&c.allowThresholdMove&&c.currentTranslate<(d.centeredSlides?a.maxTranslate()+a.slidesSizesGrid[a.slidesSizesGrid.length-1]:a.maxTranslate())&&a.loopFix({direction:"next",setTranslate:!0,activeSlideIndex:a.slides.length-(d.slidesPerView==="auto"?a.slidesPerViewDynamic():Math.ceil(parseFloat(d.slidesPerView,10)))}),c.currentTranslate<a.maxTranslate()&&(ge=!1,d.resistance&&(c.currentTranslate=a.maxTranslate()+1-(a.maxTranslate()-c.startTranslate-H)**ie))),ge&&(w.preventedByNestedSwiper=!0),!a.allowSlideNext&&a.swipeDirection==="next"&&c.currentTranslate<c.startTranslate&&(c.currentTranslate=c.startTranslate),!a.allowSlidePrev&&a.swipeDirection==="prev"&&c.currentTranslate>c.startTranslate&&(c.currentTranslate=c.startTranslate),!a.allowSlidePrev&&!a.allowSlideNext&&(c.currentTranslate=c.startTranslate),d.threshold>0)if(Math.abs(H)>d.threshold||c.allowThresholdMove){if(!c.allowThresholdMove){c.allowThresholdMove=!0,f.startX=f.currentX,f.startY=f.currentY,c.currentTranslate=c.startTranslate,f.diff=a.isHorizontal()?f.currentX-f.startX:f.currentY-f.startY;return}}else{c.currentTranslate=c.startTranslate;return}!d.followFinger||d.cssMode||((d.freeMode&&d.freeMode.enabled&&a.freeMode||d.watchSlidesProgress)&&(a.updateActiveIndex(),a.updateSlidesClasses()),d.freeMode&&d.freeMode.enabled&&a.freeMode&&a.freeMode.onTouchMove(),a.updateProgress(c.currentTranslate),a.setTranslate(c.currentTranslate))}function mG(e){const i=this,a=i.touchEventsData;let c=e;c.originalEvent&&(c=c.originalEvent);let d;if(c.type==="touchend"||c.type==="touchcancel"){if(d=[...c.changedTouches].filter(ie=>ie.identifier===a.touchId)[0],!d||d.identifier!==a.touchId)return}else{if(a.touchId!==null||c.pointerId!==a.pointerId)return;d=c}if(["pointercancel","pointerout","pointerleave","contextmenu"].includes(c.type)&&!(["pointercancel","contextmenu"].includes(c.type)&&(i.browser.isSafari||i.browser.isWebView)))return;a.pointerId=null,a.touchId=null;const{params:y,touches:s,rtlTranslate:w,slidesGrid:C,enabled:L}=i;if(!L||!y.simulateTouch&&c.pointerType==="mouse")return;if(a.allowTouchCallbacks&&i.emit("touchEnd",c),a.allowTouchCallbacks=!1,!a.isTouched){a.isMoved&&y.grabCursor&&i.setGrabCursor(!1),a.isMoved=!1,a.startMoving=!1;return}y.grabCursor&&a.isMoved&&a.isTouched&&(i.allowSlideNext===!0||i.allowSlidePrev===!0)&&i.setGrabCursor(!1);const k=lg(),R=k-a.touchStartTime;if(i.allowClick){const ie=c.path||c.composedPath&&c.composedPath();i.updateClickedSlide(ie&&ie[0]||c.target,ie),i.emit("tap click",c),R<300&&k-a.lastClickTime<300&&i.emit("doubleTap doubleClick",c)}if(a.lastClickTime=lg(),C0(()=>{i.destroyed||(i.allowClick=!0)}),!a.isTouched||!a.isMoved||!i.swipeDirection||s.diff===0&&!a.loopSwapReset||a.currentTranslate===a.startTranslate&&!a.loopSwapReset){a.isTouched=!1,a.isMoved=!1,a.startMoving=!1;return}a.isTouched=!1,a.isMoved=!1,a.startMoving=!1;let V;if(y.followFinger?V=w?i.translate:-i.translate:V=-a.currentTranslate,y.cssMode)return;if(y.freeMode&&y.freeMode.enabled){i.freeMode.onTouchEnd({currentPos:V});return}const H=V>=-i.maxTranslate()&&!i.params.loop;let J=0,ue=i.slidesSizesGrid[0];for(let ie=0;ie<C.length;ie+=ie<y.slidesPerGroupSkip?1:y.slidesPerGroup){const Ie=ie<y.slidesPerGroupSkip-1?1:y.slidesPerGroup;typeof C[ie+Ie]<"u"?(H||V>=C[ie]&&V<C[ie+Ie])&&(J=ie,ue=C[ie+Ie]-C[ie]):(H||V>=C[ie])&&(J=ie,ue=C[C.length-1]-C[C.length-2])}let j=null,q=null;y.rewind&&(i.isBeginning?q=y.virtual&&y.virtual.enabled&&i.virtual?i.virtual.slides.length-1:i.slides.length-1:i.isEnd&&(j=0));const se=(V-C[J])/ue,ge=J<y.slidesPerGroupSkip-1?1:y.slidesPerGroup;if(R>y.longSwipesMs){if(!y.longSwipes){i.slideTo(i.activeIndex);return}i.swipeDirection==="next"&&(se>=y.longSwipesRatio?i.slideTo(y.rewind&&i.isEnd?j:J+ge):i.slideTo(J)),i.swipeDirection==="prev"&&(se>1-y.longSwipesRatio?i.slideTo(J+ge):q!==null&&se<0&&Math.abs(se)>y.longSwipesRatio?i.slideTo(q):i.slideTo(J))}else{if(!y.shortSwipes){i.slideTo(i.activeIndex);return}i.navigation&&(c.target===i.navigation.nextEl||c.target===i.navigation.prevEl)?c.target===i.navigation.nextEl?i.slideTo(J+ge):i.slideTo(J):(i.swipeDirection==="next"&&i.slideTo(j!==null?j:J+ge),i.swipeDirection==="prev"&&i.slideTo(q!==null?q:J))}}function hS(){const e=this,{params:i,el:a}=e;if(a&&a.offsetWidth===0)return;i.breakpoints&&e.setBreakpoint();const{allowSlideNext:c,allowSlidePrev:d,snapGrid:f}=e,y=e.virtual&&e.params.virtual.enabled;e.allowSlideNext=!0,e.allowSlidePrev=!0,e.updateSize(),e.updateSlides(),e.updateSlidesClasses();const s=y&&i.loop;(i.slidesPerView==="auto"||i.slidesPerView>1)&&e.isEnd&&!e.isBeginning&&!e.params.centeredSlides&&!s?e.slideTo(e.slides.length-1,0,!1,!0):e.params.loop&&!y?e.slideToLoop(e.realIndex,0,!1,!0):e.slideTo(e.activeIndex,0,!1,!0),e.autoplay&&e.autoplay.running&&e.autoplay.paused&&(clearTimeout(e.autoplay.resizeTimeout),e.autoplay.resizeTimeout=setTimeout(()=>{e.autoplay&&e.autoplay.running&&e.autoplay.paused&&e.autoplay.resume()},500)),e.allowSlidePrev=d,e.allowSlideNext=c,e.params.watchOverflow&&f!==e.snapGrid&&e.checkOverflow()}function gG(e){const i=this;!i.enabled||i.allowClick||(i.params.preventClicks&&e.preventDefault(),i.params.preventClicksPropagation&&i.animating&&(e.stopPropagation(),e.stopImmediatePropagation()))}function _G(){const e=this,{wrapperEl:i,rtlTranslate:a,enabled:c}=e;if(!c)return;e.previousTranslate=e.translate,e.isHorizontal()?e.translate=-i.scrollLeft:e.translate=-i.scrollTop,e.translate===0&&(e.translate=0),e.updateActiveIndex(),e.updateSlidesClasses();let d;const f=e.maxTranslate()-e.minTranslate();f===0?d=0:d=(e.translate-e.minTranslate())/f,d!==e.progress&&e.updateProgress(a?-e.translate:e.translate),e.emit("setTranslate",e.translate,!1)}function yG(e){const i=this;Dm(i,e.target),!(i.params.cssMode||i.params.slidesPerView!=="auto"&&!i.params.autoHeight)&&i.update()}function vG(){const e=this;e.documentTouchHandlerProceeded||(e.documentTouchHandlerProceeded=!0,e.params.touchReleaseOnEdges&&(e.el.style.touchAction="auto"))}const oI=(e,i)=>{const a=Wu(),{params:c,el:d,wrapperEl:f,device:y}=e,s=!!c.nested,w=i==="on"?"addEventListener":"removeEventListener",C=i;a[w]("touchstart",e.onDocumentTouchStart,{passive:!1,capture:s}),d[w]("touchstart",e.onTouchStart,{passive:!1}),d[w]("pointerdown",e.onTouchStart,{passive:!1}),a[w]("touchmove",e.onTouchMove,{passive:!1,capture:s}),a[w]("pointermove",e.onTouchMove,{passive:!1,capture:s}),a[w]("touchend",e.onTouchEnd,{passive:!0}),a[w]("pointerup",e.onTouchEnd,{passive:!0}),a[w]("pointercancel",e.onTouchEnd,{passive:!0}),a[w]("touchcancel",e.onTouchEnd,{passive:!0}),a[w]("pointerout",e.onTouchEnd,{passive:!0}),a[w]("pointerleave",e.onTouchEnd,{passive:!0}),a[w]("contextmenu",e.onTouchEnd,{passive:!0}),(c.preventClicks||c.preventClicksPropagation)&&d[w]("click",e.onClick,!0),c.cssMode&&f[w]("scroll",e.onScroll),c.updateOnWindowResize?e[C](y.ios||y.android?"resize orientationchange observerUpdate":"resize observerUpdate",hS,!0):e[C]("observerUpdate",hS,!0),d[w]("load",e.onLoad,{capture:!0})};function xG(){const e=this,{params:i}=e;e.onTouchStart=fG.bind(e),e.onTouchMove=pG.bind(e),e.onTouchEnd=mG.bind(e),e.onDocumentTouchStart=vG.bind(e),i.cssMode&&(e.onScroll=_G.bind(e)),e.onClick=gG.bind(e),e.onLoad=yG.bind(e),oI(e,"on")}function bG(){oI(this,"off")}var wG={attachEvents:xG,detachEvents:bG};const dS=(e,i)=>e.grid&&i.grid&&i.grid.rows>1;function TG(){const e=this,{realIndex:i,initialized:a,params:c,el:d}=e,f=c.breakpoints;if(!f||f&&Object.keys(f).length===0)return;const y=e.getBreakpoint(f,e.params.breakpointsBase,e.el);if(!y||e.currentBreakpoint===y)return;const w=(y in f?f[y]:void 0)||e.originalParams,C=dS(e,c),L=dS(e,w),k=e.params.grabCursor,R=w.grabCursor,V=c.enabled;C&&!L?(d.classList.remove(`${c.containerModifierClass}grid`,`${c.containerModifierClass}grid-column`),e.emitContainerClasses()):!C&&L&&(d.classList.add(`${c.containerModifierClass}grid`),(w.grid.fill&&w.grid.fill==="column"||!w.grid.fill&&c.grid.fill==="column")&&d.classList.add(`${c.containerModifierClass}grid-column`),e.emitContainerClasses()),k&&!R?e.unsetGrabCursor():!k&&R&&e.setGrabCursor(),["navigation","pagination","scrollbar"].forEach(se=>{if(typeof w[se]>"u")return;const ge=c[se]&&c[se].enabled,ie=w[se]&&w[se].enabled;ge&&!ie&&e[se].disable(),!ge&&ie&&e[se].enable()});const H=w.direction&&w.direction!==c.direction,J=c.loop&&(w.slidesPerView!==c.slidesPerView||H),ue=c.loop;H&&a&&e.changeDirection(),is(e.params,w);const j=e.params.enabled,q=e.params.loop;Object.assign(e,{allowTouchMove:e.params.allowTouchMove,allowSlideNext:e.params.allowSlideNext,allowSlidePrev:e.params.allowSlidePrev}),V&&!j?e.disable():!V&&j&&e.enable(),e.currentBreakpoint=y,e.emit("_beforeBreakpoint",w),a&&(J?(e.loopDestroy(),e.loopCreate(i),e.updateSlides()):!ue&&q?(e.loopCreate(i),e.updateSlides()):ue&&!q&&e.loopDestroy()),e.emit("breakpoint",w)}function EG(e,i,a){if(i===void 0&&(i="window"),!e||i==="container"&&!a)return;let c=!1;const d=ds(),f=i==="window"?d.innerHeight:a.clientHeight,y=Object.keys(e).map(s=>{if(typeof s=="string"&&s.indexOf("@")===0){const w=parseFloat(s.substr(1));return{value:f*w,point:s}}return{value:s,point:s}});y.sort((s,w)=>parseInt(s.value,10)-parseInt(w.value,10));for(let s=0;s<y.length;s+=1){const{point:w,value:C}=y[s];i==="window"?d.matchMedia(`(min-width: ${C}px)`).matches&&(c=w):C<=a.clientWidth&&(c=w)}return c||"max"}var SG={setBreakpoint:TG,getBreakpoint:EG};function AG(e,i){const a=[];return e.forEach(c=>{typeof c=="object"?Object.keys(c).forEach(d=>{c[d]&&a.push(i+d)}):typeof c=="string"&&a.push(i+c)}),a}function CG(){const e=this,{classNames:i,params:a,rtl:c,el:d,device:f}=e,y=AG(["initialized",a.direction,{"free-mode":e.params.freeMode&&a.freeMode.enabled},{autoheight:a.autoHeight},{rtl:c},{grid:a.grid&&a.grid.rows>1},{"grid-column":a.grid&&a.grid.rows>1&&a.grid.fill==="column"},{android:f.android},{ios:f.ios},{"css-mode":a.cssMode},{centered:a.cssMode&&a.centeredSlides},{"watch-progress":a.watchSlidesProgress}],a.containerModifierClass);i.push(...y),d.classList.add(...i),e.emitContainerClasses()}function MG(){const e=this,{el:i,classNames:a}=e;i.classList.remove(...a),e.emitContainerClasses()}var IG={addClasses:CG,removeClasses:MG};function PG(){const e=this,{isLocked:i,params:a}=e,{slidesOffsetBefore:c}=a;if(c){const d=e.slides.length-1,f=e.slidesGrid[d]+e.slidesSizesGrid[d]+c*2;e.isLocked=e.size>f}else e.isLocked=e.snapGrid.length===1;a.allowSlideNext===!0&&(e.allowSlideNext=!e.isLocked),a.allowSlidePrev===!0&&(e.allowSlidePrev=!e.isLocked),i&&i!==e.isLocked&&(e.isEnd=!1),i!==e.isLocked&&e.emit(e.isLocked?"lock":"unlock")}var kG={checkOverflow:PG},fS={init:!0,direction:"horizontal",oneWayMovement:!1,swiperElementNodeName:"SWIPER-CONTAINER",touchEventsTarget:"wrapper",initialSlide:0,speed:300,cssMode:!1,updateOnWindowResize:!0,resizeObserver:!0,nested:!1,createElements:!1,eventsPrefix:"swiper",enabled:!0,focusableElements:"input, select, option, textarea, button, video, label",width:null,height:null,preventInteractionOnTransition:!1,userAgent:null,url:null,edgeSwipeDetection:!1,edgeSwipeThreshold:20,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",breakpoints:void 0,breakpointsBase:"window",spaceBetween:0,slidesPerView:1,slidesPerGroup:1,slidesPerGroupSkip:0,slidesPerGroupAuto:!1,centeredSlides:!1,centeredSlidesBounds:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,normalizeSlideIndex:!0,centerInsufficientSlides:!1,watchOverflow:!0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,allowTouchMove:!0,threshold:5,touchMoveStopPropagation:!1,touchStartPreventDefault:!0,touchStartForcePreventDefault:!1,touchReleaseOnEdges:!1,uniqueNavElements:!0,resistance:!0,resistanceRatio:.85,watchSlidesProgress:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,loop:!1,loopAddBlankSlides:!0,loopAdditionalSlides:0,loopPreventsSliding:!0,rewind:!1,allowSlidePrev:!0,allowSlideNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",noSwipingSelector:null,passiveListeners:!0,maxBackfaceHiddenSlides:10,containerModifierClass:"swiper-",slideClass:"swiper-slide",slideBlankClass:"swiper-slide-blank",slideActiveClass:"swiper-slide-active",slideVisibleClass:"swiper-slide-visible",slideFullyVisibleClass:"swiper-slide-fully-visible",slideNextClass:"swiper-slide-next",slidePrevClass:"swiper-slide-prev",wrapperClass:"swiper-wrapper",lazyPreloaderClass:"swiper-lazy-preloader",lazyPreloadPrevNext:0,runCallbacksOnInit:!0,_emitClasses:!1};function LG(e,i){return function(c){c===void 0&&(c={});const d=Object.keys(c)[0],f=c[d];if(typeof f!="object"||f===null){is(i,c);return}if(e[d]===!0&&(e[d]={enabled:!0}),d==="navigation"&&e[d]&&e[d].enabled&&!e[d].prevEl&&!e[d].nextEl&&(e[d].auto=!0),["pagination","scrollbar"].indexOf(d)>=0&&e[d]&&e[d].enabled&&!e[d].el&&(e[d].auto=!0),!(d in e&&"enabled"in f)){is(i,c);return}typeof e[d]=="object"&&!("enabled"in e[d])&&(e[d].enabled=!0),e[d]||(e[d]={enabled:!1}),is(i,c)}}const Av={eventsEmitter:Ij,update:Uj,translate:Wj,transition:Kj,slide:rG,loop:lG,grabCursor:hG,events:wG,breakpoints:SG,checkOverflow:kG,classes:IG},Cv={};class ts{constructor(){let i,a;for(var c=arguments.length,d=new Array(c),f=0;f<c;f++)d[f]=arguments[f];d.length===1&&d[0].constructor&&Object.prototype.toString.call(d[0]).slice(8,-1)==="Object"?a=d[0]:[i,a]=d,a||(a={}),a=is({},a),i&&!a.el&&(a.el=i);const y=Wu();if(a.el&&typeof a.el=="string"&&y.querySelectorAll(a.el).length>1){const L=[];return y.querySelectorAll(a.el).forEach(k=>{const R=is({},a,{el:k});L.push(new ts(R))}),L}const s=this;s.__swiper__=!0,s.support=nI(),s.device=rI({userAgent:a.userAgent}),s.browser=Aj(),s.eventsListeners={},s.eventsAnyListeners=[],s.modules=[...s.__modules__],a.modules&&Array.isArray(a.modules)&&s.modules.push(...a.modules);const w={};s.modules.forEach(L=>{L({params:a,swiper:s,extendParams:LG(a,w),on:s.on.bind(s),once:s.once.bind(s),off:s.off.bind(s),emit:s.emit.bind(s)})});const C=is({},fS,w);return s.params=is({},C,Cv,a),s.originalParams=is({},s.params),s.passedParams=is({},a),s.params&&s.params.on&&Object.keys(s.params.on).forEach(L=>{s.on(L,s.params.on[L])}),s.params&&s.params.onAny&&s.onAny(s.params.onAny),Object.assign(s,{enabled:s.params.enabled,el:i,classNames:[],slides:[],slidesGrid:[],snapGrid:[],slidesSizesGrid:[],isHorizontal(){return s.params.direction==="horizontal"},isVertical(){return s.params.direction==="vertical"},activeIndex:0,realIndex:0,isBeginning:!0,isEnd:!1,translate:0,previousTranslate:0,progress:0,velocity:0,animating:!1,cssOverflowAdjustment(){return Math.trunc(this.translate/2**23)*2**23},allowSlideNext:s.params.allowSlideNext,allowSlidePrev:s.params.allowSlidePrev,touchEventsData:{isTouched:void 0,isMoved:void 0,allowTouchCallbacks:void 0,touchStartTime:void 0,isScrolling:void 0,currentTranslate:void 0,startTranslate:void 0,allowThresholdMove:void 0,focusableElements:s.params.focusableElements,lastClickTime:0,clickTimeout:void 0,velocities:[],allowMomentumBounce:void 0,startMoving:void 0,pointerId:null,touchId:null},allowClick:!0,allowTouchMove:s.params.allowTouchMove,touches:{startX:0,startY:0,currentX:0,currentY:0,diff:0},imagesToLoad:[],imagesLoaded:0}),s.emit("_swiper"),s.params.init&&s.init(),s}getDirectionLabel(i){return this.isHorizontal()?i:{width:"height","margin-top":"margin-left","margin-bottom ":"margin-right","margin-left":"margin-top","margin-right":"margin-bottom","padding-left":"padding-top","padding-right":"padding-bottom",marginRight:"marginBottom"}[i]}getSlideIndex(i){const{slidesEl:a,params:c}=this,d=_o(a,`.${c.slideClass}, swiper-slide`),f=hg(d[0]);return hg(i)-f}getSlideIndexByData(i){return this.getSlideIndex(this.slides.filter(a=>a.getAttribute("data-swiper-slide-index")*1===i)[0])}recalcSlides(){const i=this,{slidesEl:a,params:c}=i;i.slides=_o(a,`.${c.slideClass}, swiper-slide`)}enable(){const i=this;i.enabled||(i.enabled=!0,i.params.grabCursor&&i.setGrabCursor(),i.emit("enable"))}disable(){const i=this;!i.enabled||(i.enabled=!1,i.params.grabCursor&&i.unsetGrabCursor(),i.emit("disable"))}setProgress(i,a){const c=this;i=Math.min(Math.max(i,0),1);const d=c.minTranslate(),y=(c.maxTranslate()-d)*i+d;c.translateTo(y,typeof a>"u"?0:a),c.updateActiveIndex(),c.updateSlidesClasses()}emitContainerClasses(){const i=this;if(!i.params._emitClasses||!i.el)return;const a=i.el.className.split(" ").filter(c=>c.indexOf("swiper")===0||c.indexOf(i.params.containerModifierClass)===0);i.emit("_containerClasses",a.join(" "))}getSlideClasses(i){const a=this;return a.destroyed?"":i.className.split(" ").filter(c=>c.indexOf("swiper-slide")===0||c.indexOf(a.params.slideClass)===0).join(" ")}emitSlidesClasses(){const i=this;if(!i.params._emitClasses||!i.el)return;const a=[];i.slides.forEach(c=>{const d=i.getSlideClasses(c);a.push({slideEl:c,classNames:d}),i.emit("_slideClass",c,d)}),i.emit("_slideClasses",a)}slidesPerViewDynamic(i,a){i===void 0&&(i="current"),a===void 0&&(a=!1);const c=this,{params:d,slides:f,slidesGrid:y,slidesSizesGrid:s,size:w,activeIndex:C}=c;let L=1;if(typeof d.slidesPerView=="number")return d.slidesPerView;if(d.centeredSlides){let k=f[C]?Math.ceil(f[C].swiperSlideSize):0,R;for(let V=C+1;V<f.length;V+=1)f[V]&&!R&&(k+=Math.ceil(f[V].swiperSlideSize),L+=1,k>w&&(R=!0));for(let V=C-1;V>=0;V-=1)f[V]&&!R&&(k+=f[V].swiperSlideSize,L+=1,k>w&&(R=!0))}else if(i==="current")for(let k=C+1;k<f.length;k+=1)(a?y[k]+s[k]-y[C]<w:y[k]-y[C]<w)&&(L+=1);else for(let k=C-1;k>=0;k-=1)y[C]-y[k]<w&&(L+=1);return L}update(){const i=this;if(!i||i.destroyed)return;const{snapGrid:a,params:c}=i;c.breakpoints&&i.setBreakpoint(),[...i.el.querySelectorAll('[loading="lazy"]')].forEach(y=>{y.complete&&Dm(i,y)}),i.updateSize(),i.updateSlides(),i.updateProgress(),i.updateSlidesClasses();function d(){const y=i.rtlTranslate?i.translate*-1:i.translate,s=Math.min(Math.max(y,i.maxTranslate()),i.minTranslate());i.setTranslate(s),i.updateActiveIndex(),i.updateSlidesClasses()}let f;if(c.freeMode&&c.freeMode.enabled&&!c.cssMode)d(),c.autoHeight&&i.updateAutoHeight();else{if((c.slidesPerView==="auto"||c.slidesPerView>1)&&i.isEnd&&!c.centeredSlides){const y=i.virtual&&c.virtual.enabled?i.virtual.slides:i.slides;f=i.slideTo(y.length-1,0,!1,!0)}else f=i.slideTo(i.activeIndex,0,!1,!0);f||d()}c.watchOverflow&&a!==i.snapGrid&&i.checkOverflow(),i.emit("update")}changeDirection(i,a){a===void 0&&(a=!0);const c=this,d=c.params.direction;return i||(i=d==="horizontal"?"vertical":"horizontal"),i===d||i!=="horizontal"&&i!=="vertical"||(c.el.classList.remove(`${c.params.containerModifierClass}${d}`),c.el.classList.add(`${c.params.containerModifierClass}${i}`),c.emitContainerClasses(),c.params.direction=i,c.slides.forEach(f=>{i==="vertical"?f.style.width="":f.style.height=""}),c.emit("changeDirection"),a&&c.update()),c}changeLanguageDirection(i){const a=this;a.rtl&&i==="rtl"||!a.rtl&&i==="ltr"||(a.rtl=i==="rtl",a.rtlTranslate=a.params.direction==="horizontal"&&a.rtl,a.rtl?(a.el.classList.add(`${a.params.containerModifierClass}rtl`),a.el.dir="rtl"):(a.el.classList.remove(`${a.params.containerModifierClass}rtl`),a.el.dir="ltr"),a.update())}mount(i){const a=this;if(a.mounted)return!0;let c=i||a.params.el;if(typeof c=="string"&&(c=document.querySelector(c)),!c)return!1;c.swiper=a,c.parentNode&&c.parentNode.host&&c.parentNode.host.nodeName===a.params.swiperElementNodeName.toUpperCase()&&(a.isElement=!0);const d=()=>`.${(a.params.wrapperClass||"").trim().split(" ").join(".")}`;let y=(()=>c&&c.shadowRoot&&c.shadowRoot.querySelector?c.shadowRoot.querySelector(d()):_o(c,d())[0])();return!y&&a.params.createElements&&(y=ug("div",a.params.wrapperClass),c.append(y),_o(c,`.${a.params.slideClass}`).forEach(s=>{y.append(s)})),Object.assign(a,{el:c,wrapperEl:y,slidesEl:a.isElement&&!c.parentNode.host.slideSlots?c.parentNode.host:y,hostEl:a.isElement?c.parentNode.host:c,mounted:!0,rtl:c.dir.toLowerCase()==="rtl"||Ra(c,"direction")==="rtl",rtlTranslate:a.params.direction==="horizontal"&&(c.dir.toLowerCase()==="rtl"||Ra(c,"direction")==="rtl"),wrongRTL:Ra(y,"display")==="-webkit-box"}),!0}init(i){const a=this;if(a.initialized||a.mount(i)===!1)return a;a.emit("beforeInit"),a.params.breakpoints&&a.setBreakpoint(),a.addClasses(),a.updateSize(),a.updateSlides(),a.params.watchOverflow&&a.checkOverflow(),a.params.grabCursor&&a.enabled&&a.setGrabCursor(),a.params.loop&&a.virtual&&a.params.virtual.enabled?a.slideTo(a.params.initialSlide+a.virtual.slidesBefore,0,a.params.runCallbacksOnInit,!1,!0):a.slideTo(a.params.initialSlide,0,a.params.runCallbacksOnInit,!1,!0),a.params.loop&&a.loopCreate(),a.attachEvents();const d=[...a.el.querySelectorAll('[loading="lazy"]')];return a.isElement&&d.push(...a.hostEl.querySelectorAll('[loading="lazy"]')),d.forEach(f=>{f.complete?Dm(a,f):f.addEventListener("load",y=>{Dm(a,y.target)})}),I0(a),a.initialized=!0,I0(a),a.emit("init"),a.emit("afterInit"),a}destroy(i,a){i===void 0&&(i=!0),a===void 0&&(a=!0);const c=this,{params:d,el:f,wrapperEl:y,slides:s}=c;return typeof c.params>"u"||c.destroyed||(c.emit("beforeDestroy"),c.initialized=!1,c.detachEvents(),d.loop&&c.loopDestroy(),a&&(c.removeClasses(),f.removeAttribute("style"),y.removeAttribute("style"),s&&s.length&&s.forEach(w=>{w.classList.remove(d.slideVisibleClass,d.slideFullyVisibleClass,d.slideActiveClass,d.slideNextClass,d.slidePrevClass),w.removeAttribute("style"),w.removeAttribute("data-swiper-slide-index")})),c.emit("destroy"),Object.keys(c.eventsListeners).forEach(w=>{c.off(w)}),i!==!1&&(c.el.swiper=null,_j(c)),c.destroyed=!0),null}static extendDefaults(i){is(Cv,i)}static get extendedDefaults(){return Cv}static get defaults(){return fS}static installModule(i){ts.prototype.__modules__||(ts.prototype.__modules__=[]);const a=ts.prototype.__modules__;typeof i=="function"&&a.indexOf(i)<0&&a.push(i)}static use(i){return Array.isArray(i)?(i.forEach(a=>ts.installModule(a)),ts):(ts.installModule(i),ts)}}Object.keys(Av).forEach(e=>{Object.keys(Av[e]).forEach(i=>{ts.prototype[i]=Av[e][i]})});ts.use([Cj,Mj]);function aI(e,i,a,c){return e.params.createElements&&Object.keys(c).forEach(d=>{if(!a[d]&&a.auto===!0){let f=_o(e.el,`.${c[d]}`)[0];f||(f=ug("div",c[d]),f.className=c[d],e.el.append(f)),a[d]=f,i[d]=f}}),a}function zG(e){let{swiper:i,extendParams:a,on:c,emit:d}=e;a({navigation:{nextEl:null,prevEl:null,hideOnClick:!1,disabledClass:"swiper-button-disabled",hiddenClass:"swiper-button-hidden",lockClass:"swiper-button-lock",navigationDisabledClass:"swiper-navigation-disabled"}}),i.navigation={nextEl:null,prevEl:null};function f(H){let J;return H&&typeof H=="string"&&i.isElement&&(J=i.el.querySelector(H),J)?J:(H&&(typeof H=="string"&&(J=[...document.querySelectorAll(H)]),i.params.uniqueNavElements&&typeof H=="string"&&J&&J.length>1&&i.el.querySelectorAll(H).length===1?J=i.el.querySelector(H):J&&J.length===1&&(J=J[0])),H&&!J?H:J)}function y(H,J){const ue=i.params.navigation;H=Jn(H),H.forEach(j=>{j&&(j.classList[J?"add":"remove"](...ue.disabledClass.split(" ")),j.tagName==="BUTTON"&&(j.disabled=J),i.params.watchOverflow&&i.enabled&&j.classList[i.isLocked?"add":"remove"](ue.lockClass))})}function s(){const{nextEl:H,prevEl:J}=i.navigation;if(i.params.loop){y(J,!1),y(H,!1);return}y(J,i.isBeginning&&!i.params.rewind),y(H,i.isEnd&&!i.params.rewind)}function w(H){H.preventDefault(),!(i.isBeginning&&!i.params.loop&&!i.params.rewind)&&(i.slidePrev(),d("navigationPrev"))}function C(H){H.preventDefault(),!(i.isEnd&&!i.params.loop&&!i.params.rewind)&&(i.slideNext(),d("navigationNext"))}function L(){const H=i.params.navigation;if(i.params.navigation=aI(i,i.originalParams.navigation,i.params.navigation,{nextEl:"swiper-button-next",prevEl:"swiper-button-prev"}),!(H.nextEl||H.prevEl))return;let J=f(H.nextEl),ue=f(H.prevEl);Object.assign(i.navigation,{nextEl:J,prevEl:ue}),J=Jn(J),ue=Jn(ue);const j=(q,se)=>{q&&q.addEventListener("click",se==="next"?C:w),!i.enabled&&q&&q.classList.add(...H.lockClass.split(" "))};J.forEach(q=>j(q,"next")),ue.forEach(q=>j(q,"prev"))}function k(){let{nextEl:H,prevEl:J}=i.navigation;H=Jn(H),J=Jn(J);const ue=(j,q)=>{j.removeEventListener("click",q==="next"?C:w),j.classList.remove(...i.params.navigation.disabledClass.split(" "))};H.forEach(j=>ue(j,"next")),J.forEach(j=>ue(j,"prev"))}c("init",()=>{i.params.navigation.enabled===!1?V():(L(),s())}),c("toEdge fromEdge lock unlock",()=>{s()}),c("destroy",()=>{k()}),c("enable disable",()=>{let{nextEl:H,prevEl:J}=i.navigation;if(H=Jn(H),J=Jn(J),i.enabled){s();return}[...H,...J].filter(ue=>!!ue).forEach(ue=>ue.classList.add(i.params.navigation.lockClass))}),c("click",(H,J)=>{let{nextEl:ue,prevEl:j}=i.navigation;ue=Jn(ue),j=Jn(j);const q=J.target;if(i.params.navigation.hideOnClick&&!j.includes(q)&&!ue.includes(q)){if(i.pagination&&i.params.pagination&&i.params.pagination.clickable&&(i.pagination.el===q||i.pagination.el.contains(q)))return;let se;ue.length?se=ue[0].classList.contains(i.params.navigation.hiddenClass):j.length&&(se=j[0].classList.contains(i.params.navigation.hiddenClass)),d(se===!0?"navigationShow":"navigationHide"),[...ue,...j].filter(ge=>!!ge).forEach(ge=>ge.classList.toggle(i.params.navigation.hiddenClass))}});const R=()=>{i.el.classList.remove(...i.params.navigation.navigationDisabledClass.split(" ")),L(),s()},V=()=>{i.el.classList.add(...i.params.navigation.navigationDisabledClass.split(" ")),k()};Object.assign(i.navigation,{enable:R,disable:V,update:s,init:L,destroy:k})}function zd(e){return e===void 0&&(e=""),`.${e.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function RG(e){let{swiper:i,extendParams:a,on:c,emit:d}=e;const f="swiper-pagination";a({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:j=>j,formatFractionTotal:j=>j,bulletClass:`${f}-bullet`,bulletActiveClass:`${f}-bullet-active`,modifierClass:`${f}-`,currentClass:`${f}-current`,totalClass:`${f}-total`,hiddenClass:`${f}-hidden`,progressbarFillClass:`${f}-progressbar-fill`,progressbarOppositeClass:`${f}-progressbar-opposite`,clickableClass:`${f}-clickable`,lockClass:`${f}-lock`,horizontalClass:`${f}-horizontal`,verticalClass:`${f}-vertical`,paginationDisabledClass:`${f}-disabled`}}),i.pagination={el:null,bullets:[]};let y,s=0;function w(){return!i.params.pagination.el||!i.pagination.el||Array.isArray(i.pagination.el)&&i.pagination.el.length===0}function C(j,q){const{bulletActiveClass:se}=i.params.pagination;!j||(j=j[`${q==="prev"?"previous":"next"}ElementSibling`],j&&(j.classList.add(`${se}-${q}`),j=j[`${q==="prev"?"previous":"next"}ElementSibling`],j&&j.classList.add(`${se}-${q}-${q}`)))}function L(j){const q=j.target.closest(zd(i.params.pagination.bulletClass));if(!q)return;j.preventDefault();const se=hg(q)*i.params.slidesPerGroup;if(i.params.loop){if(i.realIndex===se)return;i.slideToLoop(se)}else i.slideTo(se)}function k(){const j=i.rtl,q=i.params.pagination;if(w())return;let se=i.pagination.el;se=Jn(se);let ge,ie;const Ie=i.virtual&&i.params.virtual.enabled?i.virtual.slides.length:i.slides.length,ze=i.params.loop?Math.ceil(Ie/i.params.slidesPerGroup):i.snapGrid.length;if(i.params.loop?(ie=i.previousRealIndex||0,ge=i.params.slidesPerGroup>1?Math.floor(i.realIndex/i.params.slidesPerGroup):i.realIndex):typeof i.snapIndex<"u"?(ge=i.snapIndex,ie=i.previousSnapIndex):(ie=i.previousIndex||0,ge=i.activeIndex||0),q.type==="bullets"&&i.pagination.bullets&&i.pagination.bullets.length>0){const Ae=i.pagination.bullets;let He,Ce,Ge;if(q.dynamicBullets&&(y=M0(Ae[0],i.isHorizontal()?"width":"height",!0),se.forEach(De=>{De.style[i.isHorizontal()?"width":"height"]=`${y*(q.dynamicMainBullets+4)}px`}),q.dynamicMainBullets>1&&ie!==void 0&&(s+=ge-(ie||0),s>q.dynamicMainBullets-1?s=q.dynamicMainBullets-1:s<0&&(s=0)),He=Math.max(ge-s,0),Ce=He+(Math.min(Ae.length,q.dynamicMainBullets)-1),Ge=(Ce+He)/2),Ae.forEach(De=>{const We=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(et=>`${q.bulletActiveClass}${et}`)].map(et=>typeof et=="string"&&et.includes(" ")?et.split(" "):et).flat();De.classList.remove(...We)}),se.length>1)Ae.forEach(De=>{const We=hg(De);We===ge?De.classList.add(...q.bulletActiveClass.split(" ")):i.isElement&&De.setAttribute("part","bullet"),q.dynamicBullets&&(We>=He&&We<=Ce&&De.classList.add(...`${q.bulletActiveClass}-main`.split(" ")),We===He&&C(De,"prev"),We===Ce&&C(De,"next"))});else{const De=Ae[ge];if(De&&De.classList.add(...q.bulletActiveClass.split(" ")),i.isElement&&Ae.forEach((We,et)=>{We.setAttribute("part",et===ge?"bullet-active":"bullet")}),q.dynamicBullets){const We=Ae[He],et=Ae[Ce];for(let Gt=He;Gt<=Ce;Gt+=1)Ae[Gt]&&Ae[Gt].classList.add(...`${q.bulletActiveClass}-main`.split(" "));C(We,"prev"),C(et,"next")}}if(q.dynamicBullets){const De=Math.min(Ae.length,q.dynamicMainBullets+4),We=(y*De-y)/2-Ge*y,et=j?"right":"left";Ae.forEach(Gt=>{Gt.style[i.isHorizontal()?et:"top"]=`${We}px`})}}se.forEach((Ae,He)=>{if(q.type==="fraction"&&(Ae.querySelectorAll(zd(q.currentClass)).forEach(Ce=>{Ce.textContent=q.formatFractionCurrent(ge+1)}),Ae.querySelectorAll(zd(q.totalClass)).forEach(Ce=>{Ce.textContent=q.formatFractionTotal(ze)})),q.type==="progressbar"){let Ce;q.progressbarOpposite?Ce=i.isHorizontal()?"vertical":"horizontal":Ce=i.isHorizontal()?"horizontal":"vertical";const Ge=(ge+1)/ze;let De=1,We=1;Ce==="horizontal"?De=Ge:We=Ge,Ae.querySelectorAll(zd(q.progressbarFillClass)).forEach(et=>{et.style.transform=`translate3d(0,0,0) scaleX(${De}) scaleY(${We})`,et.style.transitionDuration=`${i.params.speed}ms`})}q.type==="custom"&&q.renderCustom?(Ae.innerHTML=q.renderCustom(i,ge+1,ze),He===0&&d("paginationRender",Ae)):(He===0&&d("paginationRender",Ae),d("paginationUpdate",Ae)),i.params.watchOverflow&&i.enabled&&Ae.classList[i.isLocked?"add":"remove"](q.lockClass)})}function R(){const j=i.params.pagination;if(w())return;const q=i.virtual&&i.params.virtual.enabled?i.virtual.slides.length:i.grid&&i.params.grid.rows>1?i.slides.length/Math.ceil(i.params.grid.rows):i.slides.length;let se=i.pagination.el;se=Jn(se);let ge="";if(j.type==="bullets"){let ie=i.params.loop?Math.ceil(q/i.params.slidesPerGroup):i.snapGrid.length;i.params.freeMode&&i.params.freeMode.enabled&&ie>q&&(ie=q);for(let Ie=0;Ie<ie;Ie+=1)j.renderBullet?ge+=j.renderBullet.call(i,Ie,j.bulletClass):ge+=`<${j.bulletElement} ${i.isElement?'part="bullet"':""} class="${j.bulletClass}"></${j.bulletElement}>`}j.type==="fraction"&&(j.renderFraction?ge=j.renderFraction.call(i,j.currentClass,j.totalClass):ge=`<span class="${j.currentClass}"></span> / <span class="${j.totalClass}"></span>`),j.type==="progressbar"&&(j.renderProgressbar?ge=j.renderProgressbar.call(i,j.progressbarFillClass):ge=`<span class="${j.progressbarFillClass}"></span>`),i.pagination.bullets=[],se.forEach(ie=>{j.type!=="custom"&&(ie.innerHTML=ge||""),j.type==="bullets"&&i.pagination.bullets.push(...ie.querySelectorAll(zd(j.bulletClass)))}),j.type!=="custom"&&d("paginationRender",se[0])}function V(){i.params.pagination=aI(i,i.originalParams.pagination,i.params.pagination,{el:"swiper-pagination"});const j=i.params.pagination;if(!j.el)return;let q;typeof j.el=="string"&&i.isElement&&(q=i.el.querySelector(j.el)),!q&&typeof j.el=="string"&&(q=[...document.querySelectorAll(j.el)]),q||(q=j.el),!(!q||q.length===0)&&(i.params.uniqueNavElements&&typeof j.el=="string"&&Array.isArray(q)&&q.length>1&&(q=[...i.el.querySelectorAll(j.el)],q.length>1&&(q=q.filter(se=>iI(se,".swiper")[0]===i.el)[0])),Array.isArray(q)&&q.length===1&&(q=q[0]),Object.assign(i.pagination,{el:q}),q=Jn(q),q.forEach(se=>{j.type==="bullets"&&j.clickable&&se.classList.add(...(j.clickableClass||"").split(" ")),se.classList.add(j.modifierClass+j.type),se.classList.add(i.isHorizontal()?j.horizontalClass:j.verticalClass),j.type==="bullets"&&j.dynamicBullets&&(se.classList.add(`${j.modifierClass}${j.type}-dynamic`),s=0,j.dynamicMainBullets<1&&(j.dynamicMainBullets=1)),j.type==="progressbar"&&j.progressbarOpposite&&se.classList.add(j.progressbarOppositeClass),j.clickable&&se.addEventListener("click",L),i.enabled||se.classList.add(j.lockClass)}))}function H(){const j=i.params.pagination;if(w())return;let q=i.pagination.el;q&&(q=Jn(q),q.forEach(se=>{se.classList.remove(j.hiddenClass),se.classList.remove(j.modifierClass+j.type),se.classList.remove(i.isHorizontal()?j.horizontalClass:j.verticalClass),j.clickable&&(se.classList.remove(...(j.clickableClass||"").split(" ")),se.removeEventListener("click",L))})),i.pagination.bullets&&i.pagination.bullets.forEach(se=>se.classList.remove(...j.bulletActiveClass.split(" ")))}c("changeDirection",()=>{if(!i.pagination||!i.pagination.el)return;const j=i.params.pagination;let{el:q}=i.pagination;q=Jn(q),q.forEach(se=>{se.classList.remove(j.horizontalClass,j.verticalClass),se.classList.add(i.isHorizontal()?j.horizontalClass:j.verticalClass)})}),c("init",()=>{i.params.pagination.enabled===!1?ue():(V(),R(),k())}),c("activeIndexChange",()=>{typeof i.snapIndex>"u"&&k()}),c("snapIndexChange",()=>{k()}),c("snapGridLengthChange",()=>{R(),k()}),c("destroy",()=>{H()}),c("enable disable",()=>{let{el:j}=i.pagination;j&&(j=Jn(j),j.forEach(q=>q.classList[i.enabled?"remove":"add"](i.params.pagination.lockClass)))}),c("lock unlock",()=>{k()}),c("click",(j,q)=>{const se=q.target,ge=Jn(i.pagination.el);if(i.params.pagination.el&&i.params.pagination.hideOnClick&&ge&&ge.length>0&&!se.classList.contains(i.params.pagination.bulletClass)){if(i.navigation&&(i.navigation.nextEl&&se===i.navigation.nextEl||i.navigation.prevEl&&se===i.navigation.prevEl))return;const ie=ge[0].classList.contains(i.params.pagination.hiddenClass);d(ie===!0?"paginationShow":"paginationHide"),ge.forEach(Ie=>Ie.classList.toggle(i.params.pagination.hiddenClass))}});const J=()=>{i.el.classList.remove(i.params.pagination.paginationDisabledClass);let{el:j}=i.pagination;j&&(j=Jn(j),j.forEach(q=>q.classList.remove(i.params.pagination.paginationDisabledClass))),V(),R(),k()},ue=()=>{i.el.classList.add(i.params.pagination.paginationDisabledClass);let{el:j}=i.pagination;j&&(j=Jn(j),j.forEach(q=>q.classList.add(i.params.pagination.paginationDisabledClass))),H()};Object.assign(i.pagination,{enable:J,disable:ue,render:R,update:k,init:V,destroy:H})}ts.use([zG,RG]);new ts(".swiper-reviews",{direction:"horizontal",slidesPerView:1,loop:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{600:{slidesPerView:2},820:{slidesPerView:3}}});function DG(){let e=[];return()=>(e.length===0&&(e=Array.from(document.querySelectorAll(".desktop-subnav-tmp")).map(c=>c.content).map(c=>c.querySelector(".desktop-subnav"))),e)}function pS(){return Array.from(document.querySelectorAll(".desktop-subnav"))}const mS=DG();function OG(){let e;return()=>(e||(e=new IntersectionObserver(i=>{let a=pS().length?[...pS(),...mS()]:[...mS()];i.forEach(c=>{a.forEach(d=>{c.target.classList.contains("nav-opacity")?d.classList.toggle("bg-opacity",c.isIntersecting):d.classList.toggle("bg-opacity",!c.isIntersecting)})})},{root:null,rootMargin:"0px 0px -80% 0px",threshold:0})),e)}const FG=OG();function BG(){const e=FG();document.querySelectorAll(".observable").forEach(i=>{e.observe(i)})}function NG(e){const i=e.getBoundingClientRect().left,a=e.getBoundingClientRect().width;return i+.5*a}function UG(){return{init(){const e=this.$refs["services--header--content"],i=this.$refs["services--header--rect"],a=NG(e);i.style.setProperty("width",a+"px")}}}function VG(e,[i,a],c){e.beginPath(),e.moveTo(i,a);for(let d=0;d<c.length;d++){const f=c[d];e.lineTo(f.x,f.y)}e.stroke()}function $G(){return{SHAPE([e,i],a,c,d=Math.PI/3){const f=e+a,y=f+c*Math.cos(d),s=i+c*Math.sin(d),w=s+c*Math.sin(d);return[{x:f,y:i,isPivot:!0},{x:y,y:s,isPivot:!0},{x:f,y:w,isPivot:!0},{x:e,y:w,isPivot:!1}]},SHAPE_ORIGIN:[0,0],SECTIONS:[],THETA:Math.PI/3,CANVAS:void 0,main(e){const i=e.getContext("2d"),a=[...this.SHAPE_ORIGIN],c=this.$refs.fluidContainer.getBoundingClientRect().left+this.$refs["icon-1"].getBoundingClientRect().width,d=300;e.width=this.SHAPE_ORIGIN[0]+2*c,e.height=this.SHAPE_ORIGIN[1]+2*d;const f=this.SHAPE(a,c,d,this.THETA);VG(i,a,f),setTimeout(()=>{this.placeSectionsOnPivots(f)},0)},getPivots(e){const i=[];for(let a=0;a<e.length;a++){const c=e[a];c.isPivot&&i.push(c)}return i},placeSectionsOnPivots(e){const i=this.getPivots(e);for(let a=0;a<this.SECTIONS.length;a++){const c=this.SECTIONS[a],d=c.getBoundingClientRect().height,f=this.$refs[`icon-${a}`].getBoundingClientRect().width;c.style.left=i[a].x-.5*f+"px",c.style.top=i[a].y-.5*d+"px"}}}}function jG(){return{}}const GG={solutions:jG},qG=(e,i)=>{const[a,c]=[...e];return[{x:a,y:c+i},{x:a+i*Math.cos(Math.PI/6),y:c+i+i*Math.sin(Math.PI/6)},{x:a+i*Math.cos(Math.PI/6),y:c+i+i*Math.sin(Math.PI/6)-i},{x:a,y:c}]},WG=([e,i],a)=>[{x:e+a*Math.cos(Math.PI/6),y:i-a*Math.sin(Math.PI/6)},{x:e+a*Math.cos(Math.PI/6)+a*Math.cos(Math.PI/6),y:i-a*Math.sin(Math.PI/6)+a*Math.sin(Math.PI/6)},{x:e+a*Math.cos(Math.PI/6)+a*Math.cos(Math.PI/6)-a*Math.cos(Math.PI/6),y:i-a*Math.sin(Math.PI/6)+a*Math.sin(Math.PI/6)+a*Math.sin(Math.PI/6)},{x:e,y:i}],HG=([e,i],a)=>[{x:e,y:i+a},{x:e+a*Math.cos(Math.PI/6),y:i+a-a*Math.sin(Math.PI/6)},{x:e+a*Math.cos(Math.PI/6),y:i+a-a*Math.sin(Math.PI/6)-a},{x:e,y:i}],gS=e=>[i=>qG(i,e),i=>WG(i,e),i=>HG(i,e)],ZG=(e,i,a)=>{const[c,d]=[...e],f=i,y=a;return[{x:c+f*Math.cos(Math.PI/6),y:d+f*Math.sin(Math.PI/6)},{x:c+f*Math.cos(Math.PI/6),y:d+y*Math.sin(Math.PI/6)+y},{x:c+f*Math.cos(Math.PI/6)-f*Math.cos(Math.PI/6),y:d+y*Math.sin(Math.PI/6)+y-f*Math.sin(Math.PI/6)},{x:c,y:d},{x:c+f*Math.cos(Math.PI/6),y:d+f*Math.sin(Math.PI/6)}]};function P0(e,i,a){console.log(a);const[c,d]=i,f=[...a],y=new Path2D;y.moveTo(c,d),e.fillText("ORIGIN",c,d);for(let s=0;s<f.length;s++)y.lineTo(f[s].x,f[s].y),e.fillText(`(${s})`,f[s].x,f[s].y);return e.stroke(y),y}function Mv(e,i,a,c=300){let d=[...i];const f=[];if(a.length===1){const y=P0(e,d,a[0](d));return f.push(y),f}for(let y=0;y<a.length;y++){y+1===a.length&&(d=[[...i][0]+c*Math.cos(Math.PI/6),[...i][1]+c+c*Math.sin(Math.PI/6)-c]);const s=a[y](d),w=P0(e,d,s);f.push(w)}return f}function XG(){return{CUBE_FACES:[],CANVAS:void 0,BIG_CUBE_SIDE_LENGTH:200,BIG_CUBE_ORIGIN_X:50,BIG_CUBE_ORIGIN_Y:500,SMALL_CUBE_SIDE_LENGTH:100,get SMALL_CUBE_ORIGIN(){const e=this.BIG_CUBE_ORIGIN_X+(this.BIG_CUBE_SIDE_LENGTH-this.SMALL_CUBE_SIDE_LENGTH)*Math.cos(Math.PI/6),i=this.BIG_CUBE_ORIGIN_Y+(this.BIG_CUBE_SIDE_LENGTH-this.SMALL_CUBE_SIDE_LENGTH)*Math.sin(Math.PI/6);return[e,i]},cubeSidePaths:[],main(e){this.CANVAS=e;const i=e.getContext("2d"),a=[this.BIG_CUBE_ORIGIN_X,this.BIG_CUBE_ORIGIN_Y],c=gS(this.BIG_CUBE_SIDE_LENGTH);Mv(i,a,c,this.BIG_CUBE_SIDE_LENGTH);const d=[...this.SMALL_CUBE_ORIGIN],f=gS(this.SMALL_CUBE_SIDE_LENGTH);this.CUBE_FACES=Mv(i,d,f,this.SMALL_CUBE_SIDE_LENGTH);const y=[d[0]+this.BIG_CUBE_SIDE_LENGTH*Math.cos(Math.PI/6),d[1]-this.BIG_CUBE_SIDE_LENGTH*Math.sin(Math.PI/6)-this.SMALL_CUBE_SIDE_LENGTH-50],s=[f[0]];Mv(i,y,s,this.SMALL_CUBE_SIDE_LENGTH),console.log("parallelogram");const w=[y[0],y[1]-100],C=ZG(w,this.SMALL_CUBE_SIDE_LENGTH,80);P0(i,origin,C)}}}function KG(){return{BOUNDARIES:[],STEP:10,ALPHA:0,ALPHA_STEP:void 0,ANIM_FRAME_1:void 0,ANIM_FRAME_2:void 0,CANVAS:this.$data.CANVAS,CTX:void 0,FILL_COLOR_RGB:[52,179,182],CUBE_FACES_AS_PATHS:this.$data.CUBE_FACES,main(e,i){this.$data.CUBE_FACES;const a=this.$data.CANVAS;this.CTX=a.getContext("2d");const c=this.$refs.circle,d=this.$refs.horizLine;this.ALPHA_STEP?this.ALPHA_STEP:(this.ALPHA_STEP=1/((d.getBoundingClientRect().width-parseFloat(getComputedStyle(c).left))/this.STEP),this.ALPHA_STEP,console.log("SAVING"),this.CTX.fillStyle=`rgba(${this.FILL_COLOR_RGB}, ${this.ALPHA})`,this.CTX.save());let f;if(this.BOUNDARIES.length)f=[...this.BOUNDARIES];else{const y=parseFloat(getComputedStyle(c).left),s=d.getBoundingClientRect().width;this.BOUNDARIES=[y,s],f=[...this.BOUNDARIES]}e.type==="mouseenter"?(this.ANIM_FRAME_2&&cancelAnimationFrame(this.ANIM_FRAME_2),this.ANIM_FRAME_1=requestAnimationFrame(()=>this.moveCircleToRight(c,f[1]))):e.type==="mouseleave"&&(this.ANIM_FRAME_1&&cancelAnimationFrame(this.ANIM_FRAME_1),this.ANIM_FRAME_2=requestAnimationFrame(()=>this.moveCircleToLeft(c,f[0])))},moveCircleToRight(e,i){console.log("moving circle to the right");const a=parseFloat(getComputedStyle(e).left);if(a<i){this.CTX.restore(),this.ALPHA+=this.ALPHA_STEP,this.CTX.fillStyle=`rgba(${this.FILL_COLOR_RGB}, ${this.ALPHA})`,this.CTX.fill(this.CUBE_FACES_AS_PATHS[0]);let c=a+this.STEP;if(c>=i){c=i,e.style.left=`${c}px`,this.CTX.restore();return}e.style.left=`${c}px`,this.ANIM_FRAME_1=requestAnimationFrame(()=>this.moveCircleToRight(e,i))}},moveCircleToLeft(e,i){console.log("moving circle to the left");const a=parseFloat(getComputedStyle(e).left);if(a>i){this.CTX.restore(),this.ALPHA-=this.ALPHA_STEP,console.log(this.ALPHA),this.CTX.fillStyle=`rgba(${this.FILL_COLOR_RGB}, ${this.ALPHA})`,this.CTX.fill(this.CUBE_FACES_AS_PATHS[0]);let c=a-this.STEP;if(c<=i){c=i,e.style.left=`${c}px`;return}e.style.left=`${c}px`,this.ANIM_FRAME_2=requestAnimationFrame(()=>this.moveCircleToLeft(e,i))}}}}function YG(){return{translationAnim:null,init(){this.placeCircles(),this.placeNavItems()},animateDMenu(e,i){this.translationAnim&&cancelAnimationFrame(this.translationAnim),this.translateCircle(e,i),this.fillCubeFace(e,i)},fillCubeFace(e,i){let a;switch(i){case 1:a=this.$refs["d-menu--top-face"];break;case 2:a=this.$refs["d-menu--right-face"];break;case 3:a=this.$refs["d-menu--left-face"];break;default:a=this.$refs["d-menu--top-face"]}e.type==="mouseenter"?a.style.opacity=100:a.style.opacity=0},translateCircle(e,i){const c=this.$refs["d-menu"].getBoundingClientRect(),f=this.$refs[`d-menu--line-${i}`].getBoundingClientRect(),y=f.right-c.left-10,s=this.getCircleX(c,f),w=this.$refs[`d-menu--circle-${i}`],C=parseFloat(w.style.left);e.type==="mouseenter"?this.moveCircleToRight(w,C,y):e.type==="mouseleave"&&this.moveCircleToLeft(w,C,s)},moveCircleToRight(e,i,a,c=10){if(i+c<a){const d=i+c;e.style.left=`${d}px`,this.translationAnim=requestAnimationFrame(()=>this.moveCircleToRight(e,d,a,c))}},moveCircleToLeft(e,i,a,c=10){if(i-c>a){const d=i-c;e.style.left=`${d}px`,this.translationAnim=requestAnimationFrame(()=>this.moveCircleToLeft(e,d,a,c))}},placeNavItems(){const i=this.$refs["d-menu"].getBoundingClientRect();for(let a=1;a<=4;a++){const d=this.$refs[`d-menu--line-${a}`].getBoundingClientRect(),f=this.getNavItemX(i,d),y=this.getNavItemY(i,d),s=this.$refs[`d-menu--nav-item-${a}`];this.placeCircle(s,f,y)}},placeNavItem(e,i,a){e.style.left=`${i}px`,e.style.top=`${a}px`},getNavItemX(e,i){return i.right-e.left+10},getNavItemY(e,i){return i.top-e.top},placeCircles(){const i=this.$refs["d-menu"].getBoundingClientRect();for(let a=1;a<=4;a++){const d=this.$refs[`d-menu--line-${a}`].getBoundingClientRect(),f=this.getCircleX(i,d),y=this.getCircleY(i,d),s=this.$refs[`d-menu--circle-${a}`];this.placeCircle(s,f,y)}},placeCircle(e,i,a){e.style.left=`${i}px`,e.style.top=`${a}px`},getCircleX(e,i){return i.left-e.left+i.width/3},getCircleY(e,i){return i.top-e.top}}}function QG(){let e;return()=>{if(!e){e={};const i=Array.from(document.querySelectorAll(".toc-item"));for(const a of i){const c=a.getAttribute("id");e[c]=a}}return e}}const JG=QG()();function e8(){return{showArticles:!1,init(){const e=new IntersectionObserver(a=>{const c=JG;a.forEach(d=>{const f=d.target.getAttribute("x-ref");c[f].classList.toggle("text-dida",d.isIntersecting),c[f].classList.toggle("font-medium",d.isIntersecting),console.log(d.target)})},{root:null,rootMargin:"0px 0px 0px 0px",threshold:.25});document.querySelectorAll(".observed").forEach(a=>{e.observe(a)})}}}const t8={highlightTOCItem:e8};Cs.data("research",$G);Cs.data("servicesHeader",UG);Cs.data("servicesSolutions",GG.solutions);Cs.data("home__services",XG);Cs.data("home__services_menu",KG);Cs.data("d_menu",YG);Cs.data("knowledge",t8.highlightTOCItem);window.axios=er;BG();window.getToken=async()=>await fetch("/!/DynamicToken/refresh").then(e=>e.json()).then(e=>e.csrf_token).catch(function(e){this.error="Something went wrong. Please try again later."});window.Alpine=Cs;Cs.plugin(Lz);Cs.plugin(Fz);Cs.plugin(oR);Cs.start();ac(E4).mount("#jobs");ac(G5).mount("#asmspotter-demo");ac(jU).mount("#faq-demo");const lI=ac(g$);lI.use(pj);lI.mount("#knowledge-base");const i8=ac(T$);i8.mount("#conference-registration-form");export{dn as F,d$ as L,e_ as T,qa as _,Fe as a,Hi as b,Nt as c,Wo as d,Ir as e,Ri as f,er as g,$i as n,Ft as o,Xd as r,Pi as t,Mu as w};
